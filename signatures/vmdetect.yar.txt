{
    "name": "vmdetect.yar",
    "rule": "// Copyright (C) 2010-2014 Cuckoo Foundation.\n// This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org\n// See the file 'docs/LICENSE' for copying permission.\n\nrule vmdetect\n{\n    meta:\n        author = \"nex\"\n        description = \"Possibly employs anti-virtualization techniques\"\n\n    strings:\n        // Binary tricks\n        $vmware = {56 4D 58 68}\n        $virtualpc = {0F 3F 07 0B}\n        $ssexy = {66 0F 70 ?? ?? 66 0F DB ?? ?? ?? ?? ?? 66 0F DB ?? ?? ?? ?? ?? 66 0F EF}\n        $vmcheckdll = {45 C7 00 01}\n        $redpill = {0F 01 0D 00 00 00 00 C3}\n\n        // Random strings\n        $vmware1 = \"VMXh\"\n        $vmware2 = \"Ven_VMware_\" nocase\n        $vmware3 = \"Prod_VMware_Virtual_\" nocase\n        $vmware4 = \"hgfs.sys\" nocase\n        $vmware5 = \"mhgfs.sys\" nocase\n        $vmware6 = \"prleth.sys\" nocase\n        $vmware7 = \"prlfs.sys\" nocase\n        $vmware8 = \"prlmouse.sys\" nocase\n        $vmware9 = \"prlvideo.sys\" nocase\n        $vmware10 = \"prl_pv32.sys\" nocase\n        $vmware11 = \"vpc-s3.sys\" nocase\n        $vmware12 = \"vmsrvc.sys\" nocase\n        $vmware13 = \"vmx86.sys\" nocase\n        $vmware14 = \"vmnet.sys\" nocase\n        $vmware15 = \"vmicheartbeat\" nocase\n        $vmware16 = \"vmicvss\" nocase\n        $vmware17 = \"vmicshutdown\" nocase\n        $vmware18 = \"vmicexchange\" nocase\n        $vmware19 = \"vmdebug\" nocase\n        $vmware20 = \"vmmouse.sys\" nocase\n        $vmware21 = \"vmtools\" nocase\n        $vmware22 = \"VMMEMCTL\" nocase\n        $vmware23 = \"vmx86\" nocase\n        $vmware24 = \"vmware\" nocase\n        $vmware25 = \"VMware Virtual IDE Hard Drive\" ascii wide\n        $virtualpc1 = \"vpcbus\" nocase\n        $virtualpc2 = \"vpc-s3\" nocase\n        $virtualpc3 = \"vpcuhub\" nocase\n        $virtualpc4 = \"msvmmouf\" nocase\n        $xen1 = \"xenevtchn\" nocase\n        $xen2 = \"xennet\" nocase\n        $xen3 = \"xennet6\" nocase\n        $xen4 = \"xensvc\" nocase\n        $xen5 = \"xenvdb\" nocase\n        $xen6 = \"XenVMM\" nocase\n        $virtualbox1 = \"VBoxHook.dll\" nocase\n        $virtualbox2 = \"VBoxService\" nocase\n        $virtualbox3 = \"VBoxTray\" nocase\n        $virtualbox4 = \"VBoxMouse\" nocase\n        $virtualbox5 = \"VBoxGuest\" nocase\n        $virtualbox6 = \"VBoxSF\" nocase\n        $virtualbox7 = \"VBoxGuestAdditions\" nocase\n        $virtualbox8 = \"VBOX HARDDISK\"  nocase\n\n        // MAC addresses\n        $vmware_mac_1a = \"00-05-69\"\n        $vmware_mac_1b = \"00:05:69\"\n        $vmware_mac_1c = \"000569\"\n        $vmware_mac_2a = \"00-50-56\"\n        $vmware_mac_2b = \"00:50:56\"\n        $vmware_mac_2c = \"005056\"\n        $vmware_mac_3a = \"00-0C-29\" nocase\n        $vmware_mac_3b = \"00:0C:29\" nocase\n        $vmware_mac_3c = \"000C29\" nocase\n        $vmware_mac_4a = \"00-1C-14\" nocase\n        $vmware_mac_4b = \"00:1C:14\" nocase\n        $vmware_mac_4c = \"001C14\" nocase\n        $virtualbox_mac_1a = \"08-00-27\"\n        $virtualbox_mac_1b = \"08:00:27\"\n        $virtualbox_mac_1c = \"080027\"\n\n        //Drivers \n        $vbox_driver_1 = \"SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions\" nocase ascii wide\n\t\t$vbox_driver_2 = \"SOFTWARE\\\\\\\\Oracle\\\\\\\\VirtualBox Guest Additions\" nocase ascii wide\n        $miscvm1 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\Disk\\\\Enum\" nocase ascii wide\n\t\t$miscvm2 = \"SYSTEM\\\\\\\\ControlSet001\\\\\\\\Services\\\\\\\\Disk\\\\\\\\Enum\" nocase ascii wide\n\n    condition:\n        2 of them \n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.601Z",
    "status": "active"
}