{
    "name": "Milan.yar",
    "rule": "rule Milan {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Milan Lyceum backdoor\"\n        cape_type = \"Milan Backdoor Payload\"\n    strings:\n        $ua1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.0.3705; .NET CLR 1.1.4322; Media Center PC 4.0; .NET CLR 2.0.50727)\" fullword wide\n        $ua2 = \"Mozilla/5.0 (Android; Mobile; rv:28.0) Gecko/28.0 Firefox/28.0\" fullword wide\n        $ua3 = \"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)\" fullword wide\n        $ua4 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; XBLWP7; ZuneWP7)\" fullword wide\n        $ua5 = \"Mozilla/5.0 (IE 11.0; Windows NT 6.3; Trident/7.0; .NET4.0E; .NET4.0C; rv:11.0) like Gecko\" fullword wide\n        $ua6 = \"Mozilla/5.0 (iPad; U; CPU OS 5_1_1 like Mac OS X; en-us) AppleWebKit/534.46.0 (KHTML, like Gecko) CriOS/19.0.1084.60 Mobile/9B206 Safari/7534.48.3\" fullword wide\n        $ua7 = \"Mozilla/5.0 (Linux; Android 4.1; Galaxy Nexus Build/JRN84D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Mobile Safari/535.19\" fullword wide\n        $ua8 = \"Mozilla/5.0 (Linux; Android 7.1.1; ASUS_X017DA Build/NGI77B; rv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Rocket/1.5.1(11790) Chrome/74.0.3729.157 Mobile Safari/537.36\" fullword wide\n        $ua9 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:54.0) Gecko/20100101 Firefox/54.0\" fullword wide\n        $ua10 = \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36\" fullword wide\n        $ua11 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36\" fullword wide\n        $ua12 = \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0\" fullword wide\n        $n1 = \"charset={[A-Za-z0-9\\\\-_]+}\" fullword wide\n        $n2 = \"Content-Length: {[0-9]+}\" fullword wide\n        $n3 = \"Location: {[0-9]+}\" fullword wide\n        $n4 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n        $n5 = \"{<html>}\" fullword wide\n        $n6 = \"&formid=\" fullword ascii\n        $n7 = \"/?id=\" fullword ascii\n        $p1 = \"\\\\milan\\\\Debug\\\\Milan.pdb\" ascii\n        $p2 = \"\\\\milan\\\\Release\\\\Milan.pdb\" ascii\n        $p3 = \"\\\\BackDor Last\\\\\" ascii\n        $p4 = \"\\\\BackDorLast\\\\\" ascii\n        $s1 = \"/q \\\"%s\\\" & waitfor\" wide\n        $s2 = \"/q \\\"%s\\\" & schtasks /delete\" wide\n        $s3 = \"*BOT@;\" fullword ascii\n        $s4 = \"mofcomp \\\"\" fullword ascii\n        $s5 = \"\\\"WQL\\\";};instance of \" ascii\n        $s6 = \"</svalue>\" fullword wide\n        $s7 = \"cmd.exe /C \" wide nocase\n        $d1 = \"akastatus.com\" ascii\n        $d2 = \"centosupdatecdn.com\" ascii\n        $d3 = \"checkinternet.org\" ascii\n        $d4 = \"cybersecnet.co.za\" ascii\n        $d5 = \"cybersecnet.org\" ascii\n        $d6 = \"defenderlive.com\" ascii\n        $d7 = \"defenderstatus.com\" ascii\n        $d8 = \"digitalmarketingagency.net\" ascii\n        $d9 = \"dnsanalizer.com\" ascii\n        $d10 = \"dnscatalog.net\" ascii\n        $d11 = \"dnscdn.org\" ascii\n        $d12 = \"dnsstatus.org\" ascii\n        $d13 = \"excsrvcdn.com\" ascii\n        $d14 = \"hpesystem.com\" ascii\n        $d15 = \"livednscdn.com\" ascii\n        $d16 = \"micrsoftonline.net\" ascii\n        $d17 = \"ndianmombais.com\" ascii\n        $d18 = \"online-analytic.com\" ascii\n        $d19 = \"securednsservice.net\" ascii\n        $d20 = \"sysadminnews.info\" ascii\n        $d21 = \"uctpostgraduate.com\" ascii\n        $d22 = \"updatecdn.net\" ascii\n        $d23 = \"web-traffic.info\" ascii\n        $d24 = \"windowsupdatecdn.com\" ascii\n        $d25 = \"wsuslink.com\" ascii\n        $d26 = \"zonestatistic.com\" ascii\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($p*) and (2 of ($s*) or 2 of ($ua*))) or (5 of ($n*) and (2 of ($ua*) or 1 of ($p*) or 1 of ($s*))) or (3 of ($s*) and (2 of ($ua*) or 5 of ($n*))) or (2 of ($d*) and 6 of them))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.631Z",
    "status": "active"
}