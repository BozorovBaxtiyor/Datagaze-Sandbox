{
    "name": "RanumBot.yar",
    "rule": "rule RanumBot {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects RanumBot / Windigo / GoStealer\"\n        cape_type = \"RanumBot Payload\"\n    strings:\n        // variant 1\n        $f1 = \"main.addSchedulerTaskSSH\" fullword ascii\n        $f2 = \"main.attackRouter\" fullword ascii\n        $f3 = \"main.decryptPassword\" fullword ascii\n        $f4 = \"main.handleScanRequest\" fullword ascii\n        $f5 = \"main.scanNetwork\" fullword ascii\n        $f6 = \"main.extractCredentials\" fullword ascii\n        $s1 = \"H_T= H_a= H_g= MB,  W_a= and  h_a= h_g= h_t= max= ptr  siz= tab= top= u_a= u_g=%s/16%s:%d%s:22+0330+0430+0530+0545+0630+0845+10\" ascii\n        $s2 = \"<== as  at  fp= is  lr: of  on  pc= sp: sp=) = ) m=+Inf, n -Inf00%x112212343125: p=ABRTACDTACSTAEDTAESTAKDTAKSTALRMAWSTAhomAtoiCESTChamDashEESTGOGCJulyJuneKILLLEAFLisuMiaoModiNZDTNZSTNewaPIPEQUITSASTSEGVTERMThai\" ascii\n        $s3 = \"W*struct { P *big.Int; Q *big.Int; G *big.Int; Y *big.Int; Rest []uint8 \\\"ssh:\\\\\\\"rest\\\\\\\"\\\" }\" ascii\n        $s4 = \"policy=api,ftp,local,password,policy,read,reboot,sensitive,sniff,ssh,telnet,test,web,winbox,write\" ascii\n        $s5 = \"/Users/alexander/go/src/mikrotik/winbox.go\" ascii\n        // variant 2\n        $xf1 = \"main.readConfig\" fullword ascii\n        $xf2 = \"main.ensureRunningAsUser\" fullword ascii\n        $xf3 = \"main.configRegPath\" fullword ascii\n        $xf4 = \"main.oldConfigRegPath\" fullword ascii\n        $uf1 = \"main.locateChrome\" fullword ascii\n        $uf2 = \"main.decryptAndUploadProfile\" fullword ascii\n        $uf3 = \"main.decryptCookies\" fullword ascii\n        $uf4 = \"main.extractPasswords\" fullword ascii\n        $uf5 = \"main.getFirefoxProfile\" fullword ascii\n        $uf6 = \"main.postBrowsersData\" fullword ascii\n        $uf7 = \"main.uploadFirefoxProfile\" fullword ascii\n        $uf8 = \"main.zipFirefoxProfile\" fullword ascii\n        $uf9 = /main\\.detect(Browsers|Chrome|Coccoc|Edge|Firefox|InternetExplorer|Opera|Yandex)/ fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and (5 of ($f*) or 4 of ($s*) or (2 of ($f*) and 2 of ($s*)) or (all of ($xf*) and 1 of ($uf*)) or 6 of ($uf*))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.630Z",
    "status": "active"
}