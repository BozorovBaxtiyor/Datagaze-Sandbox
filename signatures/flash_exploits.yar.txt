{
    "name": "flash_exploits.yar",
    "rule": "/* Copyright (C) 2016 Will Metcalf william.metcalf@gmail.com\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nrule Common_Flash_Exploit\n{\n   strings:\n       $fwshdr = \"FWS\" ascii\n       $s2 = \"check_spray_exp\" ascii fullword\n       $s3 = \"run_payload\" ascii fullword\n       $s4 = \"exp_class\" ascii fullword\n       $s5 = \"is_vuln\" ascii fullword\n   condition:\n         for any i in (1..#fwshdr) : ( for all of ($s*) : ($ in (@fwshdr[i]..@fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 8)) and uint16(@fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 6) == 0x0000)\n}\n\nrule Common_Flash_Exploit_1\n{\n   strings:\n       $fwshdr = \"FWS\" ascii\n       $s2 = \"check_spray_exp\" ascii fullword\n       $s3 = \"find_virtprot\" ascii fullword\n       $s4 = \"write_int_overflow\" ascii fullword\n   condition:\n        $fwshdr and all of ($s*)\n}\n\nrule Common_Flash_Exploit_CVE_2016_4117\n{\n  strings:\n       $fwshdr = \"FWS\" ascii\n       $s1 = \"DeleteRangeTimelineOperation\" ascii fullword\n       $s2 = {01 76}\n       $s3 = {03 69 72 74}\n       $s4 = {01 75}\n       $s5 = {02 61 6c}\n       $s6 = {01 70}\n       $s7 = {02 72 6f}\n       $s8 = {01 74}\n       $s9 = {03 65 63 74}\n   condition:\n        $fwshdr and all of ($s*)\n}\n\nrule Common_Flash_Exploit_CVE_2016_8561\n{\n  strings:\n       $s_2015_8561_1 = \"FWS\" ascii\n       $s_2015_8561_2 = \"\\x0dli32_overflow\" ascii wide nocase\n       $s_2015_8561_3 = \"\\x0dsi32_overflow\" ascii wide nocase\n       $s_2015_8561_4 = \"write_int_overflow\" ascii wide nocase\n   condition:\n       all of ($s*)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.596Z",
    "status": "active"
}