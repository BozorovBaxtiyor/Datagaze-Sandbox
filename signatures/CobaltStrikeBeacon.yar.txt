{
    "name": "CobaltStrikeBeacon.yar",
    "rule": "rule CobaltStrikeBeacon\n{\n    meta:\n        author = \"ditekshen, enzo & Elastic\"\n        description = \"Cobalt Strike Beacon Payload\"\n        cape_type = \"CobaltStrikeBeacon Payload\"\n    strings:\n        $s1 = \"%%IMPORT%%\" fullword ascii\n        $s2 = \"www6.%x%x.%s\" fullword ascii\n        $s3 = \"cdn.%x%x.%s\" fullword ascii\n        $s4 = \"api.%x%x.%s\" fullword ascii\n        $s5 = \"%s (admin)\" fullword ascii\n        $s6 = \"could not spawn %s: %d\" fullword ascii\n        $s7 = \"Could not kill %d: %d\" fullword ascii\n        $s8 = \"Could not connect to pipe (%s): %d\" fullword ascii\n        $s9 = /%s\\.\\d[(%08x).]+\\.%x%x\\.%s/ ascii\n        $pwsh1 = \"IEX (New-Object Net.Webclient).DownloadString('http\" ascii\n        $pwsh2 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n        $ver3a = {69 68 69 68 69 6b ?? ?? 69}\n        $ver3b = {69 69 69 69 69 69 69 69 69 69 69 69 69 69 69 69}\n        $ver4a = {2e 2f 2e 2f 2e 2c ?? ?? 2e}\n        $ver4b = {2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e 2e}\n        $a1 = \"%02d/%02d/%02d %02d:%02d:%02d\" xor(0x00-0xff)\n        $a2 = \"Started service %s on %s\" xor(0x00-0xff)\n        $a3 = \"%s as %s\\\\%s: %d\" xor(0x00-0xff)\n        $b_x64 = {4C 8B 53 08 45 8B 0A 45 8B 5A 04 4D 8D 52 08 45 85 C9 75 05 45 85 DB 74 33 45 3B CB 73 E6 49 8B F9 4C 8B 03}\n        $b_x86 = {8B 46 04 8B 08 8B 50 04 83 C0 08 89 55 08 89 45 0C 85 C9 75 04 85 D2 74 23 3B CA 73 E6 8B 06 8D 3C 08 33 D2}\n    condition:\n        all of ($ver3*) or all of ($ver4*) or 2 of ($a*) or any of ($b*) or 5 of ($s*) or (all of ($pwsh*) and 2 of ($s*)) or (#s9 > 6 and 4 of them)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.672Z",
    "status": "active"
}