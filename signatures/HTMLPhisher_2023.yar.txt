{
    "name": "HTMLPhisher_2023.yar",
    "rule": "/*\n   YARA Rule Set for HTML phishing\n   Author: Yasin Tas, Eye Security\n   Date: 2023-04-05\n   Identifier: HTMLPhisher_2023\n   Reference: Personal Research\n*/\n\nrule susp_documentwrite_HTML {\n   meta:\n      description = \"Detection for document.write in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $document_write = { 64 6F 63 75 6D 65 6E 74 2E 77 72 69 74 65 }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and $document_write \n}\n\nrule susp_obfuscated_HTML_atob_btoa {\n   meta:\n      description = \"Detection for JS atob in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $atob = { 61 74 6f 62 }\n      $btoa = { 62 74 6f 61 }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and ($atob or $btoa) \n}\n\nrule susp_obfuscated_HTML_eval {\n   meta:\n      description = \"Detection for JS eval in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $eval = { 65 76 61 6c }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and ($eval)\n}\n\nrule susp_obfuscated_HTML_fromCharCode {\n   meta:\n      description = \"Detection for JS fromCharcode in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $fromCharCode = { 66 72 6f 6d 43 68 61 72 43 6f 64 65 }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and $fromCharCode\n}\n\nrule susp_obfuscated_HTML_unescape_escape {\n   meta:\n      description = \"Detection for JS escape or unescape in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $unescape = { 75 6e 65 73 63 61 70 65 }\n      $escape = { 65 73 63 61 70 65 }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and ($unescape or $escape)\n}\n\nrule susp_obfuscated_HTML_decodeURIComponent {\n   meta:\n      description = \"Detection for JS decodeURIComponent in HTML files\"\n      author = \"Yasin Tas, Eye Security\"\n      reference = \"Personal Research\"\n\n   strings:\n      $html_magic0 = { 3C 21 44 4F 43 54 59 50 45 20 68 74 6D 6C 3E }\n      $html_magic1 = { 3C 68 74 6D 6C 3E }\n      $script_magic0 = { 3C 73 63 72 69 70 74 3E }\n      $script_magic1 = { 3C 73 63 72 69 70 74 20 }\n      $decodeURIComponent = { 64 65 63 6f 64 65 55 52 49 43 6f 6d 70 6f 6e 65 6e 74 }\n   condition:\n      ($html_magic0 at 0 or $html_magic1 at 0 or $script_magic0 at 0 or $script_magic1 at 0)\n      and $decodeURIComponent\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.602Z",
    "status": "active"
}