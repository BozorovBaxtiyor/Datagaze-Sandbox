{
    "name": "NPPSpy.yar",
    "rule": "import \"pe\"\n\nrule NPPSpy {\n    meta:\n        author = \"ditekShen\"\n        description = \"Detects NPPSpy / Ntospy\"\n        cape_type = \"NPPSpy Payload\"\n    strings:\n        $s1 = \"ntskrnl.dll\" fullword ascii\n        $s2 = \"PasswordStealing.dll\" fullword ascii\n        $s3 = \"ntoskrnl.dll\" fullword ascii\n        $s4 = \"\\\\programdata\\\\packag~\" ascii\n        $s5 = \"NPPSPY.dll\" fullword ascii\n        $s6 = \"MSControll.dll\" fullword ascii\n        $s7 = \"\\\\Windows\\\\Temp\\\\\" ascii\n        $s8 = \"\\\\NPPSpy\\\\\" ascii\n        // hunt\n        $s9 = \"NPGetCaps\" fullword ascii\n        $s10 = \"NPLogonNotify\" fullword ascii\n        // C:\\Users\\GrzegorzTworek\\source\\repos\\NPPSpy\\x64\\Release\\NPPSPY.pdb\n        $path = \"\\\\GrzegorzTworek\\\\\" ascii\n    condition:\n      uint16(0) == 0x5a4d and ((pe.is_dll() and filesize < 110KB and pe.number_of_exports == 2 and ((pe.exports(\"NPGetCaps\") and pe.exports(\"NPLogonNotify\")) or (1 of ($s*) and (pe.exports(\"NPGetCaps\") or pe.exports(\"NPLogonNotify\"))))) or (($path) and any of ($s*)))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.731Z",
    "status": "active"
}