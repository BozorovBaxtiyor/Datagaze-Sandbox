{
    "name": "CoreBot.yar",
    "rule": "rule CoreBot {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects CoreBot\"\n        cape_type = \"CoreBot Payload\"\n    strings:\n        $f1 = \"core.cert_fp\" fullword ascii\n        $f2 = \"core.crash_handler\" fullword ascii\n        $f3 = \"core.delay\" fullword ascii\n        $f4 = \"core.guid\" fullword ascii\n        $f5 = \"core.inject\" fullword ascii\n        $f6 = \"core.installed_file\" fullword ascii\n        $f7 = \"core.plugins_dir\" fullword ascii\n        $f8 = \"core.plugins_key\" fullword ascii\n        $f9 = \"core.safe_mode\" fullword ascii\n        $f10 = \"core.server\" fullword ascii\n        $f11 = \"core.servers\" fullword ascii\n        $f12 = \"core.test_env\" fullword ascii\n        $f13 = \"core.vm_detect\" fullword ascii\n        $f14 = \"core.vm_detect_skip\" fullword ascii\n        $s1 = \"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Touch; rv:11.0) like Gecko\" fullword wide\n        $s2 = \"\\\\Microsoft\\\\Windows\\\\AppCache\" wide\n        $s3 = \"crash_flag\" fullword wide\n        $s4 = \"container.dat\" fullword wide\n        $s5 = \"INJECTED\" fullword ascii\n        $s6 = \"tmp.delete_file\" fullword ascii\n        // variant\n        $x1 = \"CoreBot v\" wide\n        $x2 = \"BotName\" fullword ascii\n        $x3 = \"RunBotKiller\" fullword ascii\n        $x4 = \"botv\" fullword ascii\n        $x5 = \"\\\\CoreBot\\\\CoreBot\\\\obj\\\\\" ascii\n        $v1_1 = \"newtask\" fullword wide\n        $v1_2 = \"drivers\\\\etc\\\\hosts\" fullword wide\n        $v1_3 = \"/C schtasks /create /tn \\\\\" wide\n        $v1_4 = \"/st 00:00 /du 9999:59 /sc once /ri 1 /f\" wide\n        $v1_5 = \"AntivirusInstalled\" fullword ascii\n        $v1_6 = \"payload\" fullword ascii\n        $v1_7 = \"DownloadFile\" fullword ascii\n        $v1_8 = \"RemoveFile\" fullword ascii\n        $v1_9 = \"AutoRunName\" fullword ascii\n        $v1_10 = \"EditHosts\" fullword ascii\n        $v1_11 = /127\\.0\\.0\\.1 (avast|mcafee|eset|avira|bitdefender|bullguard|safebrowse)\\.com/ fullword wide\n        $cnc1 = \"&os=\" fullword wide\n        $cnc2 = \"&pv=\" fullword wide\n        $cnc3 = \"&ip=\" fullword wide\n        $cnc4 = \"&cn=\" fullword wide\n        $cnc5 = \"&lr=\" fullword wide\n        $cnc6 = \"&ct=\" fullword wide\n        $cnc7 = \"&bv=\" fullword wide\n        $cnc8 = \"&op=\" fullword wide\n        $cnc9 = \"&td=\" fullword wide\n        $cnc10 = \"&uni=\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and (5 of ($f*) or all of ($s*) or (3 of ($s*) and 2 of ($f*)) or 3 of ($x*) or 8 of ($v1*) or (4 of ($cnc*) and 4 of ($v1*)) or 12 of them)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.705Z",
    "status": "active"
}