{
    "name": "CoinMiners.yar",
    "rule": "rule CoinMiner01 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects coinminer payload\"\n        cape_type = \"CoinMiner01 Payload\"\n    strings:\n        $s1 = \"-o pool.\" ascii wide\n        $s2 = \"--cpu-max-threads-hint\" ascii wide\n        $s3 = \"-P stratum\" ascii wide\n        $s4 = \"--farm-retries\" ascii wide\n        $dl = \"github.com/ethereum-mining/ethminer/releases/download\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and (3 of ($s*) or ($dl))\n}\n\nrule CoinMiner02 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects coinmining malware\"\n        cape_type = \"CoinMiner02 Payload\"\n    strings:\n        $s1 = \"%s/%s (Windows NT %lu.%lu\" fullword ascii\n        $s2 = \"\\\\Microsoft\\\\Libs\\\\WR64.sys\" wide\n        $s3 = \"\\\\\\\\.\\\\WinRing0_\" wide\n        $s4 = \"pool_wallet\" ascii\n        $s5 = \"cryptonight\" ascii\n        $s6 = \"mining.submit\" ascii\n        $c1 = \"stratum+ssl://\" ascii\n        $c2 = \"daemon+http://\" ascii\n        $c3 = \"stratum+tcp://\" ascii\n        $c4 = \"socks5://\" ascii\n        $c5 = \"losedaemon+https://\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (3 of ($s*) and 1 of ($c*))\n}\n\nrule CoinMiner03 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects coinmining malware\"\n        cape_type = \"CoinMiner03 Payload\"\n    strings:\n        $s1 = \"UnVzc2lhbiBTdGFuZGFyZCBUaW1l\" wide\n        $s2 = \"/xmrig\" wide\n        $s3 = \"/gminer\" wide\n        $s4 = \"-o {0} -u {1} -p {2} -k --cpu-priority 0 --threads={3}\" wide\n        $s5 = \"--algo ethash --server\" wide\n        $s6 = \"--algo kawpow --server\" wide\n        $cnc1 = \"/delonl.php?hwid=\" fullword wide\n        $cnc2 = \"/gateonl.php?hwid=\" fullword wide\n        $cnc3 = \"&cpuname=\" fullword wide\n        $cnc4 = \"&gpuname=\" fullword wide\n        $cnc5 = \"{0}/gate.php?hwid={1}&os={2}&cpu={3}&gpu={4}&dateinstall={5}&gpumem={6}\" fullword wide\n        $cnc6 = \"/del.php?hwid=\" fullword wide\n        $f1 = \"<StartGpuethGminer>b__\" ascii\n        $f2 = \"<StartGpuetcGminer>b__\" ascii\n        $f3 = \"<StartGpurvnGminer>b__\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (3 of ($cnc*) or (2 of ($f*) and (1 of ($s*) or 1 of ($f*))) or all of ($f*) or 5 of ($s*))\n}\n\nrule CoinMiner04 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects coinmining malware\"\n        cape_type = \"CoinMiner04 Payload\"\n    strings:\n        $s1 = \"createDll\" fullword ascii\n        $s2 = \"getTasks\" fullword ascii\n        $s3 = \"SetStartup\" fullword ascii\n        $s4 = \"loadUrl\" fullword ascii\n        $s5 = \"Processer\" fullword ascii\n        $s6 = \"checkProcess\" fullword ascii\n        $s7 = \"runProcess\" fullword ascii\n        $s8 = \"createDir\" fullword ascii\n        $cnc1 = \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\" fullword wide\n        $cnc2 = \"?hwid=\" fullword wide\n        $cnc3 = \"?timeout=1\" fullword wide\n        $cnc4 = \"&completed=\" fullword wide\n        $cnc5 = \"/cmd.php\" wide\n    condition:\n        uint16(0) == 0x5a4d and (5 of ($s*) and 1 of ($cnc*))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.691Z",
    "status": "active"
}