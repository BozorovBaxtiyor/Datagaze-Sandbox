{
    "name": "Mimikatz.yar",
    "rule": "/*\tBenjamin DELPY `gentilkiwi`\n\thttp://blog.gentilkiwi.com\n\tbenjamin@gentilkiwi.com\n\tLicence : https://creativecommons.org/licenses/by/4.0/\n\tModified to add the CAPE type\n*/\nrule Mimikatz\n{\n\tmeta:\n\t\tdescription\t\t= \"mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\tcape_type\t\t= \"Mimikatz Payload\"\n\n\tstrings:\n\t\t$exe_x86_1\t\t= { 89 71 04 89 [0-3] 30 8d 04 bd }\n\t\t$exe_x86_2\t\t= { 8b 4d e? 8b 45 f4 89 75 e? 89 01 85 ff 74 }\n\n\t\t$exe_x64_1\t\t= { 33 ff 4? 89 37 4? 8b f3 45 85 c? 74}\n\t\t$exe_x64_2\t\t= { 4c 8b df 49 [0-3] c1 e3 04 48 [0-3] 8b cb 4c 03 [0-3] d8 }\n\n\t\t$dll_1\t\t\t= { c7 0? 00 00 01 00 [4-14] c7 0? 01 00 00 00 }\n\t\t$dll_2\t\t\t= { c7 0? 10 02 00 00 ?? 89 4? }\n\n\t\t$sys_x86\t\t= { a0 00 00 00 24 02 00 00 40 00 00 00 [0-4] b8 00 00 00 6c 02 00 00 40 00 00 00 }\n\t\t$sys_x64\t\t= { 88 01 00 00 3c 04 00 00 40 00 00 00 [0-4] e8 02 00 00 f8 02 00 00 40 00 00 00 }\n\n\tcondition:\n\t\t(all of ($exe_x86_*)) or (all of ($exe_x64_*)) or (all of ($dll_*)) or (any of ($sys_*))\n}\n\n\nrule mimikatz_lsass_mdmp\n{\n\tmeta:\n\t\tdescription\t\t= \"LSASS minidump file for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\tcape_type\t\t= \"Mimikatz LSASS minidump file\"\n\n\tstrings:\n\t\t$lsass\t\t\t= \"System32\\\\lsass.exe\"\twide nocase\n\n\tcondition:\n\t\t(uint32(0) == 0x504d444d) and $lsass\n}\n\n\nrule mimikatz_kirbi_ticket\n{\n\tmeta:\n\t\tdescription\t\t= \"KiRBi ticket for mimikatz\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\tcape_type\t\t= \"Mimikatz KiRBi ticket\"\n\n\tstrings:\n\t\t$asn1\t\t\t= { 76 82 ?? ?? 30 82 ?? ?? a0 03 02 01 05 a1 03 02 01 16 }\n\n\tcondition:\n\t\t$asn1 at 0\n}\n\n\nrule lsadump\n{\n\tmeta:\n\t\tdescription\t\t= \"LSA dump programe (bootkey/syskey) - pwdump and others\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\tcape_type\t\t= \"LSA dump Payload\"\n\n\tstrings:\n\t\t$str_sam_inc\t= \"\\\\Domains\\\\Account\" ascii nocase\n\t\t$str_sam_exc\t= \"\\\\Domains\\\\Account\\\\Users\\\\Names\\\\\" ascii nocase\n\t\t$hex_api_call\t= {(41 b8 | 68) 00 00 00 02 [0-64] (68 | ba) ff 07 0f 00 }\n\t\t$str_msv_lsa\t= { 4c 53 41 53 52 56 2e 44 4c 4c 00 [0-32] 6d 73 76 31 5f 30 2e 64 6c 6c 00 }\n\t\t$hex_bkey\t\t= { 4b 53 53 4d [20-70] 05 00 01 00}\n\n\tcondition:\n\t\t($str_sam_inc and not $str_sam_exc) or $hex_api_call or $str_msv_lsa or $hex_bkey\n}\n\n\nrule power_pe_injection\n{\n\tmeta:\n\t\tdescription\t\t= \"PowerShell with PE Reflective Injection\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\tcape_type\t\t= \"Reflective PE Injection\"\n\n\tstrings:\n\t\t$str_loadlib\t= \"0x53, 0x48, 0x89, 0xe3, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xb9\"\n\n\tcondition:\n\t\t$str_loadlib\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.632Z",
    "status": "active"
}