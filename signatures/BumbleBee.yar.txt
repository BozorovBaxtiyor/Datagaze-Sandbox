{
    "name": "BumbleBee.yar",
    "rule": "rule BumbleBeeLoader\n{\n    meta:\n        author = \"enzo & kevoreilly\"\n        description = \"BumbleBee Loader\"\n        cape_type = \"BumbleBeeLoader Payload\"\n    strings:\n        $str_set = {C7 ?? 53 65 74 50}\n        $str_path = {C7 4? 04 61 74 68 00}\n        $openfile = {4D 8B C? [0-70] 4C 8B C? [0-70] 41 8B D? [0-70] 4? 8B C? [0-70] FF D?}\n        $createsection = {89 44 24 20 FF 93 [2] 00 00 80 BB [2] 00 00 00 8B F? 74}\n        $hook = {48 85 C9 74 20 48 85 D2 74 1B 4C 8B C9 45 85 C0 74 13 48 2B D1 42 8A 04 0A 41 88 01 49 FF C1 41 83 E8 01 75 F0 48 8B C1 C3}\n        $iternaljob = \"IternalJob\"\n    condition:\n        uint16(0) == 0x5A4D and 2 of them\n}\n\nrule BumbleBeeShellcode\n{\n    meta:\n        author = \"kevoreilly\"\n        description = \"BumbleBee Loader 2023\"\n        cape_type = \"BumbleBeeLoader Payload\"\n        packed = \"51bb71bd446bd7fc03cc1234fcc3f489f10db44e312c9ce619b937fad6912656\"\n    strings:\n        $setpath = \"setPath\"\n        $alloc = {B8 01 00 00 00 48 6B C0 08 48 8D 0D [2] 00 00 48 03 C8 48 8B C1 48 89 [3] 00 00 00 8B 44 [2] 05 FF 0F 00 00 25 00 F0 FF FF 8B C0 48 89}\n        $hook = {48 85 C9 74 20 48 85 D2 74 1B 4C 8B C9 45 85 C0 74 13 48 2B D1 42 8A 04 0A 41 88 01 49 FF C1 41 83 E8 01 75 F0 48 8B C1 C3}\n        $algo = {41 8B C1 C1 E8 0B 0F AF C2 44 3B C0 73 6A 4C 8B [3] 44 8B C8 B8 00 08 00 00 2B C2 C1 E8 05 66 03 C2 8B 94 [2] 00 00 00}\n        $cape_string = \"cape_options\"\n    condition:\n        2 of them and not $cape_string\n}\n\nrule BumbleBee\n{\n    meta:\n        author = \"enzo & kevoreilly\"\n        description = \"BumbleBee Payload\"\n        cape_type = \"BumbleBee Payload\"\n    strings:\n        $antivm1 = {84 C0 74 09 33 C9 FF [4] 00 CC 33 C9 E8 [3] 00 4? 8B C8 E8}\n        $antivm2 = {84 C0 0F 85 [2] 00 00 33 C9 E8 [4] 48 8B C8 E8 [4] 48 8D 85}\n        $antivm3 = {33 C9 E8 [4] 48 8B C8 E8 [4] 83 CA FF 48 8B 0D [4] FF 15}\n        $antivm4 = {33 C9 E8 [4] 48 8B C8 E8 [4] 90 48 8B 05 [4] 48 85 C0 74}\n\t    $str_ua = \"bumblebee\"\n        $str_gate = \"/gate\"\n    condition:\n        uint16(0) == 0x5A4D and (any of ($antivm*) or all of ($str_*))\n}\n\nrule BumbleBee2024\n{\n    meta:\n        author = \"enzok\"\n        description = \"BumbleBee 2024\"\n        cape_type = \"BumbleBee Payload\"\n        packed = \"a20d56ab2e53b3a599af9904f163bb2e1b2bb7f2c98432519e1fbe87c3867e66\"\n    strings:\n        $rc4key = {48 [6] 48 [6] E8 [4] 4C 89 AD [4] 4C 89 AD [4] 4C 89 B5 [4] 4C 89 AD [4] 44 88 AD [4] 48 8D 15 [4] 44 38 2D [4] 75}\n        $botidlgt = {4C 8B C1 B? 4F 00 00 00 48 8D 0D [4] E8 [4] 4C 8B C3 48 8D 0D [4] B? 4F 00 00 00 E8 [4] 4C 8B C3 48 8D 0D [4] B? FF 0F 00 00 E8}\n        $botid = {90 48 [6] E8 [4] 4C 89 AD [4] 4C 89 AD [4] 4C 89 B5 [4] 4C 89 AD [4] 44 88 AD [4] 48 8D 15 [4] 44 38 2D [4] 75}\n        $port = {4C 89 6D ?? 4C 89 6D ?? 4c 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8D 05 [4] 44 38 2D [4] 75}\n        $dga1 = {4C 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8B 1D [4] 48 8D 0D [4] E8 [4] 8B F8}\n        $dga2 = {48 8D 0D [4] E8 [4] 8B F0 4C 89 6D ?? 4C 89 6D ?? 4C 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8D 15 [4] 44 38 2D [4] 75}\n    condition:\n        $rc4key and all of ($botid*) and 2 of ($port, $port, $dga1, $dga2)\n}",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.672Z",
    "status": "active"
}