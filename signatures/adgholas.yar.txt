{
    "name": "adgholas.yar",
    "rule": "/* Copyright (C) 2016 Will Metcalf william.metcalf@gmail.com\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nrule AdGholas_mem\n{\n  meta:\n      malfamily = \"AdGholas\"\n\n  strings:\n       $a1 = \"(3e8)!=\" ascii wide\n       $a2 = /href=\\x22\\.\\x22\\+[a-z]+\\,mimeType\\}/ ascii wide\n       $a3 = /\\+[a-z]+\\([\\x22\\x27]divx[^\\x22\\x27]+torrent[^\\x22\\x27]*[\\x22\\x27]\\.split/ ascii wide\n       $a4 = \"chls\" nocase ascii wide\n       $a5 = \"saz\" nocase ascii wide\n       $a6 = \"flac\" nocase ascii wide\n       $a7 = \"pcap\" nocase ascii wide\n\n  condition:\n       all of ($a*)\n}\n\nrule AdGholas_mem_MIME\n{\n  meta:\n      malfamily = \"AdGholas\"\n\n  strings:\n\n       $b1=\".300000000\" ascii nocase wide fullword\n       $b2=\".saz\" ascii nocase wide fullword\n       $b3=\".py\" ascii nocase wide fullword\n       $b4=\".pcap\" ascii nocase wide fullword\n       $b5=\".chls\" ascii nocase wide fullword\n  condition:\n       all of ($b*)\n}\n\n//expensive\nrule AdGholas_mem_antisec\n{\n  meta:\n      malfamily = \"AdGholas\"\n\n  strings:\n      $vid1 = \"res://c:\\\\windows\\\\system32\\\\atibtmon.exe\" nocase ascii wide\n      $vid2 = \"res://c:\\\\windows\\\\system32\\\\aticfx32.dll\" nocase ascii wide\n      $vid3 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\ati2mtag.sys\" nocase ascii wide\n      $vid4 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\atihdmi.sys\" nocase ascii wide\n      $vid5 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\atikmdag.sys\" nocase ascii wide\n      $vid6 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\igdkmd32.sys\" nocase ascii wide\n      $vid7 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\igdkmd64.sys\" nocase ascii wide\n      $vid8 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\igdpmd32.sys\" nocase ascii wide\n      $vid9 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\igdpmd64.sys\" nocase ascii wide\n      $vid10 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\mfeavfk.sys\" nocase ascii wide\n      $vid11 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\mfehidk.sys\" nocase ascii wide\n      $vid12 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\mfenlfk.sys\" nocase ascii wide\n      $vid13 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvhda32v.sys\" nocase ascii wide\n      $vid14 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvhda64v.sys\" nocase ascii wide\n      $vid15 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvlddmkm.sys\" nocase ascii wide\n      $vid16 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\pci.sys\" nocase ascii wide\n      $vid17 = \"res://c:\\\\windows\\\\system32\\\\igd10umd32.dll\" nocase ascii wide\n      $vid18 = \"res://c:\\\\windows\\\\system32\\\\igd10umd64.dll\" nocase ascii wide\n      $vid19 = \"res://c:\\\\windows\\\\system32\\\\igdumd32.dll\" nocase ascii wide\n      $vid20 = \"res://c:\\\\windows\\\\system32\\\\igdumd64.dll\" nocase ascii wide\n      $vid21 = \"res://c:\\\\windows\\\\system32\\\\igdumdim32.dll\" nocase ascii wide\n      $vid22 = \"res://c:\\\\windows\\\\system32\\\\igdumdim64.dll\" nocase ascii wide\n      $vid23 = \"res://c:\\\\windows\\\\system32\\\\igdusc32.dll\" nocase ascii wide\n      $vid24 = \"res://c:\\\\windows\\\\system32\\\\igdusc64.dll\" nocase ascii wide\n      $vid25 = \"res://c:\\\\windows\\\\system32\\\\nvcpl.dll\" nocase ascii wide\n      $vid26 = \"res://c:\\\\windows\\\\system32\\\\opencl.dll\" nocase ascii wide\n      $antisec0 = \"\\\\adclarity toolbar\\\\tbhelper.dll\" nocase ascii wide\n      $antisec1 = \"\\\\charles\\\\charles.exe\" nocase ascii wide\n      $antisec2 = \"\\\\debugging tools for windows (x86)\\\\windbg.exe\" nocase ascii wide\n      $antisec3 = \"\\\\effetech http sniffer\\\\ehsniffer.exe\" nocase ascii wide\n      $antisec4 = \"\\\\emet 4.0\\\\emet_gui.exe\" nocase ascii wide\n      $antisec5 = \"\\\\emet 4.1\\\\emet_gui.exe\" nocase ascii wide\n      $antisec6 = \"\\\\emet 5.0\\\\emet_gui.exe\" nocase ascii wide\n      $antisec7 = \"\\\\emet 5.1\\\\emet_gui.exe\" nocase ascii wide\n      $antisec8 = \"\\\\emet 5.2\\\\emet_gui.exe\" nocase ascii wide\n      $antisec9 = \"\\\\fiddler2\\\\fiddler.exe\" nocase ascii wide\n      $antisec10 = \"\\\\fiddler\\\\fiddler.exe\" nocase ascii wide\n      $antisec11 = \"\\\\fiddlercoreapi\\\\fiddlercore.dll\" nocase ascii wide\n      $antisec12 = \"\\\\geoedge\\\\geoproxy\\\\geoproxy.exe\" nocase ascii wide\n      $antisec13 = \"\\\\geoedge\\\\geovpn\\\\bin\\\\geovpn.exe\" nocase ascii wide\n      $antisec14 = \"\\\\geosurf by biscience toolbar\\\\tbhelper.dll\" nocase ascii wide\n      $antisec15 = \"\\\\httpwatch\\\\httpwatch.dll\" nocase ascii wide\n      $antisec16 = \"\\\\ieinspector\\\\httpanalyzerfullv6\\\\hookwinsockv6.dll\" nocase ascii wide\n      $antisec17 = \"\\\\ieinspector\\\\httpanalyzerfullv7\\\\hookwinsockv7.dll\" nocase ascii wide\n      $antisec18 = \"\\\\ieinspector\\\\iewebdeveloperv2\\\\iewebdeveloperv2.dll\" nocase ascii wide\n      $antisec19 = \"\\\\invincea\\\\browser protection\\\\invbrowser.exe\" nocase ascii wide\n      $antisec20 = \"\\\\invincea\\\\enterprise\\\\invprotect.exe\" nocase ascii wide\n      $antisec21 = \"\\\\invincea\\\\threat analyzer\\\\fips\\\\nss\\\\lib\\\\ssl3.dll\" nocase ascii wide\n      $antisec22 = \"\\\\malwarebytes anti-exploit\\\\mbae.exe\" nocase ascii wide\n      $antisec23 = \"\\\\malwarebytes anti-malware\\\\mbam.exe\" nocase ascii wide\n      $antisec24 = \"\\\\nirsoft\\\\smartsniff\\\\smsniff.exe\" nocase ascii wide\n      $antisec25 = \"\\\\oracle\\\\virtualbox guest additions\\\\vboxtray.exe\" nocase ascii wide\n      $antisec26 = \"\\\\parallels\\\\parallels tools\\\\prl_cc.exe\" nocase ascii wide\n      $antisec27 = \"\\\\proxifier\\\\proxifier.exe\" nocase ascii wide\n      $antisec28 = \"\\\\proxy labs\\\\proxycap\\\\pcapui.exe\" nocase ascii wide\n      $antisec29 = \"\\\\sandboxie\\\\sbiedll.dll\" nocase ascii wide\n      $antisec30 = \"\\\\softperfect network protocol analyzer\\\\snpa.exe\" nocase ascii wide\n      $antisec31 = \"\\\\ufasoft\\\\sockschain\\\\sockschain.exe\" nocase ascii wide\n      $antisec32 = \"\\\\vmware\\\\vmware tools\\\\vmtoolsd.exe\" nocase ascii wide\n      $antisec33 = \"\\\\wireshark\\\\wireshark.exe\" nocase ascii wide\n      $antisec34 = \"\\\\york\\\\york.exe\" nocase ascii wide\n      $antisec35 = \"res://c:\\\\python27\\\\python.exe\" nocase ascii wide\n      $antisec36 = \"res://c:\\\\python34\\\\python.exe\" nocase ascii wide\n      $antisec37 = \"res://c:\\\\python35\\\\python.exe\" nocase ascii wide\n      $antisec38 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\bdfsfltr.sys\" nocase ascii wide\n      $antisec39 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\bdsandbox.sys\" nocase ascii wide\n      $antisec40 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\eamon.sys\" nocase ascii wide\n      $antisec41 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\eamonm.sys\" nocase ascii wide\n      $antisec42 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\ehdrv.sys\" nocase ascii wide\n      $antisec43 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\hmpalert.sys\" nocase ascii wide\n      $antisec44 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvhda32v.sys\" nocase ascii wide\n      $antisec45 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvhda64v.sys\" nocase ascii wide\n      $antisec46 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\nvlddmkm.sys\" nocase ascii wide\n      $antisec47 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\prl_fs.sys\" nocase ascii wide\n      $antisec48 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\pssdklbf.sys\" nocase ascii wide\n      $antisec49 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\tmactmon.sys\" nocase ascii wide\n      $antisec50 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\tmcomm.sys\" nocase ascii wide\n      $antisec51 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\tmevtmgr.sys\" nocase ascii wide\n      $antisec52 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\tmtdi.sys\" nocase ascii wide\n      $antisec53 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\vboxdrv.sys\" nocase ascii wide\n      $antisec54 = \"res://c:\\\\windows\\\\system32\\\\drivers\\\\vmci.sys\" nocase ascii wide\n      $antisec55 = \"res://c:\\\\windows\\\\system32\\\\pcapwsp.dll\" nocase ascii wide\n      $antisec56 = \"res://c:\\\\windows\\\\system32\\\\prxerdrv.dll\" nocase ascii wide\n      $antisec57 = \"res://c:\\\\windows\\\\system32\\\\socketspy.dll\" nocase ascii wide\n      $antisec58 = \"res://c:\\\\windows\\\\system32\\\\vboxservice.exe\" nocase ascii wide\n      $antisec59 = \"res://c:\\\\windows\\\\system32\\\\vmsrvc.exe\" nocase ascii wide\n      $antisec60 = \"res://c:\\\\windows\\\\system32\\\\vmusrvc.exe\" nocase ascii wide\n      $antisec61 = \"res://hookwinsockv6.dll\" nocase ascii wide\n      $antisec62 = \"res://hookwinsockv7.dll\" nocase ascii wide\n      $antisec63 = \"res://httpwatch.dll\" nocase ascii wide\n      $antisec64 = \"res://invguestie.dll\" nocase ascii wide\n      $antisec66 = \"res://invredirhostie.dll\" nocase ascii wide\n      $antisec67 = \"res://mbae.dll\" nocase ascii wide\n      $antisec68 = \"res://pcapwsp.dll\" nocase ascii wide\n      $antisec69 = \"res://prxerdrv.dll\" nocase ascii wide\n      $antisec70 = \"res://sbiedll.dll\" nocase ascii wide\n      $antisec71 = \"res://sboxdll.dll\" nocase ascii wide\n      $antisec72 = \"res://socketspy.dll\" nocase ascii wide\n      $antisec73 = \"res://xproxyplugin.dll\" nocase ascii wide\n  condition:\n       any of ($vid*) and 20 of ($antisec*)\n}\n\nrule AdGholas_mem_antisec_M2\n{\n  meta:\n      malfamily = \"AdGholas\"\n  strings:\n      $s1 = \"ActiveXObject(\\\"Microsoft.XMLDOM\\\")\" nocase ascii wide\n      $s2 = \"loadXML\" nocase ascii wide fullword\n      $s3 = \"parseError.errorCode\" nocase ascii wide\n      $s4 = /res\\x3a\\x2f\\x2f[\\x27\\x22]\\x2b/ nocase ascii wide\n      $s5 = /\\x251e3\\x21\\s*\\x3d\\x3d\\s*[a-zA-Z]+\\x3f1\\x3a0/ nocase ascii wide\n  condition:\n      all of ($s*)\n}\n\nrule AdGholas_mem_MIME_M2\n{\n  meta:\n      malfamily = \"AdGholas\"\n  strings:\n      $s1 = \"halog\" nocase ascii wide fullword\n      $s2 = \"pcap\" nocase ascii wide fullword\n      $s3 = \"saz\" nocase ascii wide fullword\n      $s4 = \"chls\" nocase ascii wide fullword\n      $s5 = /return[^\\x3b\\x7d\\n]+href\\s*=\\s*[\\x22\\x27]\\x2e[\\x27\\x22]\\s*\\+\\s*[^\\x3b\\x7d\\n]+\\s*,\\s*[^\\x3b\\x7d\\n]+\\.mimeType/ nocase ascii wide\n      $s6 = /\\x21==[a-zA-Z]+\\x3f\\x210\\x3a\\x211/ nocase ascii wide\n  condition:\n      all of ($s*)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.597Z",
    "status": "active"
}