{
    "name": "IRCBot.yar",
    "rule": "rule IRCBot {\n    meta:\n      author = \"ditekshen\"\n      description = \"IRCBot payload\"\n      cape_type = \"IRCBot payload\"\n    strings:\n        $s1 = \".okuninstall\" fullword wide\n        $s2 = \".oksnapshot\" fullword wide\n        $s3 = \"\\\\uspread.vbs\" fullword wide\n        $s4 = \"KEYLogger\" ascii nocase\n        $s5 = \"GetKeyLogs\" fullword ascii\n        $s6 = \"GetLoocationInfo\" fullword ascii\n        $s7 = \"CaputerScreenshot\" fullword ascii\n        $s8 = \"get_SCRIPT_DATA\" fullword ascii\n        $s9 = /irc_(server|nickname|password|channle)/ fullword ascii\n        $s10 = \"machine_screenshot\" fullword ascii\n        $s11 = \"CollectPassword\" fullword ascii\n        $s12 = \"USBInfection\" fullword ascii nocase\n\n        $cnc1 = \"&command=UpdateAndGetTasks&machine_id=\" wide\n        $cnc2 = \"&machine_os=1&privateip=\" wide\n        $cnc3 = \"&command=InsertTaskExecution&excuter_id=\" wide\n        $cnc4 = \"&command=RegisterNewMachine\" wide\n        $cnc5 = \"&command=UpdateNewMachine\" wide\n        $cnc6 = \"&command=GetPayloads&keys=\" wide\n        $cnc7 = \"&command=SaveSnapshot\" wide\n\n        $pdb = \"\\\\Projects\\\\USBStarter\\\\USBStarter\\\\obj\\\\Release\\\\USBStarter.pdb\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (7 of ($s*) or 3 of ($cnc*) or ($pdb and 2 of them))\n}\n\nrule GENIRCBot {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects generic IRCBots\"\n        cape_type = \"IRCBot Generic Payload\"\n    strings:\n        $s1 = \"@login\" ascii nocase\n        $s2 = \"PRIVMSG\" fullword ascii\n        $s3 = \"JOIN\" fullword ascii\n        $s4 = \"PING :\" fullword ascii\n        $s5 = \"NICK\" fullword ascii\n        $s6 = \"USER\" fullword ascii\n        $x1 = \"irc.danger.net\" fullword ascii nocase\n        $x2 = \"evilBot\" fullword ascii nocase\n        $x3 = \"#evilChannel\" fullword ascii nocase\n    condition:\n        uint16(0) == 0x5a4d and (all of ($s*) or 2 of ($x*))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.730Z",
    "status": "active"
}