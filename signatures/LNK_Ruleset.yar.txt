{
    "name": "LNK_Ruleset.yar",
    "rule": "private rule isLNK\n{\nmeta:\n\tdescription = \"Private rule identifying shortcut (LNK) files. To be used in conjunction with the other LNK rules below.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$lnk = { 4C 00 00 00 01 14 02 00 }\ncondition:\n\t$lnk at 0\n}\n\nrule PS_in_LNK\n{\nmeta:\n\tdescription = \"Identifies PowerShell artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \".ps1\" ascii wide nocase\n\t$ = \"powershell\" ascii wide nocase\n\t$ = \"invoke\" ascii wide nocase\n\t$ = \"[Convert]\" ascii wide nocase\n\t$ = \"FromBase\" ascii wide nocase\n\t$ = \"-exec\" ascii wide nocase\n\t$ = \"-nop\" ascii wide nocase\n\t$ = \"-noni\" ascii wide nocase\n\t$ = \"-noninteractive\" ascii wide nocase\n\t$ = \"-w hidden\" ascii wide nocase\n\t$ = \"-enc\" ascii wide nocase\n\t$ = \"-decode\" ascii wide nocase\n\t$ = \"bypass\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Script_in_LNK\n{\nmeta:\n\tdescription = \"Identifies scripting artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"javascript\" ascii wide nocase\n\t$ = \"jscript\" ascii wide nocase\n\t$ = \"vbscript\" ascii wide nocase\n\t$ = \"wscript\" ascii wide nocase\n\t$ = \"cscript\" ascii wide nocase\n\t$ = \".js\" ascii wide nocase\n\t$ = \".vb\" ascii wide nocase //.vb, .vbs and .vbe\n\t$ = \".wsc\" ascii wide nocase\n\t$ = \".wsh\" ascii wide nocase\n\t$ = \".wsf\" ascii wide nocase\n\t$ = \".sct\" ascii wide nocase\n\t$ = \".cmd\" ascii wide nocase\n\t$ = \".hta\" ascii wide nocase\n\t$ = \".bat\" ascii wide nocase\n\t$ = \"ActiveXObject\" ascii wide nocase\n\t$ = \"eval\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Archive_in_LNK\n{\nmeta:\n\tdescription = \"Identifies archive (compressed) files in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \".7z\" ascii wide nocase\n\t$ = \".zip\" ascii wide nocase\n\t$ = \".cab\" ascii wide nocase\n\t$ = \".iso\" ascii wide nocase\n\t$ = \".rar\" ascii wide nocase\n\t$ = \".bz2\" ascii wide nocase\n\t$ = \".tar\" ascii wide nocase\n\t$ = \".lzh\" ascii wide nocase\n\t$ = \".dat\" ascii wide nocase\n\t$ = \"expand\" ascii wide nocase\n\t$ = \"makecab\" ascii wide nocase\n\t$ = \"UEsDBA\" ascii wide nocase // ZIP Base64\n\t$ = \"TVNDRg\" ascii wide nocase //CAB Base64\ncondition:\n\tisLNK and any of them\n}\n\nrule Execution_in_LNK\n{\nmeta:\n\tdescription = \"Identifies execution artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"cmd.exe\" ascii wide nocase\n\t$ = \"/c echo\" ascii wide nocase\n\t$ = \"/c start\" ascii wide nocase\n\t$ = \"/c set\" ascii wide nocase\n\t$ = \"%COMSPEC%\" ascii wide nocase\n\t$ = \"rundll32.exe\" ascii wide nocase\n\t$ = \"regsvr32.exe\" ascii wide nocase\n\t$ = \"Assembly.Load\" ascii wide nocase\n\t$ = \"[Reflection.Assembly]::Load\" ascii wide nocase\n\t$ = \"process call\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Compilation_in_LNK\n{\nmeta:\n\tdescription = \"Identifies compilation artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"vbc.exe\" ascii wide nocase\n\t$ = \"csc.exe\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Download_in_LNK\n{\nmeta:\n\tdescription = \"Identifies download artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"bitsadmin\" ascii wide nocase\n\t$ = \"certutil\" ascii wide nocase\n\t$ = \"ServerXMLHTTP\" ascii wide nocase\n\t$ = \"http\" ascii wide nocase //http and https\n\t$ = \"ftp\" ascii wide nocase\n\t$ = \".url\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule PDF_in_LNK\n{\nmeta:\n\tdescription = \"Identifies Adobe Acrobat artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \".pdf\" ascii wide nocase\n\t$ = \"%PDF\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Flash_in_LNK\n{\nmeta:\n\tdescription = \"Identifies Adobe Flash artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \".swf\" ascii wide nocase\n\t$ = \".fws\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule SMB_in_LNK\n{\nmeta:\n\tdescription = \"Identifies SMB (share) artefacts in shortcut (LNK) files.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"\\\\c$\\\\\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n\nrule Large_filesize_LNK\n{\nmeta:\n\tdescription = \"Identifies shortcut (LNK) file larger than 100KB. Most goodware LNK files are smaller than 100KB.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\ncondition:\n\tisLNK and filesize > 100KB\n}\n\nimport \"math\"\nrule High_Entropy_LNK\n{\nmeta:\n\tdescription = \"Identifies shortcut (LNK) file with equal or higher entropy than 6.5. Most goodware LNK files have a low entropy, lower than 6.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\ttlp = \"White\"\ncondition:\n\tisLNK and math.entropy(0, filesize) >= 6.5\n}\n\nrule CDN_in_LNK\n{\nmeta:\n\tdescription = \"Identifies CDN (Content Delivery Network) domain in shortcut (LNK) file.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-03\"\n\ttlp = \"White\"\nstrings:\n\t$ = \"cdn.\" ascii wide nocase //May FP\n\t$ = \"githubusercontent\" ascii wide nocase\n\t$ = \"googleusercontent\" ascii wide nocase\n\t$ = \"cloudfront\" ascii wide nocase\n\t$ = \"amazonaws.com\" ascii wide nocase\n\t$ = \"akamai\" ascii wide nocase\n\t$ = \"cdn77\" ascii wide nocase\n\t$ = \"discordapp\" ascii wide nocase\ncondition:\n\tisLNK and any of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.604Z",
    "status": "active"
}