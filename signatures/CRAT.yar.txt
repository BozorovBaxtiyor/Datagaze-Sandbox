{
    "name": "CRAT.yar",
    "rule": "rule CRAT {\n    meta:\n        author = \"ditekSHen\"\n        description = \"CRAT payload\"\n        cape_type = \"CRAT Payload\"\n    strings:\n        $s1 = \"cmd /c \\\"dir %s /s >> %s\\\"\" wide\n        $s2 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" wide\n        $s3 = \"Location: {[0-9]+}\" wide\n        $s4 = \"Content-Disposition: form-data; name=\\\"%s\\\"; filename=\\\"\" ascii\n        $s6 = \"%serror.log\" wide\n        $v2x_1 = \"?timestamp=%u\" wide\n        $v2x_2 = \"config.txt\" wide\n        $v2x_3 = \"entdll.dll\" wide\n        $v2x_4 = \"\\\\cmd.exe\" wide\n        $v2x_5 = \"[MyDocuments]\" wide\n        $v2x_6 = \"@SetWindowTextW FindFileExA\" wide\n        $v2x_7 = \"Microsoft\\\\Windows\\\\WinX\\\\Group1\\\\*.exe\" wide\n        $v2s_1 = \"Installed Anti Virus Programs\" ascii\n        $v2s_2 = \"Running Processes\" ascii\n        $v2s_3 = \"id=%u&content=\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (all of ($s*) or 6 of ($v2x*) or all of ($v2s*) or (2 of ($v2s*) and 4 of ($v2x*)))\n}\n\nrule CRATPluginKeylogger {\n    meta:\n        author = \"ditekshen\"\n        description = \"CRAT keylogger plugin payload\"\n        cape_type = \"CRAT KeyloggerPlugin Payload\"\n    strings:\n        $ai1 = \"VM detected!\" fullword wide\n        $ai2 = \"Sandbox detected!\" fullword wide\n        $ai3 = \"Debug detected!\" fullword wide\n        $ai4 = \"Analysis process detected!\" fullword wide\n        $s1 = \"Create KeyLogMutex %s failure %d\" wide\n        $s2 = \"Key Log Mutex already created! %s\" wide\n        $s3 = /KeyLogThread\\s(started|finished|terminated)!/ wide\n        $s4 = /KeyLog_(x64|x32|Win64|Win32)_DllRelease\\.dll/ fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((all of ($ai*) and 1 of ($s*)) or (3 of ($s*) and 1 of ($ai*)) or 5 of them)\n}\n\nrule CRATPluginClipboardMonitor {\n    meta:\n        author = \"ditekshen\"\n        description = \"CRAT clipboard monitor plugin payload\"\n        cape_type = \"CRAT ClipboardMonitorPlugin Payload\"\n    strings:\n        $ai1 = \"VM detected!\" fullword wide\n        $ai2 = \"Sandbox detected!\" fullword wide\n        $ai3 = \"Debug detected!\" fullword wide\n        $ai4 = \"Analysis process detected!\" fullword wide\n        $s1 = \"Clipboard Monitor Mutex [%s] already created!\" wide\n        $s2 = \"ClipboardMonitorThread started!\" fullword wide\n        $s3 = /MonitorClipboardThread\\s(finished|terminated)!/ wide\n        $s4 = /ClipboardMonitor_(x64|x32|Win64|Win32)_DllRelease\\.dll/ fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((all of ($ai*) and 1 of ($s*)) or (3 of ($s*) and 1 of ($ai*)) or 5 of them)\n}\n\nrule CRATPluginScreenCapture {\n    meta:\n        author = \"ditekshen\"\n        description = \"CRAT screen capture plugin payload\"\n        cape_type = \"CRAT ScreenCapturePlugin Payload\"\n    strings:\n        $ai1 = \"VM detected!\" fullword wide\n        $ai2 = \"Sandbox detected!\" fullword wide\n        $ai3 = \"Debug detected!\" fullword wide\n        $ai4 = \"Analysis process detected!\" fullword wide\n        $s1 = \"User is inactive!, give up capture\" wide\n        $s2 = \"Capturing screen...\" wide\n        $s3 = \"%s\\\\P%02d%lu.tmp\" fullword wide\n        $s4 = \"CloseHandle ScreenCaptureMutex failure! %d\" fullword wide\n        $s5 = \"ScreenCaptureMutex already created! %s\" fullword wide\n        $s6 = \"Create ScreenCaptureMutex %s failure %d\" fullword wide\n        $s7 = /ScreenCaptureThread\\s(finished|terminated)!/ wide\n        $s8 = /ScreenCapture_(x64|x32|Win64|Win32)_DllRelease\\.dll/ fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((all of ($ai*) and 1 of ($s*)) or (3 of ($s*) and 1 of ($ai*)) or 6 of them)\n}\n\nrule CRATRansomHansom {\n    meta:\n        author = \"ditekshen\"\n        description = \"CRAT hansom ransom plugin payload\"\n        cape_type = \"CRAT HansomRansomPlugin Payload\"\n    strings:\n        $cmd1 = \"/f /im \\\"%s\\\"\" wide\n        $cmd2 = \"add HKLM\\\\%s /v %s /t REG_DWORD /d %d /F\" wide\n        $cmd3 = \"add HKCU\\\\%s /v %s /t REG_DWORD /d %d /F\" wide\n        $cmd4 = \"\\\"%s\\\" a -y -ep -k -r -s -ibck -df -m0 -hp%s -ri1:%d \\\"%s\\\" \\\"%s\\\"\" wide\n        $s1 = \"\\\\hansom.jpg\" wide\n        $s2 = \"HansomMain\" fullword ascii wide\n        $s3 = \"ExtractHansom\" fullword ascii wide\n        $s4 = \"Hansom2008\" fullword ascii\n        $s5 = \".hansomkey\" fullword wide\n        $s6 = \".hansom\" fullword wide\n        $s7 = /Ransom_(x64|x32|Win64|Win32)_DllRelease\\.dll/ fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((2 of ($cmd*) and 2 of ($s*)) or (4 of ($s*) and 1 of ($cmd*)) or 6 of them)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.716Z",
    "status": "active"
}