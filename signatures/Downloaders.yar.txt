{
    "name": "Downloaders.yar",
    "rule": "import \"pe\"\n\nrule DLAgent01 {\n    meta:\n      author = \"ditekshen\"\n      description = \"Detects downloader agent\"\n      cape_type = \"DLAgent01 Payload\"\n    strings:\n        $s1 = \"Mozilla/5.0 Gecko/41.0 Firefox/41.0\" fullword wide\n        $s2 = \"/Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List\" fullword wide\n        $s3 = \"GUID.log\" fullword wide\n        $s4 = \"NO AV\" fullword wide\n        $s5 = \"%d:%I64d:%I64d:%I64d\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule DLAgent02 {\n    meta:\n      author = \"ditekSHen\"\n      description = \"Detects known downloader agent downloading encoded binaries in patches from paste-like websites, most notably hastebin\"\n      cape_type = \"DLAgent02 Payload\"\n    strings:\n        $x1 = \"/c timeout {0}\" fullword wide\n        $x2 = \"^(https?|ftp):\\\\/\\\\/\" fullword wide\n        $x3 = \"{0}{1}{2}{3}\" wide\n        $x4 = \"timeout {0}\" fullword wide\n        $s1 = \"HttpWebRequest\" fullword ascii\n        $s2 = \"GetResponseStream\" fullword ascii\n        $s3 = \"set_FileName\" fullword ascii\n        $s4 = \"set_UseShellExecute\" fullword ascii\n        $s5 = \"WebClient\" fullword ascii\n        $s6 = \"set_CreateNoWindow\" fullword ascii\n        $s7 = \"DownloadString\" fullword ascii\n        $s8 = \"WriteByte\" fullword ascii\n        $s9 = \"CreateUrlCacheEntryW\" fullword ascii\n        $s10 = \"HttpStatusCode\" fullword ascii\n        $s11 = \"FILETIME\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and ((2 of ($x*) and 2 of ($s*)) or (#x3 > 2 and 4 of ($s*)))\n}\n\nrule DLAgent03 {\n    meta:\n      author = \"ditekSHen\"\n      description = \"Detects known Delphi downloader agent downloading second stage payload, notably from discord\"\n      cape_type = \"DLAgent03 Payload\"\n    strings:\n        $delph1 = \"FastMM Borland Edition\" fullword ascii\n        $delph2 = \"SOFTWARE\\\\Borland\\\\Delphi\" ascii\n        $v1_1 = \"InternetOpenUrlA\" fullword ascii\n        $v1_2 = \"CreateFileA\" fullword ascii\n        $v1_3 = \"WriteFile\" fullword ascii\n        $v1_4 = \"$(,048<@DHLLPPTTXX\\\\\\\\``ddhhllppttttxxxx||||\" ascii\n        $v2_1 = \"WinHttp.WinHttpRequest.5.1\" fullword ascii\n        $v2_2 = { 6f 70 65 6e ?? ?? ?? ?? ?? 73 65 6e 64 ?? ?? ?? ?? 72 65 73 70 6f 6e 73 65 74 65 78 74 }\n        // $pat is slowing down scanning\n        //$pat = /[a-f0-9]{168}/ fullword ascii\n        $url1 = \"https://discord.com/\" fullword ascii\n        $url2 = \"http://www.superutils.com\" fullword ascii\n    condition:\n        //uint16(0) == 0x5a4d and 1 of ($delph*) and $discord and ((all of ($v1*) or all of ($v2*)) or $pat)\n        uint16(0) == 0x5a4d and 1 of ($delph*) and 1 of ($url*) and (all of ($v1*) or 1 of ($v2*))\n}\n\nrule DLAgent04 {\n    meta:\n      author = \"ditekSHen\"\n      description = \"Detects known downloader agent downloading encoded binaries in patches from paste-like websites, most notably hastebin\"\n      cape_type = \"DLAgent04 Payload\"\n    strings:\n        $x1 = \"@@@http\" ascii wide\n        $s1 = \"HttpWebRequest\" fullword ascii\n        $s2 = \"GetResponseStream\" fullword ascii\n        $s3 = \"set_FileName\" fullword ascii\n        $s4 = \"set_UseShellExecute\" fullword ascii\n        $s5 = \"WebClient\" fullword ascii\n        $s6 = \"set_CreateNoWindow\" fullword ascii\n        $s7 = \"DownloadString\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and #x1 > 1 and 4 of ($s*)\n}\n\nrule DLAgent05 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects an unknown dropper. Typically exisys as a DLL in base64-encoded gzip-compressed file embedded within another executable\"\n        cape_type = \"DLAgent05 Payload\"\n    strings:\n        $s1 = \"MARCUS.dll\" fullword ascii wide\n        $s2 = \"GZipStream\" fullword ascii\n        $s3 = \"MemoryStream\" fullword ascii\n        $s4 = \"proj_name\" fullword ascii\n        $s5 = \"res_name\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule DLAgent06 {\n    meta:\n      author = \"ditekSHen\"\n      description = \"Detects known downloader agent downloading encoded binaries in patches\"\n      cape_type = \"DLAgent06 Payload\"\n    strings:\n        $s1 = \"totallist\" fullword ascii wide\n        $s2 = \"LINKS_HERE\" fullword wide\n        $s3 = \"[SPLITTER]\" fullword wide\n        $var2_1 = \"DownloadWeb\" fullword ascii\n        $var2_2 = \"WriteByte\" fullword ascii\n        $var2_3 = \"MemoryStream\" fullword ascii\n        $var2_4 = \"DownloadString\" fullword ascii\n        $var2_5 = \"WebClient\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((all of ($s*) and 2 of ($var2*)) or (4 of ($var2*) and 2 of ($s*)))\n}\n\nrule DLAgent07 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects delf downloader agent\"\n        cape_type = \"DLAgent07 Payload\"\n    strings:\n        $s1 = \"C:\\\\Users\\\\Public\\\\Libraries\\\\temp\" fullword ascii\n        $s2 = \"SOFTWARE\\\\Borland\\\\Delphi\" ascii\n        $s3 = \"Mozilla/5.0(compatible; WinInet)\" fullword ascii\n        $o1 = { f3 a5 e9 6b ff ff ff 5a 5d 5f 5e 5b c3 a3 00 40 }\n        $o2 = { e8 83 d5 ff ff 8b 15 34 40 41 00 89 10 89 58 04 }\n        $o3 = { c3 8b c0 53 51 e8 f1 ff ff ff 8b d8 85 db 74 3e }\n        $o4 = { e8 5c e2 ff ff 8b c3 e8 b9 ff ff ff 89 04 24 83 }\n        $o5 = { 85 c0 74 1f e8 62 ff ff ff a3 98 40 41 00 e8 98 }\n        $o6 = { 85 c0 74 19 e8 be ff ff ff 83 3d 98 40 41 00 ff }\n        $x1 = \"22:40:08        \\\"> <rdf:RDF xmlns:rdf=\\\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\\\"> <rdf:Description rdf:about=\\\"\\\"\" ascii\n        $x2 = \"uuid:A9BD8E384B2FDE118D26E6EE744C235C\\\" stRef:documentID=\\\"uuid:A8BD8E384B2FDE118D26E6EE744C235C\\\"/>\" ascii\n    condition:\n        uint16(0) == 0x5a4d and ((2 of ($s*) and 5 of ($o*)) or (all of ($s*) and 2 of ($o*)) or (all of ($x*) and 2 of them))\n}\n\nrule DLAgentGo {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Go-based downloader\"\n        cape_type = \"DLAgentGo Payload\"\n    strings:\n        $s1 = \"main.downloadFile\" fullword ascii\n        $s2 = \"main.fetchFiles\" fullword ascii\n        $s3 = \"main.createDefenderAllowanceException\" fullword ascii\n        $s4 = \"main.unzip\" fullword ascii\n        $s5 = \"HideWindow\" fullword ascii\n        $s6 = \"/go/src/installwrap/main.go\" ascii\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule DLAgent09 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects known downloader agent\"\n        cape_type = \"DLAgent09 Payload\"\n    strings:\n        $h1 = \"//:ptth\" ascii wide nocase\n        $h2 = \"//:sptth\" ascii wide nocase\n        $s1 = \"DownloadString\" fullword ascii wide\n        $s2 = \"StrReverse\" fullword ascii wide\n        $s3 = \"FromBase64String\" fullword ascii wide\n        $s4 = \"WebClient\" fullword ascii wide\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($h*) and all of ($s*))\n}\n\nrule DLAgent10 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects known downloader agent\"\n        cape_type = \"DLAgent10 Payload\"\n    strings:\n        $s1 = \"powershell.exe\" ascii wide nocase\n        $s2 = \".DownloadFile(\" ascii wide nocase\n        $s3 = \"_UseShellExecute\" ascii wide nocase\n        $s4 = \"_CreateNoWindow\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule DLAgent11 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader agent\"\n        cape_type = \"DLAgent11 Payload\"\n    strings:\n        $pdb = \"\\\\loader2\\\\obj\\\\Debug\\\\loader2.pdb\" ascii\n        $s1 = \"DownloadFile\" fullword ascii\n        $s2 = \"ZipFile\" fullword ascii\n        $s3 = \"WebClient\" fullword ascii\n        $s4 = \"ExtractToDirectory\" fullword ascii\n        $s5 = \"System Clear\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and (all of ($s*) or (($pdb) and 4 of ($s*)))\n}\n\nrule DLAgent12 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader agent\"\n        cape_type = \"DLAgent12 Payload\"\n    strings:\n        $s1 = \"WebClient\" fullword ascii\n        $s2 = \"DownloadData\" fullword ascii\n        $s3 = \"packet_server\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and all of them and filesize < 50KB\n}\n\nrule DLInjector01 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects specific downloader injector shellcode\"\n    strings:\n        $s1 = \"process call create \\\"%s\\\"\" ascii wide\n        $s2 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Enum\\\\\" ascii wide\n        $s3 = \"%systemroot%\\\\system32\\\\ntdll.dll\" ascii wide\n        $s4 = \"qemu-ga.exe\" ascii wide\n        $s5 = \"prl_tools.exe\" ascii wide\n        $s6 = \"vboxservice.exe\" ascii wide\n        $o1 = { 75 04 74 02 38 6e 8b 34 24 83 c4 04 eb 0a 08 81 }\n        $o2 = { 16 f8 f7 ba f0 3d 87 c7 95 13 b7 64 22 be e1 59 }\n        $o3 = { 8b 0c 24 83 c4 04 eb 05 ea f2 eb ef 05 e8 ad fe }\n        $o4 = { eb 05 1d 51 eb f5 ce e8 80 fd ff ff 77 a1 f4 cd }\n        $o5 = { eb 05 6e 33 eb f5 73 e8 64 f6 ff ff 77 a1 f4 77 }\n        $o6 = { 59 eb 05 fd 98 eb f4 50 e8 d5 f5 ff ff 3b b9 00 }\n        $o7 = \"bYkoDA7G\" fullword ascii\n    condition:\n        (uint16(0) == 0x5a4d and all of ($o*)) or (all of ($s*))\n}\n\nrule DLInjector02 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader injector\"\n    strings:\n        $x1 = \"In$J$ct0r\" fullword wide\n        $x2 = \"%InJ%ector%\" fullword wide\n        $a1 = \"WriteProcessMemory\" fullword wide\n        $a2 = \"URLDownloadToFileA\" fullword ascii\n        $a3 = \"Wow64SetThreadContext\" fullword wide\n        $a4 = \"VirtualAllocEx\" fullword wide\n        $s1 = \"RunPE\" fullword wide\n        $s2 = \"SETTINGS\" fullword wide\n        $s3 = \"net.pipe\" fullword wide\n        $s4 = \"vsmacros\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*) or (all of ($a*) and 3 of ($s*)))\n}\n\nrule DLAgent14 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader injector\"\n        cape_type = \"DLAgent14 Payload\"\n    strings:\n        $s1 = \"%ProgramData%\\\\AVG\" fullword wide\n        $s2 = \"%ProgramData%\\\\AVAST Software\" fullword wide\n        $s3 = \"%wS\\\\%wS.vbs\" fullword wide\n        $s4 = \"%wS\\\\%wS.exe\" fullword wide\n        $s5 = \"CL,FR,US,CY,FI,HR,HU,RO,PL,IT,PT,ES,CA,DK,AT,NL,AU,AR,NP,SE,BE,NZ,SK,GR,BG,NO,GE\" ascii\n        $s6 = \"= CreateObject(\\\"Microsoft.XMLHTTP\\\")\" ascii\n    condition:\n        uint16(0) == 0x5a4d and 5 of them\n}\n\nrule DLInjector03 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects unknown loader / injector\"\n    strings:\n        $x1 = \"LOADER ERROR\" fullword ascii\n        $s1 = \"_ZN6curlpp10OptionBaseC2E10CURLoption\" fullword ascii\n        $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule Phonzy {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects specific downloader agent\"\n        cape_type = \"Phonzy Payload\"\n    strings:\n        $ua1 = \"User-Agent: Mozilla/5.0 (X11; Linux\" wide\n        $s1 = \"<meta name=\\\"keywords\\\" content=\\\"([\\\\w\\\\d ]*)\\\">\" fullword wide\n        $s2 = \"WebClient\" fullword ascii\n        $s3 = \"WriteAllText\" fullword ascii\n        $s4 = \"DownloadString\" fullword ascii\n        $s5 = \"WriteByte\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and (all of ($s*) or (1 of ($ua*) and ($s1) and 2 of ($s*)))\n}\n\nrule ShellcodeDLEI {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects shellcode downloader, executer, injector\"\n        cape_type = \"ShellcodeInject Payload\"\n    strings:\n        $s1 = \"PPidSpoof\" fullword ascii\n        $s2 = \"ProcHollowing\" fullword ascii\n        $s3 = \"CreateProcess\" fullword ascii\n        $s4 = \"DynamicCodeInject\" fullword ascii\n        $s5 = \"PPIDDynCodeInject\" fullword ascii\n        $s6 = \"MapAndStart\" fullword ascii\n        $s7 = \"PPIDAPCInject\" fullword ascii\n        $s8 = \"PPIDDLLInject\" fullword ascii\n        $s9 = \"CopyShellcode\" fullword ascii\n        $s10 = \"GetEntryFromBuffer\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 5 of ($s*)\n}\n\nrule EXEPWSHDL {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executable downloaders using PowerShell\"\n    strings:\n        $x1 = \"[Ref].Assembly.GetType(\" ascii wide\n        $x2 = \".SetValue($null,$true)\" ascii wide\n        $s1 = \"replace\" ascii wide\n        $s2 = \"=@(\" ascii wide\n        $s3 = \"[System.Text.Encoding]::\" ascii wide\n        $s4 = \".substring\" ascii wide\n        $s5 = \"FromBase64String\" ascii wide\n        $d1 = \"New-Object\" ascii wide\n        $d2 = \"Microsoft.XMLHTTP\" ascii wide\n        $d3 = \".open(\" ascii wide\n        $d4 = \".send(\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of ($x*) and (3 of ($s*) or all of ($d*))\n}\n\nrule DLInjector04 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader / injector\"\n    strings:\n        $s1 = \"Runner\" fullword ascii\n        $s2 = \"DownloadPayload\" fullword ascii\n        $s3 = \"RunOnStartup\" fullword ascii\n        $a1 = \"Antis\" fullword ascii\n        $a2 = \"antiVM\" fullword ascii\n        $a3 = \"antiSandbox\" fullword ascii\n        $a4 = \"antiDebug\" fullword ascii\n        $a5 = \"antiEmulator\" fullword ascii\n        $a6 = \"enablePersistence\" fullword ascii\n        $a7 = \"enableFakeError\" fullword ascii\n        $a8 = \"DetectVirtualMachine\" fullword ascii\n        $a9 = \"DetectSandboxie\" fullword ascii\n        $a10 = \"DetectDebugger\" fullword ascii\n        $a11 = \"CheckEmulator\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((all of ($s*) and 5 of ($a*)) or 10 of ($a*))\n}\n\nrule DLInjector05 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader / injector (NiceProcess)\"\n    strings:\n        $s1 = \"pidhtmpfile.tmp\" fullword ascii\n        $s2 = \"pidhtmpdata.tmp\" fullword ascii\n        $s3 = \"pidHTSIG\" fullword ascii\n        $s4 = \"Taskmgr.exe\" fullword ascii\n        $s5 = \"[HP][\" ascii\n        $s6 = \"[PP][\" ascii\n        $s7 = { 70 69 64 68 74 6d 70 66 69 6c 65 2e 74 6d 70 00\n                2e 64 6c 6c 00 00 00 00 70 69 64 48 54 53 49 47\n                00 00 00 00 ?? ?? 00 00 54 61 73 6b 6d 67 72 2e\n                65 78 65 }\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule DLInjector06 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader / injector\"\n    strings:\n        $s1 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\" ascii wide\n        $s2 = \"Content-Type: application/x-www-form-urlencoded\" wide\n        $s3 = \"https://ipinfo.io/\" wide\n        $s4 = \"https://db-ip.com/\" wide\n        $s5 = \"https://www.maxmind.com/en/locate-my-ip-address\" wide\n        $s6 = \"https://ipgeolocation.io/\" wide\n        $s7 = \"POST\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule dotRunpeX {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects dotRunpeX injector\"\n    strings:\n        $s1 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Services\\\\TaskKill\" fullword wide\n        $s2 = \"KoiVM\" ascii\n        $s3 = \"RunpeX.Stub.Framework\" wide\n        $s4 = \"ExceptionServices.ExceptionDispatchInfo\" wide\n        $s5 = \"Kernel32.Dll\" wide\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule DLInjector07 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader injector\"\n    strings:\n        $x1 = \"23lenrek[||]lldtn[||]daerhTemuseR[||]txetnoCdaerhTteS46woW[||]txetnoCdaerhTteS[||]txetnoCdaerhTteG46woW[||]txetnoCdaerhTteG[||]xEcollAlautriV[||]yromeMssecorPetirW[||]yromeMssecorPdaeR[||]noitceSfOweiVpamnUwZ[||]AssecorPetaerC\" wide\n        $l1 = \"[||]\" wide\n        $r1 = \"yromeMssecorPetirW\" wide\n        $r2 = \"xEcollAlautriV\" wide\n        $r3 = \"daerhTemuseR\" ascii wide\n        $r4 = \"noitceSfOweiVpamnUwZ\" wide\n        $s1 = \"Debugger Detected\" fullword wide\n        $s2 = \"payload\" fullword ascii\n        $s3 = \"_ENABLE_PROFILING\" fullword wide // Confuser Anti-Debug\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*) or (1 of ($l*) and 2 of ($r*)) or 6 of them)\n}\n\nrule RookIEDownloader {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detect malware downlaoder, variant of ZombieBoy downloader\"\n    strings:\n        $s1 = \"shell:::{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0}\" fullword ascii\n        $s2 = \"taskkill /f /im hh.exe\" fullword ascii\n        $s3 = \"RookIE/1.0\" fullword ascii\n        $s4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\0\" fullword ascii\n        $s5 = \"#32770\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule PackedLoader {\n    meta:\n        author = \"ditekShen\"\n        description = \"Detects unknown loader / packer\"\n    strings:\n        $s1 = \"Error at hooking API \\\"%S\\\"\" wide\n        $s2 = \"Dumping first %d bytes:\" wide\n        $s3 = \"Error at initialization of bundled DLL: %s\" wide\n        $s4 = \"GetMemoryForDLL()\" ascii\n        $s5 = \"type=activation&code=\" ascii\n        $s6 = \"activation.php?code=\" ascii\n        $s7 = \"&hwid=\" ascii\n        $s8 = \"&hash=\" ascii\n        $s9 = \"type=deactivation&hash=\" ascii\n        $s10 = \"deactivation.php?hash=\" ascii\n        $s11 = \"BANNED\" fullword ascii\n        $s12 = \"GetAdaptersInfo\" ascii\n    condition:\n        uint16(0) == 0x5a4d and 11 of them\n}\n\nrule PWSHDLLDL {\n    meta:\n        author = \"ditekShen\"\n        description = \"Detects downloader\"\n    strings:\n        $s1 = \"powershell.exe Set-ExecutionPolicy Bypass -Scope Process ; powershell -file \" fullword wide nocase\n        $s2 = \"objShell.run \\\"powershell -WindowStyle hidden -command wscript.exe //b //nologo '\" fullword wide nocase\n        $s3 = \"cmd.exe /c schtasks.exe /create /tn \\\"\" fullword wide nocase\n        $s4 = \"-WindowStyle hidden -command wscript.exe //b //nologo '\" fullword wide nocase\n        $s6 = \"\\\" /tr \\\"wscript.exe //b //nologo '\" fullword wide nocase\n        $s7 = \"\\\" -Value \\\"Powershell.exe -WindowStyle hidden \\\"\\\"& '\" fullword wide nocase\n        $op0 = { 61 01 00 34 53 79 73 74 65 6d 2e 57 65 62 2e 53 }\n        $op1 = { 4b 04 00 00 34 01 00 00 7f 05 00 00 1a }\n    condition:\n        uint16(0) == 0x5a4d and pe.is_dll() and 5 of them\n}\n\nrule VBSDownloader {\n    meta:\n        author = \"ditekShen\"\n        description = \"Detects second stage VBS downloader of third stage VBS\"\n    strings:\n        $s1 = \"CreateObject(\\\"MSXML2.ServerXMLHTTP\\\")\" wide\n        $s2 = \".Open \\\"GET\\\",\" wide\n        $s3 = \".Send\" wide\n        $s4 = \".responseText\" wide\n        $s5 = \"ExecuteGlobal\" wide\n    condition:\n       filesize < 50KB and all of them \n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.656Z",
    "status": "active"
}