{
    "name": "WSHRAT.yar",
    "rule": "rule WSHRATPlugin {\n    meta:\n        author = \"ditekshen\"\n        description = \"WSHRAT keylogger plugin payload\"\n        cape_type = \"WSHRAT Payload\"\n    strings:\n        $s1 = \"GET /open-keylogger HTTP/1.1\" fullword wide\n        $s2 = \"KeyboardChange: nCode={0}, wParam={1}, vkCode={2}, scanCode={3}, flags={4}, dwExtraInfo={6}\" wide\n        $s3 = \"MouseChange: nCode={0}, wParam={1}, x={2}, y={3}, mouseData={4}, flags={5}, dwExtraInfo={7}\" wide\n        $s4 = \"sendKeyLog\" fullword ascii\n        $s5 = \"saveKeyLog\" fullword ascii\n        $s6 = \"get_TotalKeyboardClick\" fullword ascii\n        $s7 = \"get_SessionMouseClick\" fullword ascii\n        $pdb = \"\\\\Android\\\\documents\\\\visual studio 2010\\\\Projects\\\\Keylogger\\\\Keylogger\\\\obj\\\\x86\\\\Debug\\\\Keylogger.pdb\" ascii\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}\n\nrule WSHRAT {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects WASHRAT\"\n        cape_type = \"WSHRAT Payload\"\n    strings:\n        $x1 = \"WSH Rat v\" wide\n        $x2 = \"SOFTWARE\\\\WSHRat\" wide\n        $x3 = \"WSH Remote\" wide nocase\n        $x4 = \"WSHRAT\" wide nocase\n        $s1 = \"shellobj.regwrite \\\"HKEY_\" ascii nocase\n        $s2 = \"shellobj.run(\\\"%comspec% /c\" ascii nocase\n        $s3 = \"objhttpdownload.setrequestheader \\\"user-agent:\\\",\" ascii nocase\n        $s4 = \"WScript.CreateObject(\\\"Shell.Application\\\").ShellExecute\" ascii nocase\n        $s5 = \"objwmiservice.ExecQuery(\\\"select\" ascii nocase\n        $s6 = \"httpobj.open(\\\"post\\\",\\\"http\" ascii nocase\n        $s7 = /(rdp|keylogger|get-pass|uvnc)\\|http/ wide\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($x*) or (1 of ($x*) and 1 of ($s*)) or (6 of ($s*)))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.654Z",
    "status": "active"
}