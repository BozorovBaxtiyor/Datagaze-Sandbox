{
    "name": "Sfile.yar",
    "rule": "rule Sfile\n{\nmeta:\n\tdescription = \"Identifies Sfile aka Escal ransomware.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-09\"\n\ttlp = \"White\"\n\tcape_type = \"Sfile Payload\"\n\nstrings:\n\t$pdb = \"D:\\\\code\\\\ransomware_win\\\\bin\\\\ransomware.pdb\" ascii wide\n\n\t$ = \"%s SORTING time : %s\" ascii wide\n\t$ = \"%ws -> WorkModeDecryptFiles : %d of %d files decrypted +%d (%d MB)...\" ascii wide\n\t$ = \"%ws -> WorkModeEncryptFiles : %d of %d files encrypted +%d [bps : %d, size = %d MB] (%d skipped, ld = %d.%d.%d %d:%d:%d, lf = %ws)...\" ascii wide\n\t$ = \"%ws -> WorkModeEnded\" ascii wide\n\t$ = \"%ws -> WorkModeFindFiles : %d files / %d folders found (already (de?)crypted %d/%d) (lf = %ws)...\" ascii wide\n\t$ = \"%ws -> WorkModeSorting\" ascii wide\n\t$ = \"%ws ENCRYPTFILES count : %d (%d skipped), time : %s\" ascii wide\n\t$ = \"%ws FINDFILES RESULTS : dwDirectoriesCount = %d, dwFilesCount = %d MB = %d (FIND END)\" ascii wide\n\t$ = \"%ws FINDFILES time : %s\" ascii wide\n\t$ = \"DRIVE_FIXED : %ws\" ascii wide\n\t$ = \"EncryptDisk(%ws) DONE\" ascii wide\n\t$ = \"ScheduleRoutine() : gogogo\" ascii wide\n\t$ = \"ScheduleRoutine() : waiting for sacred time... Expecting %d hours, now id %d\" ascii wide\n\t$ = \"WARN! FileLength more then memory has %ws\" ascii wide\n\t$ = \"WaitForHours() : gogogo\" ascii wide\n\t$ = \"WaitForHours() : waiting for sacred time... Expecting %d hours, now id %d\" ascii wide\n\t$ = \"Your network has been penetrated.\" ascii wide\n\t$ = \"--kill-susp\" ascii wide\n\t$ = \"--enable-shares\" ascii wide\n\ncondition:\n\t$pdb or 3 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.722Z",
    "status": "active"
}