{
    "name": "Exaramel.yar",
    "rule": "rule Exaramel {\n    meta:\n        author = \"ditekshen\"\n        description = \"Exaramel backdoor payload\"\n        cape_type = \"Exaramel payload\"\n    strings:\n        // Linux payload\n        $s1 = \"vendor/golang_org/x/crypto/\" ascii\n        $s2 = \"vendor/golang_org/x/net/http2\" ascii\n        $s3 = \"vendor/golang_org/x/text/unicode\" ascii\n        $s4 = \"vendor/golang_org/x/text/transform\" ascii\n        $s5 = \"config.json\" ascii\n        $cmd1 = \"App.Update\" ascii\n        $cmd2 = \"App.Delete\" ascii\n        $cmd3 = \"App.SetProxy\" ascii\n        $cmd4 = \"App.SetServer\" ascii\n        $cmd5 = \"App.SetTimeout\" ascii\n        $cmd6 = \"IO.WriteFile\" ascii\n        $cmd7 = \"IO.ReadFile\" ascii\n        $cmd8 = \"OS.ShellExecute\" ascii\n        $cmd9 = \"awk 'match($0, /(upstart|systemd|sysvinit)/){ print substr($0, RSTART, RLENGTH);exit;\" ascii\n        // Windows payload\n        $ws1 = \"/commands/@slp\" wide\n        $ws2 = \"/commands/cmd\" wide\n        $ws3 = \"/settings/proxy/@password\" wide\n        $ws4 = \"/settings/servers/server[@current='true']\" wide\n        $ws5 = \"/settings/servers/server/@current[text()='true']\" wide\n        $ws6 = \"/settings/servers/server[text()='%s']/@current\" wide\n        $ws7 = \"/settings/servers/server[%d]\" wide\n        $ws8 = \"/settings/storage\" wide\n        $ws9 = \"/settings/check\" wide\n        $ws10 = \"/settings/interval\" wide\n        $ws11 = \"report.txt\" wide\n        $ws12 = \"stg%02d.cab\" ascii\n        $ws13 = \"urlmon.dll\" ascii\n        $ws14 = \"ReportDir\" ascii\n    condition:\n        (uint16(0) == 0x457f and (all of ($s*) and 6 of ($cmd*))) or (uint16(0) == 0x5a4d and 12 of ($ws*))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.679Z",
    "status": "active"
}