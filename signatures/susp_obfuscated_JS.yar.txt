{
    "name": "susp_obfuscated_JS.yar",
    "rule": "rule SUSP_obfuscated_JS_obfuscatorio\n{\n\tmeta:\n\n\t\tauthor      = \"@imp0rtp3\"\n\t\tdescription = \"Detect JS obfuscation done by the js obfuscator (often malicious)\"\n\t\treference   = \"https://obfuscator.io\"\n\n\tstrings:\n\t\t// Beggining of the script\n\t\t$a1 = \"var a0_0x\"\n\t\t$a2 = /var _0x[a-f0-9]{4}/\n\t\t\n\t\t// Strings to search By number of occurences\n\t\t$b1 = /a0_0x([a-f0-9]{2}){2,4}\\('?0x[0-9a-f]{1,3}'?\\)/\n\t\t$b2 =/[^\\w\\d]_0x([a-f0-9]{2}){2,4}\\('?0x[0-9a-f]{1,3}'?\\)[^\\w\\d]/\n\t\t$b3 = /[^\\w\\d]_0x([a-f0-9]{2}){2,4}\\['push'\\]\\(_0x([a-f0-9]{2}){2,4}\\['shift'\\]\\(\\)[^\\w\\d]/\n\t\t$b4 = /!0x1[^\\d\\w]/\n\t\t$b5 = /[^\\w\\d]function\\((_0x([a-f0-9]{2}){2,4},)+_0x([a-f0-9]{2}){2,4}\\)\\s?\\{/\n\t\t$b6 = /[^\\w\\d]_0x([a-f0-9]{2}){2,4}\\s?=\\s?_0x([a-f0-9]{2}){2,4}[^\\w\\d]/\n\t\t\n\t\t// generic strings often used by the obfuscator\n\t\t$c1 = \"))),function(){try{var _0x\"\n\t\t$c2 = \"=Function('return\\\\x20(function()\\\\x20'+'{}.constructor(\\\\x22return\\\\x20this\\\\x22)(\\\\x20)'+');');\"\n\t\t$c3 = \"['atob']=function(\"\n\t\t$c4 = \")['replace'](/=+$/,'');var\"\n\t\t$c5 = \"return!![]\"\n\t\t$c6 = \"'{}.constructor(\\\\x22return\\\\\\x20this\\\\x22)(\\\\x20)'\"\n\t\t$c7 = \"{}.constructor(\\x22return\\x20this\\x22)(\\x20)\" base64\n\t\t$c8 = \"while(!![])\"\n\t\t$c9 = \"while (!![])\"\n\t\t// Strong strings\n\t\t$d1 = /(parseInt\\(_0x([a-f0-9]{2}){2,4}\\(0x[a-f0-9]{1,5}\\)\\)\\/0x[a-f0-9]{1,2}\\)?(\\+|\\*\\()\\-?){6}/\n\t\t\t\t\n\tcondition:\n\t\t$a1 at 0 or\n\t\t$a2 at 0 or\n\t\t(\n\t\t\tfilesize<1000000 and\n\t\t\t(\n\t\t\t\t(#b1 + #b2) > (filesize \\ 200) or\n\t\t\t\t#b3 > 1 or\n\t\t\t\t#b4 > 10 or\n\t\t\t\t#b5 > (filesize \\ 2000) or\n\t\t\t\t#b6 > (filesize \\ 200) or\n\t\t\t\t3 of ($c*) or\n\t\t\t\t$d1\n\t\t\t)\n\t\t)\n}",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.604Z",
    "status": "active"
}