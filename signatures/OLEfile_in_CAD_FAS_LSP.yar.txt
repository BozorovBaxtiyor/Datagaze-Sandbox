{
    "name": "OLEfile_in_CAD_FAS_LSP.yar",
    "rule": "rule OLEfile_in_CAD_FAS_LSP\n{\nmeta:\n\tdescription = \"Identifies OLE files embedded in AutoCAD and related Autodesk files, quite uncommon and potentially malicious.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2019-12\"\n\treference = \"https://blog.didierstevens.com/2019/12/16/analyzing-dwg-files-with-vba-macros/\"\n\ttlp = \"White\"\n\nstrings:\n\t$acad = {41 43 31} //AC1 (old format follows with 0x2E, new with 0x30)\n\t$fas = {0D 0A 20 46 41 53 34 2D 46 49 4C 45 20 3B 20 44 6F 20 6E 6F 74 20 63 68 61 6E 67 65 20 69 74 21}\n\t$lsp1 = \"acaddoc.lsp\"\n\t$lsp2 = \"doc.lsp\"\n\t$lsp3 = \"doclsp\"\n\t$lsp4 = \"lspfilelist\"\n\t$ole = {D0 CF 11 E0}\n\ncondition:\n\t($acad at 0 and $ole) or\n\t($fas at 0 and $ole) or\n\t((any of ($lsp*)) and $ole)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.606Z",
    "status": "active"
}