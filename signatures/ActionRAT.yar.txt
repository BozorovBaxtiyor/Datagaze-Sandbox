{
    "name": "ActionRAT.yar",
    "rule": "rule ActionRAT {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects ActionRAT, CSharp and Delfi variants\"\n        cape_type = \"ActionRAT Payload\"\n    strings:\n        $x1 = /<action>(connect|command|drives|getfiles|upload|execute|download)<action>/ fullword wide\n        $x2 = \"aHR0cDovLzE0NC45MS42NS4xMDAv\" wide\n        $x3 = \"aHR0cDovL21mYWhvc3QuZGRucy5uZXQv\" wide\n        $f1 = \"<updateCommand>b__\" ascii\n        $f2 = \"<getDrives>b__\" ascii\n        $f3 = \"<getStatus>b__\" ascii\n        $f4 = \"<getDirectories>b__\" ascii\n        $f5 = \"<updateUpload>b__\" ascii\n        $f6 = \"<infinity>b__\" ascii\n        $f7 = \"<uploadFile>b__\" ascii\n        $s1 = \"beaconURL\" ascii\n        $s2 = \"PingReply\" ascii\n        $s3 = \"updateUpload\" ascii\n        $s4 = \"updateCommand\" ascii\n        $s5 = \"runCommand\" ascii\n        $s6 = \"uploadFile\" ascii\n        $s7 = \"SELECT * FROM MSFT_NetAdapter WHERE ConnectorPresent = True AND DeviceID = '{0}'\" fullword wide\n        $s8 = \"SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $s9 = \"Mozilla/3.0\" fullword wide\n        $s10 = \"|directory|N/A|\" fullword wide\n        $s11 = \"cmd.exe /c\" fullword wide\n        $c1 = /Content-Disposition: form-data; name=(hostname|hid|id|action|secondary)/ fullword wide\n        $c2 = /(classification|updatecs|update|beacon)\\.php/ wide\n        $c3 = \"Content-Disposition: form-data;name=\\\"{0}\\\";filename=\\\"{1}\\\"filepath=\\\"{2}\\\"\" fullword wide\n        $pdb1 = \"D:\\\\Projects\\\\C#\\\\HTTP-Simple\\\\WindowsMediaPlayer - HTTP - \" ascii\n        $pdb2 = \"\\\\WindowsMediaPlayer10\\\\obj\\\\x86\\\\Release\\\\winow4.pdb\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (#x1 > 5 or (all of ($f*) and (1 of ($s*) or 2 of ($c*))) or 7 of ($s*) or all of ($c*) or (all of ($pdb*) and 4 of them) or ( 2 of ($x*) and 5 of them))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.708Z",
    "status": "active"
}