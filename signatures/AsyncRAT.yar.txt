{
    "name": "AsyncRAT.yar",
    "rule": "rule AsyncRAT_kingrat {\n    meta:\n        author = \"jeFF0Falltrades\"\n        cape_type = \"AsyncRAT Payload\"\n\n    strings:\n        $str_async = \"AsyncClient\" wide ascii nocase\n        $str_aes_exc = \"masterKey can not be null or empty\" wide ascii\n        $str_schtasks = \"schtasks /create /f /sc onlogon /rl highest\" wide ascii\n        $byte_aes_key_base = { 7E [3] 04 73 [3] 06 80 }\n        $byte_aes_salt_base = { BF EB 1E 56 FB CD 97 3B B2 19 }\n        $patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }\n        $patt_config = { 72 [3] 70 80 [3] 04 }\n\n        $dcrat_1 = \"dcrat\" wide ascii nocase\n        $dcrat_2 = \"qwqdan\" wide ascii\n        $dcrat_3 = \"YW1zaS5kbGw=\" wide ascii\n        $dcrat_4 = \"VmlydHVhbFByb3RlY3Q=\" wide ascii\n        $dcrat_5 = \"save_Plugin\" wide ascii\n\n        $ww2 = \"WorldWindClient\" wide fullword nocase\n        $ww3 = \"WorldWindStealer\" wide fullword nocase\n        $ww4 = \"*WorldWind Pro - Results:*\" wide fullword nocase\n        $ww5 = /WorldWind(\\s)?Stealer/ ascii wide\n\n        $prynt = /Prynt(\\s)?Stealer/ ascii wide\n\n    condition:\n        (not any of ($dcrat*) and not any of ($ww*) and not $prynt) and 6 of them and #patt_config >= 10\n}\n\nrule StormKitty {\n    meta:\n        author = \"ditekSHen\"\n        description = \"StormKitty infostealer payload\"\n        cape_type = \"StormKitty Payload\"\n    strings:\n        $x1 = \"\\\\ARTIKA\\\\Videos\\\\Chrome-Password-Recovery\" ascii\n        $x2 = \"https://github.com/LimerBoy/StormKitty\" fullword ascii\n        $x3 = \"StormKitty\" fullword ascii\n        $s1 = \"GetBSSID\" fullword ascii\n        $s2 = \"GetAntivirus\" fullword ascii\n        $s3 = \"C:\\\\Users\\\\Public\\\\credentials.txt\" fullword wide\n        $s4 = \"^([a-zA-Z0-9_\\\\-\\\\.]+)@([a-zA-Z0-9_\\\\-\\\\.]+)\\\\.([a-zA-Z]{2,5})$\" fullword wide\n        $s5 = \"BCrypt.BCryptGetProperty() (get size) failed with status code:{0}\" fullword wide\n        $s6 = \"\\\"encrypted_key\\\":\\\"(.*?)\\\"\" fullword wide\n\n        $ww2 = \"WorldWindClient\" wide fullword nocase\n        $ww3 = \"WorldWindStealer\" wide fullword nocase\n        $ww4 = \"*WorldWind Pro - Results:*\" wide fullword nocase\n        $ww5 = /WorldWind(\\s)?Stealer/ ascii wide\n\n        $prynt = /Prynt(\\s)?Stealer/ ascii wide\n\n    condition:\n        uint16(0) == 0x5a4d and (not any of ($ww*) and not $prynt) and (2 of ($x*) or 5 of ($s*) or (3 of ($s*) and 1 of ($x*)))\n}\n\n\nrule WorldWind {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects WorldWind infostealer\"\n        cape_type = \"WorldWind Payload\"\n    strings:\n        $c1 = /WorldWind(\\s)?Stealer/ ascii wide\n        $x2 = \"@FlatLineStealer\" ascii wide\n        $x3 = \"@CashOutGangTalk\" ascii wide\n        $m1 = \".Passwords.Targets.\" ascii\n        $m2 = \".Modules.Keylogger\" ascii\n        $m3 = \".Modules.Clipper\" ascii\n        $m4 = \".Modules.Implant\" ascii\n        $s1 = \"--- Clipper\" wide\n        $s2 = \"Downloading file: \\\"{file}\\\"\" wide\n        $s3 = \"/bot{0}/getUpdates?offset={1}\" wide\n        $s4 = \"send command to bot!\" wide\n        $s5 = \" *Keylogger \" fullword wide\n        $s6 = \"*Stealer\" wide\n        $s7 = \"Bot connected\" wide\n    condition:\n        uint16(0) == 0x5a4d and 1 of ($c*) and (1 of ($x*) or 2 of ($m*) or 3 of ($s*))\n}\n\n\nrule Prynt {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Prynt infostealer\"\n        cape_type = \"Prynt Payload\"\n    strings:\n        $c1 = /Prynt(\\s)?Stealer/ ascii wide\n        $x2 = \"@FlatLineStealer\" ascii wide\n        $x3 = \"@CashOutGangTalk\" ascii wide\n        $m1 = \".Passwords.Targets.\" ascii\n        $m2 = \".Modules.Keylogger\" ascii\n        $m3 = \".Modules.Clipper\" ascii\n        $m4 = \".Modules.Implant\" ascii\n        $s1 = \"--- Clipper\" wide\n        $s2 = \"Downloading file: \\\"{file}\\\"\" wide\n        $s3 = \"/bot{0}/getUpdates?offset={1}\" wide\n        $s4 = \"send command to bot!\" wide\n        $s5 = \" *Keylogger \" fullword wide\n        $s6 = \"*Stealer\" wide\n        $s7 = \"Bot connected\" wide\n    condition:\n        uint16(0) == 0x5a4d and 1 of ($c*) and (1 of ($x*) or 2 of ($m*) or 3 of ($s*))\n}\n\n\nrule XWorm {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects XWorm\"\n        cape_type = \"XWorm Payload\"\n    strings:\n        $x1 = \"XWorm \" wide nocase\n        $x2 = /XWorm\\s(V|v)\\d+\\.\\d+/ fullword wide\n        $s1 = \"RunBotKiller\" fullword wide\n        $s2 = \"XKlog.txt\" fullword wide\n        $s3 = /(shell|reg)fuc/ fullword wide\n        $s4 = \"closeshell\" fullword ascii\n        $s5 = { 62 00 79 00 70 00 73 00 73 00 00 ?? 63 00 61 00 6c 00 6c 00 75 00 61 00 63 00 00 ?? 73 00 63 00 }\n        $s6 = { 44 00 44 00 6f 00 73 00 54 00 00 ?? 43 00 69 00 6c 00 70 00 70 00 65 00 72 00 00 ?? 50 00 45 00 }\n        $s7 = { 69 00 6e 00 6a 00 52 00 75 00 6e 00 00 ?? 73 00 74 00 61 00 72 00 74 00 75 00 73 00 62 }\n        $s8 = { 48 6f 73 74 00 50 6f 72 74 00 75 70 6c 6f 61 64 65 72 00 6e 61 6d 65 65 65 00 4b 45 59 00 53 50 4c 00 4d 75 74 65 78 78 00 }\n        $v2_1 = \"PING!\" fullword wide\n        $v2_2 = \"Urlhide\" fullword wide\n        $v2_3 = /PC(Restart|Shutdown)/ fullword wide\n        $v2_4 = /(Start|Stop)(DDos|Report)/ fullword wide\n        $v2_5 = /Offline(Get|Keylogger)/ wide\n        $v2_6 = \"injRun\" fullword wide\n        $v2_7 = \"Xchat\" fullword wide\n        $v2_8 = \"UACFunc\" fullword ascii wide\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($x*) and (3 of ($s*) or 3 of ($v2*))) or 6 of them)\n}\n\nrule xworm_kingrat {\n    meta:\n        author = \"jeFF0Falltrades\"\n        cape_type = \"XWorm payload\"\n    strings:\n        $str_xworm = \"xworm\" wide ascii nocase\n        $str_xwormmm = \"Xwormmm\" wide ascii\n        $str_xclient = \"XClient\" wide ascii\n        $str_default_log = \"\\\\Log.tmp\" wide ascii\n        $str_create_proc = \"/create /f /RL HIGHEST /sc minute /mo 1 /t\" wide ascii\n        $str_ddos_start = \"StartDDos\" wide ascii\n        $str_ddos_stop = \"StopDDos\" wide ascii\n        $str_timeout = \"timeout 3 > NUL\" wide ascii\n        $byte_md5_hash = { 7e [3] 04 28 [3] 06 6f }\n        $patt_config = { 72 [3] 70 80 [3] 04 }\n    condition:\n        5 of them and #patt_config >= 7\n}\n\nrule DCRat {\n    meta:\n        author = \"ditekSHen\"\n        description = \"DCRat payload\"\n        cape_type = \"DCRat Payload\"\n    strings:\n        // DCRat\n        $dc1 = \"DCRatBuild\" ascii\n        $dc2 = \"DCStlr\" ascii\n        $x1 = \"px\\\"><center>DCRat Keylogger\" wide\n        $x2 = \"DCRat-Log#\" wide\n        $x3 = \"DCRat.Code\" wide\n        $string1 = \"CaptureBrowsers\" fullword ascii\n        $string2 = \"DecryptBrowsers\" fullword ascii\n        $string3 = \"Browsers.IE10\" ascii\n        $string4 = \"Browsers.Chromium\" ascii\n        $string5 = \"WshShell\" ascii\n        $string6 = \"SysMngmts\" fullword ascii\n        $string7 = \"LoggerData\" fullword ascii\n        // DCRat Plugins/Libraries\n        $plugin = \"DCRatPlugin\" fullword ascii\n        // AntiVM\n        $av1 = \"AntiVM\" ascii wide\n        $av2 = \"vmware\" fullword wide\n        $av3 = \"VirtualBox\" fullword wide\n        $av4 = \"microsoft corporation\" fullword wide\n        $av5 = \"VIRTUAL\" fullword wide\n        $av6 = \"DetectVirtualMachine\" fullword ascii\n        $av7 = \"Select * from Win32_ComputerSystem\" fullword wide\n        // Plugin_AutoStealer, Plugin_AutoKeylogger\n        $pl1 = \"dcratAPI\" fullword ascii\n        $pl2 = \"dsockapi\" fullword ascii\n        $pl3 = \"file_get_contents\" fullword ascii\n        $pl4 = \"classthis\" fullword ascii\n        $pl5 = \"typemdt\" fullword ascii\n        $pl6 = \"Plugin_AutoStealer\" ascii wide\n        $pl7 = \"Plugin_AutoKeylogger\" ascii wide\n        // variant\n        $v1 = \"Plugin couldn't process this action!\" wide\n        $v2 = \"Unknown command!\" wide\n        $v3 = \"PLUGINCONFIGS\" wide\n        $v4 = \"Saving log...\" wide\n        $v5 = \"~Work.log\" wide\n        $v6 = \"MicrophoneNum\" fullword wide\n        $v7 = \"WebcamNum\" fullword wide\n        $v8 = \"%SystemDrive% - Slow\" wide\n        $v9 = \"%UsersFolder% - Fast\" wide\n        $v10 = \"%AppData% - Very Fast\" wide\n        $v11 = /<span style=\\\"color: #F85C50;\\\">\\[(Up|Down|Enter|ESC|CTRL|Shift|Win|Tab|CAPSLOCK: (ON|OFF))\\]<\\/span>/ wide\n        $px1 = \"[Browsers] Scanned elements: \" wide\n        $px2 = \"[Browsers] Grabbing cookies\" wide\n        $px3 = \"[Browsers] Grabbing passwords\" wide\n        $px4 = \"[Browsers] Grabbing forms\" wide\n        $px5 = \"[Browsers] Grabbing CC\" wide\n        $px6 = \"[Browsers] Grabbing history\" wide\n        $px7 = \"[StealerPlugin] Invoke: \" wide\n        $px8 = \"[Other] Grabbing steam\" wide\n        $px9 = \"[Other] Grabbing telegram\" wide\n        $px10 = \"[Other] Grabbing discord tokens\" wide\n        $px11 = \"[Other] Grabbing filezilla\" wide\n        $px12 = \"[Other] Screenshots:\" wide\n        $px13 = \"[Other] Clipboard\" wide\n        $px14 = \"[Other] Saving system information\" wide\n    condition:\n        uint16(0) == 0x5a4d and (all of ($dc*) or all of ($string*) or 2 of ($x*) or 6 of ($v*) or 5 of ($px*)) or ($plugin and (4 of ($av*) or 5 of ($pl*)))\n}\n\nrule dcrat_kingrat {\n    meta:\n        author = \"jeFF0Falltrades\"\n        cape_type = \"DCRat Payload\"\n    strings:\n        $venom_1 = \"VenomRAT\" wide ascii nocase\n        $venom_2 = \"HVNC_REPLY_MESSAGE\" wide ascii\n        $str_aes_exc = \"masterKey can not be null or empty\" wide ascii\n        $str_b64_amsi = \"YW1zaS5kbGw=\" wide ascii\n        $str_b64_virtual_protect = \"VmlydHVhbFByb3RlY3Q=\" wide ascii\n        $str_dcrat = \"dcrat\" wide ascii nocase\n        $str_plugin = \"save_Plugin\" wide ascii\n        $str_qwqdan = \"qwqdan\" wide ascii\n        $byte_aes_key_base = { 7E [3] 04 73 [3] 06 80 }\n        $patt_config = { 72 [3] 70 80 [3] 04 }\n        $patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }\n\n    condition:\n        (not any of ($venom*)) and 5 of them and #patt_config >= 10\n}\n\nrule QuasarRAT {\n    meta:\n        author = \"ditekshen\"\n        description = \"QuasarRAT payload\"\n        cape_type = \"QuasarRAT Payload\"\n    strings:\n        $s1 = \"GetKeyloggerLogsResponse\" fullword ascii\n        $s2 = \"GetKeyloggerLogs\" fullword ascii\n        $s3 = \"/>Log created on\" wide\n        $s4 = \"User: {0}{3}Pass: {1}{3}Host: {2}\" wide\n        $s5 = \"Domain: {1}{0}Cookie Name: {2}{0}Value: {3}{0}Path: {4}{0}Expired: {5}{0}HttpOnly: {6}{0}Secure: {7}\" wide\n        $s6 = \"grabber_\" wide\n        $s7 = \"<virtualKeyCode>\" ascii\n        $s8 = \"<RunHidden>k__BackingField\" fullword ascii\n        $s9 = \"<keyboardHookStruct>\" ascii\n        $s10 = \"add_OnHotKeysDown\" ascii\n        $mutex = \"QSR_MUTEX_\" ascii wide\n        $ua1 = \"Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0\" fullword wide\n        $us2 = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/7046A194A\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and ($mutex or (all of ($ua*) and 2 of them) or 6 of ($s*))\n}\n\nrule quasarrat_kingrat {\n    meta:\n        author = \"jeFF0Falltrades\"\n        cape_type = \"QuasarRAT Payload\"\n    strings:\n        $str_quasar = \"Quasar.\" wide ascii\n        $str_hidden = \"set_Hidden\" wide ascii\n        $str_shell = \"DoShellExecuteResponse\" wide ascii\n    $str_close = \"echo DONT CLOSE THIS WINDOW!\" wide ascii\n        $str_pause = \"ping -n 10 localhost > nul\" wide ascii\n        $str_aes_exc = \"masterKey can not be null or empty\" wide ascii\n        $byte_aes_key_base = { 7E [3] 04 73 [3] 06 25 }\n        $byte_aes_salt_base = { BF EB 1E 56 FB CD 97 3B B2 19 }\n        $byte_special_folder = { 7e 73 [4] 28 [4] 80 }\n        $patt_config = { 72 [3] 70 80 [3] 04 }\n        $patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }\n\n    condition:\n        6 of them and #patt_config >= 10\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.703Z",
    "status": "active"
}