{
    "name": "BroEx.yar",
    "rule": "rule BroEx\n{\nmeta:\n\tid = \"5MNXppaMBFMS0DMQ63eCJO\"\n\tfingerprint = \"8eea2d3d8d4e8ca6ef89d474232d1117e2a5a5b4c714b4c82493293f31e4f2c6\"\n\tversion = \"1.0\"\n\tfirst_imported = \"2023-09-18\"\n\tlast_modified = \"2023-09-18\"\n\tstatus = \"RELEASED\"\n\tsharing = \"TLP:WHITE\"\n\tsource = \"BARTBLAZE\"\n\tauthor = \"@bartblaze\"\n\tdescription = \"Detects BroEx, a type of agressive adware.\"\n\tcategory = \"MALWARE\"\n\tmalware = \"BROEX\"\n\tmalware_type = \"ADWARE\"\n\thash = \"7f103012a143b9e358087cf94dbdd160362a57e5ebc65c560e352ac7541bd80e\"\n  cape_type = \"BroEx payload\"\n\nstrings:\n\t//PDB\n\t$pdb = \"I:\\\\Repository2\\\\test\\\\Project21\\\\event\\\\Release\\\\event.pdb\" ascii wide\n\t\n\t//Mutants\n\t$mut1 = \"Global\\\\A6A161D8-150E-46A1-B7EC-18E4CB58C6D2\" ascii wide\n\t$mut2 = \"Global\\\\D80D9D78-BCDA-482C-98F2-C38991A8CA3\" ascii wide\n\t$mut3 = \"Global\\\\8D13D07B-A758-456A-A215-0518F1268C2A\" ascii wide\n\t\n\t//Launch\n\t$browser1 = \"main -c rbrowser chrome\" ascii wide\n\t$browser2 = \"main -c rbrowser msedge\" ascii wide\n\t\n\t//Service names\n\t$svc1 = \"WimsysUpdaterService\" ascii wide\n\t$svc2 = \"WimsysService\" ascii wide\n\t$svc3 = \"WimsysServiceX64\" ascii wide\n\t\n\t/*\n\tpvVar1 = (void *)0x0;\n\tparam_1[3] = (void *)0x7;\n\tparam_1[2] = (void *)0x0;\n\t*(undefined2 *)param_1 = 0;\n\tif (*(short *)param_2 != 0) {\n\tpvVar1 = (void *)0xffffffffffffffff;\n\t*/\n\t$str_decode = { 4? 53 4? 83 ec 20 4? 33 c0 4? c7 41 18 07 00 00 00 4? 8b d9 4? 89 41 10 66 4? 89 01 66 4? 39 02 74 11 4? 83 c8 ff  }\n\ncondition:\n\tuint16(0) == 0x5a4d and ($pdb or 2 of ($mut*) or all of ($browser*) \n\tor 2 of ($svc*) or $str_decode)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.700Z",
    "status": "active"
}