{
    "name": "Lorenz.yar",
    "rule": "rule Lorenz {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Lorenz ransomware\"\n        cape_type = \"Lorenz Payload\"\n    strings:\n        $x1 = \"143.198.117.43\" fullword ascii\n        $x2 = \"157.90.147.28\" fullword ascii\n        $x3 = \"//kpb3ss3vwvfejd4g3gvpvqo6ad7nnmvcqoik4mxt2376yu2adlg5fwyd.onion\" ascii\n        $x4 = \"http://lorenz\" ascii\n        $x5 = \"\\\\lora\\\\Release\\\\lora.pdb\" ascii\n        $x6 = \"--MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQ\" ascii\n        $x7 = \"/USER:'HOMEOFFICE.COM\\\\\" ascii\n        $x8 = \"/USER:'Sentinel.com\\\\\" ascii\n        $s1 = \"to->_What == nullptr && to->_DoFree == false\" fullword wide\n        $s2 = \"*it == '\\\\0'\" fullword wide\n        $s3 = \"process call create 'cmd.exe /c\" ascii\n        $s4 = \"\\\\Control Panel\\\\Desktop\\\" /V Wallpaper /T REG_SZ /F /D\" ascii\n        $s5 = \"HELP_SECURITY_EVENT.html\" ascii\n        $s6 = \"<br>[+] Whats Happen?\" ascii\n        $s7 = /\\.Lorenz\\.sz\\d+$/ fullword ascii\n        $s8 = \"TW9Vc29Db3JlV29ya2VyLmV4ZQ==\" fullword ascii\n        $s9 = \".Speak(\\\"You've been hack\" ascii nocase\n        $s10 = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAo\" ascii\n        $n1 = \"ame_serv=\" ascii\n        $n2 = \"&ip=\" ascii\n        $n3 = \"&winver=Windows\" ascii\n        $n4 = \"&list_drive=\" ascii\n        $n5 = \"&file=\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($x*) or 8 of ($s*) or (4 of ($n*) and 2 of them) or (1 of ($x*) and 6 of them))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.679Z",
    "status": "active"
}