{
    "name": "RomCom.yar",
    "rule": "import \"pe\"\n\nrule MALWARE_Win_RomCom_Loader {\n    meta:\n        author = \"ditekShen\"\n        description = \"Hunt for RomCom loader\"\n    //strings:\n        //$s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Classes\" wide nocase\n        //$s2 = \"\\\\REGISTRY\\\\USER\" wide nocase\n        //$s3 = \"CreateToolhelp32Snapshot\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and pe.is_dll() and (\n            pe.exports(\"DllCanUnloadNow\") and pe.exports(\"DllGetClassObject\")\n            and pe.exports(\"DllRegisterServer\") and pe.exports(\"DllUnregisterServer\")\n            and pe.exports(\"GetProxyDllInfo\")\n        ) and for any fn in pe.export_details: (\n            fn.forward_name contains \"Dll\"\n        )\n}\n\nrule RomCom_Worker {\n    meta:\n        author = \"ditekShen\"\n        description = \"Hunt for RomCom worker\"\n        cape_type = \"RomCom Payload\"\n    strings:\n        $s1 = \"UpdateProcThreadAttribute\" fullword ascii\n        $s2 = \"WriteFile\" fullword ascii\n        $s3 = \"GetAdaptersAddresses\" fullword ascii nocase\n        $s4 = /inflate\\s\\d+\\.\\d+\\.\\d+\\sCopyright/ ascii\n        $s5 = \"SetHandleInformation\" fullword ascii\n        $s6 = \"PeekNamedPipe\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and pe.is_dll() and pe.number_of_exports == 1 and pe.exports(\"Main\") and all of them\n}\n\nrule RomCom_Dropper {\n    meta:\n        author = \"ditekShen\"\n        description = \"Hunt for RomCom worker\"\n        cape_type = \"RomCom Payload\"\n    strings:\n        $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Classes\" wide nocase\n        $s2 = \"\\\\REGISTRY\\\\USER\" wide nocase\n        $s3 = \"BINARY\" fullword wide\n        $s4 = \"POST\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and pe.is_dll() and pe.number_of_exports == 1 and pe.exports(\"Main\") and 3 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.711Z",
    "status": "active"
}