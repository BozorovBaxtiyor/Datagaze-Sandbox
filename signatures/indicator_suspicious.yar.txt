{
    "name": "indicator_suspicious.yar",
    "rule": "import \"pe\"\n\nrule INDICATOR_SUSPICIOUS_GENRansomware {\n    meta:\n        description = \"detects command variations typically used by ransomware\"\n        author = \"ditekSHen\"\n    strings:\n        $cmd1 = \"cmd /c \\\"WMIC.exe shadowcopy delet\\\"\" ascii wide nocase\n        $cmd2 = \"vssadmin.exe Delete Shadows /all\" ascii wide nocase\n        $cmd3 = \"Delete Shadows /all\" ascii wide nocase\n        $cmd4 = \"} recoveryenabled no\" ascii wide nocase\n        $cmd5 = \"} bootstatuspolicy ignoreallfailures\" ascii wide nocase\n        $cmd6 = \"wmic SHADOWCOPY DELETE\" ascii wide nocase\n        $cmd7 = \"\\\\Microsoft\\\\Windows\\\\SystemRestore\\\\SR\\\" /disable\" ascii wide nocase\n        $cmd8 = \"resize shadowstorage /for=c: /on=c: /maxsize=\" ascii wide nocase\n        $cmd9 = \"shadowcopy where \\\"ID='%s'\\\" delete\" ascii wide nocase\n        $cmd10 = \"wmic.exe SHADOWCOPY /nointeractive\" ascii wide nocase\n        $cmd11 = \"WMIC.exe shadowcopy delete\" ascii wide nocase\n        $cmd12 = \"Win32_Shadowcopy | ForEach-Object {$_.Delete();}\" ascii wide nocase\n        $delr = /del \\/s \\/f \\/q(( [A-Za-z]:\\\\(\\*\\.|[Bb]ackup))(VHD|bac|bak|wbcat|bkf)?)+/ ascii wide\n        $wp1 = \"delete catalog -quiet\" ascii wide nocase\n        $wp2 = \"wbadmin delete backup\" ascii wide nocase\n        $wp3 = \"delete systemstatebackup\" ascii wide nocase\n    condition:\n        (uint16(0) == 0x5a4d and 2 of ($cmd*) or (1 of ($cmd*) and 1 of ($wp*)) or #delr > 4) or (4 of them)\n}\n\nrule INDICATOR_SUSPICIOUS_ReflectiveLoader {\n    meta:\n        description = \"detects Reflective DLL injection artifacts\"\n        author = \"ditekSHen\"\n    strings:\n        $s1 = \"_ReflectiveLoader@\" ascii wide\n        $s2 = \"ReflectiveLoader@\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and (1 of them or (\n            pe.exports(\"ReflectiveLoader@4\") or\n            pe.exports(\"_ReflectiveLoader@4\") or\n            pe.exports(\"ReflectiveLoader\")\n            )\n        )\n}\n\nrule INDICATOR_SUSPICIOUS_IMG_Embedded_Archive {\n    meta:\n        description = \"Detects images embedding archives. Observed in TheRat RAT.\"\n        author = \"@ditekSHen\"\n    strings:\n        $sevenzip1 = { 37 7a bc af 27 1c 00 04 } // 7ZIP, regardless of password-protection\n        $sevenzip2 = { 37 e4 53 96 c9 db d6 07 } // 7ZIP zisofs compression format\n        $zipwopass = { 50 4b 03 04 14 00 00 00 } // None password-protected PKZIP\n        $zipwipass = { 50 4b 03 04 33 00 01 00 } // Password-protected PKZIP\n        $zippkfile = { 50 4b 03 04 0a 00 02 00 } // PKZIP\n        $rarheade1 = { 52 61 72 21 1a 07 01 00 } // RARv4\n        $rarheade2 = { 52 65 74 75 72 6e 2d 50 } // RARv5\n        $rarheade3 = { 52 61 72 21 1a 07 00 cf } // RAR\n        $mscabinet = { 4d 53 46 54 02 00 01 00 } // Microsoft cabinet file\n        $zlockproe = { 50 4b 03 04 14 00 01 00 } // ZLock Pro encrypted ZIP\n        $winzip    = { 57 69 6E 5A 69 70 }       // WinZip compressed archive\n        $pklite    = { 50 4B 4C 49 54 45 }       // PKLITE compressed ZIP archive\n        $pksfx     = { 50 4B 53 70 58 }          // PKSFX self-extracting executable compressed file\n    condition:\n        // JPEG or JFIF or PNG or BMP\n        (uint32(0) == 0xe0ffd8ff or uint32(0) == 0x474e5089 or uint16(0) == 0x4d42) and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_UACBypass_EventViewer {\n    meta:\n        description = \"detects Windows exceutables potentially bypassing UAC using eventvwr.exe\"\n        author = \"ditekSHen\"\n    strings:\n        $s1 = \"\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command\" ascii wide nocase\n        $s2 = \"eventvwr.exe\" ascii wide nocase\n    condition:\n       uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_UACBypass_CleanMgr {\n    meta:\n        description = \"detects Windows exceutables potentially bypassing UAC using cleanmgr.exe\"\n        author = \"ditekSHen\"\n    strings:\n        $s1 = \"\\\\Enviroment\\\\windir\" ascii wide nocase\n        $s2 = \"\\\\system32\\\\cleanmgr.exe\" ascii wide nocase\n    condition:\n       uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_Enable_OfficeMacro {\n    meta:\n        description = \"Detects Windows executables referencing Office macro registry keys. Observed modifying Office configurations via the registy to enable macros\"\n        author = \"@ditekSHen\"\n    strings:\n        $s1 = \"\\\\Word\\\\Security\\\\VBAWarnings\" ascii wide\n        $s2 = \"\\\\PowerPoint\\\\Security\\\\VBAWarnings\" ascii wide\n        $s3 = \"\\\\Excel\\\\Security\\\\VBAWarnings\" ascii wide\n\n        $h1 = \"5c576f72645c53656375726974795c5642415761726e696e6773\" nocase ascii wide\n        $h2 = \"5c506f776572506f696e745c53656375726974795c5642415761726e696e6773\" nocase ascii wide\n        $h3 = \"5c5c457863656c5c5c53656375726974795c5c5642415761726e696e6773\" nocase ascii wide\n\n        $d1 = \"5c%57%6f%72%64%5c%53%65%63%75%72%69%74%79%5c%56%42%41%57%61%72%6e%69%6e%67%73\" nocase ascii\n        $d2 = \"5c%50%6f%77%65%72%50%6f%69%6e%74%5c%53%65%63%75%72%69%74%79%5c%56%42%41%57%61%72%6e%69%6e%67%73\" nocase ascii\n        $d3 = \"5c%5c%45%78%63%65%6c%5c%5c%53%65%63%75%72%69%74%79%5c%5c%56%42%41%57%61%72%6e%69%6e%67%73\" nocase ascii\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($s*) or 2 of ($h*) or 2 of ($d*))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_Disable_OfficeProtectedView {\n    meta:\n        description = \"Detects Windows executables referencing Office ProtectedView registry keys. Observed modifying Office configurations via the registy to disable ProtectedView\"\n        author = \"@ditekSHen\"\n    strings:\n        $s1 = \"\\\\Security\\\\ProtectedView\\\\DisableInternetFilesInPV\" ascii wide\n        $s2 = \"\\\\Security\\\\ProtectedView\\\\DisableAttachementsInPV\" ascii wide\n        $s3 = \"\\\\Security\\\\ProtectedView\\\\DisableUnsafeLocationsInPV\" ascii wide\n\n        $h1 = \"5c53656375726974795c50726f746563746564566965775c44697361626c65496e7465726e657446696c6573496e5056\" nocase ascii wide\n        $h2 = \"5c53656375726974795c50726f746563746564566965775c44697361626c65417474616368656d656e7473496e5056\" nocase ascii wide\n        $h3 = \"5c53656375726974795c50726f746563746564566965775c44697361626c65556e736166654c6f636174696f6e73496e5056\" nocase ascii wide\n\n        $d1 = \"5c%53%65%63%75%72%69%74%79%5c%50%72%6f%74%65%63%74%65%64%56%69%65%77%5c%44%69%73%61%62%6c%65%49%6e%74%65%72%6e%65%74%46%69%6c%65%73%49%6e%50%56\" nocase ascii\n        $d2 = \"5c%53%65%63%75%72%69%74%79%5c%50%72%6f%74%65%63%74%65%64%56%69%65%77%5c%44%69%73%61%62%6c%65%41%74%74%61%63%68%65%6d%65%6e%74%73%49%6e%50%56\" nocase ascii\n        $d3 = \"5c%53%65%63%75%72%69%74%79%5c%50%72%6f%74%65%63%74%65%64%56%69%65%77%5c%44%69%73%61%62%6c%65%55%6e%73%61%66%65%4c%6f%63%61%74%69%6f%6e%73%49%6e%50%56\" nocase ascii\n    condition:\n         uint16(0) == 0x5a4d and (2 of ($s*) or 2 of ($h*) or 2 of ($d*))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SandboxProductID {\n    meta:\n        description = \"Detects binaries and memory artifcats referencing sandbox product IDs\"\n        author = \"ditekSHen\"\n    strings:\n        $id1 = \"76487-337-8429955-22614\" fullword ascii wide // Anubis Sandbox\n        $id2 = \"76487-644-3177037-23510\" fullword ascii wide // CW Sandbox\n        $id3 = \"55274-640-2673064-23950\" fullword ascii wide // Joe Sandbox\n        $id4 = \"76487-640-1457236-23837\" fullword ascii wide // Anubis Sandbox\n        $id5 = \"76497-640-6308873-23835\" fullword ascii wide // CWSandbox\n        $id6 = \"76487-640-1464517-23259\" fullword ascii wide // ??\n        $id7 = \"76487 - 337 - 8429955 - 22614\" fullword ascii wide // Anubis Sandbox\n        $id8 = \"76487 - 644 - 3177037 - 23510\" fullword ascii wide // CW Sandbox\n        $id9 = \"55274 - 640 - 2673064 - 23950\" fullword ascii wide // Joe Sandbox\n        $id10 = \"76487 - 640 - 1457236 - 23837\" fullword ascii wide // Anubis Sandbox\n        $id11 = \"76497 - 640 - 6308873 - 23835\" fullword ascii wide // CWSandbox\n        $id12 = \"76487 - 640 - 1464517 - 23259\" fullword ascii wide // ??\n    condition:\n        uint16(0) == 0x5a4d and 2 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SandboxHookingDLL {\n    meta:\n        description = \"Detects binaries and memory artifcats referencing sandbox DLLs typically observed in sandbox evasion\"\n        author = \"ditekSHen\"\n    strings:\n        $dll1 = \"sbiedll.dll\" nocase fullword ascii wide\n        // $dll2 = \"dbghelp.dll\" nocase fullword ascii wide\n        $dll3 = \"api_log.dll\" nocase fullword ascii wide\n        $dll4 = \"pstorec.dll\" nocase fullword ascii wide\n        $dll5 = \"dir_watch.dll\" nocase fullword ascii wide\n        $dll6 = \"vmcheck.dll\" nocase fullword ascii wide\n        $dll7 = \"wpespy.dll\" nocase fullword ascii wide\n        $dll8 = \"SxIn.dll\" nocase fullword ascii wide\n        $dll9 = \"Sf2.dll\" nocase fullword ascii wide\n        $dll10 = \"deploy.dll\" nocase fullword ascii wide\n        $dll11 = \"avcuf32.dll\" nocase fullword ascii wide\n        $dll12 = \"BgAgent.dll\" nocase fullword ascii wide\n        $dll13 = \"guard32.dll\" nocase fullword ascii wide\n        $dll14 = \"wl_hook.dll\" nocase fullword ascii wide\n        $dll15 = \"QOEHook.dll\" nocase fullword ascii wide\n        $dll16 = \"a2hooks32.dll\" nocase fullword ascii wide\n        $dll17 = \"tracer.dll\" nocase fullword ascii wide\n        $dll18 = \"APIOverride.dll\" nocase fullword ascii wide\n        $dll19 = \"NtHookEngine.dll\" nocase fullword ascii wide\n        $dll20 = \"LOG_API.DLL\" nocase fullword ascii wide\n        $dll21 = \"LOG_API32.DLL\" nocase fullword ascii wide\n        $dll22 = \"vmcheck32.dll\" nocase ascii wide\n        $dll23 = \"vmcheck64.dll\" nocase ascii wide\n    condition:\n        uint16(0) == 0x5a4d and 3 of them\n}\n\nrule INDICATOR_SUSPICIOUS_AHK_Downloader {\n    meta:\n        description = \"Detects AutoHotKey binaries acting as second stage droppers\"\n        author = \"ditekSHen\"\n    strings:\n        $d1 = \"URLDownloadToFile, http\" ascii\n        $d2 = \"URLDownloadToFile, file\" ascii\n        $s1 = \">AUTOHOTKEY SCRIPT<\" fullword wide\n        $s2 = \"open \\\"%s\\\" alias AHK_PlayMe\" fullword wide\n        $s3 = /AHK\\s(Keybd|Mouse)/ fullword wide\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($d*) and 1 of ($s*))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_UACBypass_CMSTPCOM {\n    meta:\n        description = \"Detects Windows exceutables bypassing UAC using CMSTP COM interfaces. MITRE (T1218.003)\"\n        author = \"ditekSHen\"\n    strings:\n        // CMSTPLUA\n        $guid1 = \"{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\" ascii wide nocase\n        // CMLUAUTIL\n        $guid2 = \"{3E000D72-A845-4CD9-BD83-80C07C3B881F}\" ascii wide nocase\n        // Connection Manager LUA Host Object\n        $guid3 = \"{BA126F01-2166-11D1-B1D0-00805FC1270E}\" ascii wide nocase\n        $s1 = \"CoGetObject\" fullword ascii wide\n        $s2 = \"Elevation:Administrator!new:\" fullword ascii wide\n    condition:\n       uint16(0) == 0x5a4d and (1 of ($guid*) and 1 of ($s*))\n}\n\nrule INDICATOR_SUSPICIOUS_ClearWinLogs {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing commands for clearing Windows Event Logs\"\n    strings:\n        $cmd1 = \"wevtutil.exe clear-log\" ascii wide nocase\n        $cmd2 = \"wevtutil.exe cl \" ascii wide nocase\n        $cmd3 = \".ClearEventLog()\" ascii wide nocase\n        $cmd4 = \"Foreach-Object {wevtutil cl \\\"$_\\\"}\" ascii wide nocase\n        $cmd5 = \"('wevtutil.exe el') DO (call :do_clear\" ascii wide nocase\n        $cmd6 = \"| ForEach { Clear-EventLog $_.Log }\" ascii wide nocase\n        $cmd7 = \"('wevtutil.exe el') DO wevtutil.exe cl \\\"%s\\\"\" ascii wide nocase\n        $t1 = \"wevtutil\" ascii wide nocase\n        $l1 = \"cl Application\" ascii wide nocase\n        $l2 = \"cl System\" ascii wide nocase\n        $l3 = \"cl Setup\" ascii wide nocase\n        $l4 = \"cl Security\" ascii wide nocase\n        $l5 = \"sl Security /e:false\" ascii wide nocase\n        $ne1 = \"wevtutil.exe cl Aplicaci\" fullword wide\n        $ne2 = \"wevtutil.exe cl Application /bu:C:\\\\admin\\\\backup\\\\al0306.evtx\" fullword wide\n        $ne3 = \"wevtutil.exe cl Application /bu:C:\\\\admin\\\\backups\\\\al0306.evtx\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and not any of ($ne*) and ((1 of ($cmd*)) or (1 of ($t*) and 4 of ($l*)))\n}\n\nrule INDICATOR_SUSPICIOUS_DisableWinDefender {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing artifcats associated with disabling Widnows Defender\"\n    strings:\n        $reg1 = \"SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Features\" ascii wide nocase\n        $reg2 = \"SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\" ascii wide nocase\n        $s1 = \"Set-MpPreference -SignatureDisableUpdateOnStartupWithoutEngine $true\" ascii wide nocase\n        $s2 = \"Set-MpPreference -DisableArchiveScanning $true\" ascii wide nocase\n        $s3 = \"Set-MpPreference -DisableIntrusionPreventionSystem $true\" ascii wide nocase\n        $s4 = \"Set-MpPreference -DisableScriptScanning $true\" ascii wide nocase\n        $s5 = \"Set-MpPreference -SubmitSamplesConsent 2\" ascii wide nocase\n        $s6 = \"Set-MpPreference -MAPSReporting 0\" ascii wide nocase\n        $s7 = \"Set-MpPreference -HighThreatDefaultAction 6\" ascii wide nocase\n        $s8 = \"Set-MpPreference -ModerateThreatDefaultAction 6\" ascii wide nocase\n        $s9 = \"Set-MpPreference -LowThreatDefaultAction 6\" ascii wide nocase\n        $s10 = \"Set-MpPreference -SevereThreatDefaultAction 6\" ascii wide nocase\n        $s11 = \"Set-MpPreference -EnableControlledFolderAccess Disabled\" ascii wide nocase\n        $pdb = \"\\\\Disable-Windows-Defender\\\\obj\\\\Debug\\\\Disable-Windows-Defender.pdb\" ascii\n        $e1 = \"Microsoft\\\\Windows Defender\\\\Exclusions\\\\Paths\" ascii wide nocase\n        $e2 = \"Add-MpPreference -Exclusion\" ascii wide nocase\n        $c1 = \"QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgAC0ARQB4AGMAbAB1AHMAaQBvAG4\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($reg*) and 1 of ($s*)) or ($pdb) or all of ($e*) or #c1 > 1)\n}\n\nrule INDICATOR_SUSPICIOUS_USNDeleteJournal {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing anti-forensic artifcats of deletiing USN change journal. Observed in ransomware\"\n    strings:\n        $cmd1 = \"fsutil.exe\" ascii wide nocase\n        $s1 = \"usn deletejournal /D C:\" ascii wide nocase\n        $s2 = \"fsutil.exe usn deletejournal\" ascii wide nocase\n        $s3 = \"fsutil usn deletejournal\" ascii wide nocase\n        $ne1 = \"fsutil usn readdata C:\\\\Temp\\\\sample.txt\" wide\n        $ne2 = \"fsutil transaction query {0f2d8905-6153-449a-8e03-7d3a38187ba1}\" wide\n        $ne3 = \"fsutil resource start d:\\\\foobar d:\\\\foobar\\\\LogDir\\\\LogBLF::TxfLog d:\\\\foobar\\\\LogDir\\\\LogBLF::TmLog\" wide\n        $ne4 = \"fsutil objectid query C:\\\\Temp\\\\sample.txt\" wide\n    condition:\n        uint16(0) == 0x5a4d and (not any of ($ne*) and (1 of ($cmd*) and 1 of ($s*)))\n}\n\nrule INDICATOR_SUSPICIOUS_WMIC_Downloader {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects files utilizing WMIC for whitelisting bypass and downloading second stage payloads\"\n    strings:\n        $s1 = \"WMIC.exe os get /format:\\\"http\" wide\n        $s2 = \"WMIC.exe computersystem get /format:\\\"http\" wide\n        $s3 = \"WMIC.exe dcomapp get /format:\\\"http\" wide\n        $s4 = \"WMIC.exe desktop get /format:\\\"http\" wide\n    condition:\n        (uint16(0) == 0x004c or uint16(0) == 0x5a4d) and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_PE_ResourceTuner {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables with modified PE resources usning the unpaid version of Resource Tuner\"\n    strings:\n        $s1 = \"Modified by an unpaid evaluation copy of Resource Tuner 2 (www.heaventools.com)\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_ASEP_REG_Reverse {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects file containing reversed ASEP Autorun registry keys\"\n    strings:\n        $s1 = \"nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s2 = \"ecnOnuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s3 = \"secivreSnuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s4 = \"xEecnOnuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s5 = \"ecnOsecivreSnuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s6 = \"yfitoN\\\\nogolniW\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s7 = \"tiniresU\\\\nogolniW\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s8 = \"nuR\\\\rerolpxE\\\\seiciloP\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s9 = \"stnenopmoC dellatsnI\\\\puteS evitcA\\\\tfosorciM\" ascii wide nocase\n        $s10 = \"sLLD_tinIppA\\\\swodniW\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s11 = \"snoitpO noitucexE eliF egamI\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s12 = \"llehS\\\\nogolniW\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s13 = \"daol\\\\swodniW\\\\noisreVtnerruC\\\\TN swodniW\\\\tfosorciM\" ascii wide nocase\n        $s14 = \"daoLyaleDtcejbOecivreSllehS\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s15 = \"nuRotuA\\\\rossecorP\\\\dnammoC\\\\tfosorciM\" ascii wide nocase\n        $s16 = \"putratS\\\\sredloF llehS resU\\\\rerolpxE\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\" ascii wide nocase\n        $s17 = \"sllDtreCppA\\\\reganaM noisseS\\\\lortnoC\\\\teSlortnoCtnerruC\\\\metsyS\" ascii wide nocase\n        $s18 = \"sllDtreCppA\\\\reganaM noisseS\\\\lortnoC\\\\100teSlortnoC\\\\metsyS\" ascii wide nocase\n        $s19 = \")tluafeD(\\\\dnammoC\\\\nepO\\\\llehS\\\\elifexE\\\\sessalC\\\\erawtfoS\" ascii wide nocase\n        $s20 = \")tluafeD(\\\\dnammoC\\\\nepO\\\\llehS\\\\elifexE\\\\sessalC\\\\edoN2346woW\\\\erawtfoS\" ascii wide nocase\n    condition:\n        1 of them and filesize < 2000KB\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SQLQuery_ConfidentialDataStore {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing SQL queries to confidential data stores. Observed in infostealers\"\n    strings:\n        $select = \"select \" ascii wide nocase\n        $table1 = \" from credit_cards\" ascii wide nocase\n        $table2 = \" from logins\" ascii wide nocase\n        $table3 = \" from cookies\" ascii wide nocase\n        $table4 = \" from moz_cookies\" ascii wide nocase\n        $table5 = \" from moz_formhistory\" ascii wide nocase\n        $table6 = \" from moz_logins\" ascii wide nocase\n        $column1 = \"name\" ascii wide nocase\n        $column2 = \"password_value\" ascii wide nocase\n        $column3 = \"encrypted_value\" ascii wide nocase\n        $column4 = \"card_number_encrypted\" ascii wide nocase\n        $column5 = \"isHttpOnly\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and 2 of ($table*) and 2 of ($column*) and $select\n}\n\nrule INDICATOR_SUSPICIOUS_PWSH_B64Encoded_Concatenated_FileEXEC {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PowerShell scripts containing patterns of base64 encoded files, concatenation and execution\"\n    strings:\n        $b1 = \"::WriteAllBytes(\" ascii\n        $b2 = \"::FromBase64String(\" ascii\n        $b3 = \"::UTF8.GetString(\" ascii\n\n        $s1 = \"-join\" nocase ascii\n        $s2 = \"[Char]$_\"\n        $s3 = \"reverse\" nocase ascii\n        $s4 = \" += \" ascii\n\n        $e1 = \"System.Diagnostics.Process\" ascii\n        $e2 = /StartInfo\\.(Filename|UseShellExecute)/ ascii\n        $e3 = /-eq\\s'\\.(exe|dll)'\\)/ ascii\n        $e4 = /(Get|Start)-(Process|WmiObject)/ ascii\n    condition:\n        #s4 > 10 and ((3 of ($b*)) or (1 of ($b*) and 2 of ($s*) and 1 of ($e*)) or (8 of them))\n}\n\nrule INDICATOR_SUSPICIOUS_JS_Hex_B64Encoded_EXE {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects JavaScript files hex and base64 encoded executables\"\n    strings:\n        $s1 = \".SaveToFile\" ascii\n        $s2 = \".Run\" ascii\n        $s3 = \"ActiveXObject\" ascii\n        $s4 = \"fromCharCode\" ascii\n        $s5 = \"\\\\x66\\\\x72\\\\x6F\\\\x6D\\\\x43\\\\x68\\\\x61\\\\x72\\\\x43\\\\x6F\\\\x64\\\\x65\" ascii\n        $binary = \"\\\\x54\\\\x56\\\\x71\\\\x51\\\\x41\\\\x41\" ascii\n        $pattern = /[\\s\\{\\(\\[=]_0x[0-9a-z]{3,6}/ ascii\n    condition:\n        $binary and $pattern and 2 of ($s*) and filesize < 2500KB\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_PWSH_Downloader {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects downloader agent, using PowerShell\"\n    strings:\n        $pwsh = \"powershell\" fullword ascii\n        $bitstansfer = \"Start-BitsTransfer\" ascii wide\n        $s1 = \"GET %s HTTP/1\" ascii\n        $s2 = \"User-Agent:\" ascii\n        $s3 = \"-WindowStyle Hidden -ep bypass -file \\\"\" fullword ascii\n        $s4 = \"LdrLoadDll\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and $pwsh and ($bitstansfer or 2 of ($s*))\n}\n\nrule INDICATOR_SUSPICIOUS_PWSH_PasswordCredential_RetrievePassword {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PowerShell content designed to retrieve passwords from host\"\n    strings:\n        $namespace = \"Windows.Security.Credentials.PasswordVault\" ascii wide nocase\n        $method1 = \"RetrieveAll()\" ascii wide nocase\n        $method2 = \".RetrievePassword()\" ascii wide nocase\n    condition:\n       $namespace and 1 of ($method*)\n}\n\nrule INDICATOR_SUSPICIOUS_UACBypass_EnvVarScheduledTasks {\n    meta:\n        author = \"ditekSHen\"\n        description = \"detects Windows exceutables potentially bypassing UAC (ab)using Environment Variables in Scheduled Tasks\"\n    strings:\n        $s1 = \"\\\\Microsoft\\\\Windows\\\\DiskCleanup\\\\SilentCleanup\" ascii wide\n        $s2 = \"\\\\Environment\" ascii wide\n        $s3 = \"schtasks\" ascii wide\n        $s4 = \"/v windir\" ascii wide\n    condition:\n       all of them\n}\n\nrule INDICATOR_SUSPICIOUS_UACBypass_fodhelper {\n    meta:\n        author = \"ditekSHen\"\n        description = \"detects Windows exceutables potentially bypassing UAC using fodhelper.exe\"\n    strings:\n        $s1 = \"\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command\" ascii wide nocase\n        $s2 = \"DelegateExecute\" ascii wide\n        $s3 = \"fodhelper\" ascii wide\n        $s4 = \"ConsentPromptBehaviorAdmin\" ascii wide\n    condition:\n       all of them\n}\n\nrule INDICATOR_SUSPICIOUS_Win_GENERIC01 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects known unamed malicious executables, mostly DLLs\"\n    strings:\n        $s1 = \"xcopy \\\"%s\\\" \\\"%s\\\" /e /i /y\" fullword ascii\n        $s2 = \"LoadFromMemory END---\" fullword ascii\n        $s3 = \"<<== Message sending:\" fullword ascii\n        $s4 = \"==>> Message received:\" fullword ascii\n        $s5 = \"I am virus! Fuck you\" ascii\n        $s6 = \"TMBMSRV.exe\" fullword ascii\n        $s7 = \"rtvscan.exe\" fullword ascii\n        $s8 = \"SPIDer.exe\" fullword ascii\n        $s9 = \"kxetray.exe\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and 5 of them\n}\n\nrule INDICATOR_SUSPICIOUS_Win_GENERIC02 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects known unamed malicious executables, mostly DLLs\"\n    strings:\n        $s1 = \"\\\\wmkawe_%d.data\" ascii\n        $s2 = \"\\\\resmon.resmoncfg\" ascii\n        $s3 = \"ByPassUAC\" fullword ascii\n        $s4 = \"rundll32.exe C:\\\\ProgramData\\\\Sandboxie\\\\SbieMsg.dll,installsvc\" fullword ascii nocase\n        $s5 = \"%s\\\\SbieMsg.\" ascii\n        $s6 = \"Stupid Japanese\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and 5 of them\n}\n\nrule INDICATOR_SUSPICIOUS_Win_GENERIC03 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects known unamed malicious executables\"\n    strings:\n        $s1 = \"{%s-%d-%d}\" fullword wide\n        $s2 = \"update\" fullword wide\n        $s3 = \"https://\" fullword wide\n        $s4 = \"http://\" fullword wide\n        $s5 = \"configure\" fullword ascii\n        $s6 = { 8d 4f 02 e8 8c ff ff ff 8b d8 81 fb 00 dc 00 00 }\n        $s7 = { 83 c1 02 e8 3c ff ff ff 8b c8 ba ff 03 00 00 8d }\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_Finger_Download_Pattern {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects files embedding and abusing the finger command for download\"\n    strings:\n        $pat1 = /finger(\\.exe)?\\s.{1,50}@.{7,10}\\|/ ascii wide\n        $pat2 = \"-Command \\\"finger\" ascii wide\n        $ne1 = \"Nmap service detection probe list\" ascii\n    condition:\n       not any of ($ne*) and any of ($pat*)\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_UACBypass_CMSTPCMD {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Windows exceutables bypassing UAC using CMSTP utility, command line and INF\"\n    strings:\n        $s1 = \"c:\\\\windows\\\\system32\\\\cmstp.exe\" ascii wide nocase\n        $s2 = \"taskkill /IM cmstp.exe /F\" ascii wide nocase\n        $s3 = \"CMSTPBypass\" fullword ascii\n        $s4 = \"CommandToExecute\" fullword ascii\n        $s5 = \"RunPreSetupCommands=RunPreSetupCommandsSection\" fullword wide\n        $s6 = \"\\\"HKLM\\\", \\\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\CMMGR32.EXE\\\", \\\"ProfileInstallPath\\\", \\\"%UnexpectedError%\\\", \\\"\\\"\" fullword wide nocase\n    condition:\n       uint16(0) == 0x5a4d and 3 of them\n}\n\nrule INDICATOR_SUSPICIOUS_JS_WMI_ExecQuery {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects JS potentially executing WMI queries\"\n    strings:\n        $ex = \".ExecQuery(\" ascii nocase\n        $s1 = \"GetObject(\" ascii nocase\n        $s2 = \"String.fromCharCode(\" ascii nocase\n        $s3 = \"ActiveXObject(\" ascii nocase\n        $s4 = \".Sleep(\" ascii nocase\n    condition:\n       ($ex and 2 of ($s*))\n}\n\nrule INDICATOR_SUSPICIOUS_PWSHLoader_RunPE {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PowerShell PE loader / executer. Observed MasterMana TTPs\"\n    strings:\n        $rp1 = \"GetType('RunPe.RunPe'\" ascii\n        $rp2 = \"GetType(\\\"RunPe.RunPe\\\"\" ascii\n        $rm1 = \"GetMethod('Run'\" ascii\n        $rm2 = \"GetMethod(\\\"Run\\\"\" ascii\n        $s1 = \".Invoke(\" ascii\n        $s2 = \"[Reflection.Assembly]::Load(\" ascii\n    condition:\n        all of ($s*) and 1 of ($rp*) and 1 of ($rm*)\n}\n\nrule INDICATOR_SUSPICIOUS_PELoader_RunPE {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PE loader / injector. Observed Gorgon TTPs\"\n    strings:\n        $s1 = \"commandLine'\" fullword ascii\n        $s2 = \"RunPe.dll\" fullword ascii\n        $s3 = \"HandleRun\" fullword ascii\n        $s4 = \"inheritHandles\" fullword ascii\n        $s5 = \"BlockCopy\" fullword ascii\n        $s6 = \"WriteProcessMemory\" fullword ascii\n        $s7 = \"startupInfo\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and 6 of them\n}\n\nrule INDICATOR_SUSPICIOUS_XML_Liverpool_Downlaoder_UserConfig {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects XML files associated with 'Liverpool' downloader containing encoded executables\"\n    strings:\n        $s1 = \"<configSections>\" ascii nocase\n        $s2 = \"<value>77 90\" ascii nocase\n    condition:\n       uint32(0) == 0x6d783f3c and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SandboxUserNames {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing possible sandbox analysis VM usernames\"\n    strings:\n        $s1 = \"15pb\" fullword ascii wide nocase\n        $s2 = \"7man2\" fullword ascii wide nocase\n        $s3 = \"stella\" fullword ascii wide nocase\n        $s4 = \"f4kh9od\" fullword ascii wide nocase\n        $s5 = \"willcarter\" fullword ascii wide nocase\n        $s6 = \"biluta\" fullword ascii wide nocase\n        $s7 = \"ehwalker\" fullword ascii wide nocase\n        $s8 = \"hong lee\" fullword ascii wide nocase\n        $s9 = \"joe cage\" fullword ascii wide nocase\n        $s10 = \"jonathan\" fullword ascii wide nocase\n        $s11 = \"kindsight\" fullword ascii wide nocase\n        $s12 = \"malware\" fullword ascii wide nocase\n        $s13 = \"peter miller\" fullword ascii wide nocase\n        $s14 = \"petermiller\" fullword ascii wide nocase\n        $s15 = \"phil\" fullword ascii wide nocase\n        $s16 = \"rapit\" fullword ascii wide nocase\n        $s17 = \"r0b0t\" fullword ascii wide nocase\n        $s18 = \"cuckoo\" fullword ascii wide nocase\n        $s19 = \"vm-pc\" fullword ascii wide nocase\n        $s20 = \"analyze\" fullword ascii wide nocase\n        $s21 = \"roslyn\" fullword ascii wide nocase\n        $s22 = \"vince\" fullword ascii wide nocase\n        $s23 = \"test\" fullword ascii wide nocase\n        $s24 = \"sample\" fullword ascii wide nocase\n        $s25 = \"mcafee\" fullword ascii wide nocase\n        $s26 = \"vmscan\" fullword ascii wide nocase\n        $s27 = \"mallab\" fullword ascii wide nocase\n        $s28 = \"abby\" fullword ascii wide nocase\n        $s29 = \"elvis\" fullword ascii wide nocase\n        $s30 = \"wilbert\" fullword ascii wide nocase\n        $s31 = \"joe smith\" fullword ascii wide nocase\n        $s32 = \"hanspeter\" fullword ascii wide nocase\n        $s33 = \"johnson\" fullword ascii wide nocase\n        $s34 = \"placehole\" fullword ascii wide nocase\n        $s35 = \"tequila\" fullword ascii wide nocase\n        $s36 = \"paggy sue\" fullword ascii wide nocase\n        $s37 = \"klone\" fullword ascii wide nocase\n        $s38 = \"oliver\" fullword ascii wide nocase\n        $s39 = \"stevens\" fullword ascii wide nocase\n        $s40 = \"ieuser\" fullword ascii wide nocase\n        $s41 = \"virlab\" fullword ascii wide nocase\n        $s42 = \"beginer\" fullword ascii wide nocase\n        $s43 = \"beginner\" fullword ascii wide nocase\n        $s44 = \"markos\" fullword ascii wide nocase\n        $s45 = \"semims\" fullword ascii wide nocase\n        $s46 = \"gregory\" fullword ascii wide nocase\n        $s47 = \"tom-pc\" fullword ascii wide nocase\n        $s48 = \"will carter\" fullword ascii wide nocase\n        $s49 = \"angelica\" fullword ascii wide nocase\n        $s50 = \"eric johns\" fullword ascii wide nocase\n        $s51 = \"john ca\" fullword ascii wide nocase\n        $s52 = \"lebron james\" fullword ascii wide nocase\n        $s53 = \"rats-pc\" fullword ascii wide nocase\n        $s54 = \"robot\" fullword ascii wide nocase\n        $s55 = \"serena\" fullword ascii wide nocase\n        $s56 = \"sofynia\" fullword ascii wide nocase\n        $s57 = \"straz\" fullword ascii wide nocase\n        $s58 = \"bea-ch\" fullword ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and 10 of them\n}\n\nrule INDICATOR_SUSPICIOUS_B64_Encoded_UserAgent {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing base64 encoded User Agent\"\n    strings:\n        $s1 = \"TW96aWxsYS81LjAgK\" ascii wide\n        $s2 = \"TW96aWxsYS81LjAgKFdpbmRvd3M\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and any of them\n}\n\nrule INDICATOR_SUSPICIOUS_WindDefender_AntiEmaulation {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing potential Windows Defender anti-emulation checks\"\n    strings:\n        $s1 = \"JohnDoe\" fullword ascii wide\n        $s2 = \"HAL9TH\" fullword ascii wide\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_ClearMyTracksByProcess {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables calling ClearMyTracksByProcess\"\n    strings:\n        $s1 = \"InetCpl.cpl,ClearMyTracksByProcess\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and any of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_TelegramChatBot {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables using Telegram Chat Bot\"\n    strings:\n        $s1 = \"https://api.telegram.org/bot\" ascii wide\n        $s2 = \"/sendMessage?chat_id=\" fullword ascii wide\n        $s3 = \"Content-Disposition: form-data; name=\\\"\" fullword ascii\n        $s4 = \"/sendDocument?chat_id=\" fullword ascii wide\n        $p1 = \"/sendMessage\" ascii wide\n        $p2 = \"/sendDocument\" ascii wide\n        $p3 = \"&chat_id=\" ascii wide\n        $p4 = \"/sendLocation\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($s*) or (2 of ($p*) and 1 of ($s*)))\n}\n  \nrule INDICATOR_SUSPICIOUS_EXE_B64_Artifacts {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding bas64-encoded APIs, command lines, registry keys, etc.\"\n    strings:\n        $s1 = \"U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuXA\" ascii wide\n        $s2 = \"L2Mgc2NodGFza3MgL2\" ascii wide\n        $s3 = \"QW1zaVNjYW5CdWZmZXI\" ascii wide\n        $s4 = \"VmlydHVhbFByb3RlY3Q\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and 2 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_DiscordURL {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables Discord URL observed in first stage droppers\"\n    strings:\n        $s1 = \"https://discord.com/api/webhooks/\" ascii wide nocase\n        $s2 = \"https://cdn.discordapp.com/attachments/\" ascii wide nocase\n        $s3 = \"aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va\" ascii wide\n        $s4 = \"aHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobW\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and any of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_RegKeyComb_IExecuteCommandCOM {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding command execution via IExecuteCommand COM object\"\n    strings:\n        $r1 = \"Classes\\\\Folder\\\\shell\\\\open\\\\command\" ascii wide nocase\n        $k1 = \"DelegateExecute\" ascii wide\n        $s1 = \"/EXEFilename \\\"{0}\" ascii wide\n        $s2 = \"/WindowState \\\"\\\"\" ascii wide\n        $s3 = \"/PriorityClass \\\"\\\"32\\\"\\\" /CommandLine \\\"\" ascii wide\n        $s4 = \"/StartDirectory \\\"\" ascii wide\n        $s5 = \"/RunAs\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($r*) and 1 of ($k*)) or (all of ($s*)))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_WMI_EnumerateVideoDevice {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables attemping to enumerate video devices using WMI\"\n    strings:\n        $q1 = \"Select * from Win32_CacheMemory\" ascii wide nocase\n        $d1 = \"{860BB310-5D01-11d0-BD3B-00A0C911CE86}\" ascii wide\n        $d2 = \"{62BE5D10-60EB-11d0-BD3B-00A0C911CE86}\" ascii wide\n        $d3 = \"{55272A00-42CB-11CE-8135-00AA004BB851}\" ascii wide\n        $d4 = \"SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4d36e968-e325-11ce-bfc1-08002be10318}\\\\000\" ascii wide nocase\n        $d5 = \"HardwareInformation.AdapterString\" ascii wide\n        $d6 = \"HardwareInformation.qwMemorySize\" ascii wide\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($q*) and 1 of ($d*)) or 3 of ($d*))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_Go_GoLazagne {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Go executables using GoLazagne\"\n    strings:\n        $s1 = \"/goLazagne/\" ascii nocase\n        $s2 = \"Go build ID:\" ascii\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_CSPROJ {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects suspicious .CSPROJ files\"\n    strings:\n        $s1 = \"ToolsVersion=\" ascii\n        $s2 = \"/developer/msbuild/\" ascii\n        $x1 = \"[DllImport(\\\"\\\\x\" ascii\n        $x2 = \"VirtualAlloc(\" ascii nocase\n        $x3 = \"CallWindowProc(\" ascii nocase\n    condition:\n        uint32(0) == 0x6f72503c and (all of ($s*) and 2 of ($x*))\n}\n\nrule INDICATOR_SUSPICIOUS_Sandbox_Evasion_FilesComb {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing specific set of files observed in sandob anti-evation, and Emotet\"\n    strings:\n        $s1 = \"c:\\\\take_screenshot.ps1\" ascii wide nocase\n        $s2 = \"c:\\\\loaddll.exe\" ascii wide nocase\n        $s3 = \"c:\\\\email.doc\" ascii wide nocase\n        $s4 = \"c:\\\\email.htm\" ascii wide nocase\n        $s5 = \"c:\\\\123\\\\email.doc\" ascii wide nocase\n        $s6 = \"c:\\\\123\\\\email.docx\" ascii wide nocase\n        $s7 = \"c:\\\\a\\\\foobar.bmp\" ascii wide nocase\n        $s8 = \"c:\\\\a\\\\foobar.doc\" ascii wide nocase\n        $s9 = \"c:\\\\a\\\\foobar.gif\" ascii wide nocase\n        $s10 = \"c:\\\\symbols\\\\aagmmc.pdb\" ascii wide nocase\n    condition:\n         uint16(0) == 0x5a4d and 6 of them\n}\n\nrule INDICATOR_SUSPICIOUS_Sandbox_Evasion_VirtDrvComb {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing combination of virtualization drivers\"\n    strings:\n        $p1 = \"prleth.sys\" ascii wide\n        $p2 = \"prlfs.sys\" ascii wide\n        $p3 = \"prlmouse.sys\" ascii wide\n        $p4 = \"prlvideo.sys\t\" ascii wide\n        $p5 = \"prltime.sys\" ascii wide\n        $p6 = \"prl_pv32.sys\" ascii wide\n        $p7 = \"prl_paravirt_32.sys\" ascii wide\n        $vb1 = \"VBoxMouse.sys\" ascii wide\n        $vb2 = \"VBoxGuest.sys\" ascii wide\n        $vb3 = \"VBoxSF.sys\" ascii wide\n        $vb4 = \"VBoxVideo.sys\" ascii wide\n        $vb5 = \"vboxdisp.dll\" ascii wide\n        $vb6 = \"vboxhook.dll\" ascii wide\n        $vb7 = \"vboxmrxnp.dll\" ascii wide\n        $vb8 = \"vboxogl.dll\" ascii wide\n        $vb9 = \"vboxoglarrayspu.dll\" ascii wide\n        $vb10 = \"vboxoglcrutil.dll\" ascii wide\n        $vb11 = \"vboxoglerrorspu.dll\" ascii wide\n        $vb12 = \"vboxoglfeedbackspu.dll\" ascii wide\n        $vb13 = \"vboxoglpackspu.dll\" ascii wide\n        $vb14 = \"vboxoglpassthroughspu.dll\" ascii wide\n        $vb15 = \"vboxservice.exe\" ascii wide\n        $vb16 = \"vboxtray.exe\" ascii wide\n        $vb17 = \"VBoxControl.exe\" ascii wide\n        $vp1 = \"vmsrvc.sys\" ascii wide\n        $vp2 = \"vpc-s3.sys\" ascii wide\n        $vw1 = \"vmmouse.sys\" ascii wide\n        $vw2 = \"vmnet.sys\" ascii wide\n        $vw3 = \"vmxnet.sys\" ascii wide\n        $vw4 = \"vmhgfs.sys\" ascii wide\n        $vw5 = \"vmx86.sys\" ascii wide\n        $vw6 = \"hgfs.sys\" ascii wide\n    condition:\n         uint16(0) == 0x5a4d and (\n             (2 of ($p*) and (2 of ($vb*) or 2 of ($vp*) or 2 of ($vw*))) or\n             (2 of ($vb*) and (2 of ($p*) or 2 of ($vp*) or 2 of ($vw*))) or\n             (2 of ($vp*) and (2 of ($p*) or 2 of ($vb*) or 2 of ($vw*))) or\n             (2 of ($vw*) and (2 of ($p*) or 2 of ($vb*) or 2 of ($vp*)))\n         )\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_NoneWindowsUA {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Windows executables referencing non-Windows User-Agents\"\n    strings:\n        $ua1 = \"Mozilla/5.0 (Macintosh; Intel Mac OS\" wide ascii\n        $ua2 = \"Mozilla/5.0 (iPhone; CPU iPhone OS\" ascii wide\n        $ua3 = \"Mozilla/5.0 (Linux; Android \" ascii wide\n        $ua4 = \"Mozilla/5.0 (PlayStation \" ascii wide\n        $ua5 = \"Mozilla/5.0 (X11; \" wide ascii\n        $ua6 = \"Mozilla/5.0 (Windows Phone \" ascii wide\n        $ua7 = \"Mozilla/5.0 (compatible; MSIE 10.0; Macintosh; Intel Mac OS X 10_7_3; Trident/6.0)\" wide ascii\n        $ua8 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0)\" wide ascii\n        $ua9 = \"HTC_Touch_3G Mozilla/4.0 (compatible; MSIE 6.0; Windows CE; IEMobile 7.11)\" wide ascii\n        $ua10 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows Phone OS 7.0; Trident/3.1; IEMobile/7.0; Nokia;N70)\" wide ascii\n        $ua11 = \"Mozilla/5.0 (BlackBerry; U; BlackBerry \" wide ascii\n        $ua12 = \"Mozilla/5.0 (iPad; CPU OS\" wide ascii\n        $ua13 = \"Mozilla/5.0 (iPad; U;\" ascii wide\n        $ua14 = \"Mozilla/5.0 (IE 11.0;\" ascii wide\n        $ua15 = \"Mozilla/5.0 (Android;\" ascii wide\n        $ua16 = \"User-Agent: Internal Wordpress RPC connection\" ascii wide\n    condition:\n         uint16(0) == 0x5a4d and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_VM_Evasion_MACAddrComb {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing virtualization MAC addresses\"\n    strings:\n        $s1 = \"00:03:FF\" ascii wide nocase\n        $s2 = \"00:05:69\" ascii wide nocase\n        $s3 = \"00:0C:29\" ascii wide nocase\n        $s4 = \"00:16:3E\" ascii wide nocase\n        $s5 = \"00:1C:14\" ascii wide nocase\n        $s6 = \"00:1C:42\" ascii wide nocase\n        $s7 = \"00:50:56\" ascii wide nocase\n        $s8 = \"08:00:27\" ascii wide nocase\n    condition:\n         uint16(0) == 0x5a4d and 3 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_CC_Regex {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing credit card regular expressions\"\n    strings:\n        // Amex / Express Card\n        $s1 = \"^3[47][0-9]{13}$\" ascii wide nocase\n        $s2 = \"3[47][0-9]{13}$\" ascii wide nocase\n        $s3 = \"37[0-9]{2}\\\\s[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\" ascii wide nocase\n        // BCGlobal\n        $s4 = \"^(6541|6556)[0-9]{12}$\" ascii wide nocase\n        // Carte Blanche Card\n        $s5 = \"^389[0-9]{11}$\" ascii wide nocase\n        // Diners Club Card\n        $s6 = \"^3(?:0[0-5]|[68][0-9])[0-9]{11}$\" ascii wide nocase\n        // Discover Card\n        $s7 = \"6(?:011|5[0-9]{2})[0-9]{12}$\" ascii wide nocase\n        $s8 = \"6011\\\\s[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\" ascii wide nocase\n        // Insta Payment Card\n        $s9 = \"^63[7-9][0-9]{13}$\" ascii wide nocase\n        // JCB Card\n        $s10 = \"^(?:2131|1800|35\\\\d{3})\\\\d{11}$\" ascii wide nocase\n        // KoreanLocalCard\n        $s11 = \"^9[0-9]{15}$\" ascii wide nocase\n        // Laser Card\n        $s12 = \"^(6304|6706|6709|6771)[0-9]{12,15}$\" ascii wide nocase\n        // Maestro Card\n        $s13 = \"^(5018|5020|5038|6304|6759|6761|6763)[0-9]{8,15}$\" ascii wide nocase\n        // Mastercard\n        $s14 = \"5[1-5][0-9]{14}$\" ascii wide nocase\n        // Solo Card\n        $s15 = \"^(6334|6767)[0-9]{12}|(6334|6767)[0-9]{14}|(6334|6767)[0-9]{15}$\" ascii wide nocase\n        // Switch Card\n        $s16 = \"^(4903|4905|4911|4936|6333|6759)[0-9]{12}|(4903|4905|4911|4936|6333|6759)[0-9]{14}|(4903|4905|4911|4936|6333|6759)[0-9]{15}|564182[0-9]{10}|564182[0-9]{12}|564182[0-9]{13}|633110[0-9]{10}|633110[0-9]{12}|633110[0-9]{13}$\" ascii wide nocase\n        // Union Pay Card\n        $s17 = \"^(62[0-9]{14,17})$\" ascii wide nocase\n        // Visa Card\n        $s18 = \"4[0-9]{12}(?:[0-9]{3})?$\" ascii wide nocase\n        // Visa Master Card\n        $s19 = \"^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14})$\" ascii wide nocase\n        $s20 = \"4[0-9]{3}\\\\s[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\" ascii wide nocase\n        $a21 = \"^[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\"ascii wide nocase\n    condition:\n         (uint16(0) == 0x5a4d and 2 of them) or (4 of them)\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_Discord_Regex {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing Discord tokens regular expressions\"\n    strings:\n        $s1 = \"[a-zA-Z0-9]{24}\\\\.[a-zA-Z0-9]{6}\\\\.[a-zA-Z0-9_\\\\-]{27}|mfa\\\\.[a-zA-Z0-9_\\\\-]{84}\" ascii wide nocase\n    condition:\n         (uint16(0) == 0x5a4d and all of them) or all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_VaultSchemaGUID {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing Windows vault credential objects. Observed in infostealers\"\n    strings:\n        // Windows Secure Note\n        $s1 = \"2F1A6504-0641-44CF-8BB5-3612D865F2E5\" ascii wide\n        // Windows Web Password Credential\n        $s2 = \"3CCD5499-87A8-4B10-A215-608888DD3B55\" ascii wide\n        // Windows Credential Picker Protector\n        $s3 = \"154E23D0-C644-4E6F-8CE6-5069272F999F\" ascii wide\n        // Web Credentials\n        $s4 = \"4BF4C442-9B8A-41A0-B380-DD4A704DDB28\" ascii wide\n        // Windows Credentials\n        $s5 = \"77BC582B-F0A6-4E15-4E80-61736B6F3B29\" ascii wide\n        // Windows Domain Certificate Credential\n        $s6 = \"E69D7838-91B5-4FC9-89D5-230D4D4CC2BC\" ascii wide\n        // Windows Domain Password Credential\n        $s7 = \"3E0E35BE-1B77-43E7-B873-AED901B6275B\" ascii wide\n        // Windows Extended Credential\n        $s8 = \"3C886FF3-2669-4AA2-A8FB-3F6759A77548\" ascii wide\n    condition:\n         uint16(0) == 0x5a4d and 4 of them\n}\n\nrule INDICATOR_SUSPICIOUS_AntiVM_UNK01 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects memory artifcats referencing specific combination of anti-VM checks\"\n    strings:\n        $s1 = \"vmci.s\" fullword ascii wide\n        $s2 = \"vmmemc\" fullword ascii wide\n        $s3 = \"qemu-ga.exe\" fullword ascii wide\n        $s4 = \"qga.exe\" fullword ascii wide\n        $s5 = \"windanr.exe\" fullword ascii wide\n        $s6 = \"vboxservice.exe\" fullword ascii wide\n        $s7 = \"vboxtray.exe\" fullword ascii wide\n        $s8 = \"vmtoolsd.exe\" fullword ascii wide\n        $s9 = \"prl_tools.exe\" fullword ascii wide\n        $s10 = \"7869.vmt\" fullword ascii wide\n        $s11 = \"qemu\" fullword ascii wide\n        $s12 = \"virtio\" fullword ascii wide\n        $s13 = \"vmware\" fullword ascii wide\n        $s14 = \"vbox\" fullword ascii wide\n        $s15 = \"%systemroot%\\\\system32\\\\ntdll.dll\" fullword ascii wide\n    condition:\n         uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_AntiVM_WMIC {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects memory artifcats referencing WMIC commands for anti-VM checks\"\n    strings:\n        $s1 = \"wmic process where \\\"name like '%vmwp%'\\\"\" ascii wide nocase\n        $s2 = \"wmic process where \\\"name like '%virtualbox%'\\\"\" ascii wide nocase\n        $s3 = \"wmic process where \\\"name like '%vbox%'\\\"\" ascii wide nocase\n    condition:\n         uint16(0) == 0x5a4d and 2 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EnableSMBv1 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects binaries with PowerShell command enable SMBv1\"\n    strings:\n        $s1 = \"Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol\" ascii wide nocase\n    condition:\n         uint16(0) == 0x5a4d and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EnableNetworkDiscovery {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects binaries manipulating Windows firewall to enable permissive network discovery\"\n    strings:\n        $s1 = \"netsh advfirewall firewall set rule group=\\\"Network Discovery\\\" new enable=Yes\" ascii wide nocase\n        $s2 = \"netsh advfirewall firewall set rule group=\\\"File and Printer Sharing\\\" new enable=Yes\" ascii wide nocase\n    condition:\n         uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_References_AuthApps {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing many authentication apps. Observed in information stealers\"\n    strings:\n        $s1 = \"WinAuth\\\\winauth.xml\" ascii wide nocase\n        $s2 = \"Authy Desktop\\\\Local\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_RegKeyComb_RDP {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding registry key / value combination manipulating RDP / Terminal Services\"\n    strings:\n        // Beginning with Windows Server 2008 and Windows Vista, this policy no longer has any effect\n        // https://docs.microsoft.com/en-us/windows/win32/msi/enableadmintsremote\n        $r1 = \"SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\Installer\" ascii wide nocase\n        $k1 = \"EnableAdminTSRemote\" fullword ascii wide nocase\n        // Whether basic Terminal Services functions are enabled\n        $r2 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" ascii wide nocase\n        $k2 = \"TSEnabled\" fullword ascii wide nocase\n        // Terminal Device Driver Attributes\n        // Terminal Services hosts and configurations\n        $r3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\TermDD\" ascii wide nocase\n        $r4 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\TermService\" ascii wide nocase\n        $k3 = \"Start\" fullword ascii wide nocase\n        // Allows or denies connecting to Terminal Services\n        $r5 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\" ascii wide nocase\n        $k4 = \"fDenyTSConnections\" fullword ascii wide nocase\n        // RDP Port Number\n        $r6 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\RDPTcp\" ascii wide nocase\n        $r7 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\Wds\\\\rdpwd\\\\Tds\\\\tcp\" ascii wide nocase\n        $r8 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\" ascii wide nocase\n        $k5 = \"PortNumber\" fullword ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and 5 of ($r*) and 3 of ($k*)\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_Undocumented_WinAPI_Kerberos {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing undocumented kerberos Windows APIs and obsereved in malware\"\n    strings:\n        // Undocumented Kerberos-related functions\n        // Reference: https://unit42.paloaltonetworks.com/manageengine-godzilla-nglite-kdcsponge/ (KdcSponge)\n        // Reference: https://us-cert.cisa.gov/ncas/current-activity/2021/11/19/updated-apt-exploitation-manageengine-adselfservice-plus\n        // New Sample: e391c2d3e8e4860e061f69b894cf2b1ba578a3e91de610410e7e9fa87c07304c\n        $kdc1 = \"KdcVerifyEncryptedTimeStamp\" ascii wide nocase\n        $kdc2 = \"KerbHashPasswordEx3\" ascii wide nocase\n        $kdc3 = \"KerbFreeKey\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and all of ($kdc*)\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_NKN_BCP2P {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables referencing NKN Blockchain P2P network\"\n    strings:\n        $x1 = \"/nknorg/nkn-sdk-go.\" ascii\n        $x2 = \"://seed.nkn.org\" ascii\n        $x3 = \"/nknorg/nkn/\" ascii\n        $s1 = \").NewNanoPayClaimer\" ascii\n        $s2 = \").IncrementAmount\" ascii\n        $s3 = \").BalanceByAddress\" ascii\n        $s4 = \").TransferName\" ascii\n        $s5 = \".GetWsAddr\" ascii\n        $s6 = \".GetNodeStateContext\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*) or all of ($s*))\n}\n\nrule INDICATOR_Binary_Embedded_Cryptocurrency_Wallet_Browser_Extension_IDs {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detect binaries embedding considerable number of cryptocurrency wallet browser extension IDs.\"\n    strings:\n        $s1 = \"Ibnejdfjmmkpcnlpebklmnkoeoihofec\" ascii wide nocase // TronLink\n        $s2 = \"fhbohimaelbohpjbbldcngcnapndodjp\" ascii wide nocase // BinanceChain\n        $s3 = \"ffnbelfdoeiohenkjibnmadjiehjhajb\" ascii wide nocase // Yoroi\n        $s4 = \"jbdaocneiiinmjbjlgalhcelgbejmnid\" ascii wide nocase // Nifty Wallet\n        $s5 = \"afbcbjpbpfadlkmhmclhkeeodmamcflc\" ascii wide nocase // Math Wallet\n        $s6 = \"hnfanknocfeofbddgcijnmhnfnkdnaad\" ascii wide nocase // Coinbase Wallet\n        $s7 = \"hpglfhgfnhbgpjdenjgmdgoeiappafln\" ascii wide nocase // Guarda\n        $s8 = \"blnieiiffboillknjnepogjhkgnoapac\" ascii wide nocase // EQUAL Wallet\n        $s9 = \"cjelfplplebdjjenllpjcblmjkfcffne\" ascii wide nocase // Jaxx Liberty\n        $s10 = \"fihkakfobkmkjojpchpfgcmhfjnmnfpi\" ascii wide nocase // BitApp Wallet\n        $s11 = \"kncchdigobghenbbaddojjnnaogfppfj\" ascii wide nocase // iWallet\n        $s12 = \"amkmjjmmflddogmhpjloimipbofnfjih\" ascii wide nocase // Wombat\n        $s13 = \"nlbmnnijcnlegkjjpcfjclmcfggfefdm\" ascii wide nocase // MEW CX\n        $s14 = \"nanjmdknhkinifnkgdcggcfnhdaammmj\" ascii wide nocase // GuildWallet\n        $s15 = \"nkddgncdjgjfcddamfgcmfnlhccnimig\" ascii wide nocase // Saturn Wallet\n        $s16 = \"fnjhmkhhmkbjkkabndcnnogagogbneec\" ascii wide nocase // Ronin Wallet\n        $s17 = \"cphhlgmgameodnhkjdmkpanlelnlohao\" ascii wide nocase // NeoLine\n        $s18 = \"nhnkbkgjikgcigadomkphalanndcapjk\" ascii wide nocase // Clover Wallet\n        $s19 = \"kpfopkelmapcoipemfendmdcghnegimn\" ascii wide nocase // Liquality Wallet\n        $s20 = \"aiifbnbfobpmeekipheeijimdpnlpgpp\" ascii wide nocase // Terra Station\n        $s21 = \"dmkamcknogkgcdfhhbddcghachkejeap\" ascii wide nocase // Keplr\n        $s22 = \"fhmfendgdocmcbmfikdcogofphimnkno\" ascii wide nocase // Sollet\n        $s23 = \"cnmamaachppnkjgnildpdmkaakejnhae\" ascii wide nocase // Auro Wallet\n        $s24 = \"jojhfeoedkpkglbfimdfabpdfjaoolaf\" ascii wide nocase // Polymesh Wallet\n        $s25 = \"flpiciilemghbmfalicajoolhkkenfel\" ascii wide nocase // ICONex\n        $s26 = \"nknhiehlklippafakaeklbeglecifhad\" ascii wide nocase // Nabox Wallet\n        $s27 = \"hcflpincpppdclinealmandijcmnkbgn\" ascii wide nocase // KHC\n        $s28 = \"ookjlbkiijinhpmnjffcofjonbfbgaoc\" ascii wide nocase // Temple\n        $s29 = \"mnfifefkajgofkcjkemidiaecocnkjeh\" ascii wide nocase // TezBox\n        $s30 = \"lodccjjbdhfakaekdiahmedfbieldgik\" ascii wide nocase // DAppPlay\n        $s31 = \"Ijmpgkjfkbfhoebgogflfebnmejmfbml\" ascii wide nocase // BitClip\n        $s32 = \"lkcjlnjfpbikmcmbachjpdbijejflpcm\" ascii wide nocase // Steem Keychain\n        $s33 = \"nkbihfbeogaeaoehlefnkodbefgpgknn\" ascii wide nocase // MetaMask\n        $s34 = \"bcopgchhojmggmffilplmbdicgaihlkp\" ascii wide nocase // Hycon Lite Client\n        $s35 = \"klnaejjgbibmhlephnhpmaofohgkpgkd\" ascii wide nocase // ZilPay\n        $s36 = \"aeachknmefphepccionboohckonoeemg\" ascii wide nocase // Coin98 Wallet\n        $s37 = \"dkdedlpgdmmkkfjabffeganieamfklkm\" ascii wide nocase // Cyano Wallet\n        $s38 = \"nlgbhdfgdhgbiamfdfmbikcdghidoadd\" ascii wide nocase // Byone\n        $s39 = \"onofpnbbkehpmmoabgpcpmigafmmnjhl\" ascii wide nocase // Nash Extension\n        $s40 = \"cihmoadaighcejopammfbmddcmdekcje\" ascii wide nocase // Leaf Wallet\n        $s41 = \"cgeeodpfagjceefieflmdfphplkenlfk\" ascii wide nocase // EVER Wallet\n        $s42 = \"pdadjkfkgcafgbceimcpbkalnfnepbnk\" ascii wide nocase // KardiaChain Wallet\n        $s43 = \"acmacodkjbdgmoleebolmdjonilkdbch\" ascii wide nocase // Rabby Wallet\n        $s44 = \"bfnaelmomeimhlpmgjnjophhpkkoljpa\" ascii wide nocase // Phantom\n        $s45 = \"fhilaheimglignddkjgofkcbgekhenbh\" ascii wide nocase // Oxygen - Atomic Crypto Wallet\n        $s46 = \"mgffkfbidihjpoaomajlbgchddlicgpn\" ascii wide nocase // Pali Wallet\n        $s47 = \"hmeobnfnfcmdkdcmlblgagmfpfboieaf\" ascii wide nocase // XDEFI Wallet\n        $s48 = \"lpfcbjknijpeeillifnkikgncikgfhdo\" ascii wide nocase // Nami\n        $s49 = \"dngmlblcodfobpdpecaadgfbcggfjfnm\" ascii wide nocase // MultiversX DeFi Wallet\n        $s50 = \"bhhhlbepdkbapadjdnnojkbgioiodbic\" ascii wide nocase // Solflare Wallet\n        $s51 = \"jnkelfanjkeadonecabehalmbgpfodjm\" ascii wide nocase // Goby\n        $s52 = \"jhgnbkkipaallpehbohjmkbjofjdmeid\" ascii wide nocase // SteemKeychain\n        $s53 = \"jnlgamecbpmbajjfhmmmlhejkemejdma\" ascii wide nocase // Braavos Smart Wallet\n        $s54 = \"kkpllkodjeloidieedojogacfhpaihoh\" ascii wide nocase // Enkrypt: Ethereum, Polkadot & RSK Wallet\n        $s55 = \"mcohilncbfahbmgdjkbpemcciiolgcge\" ascii wide nocase // OKX Wallet\n        $s56 = \"gjagmgiddbbciopjhllkdnddhcglnemk\" ascii wide nocase // Hashpack\n        $s57 = \"kmhcihpebfmpgmihbkipmjlmmioameka\" ascii wide nocase // Eternl\n        $s58 = \"phkbamefinggmakgklpkljjmgibohnba\" ascii wide nocase // Pontem Aptos Wallet\n        $s59 = \"lpilbniiabackdjcionkobglmddfbcjo\" ascii wide nocase // Keeper Wallet\n        $s60 = \"cjmkndjhnagcfbpiemnkdpomccnjblmj\" ascii wide nocase // Finnie\n        $s61 = \"aijcbedoijmgnlmjeegjaglmepbmpkpi\" ascii wide nocase // Leap Terra Wallet\n        $s62 = \"efbglgofoippbgcjepnhiblaibcnclgk\" ascii wide nocase // Martian Wallet for Sui & Aptos\n        $s63 = \"odbfpeeihdkbihmopkbjmoonfanlbfcl\" ascii wide nocase // Brave Wallet\n        $s64 = \"fnnegphlobjdpkhecapkijjdkgcjhkib\" ascii wide nocase // Harmony\n        $s65 = \"aodkkagnadcbobfpggfnjeongemjbjca\" ascii wide nocase // BOLT X\n        $s66 = \"akoiaibnepcedcplijmiamnaigbepmcb\" ascii wide nocase // Edge - Yoroi\n        $s67 = \"ejbalbakoplchlghecdalmeeeajnimhm\" ascii wide nocase // Edge - MetaMask\n        $s68 = \"dfeccadlilpndjjohbjdblepmjeahlmm\" ascii wide nocase // Edge - Math Wallet\n        $s69 = \"kjmoohlgokccodicjjfebfomlbljgfhk\" ascii wide nocase // Edge - Ronin Wallet\n        $s70 = \"ajkhoeiiokighlmdnlakpjfoobnjinie\" ascii wide nocase // Edge - Station Wallet\n        $s71 = \"fplfipmamcjaknpgnipjeaeeidnjooao\" ascii wide nocase // Edge - BDLT Wallet\n        $s72 = \"niihfokdlimbddhfmngnplgfcgpmlido\" ascii wide nocase // Edge - Glow\n        $s73 = \"obffkkagpmohennipjokmpllocnlndac\" ascii wide nocase // Edge - OneKey\n        $s74 = \"kfocnlddfahihoalinnfbnfmopjokmhl\" ascii wide nocase // Edge - MetaWallet\n        $s75 = \"infeboajgfhgbjpjbeppbkgnabfdkdaf\" ascii wide nocase // OneKey\n        $s76 = \"{530f7c6c-6077-4703-8f71-cb368c663e35}.xpi\" ascii wide nocase // Firefox - Yoroi\n        $s77 = \"ronin-wallet@axieinfinity.com.xpi\" ascii wide nocase // Firefox - Ronin Wallet\n        $s78 = \"webextension@metamask.io.xpi\" ascii wide nocase // Firefox - MetaMask\n        $s79 = \"{5799d9b6-8343-4c26-9ab6-5d2ad39884ce}.xpi\" ascii wide nocase // Firefox - TronLink\n        $s80 = \"{aa812bee-9e92-48ba-9570-5faf0cfe2578}.xpi\" ascii wide nocase // Firefox - TronLink\n        $s81 = \"{59ea5f29-6ea9-40b5-83cd-937249b001e1}.xpi\" ascii wide nocase // Firefox - TronLink\n        $s82 = \"{d8ddfc2a-97d9-4c60-8b53-5edd299b6674}.xpi\" ascii wide nocase // Firefox - TronLink\n        $s83 = \"{7c42eea1-b3e4-4be4-a56f-82a5852b12dc}.xpi\" ascii wide nocase // Firefox - Phantom\n        $s84 = \"{b3e96b5f-b5bf-8b48-846b-52f430365e80}.xpi\" ascii wide nocase // Firefox - Phantom\n        $s85 = \"{eb1fb57b-ca3d-4624-a841-728fdb28455f}.xpi\" ascii wide nocase // Firefox - Phantom\n        $s86 = \"{76596e30-ecdb-477a-91fd-c08f2018df1a}.xpi\" ascii wide nocase // Firefox - Phantom\n        $s87 = \"ejjladinnckdgjemekebdpeokbikhfci\" ascii wide nocase // Petra Wallet\n        $s88 = \"bgpipimickeadkjlklgciifhnalhdjhe\" ascii wide nocase // GeroWallet\n        $s89 = \"epapihdplajcdnnkdeiahlgigofloibg\" ascii wide nocase // Sender\n        $s90 = \"aholpfdialjgjfhomihkjbmgjidlcdno\" ascii wide nocase // Exodus Web3 Wallet\n        $s91 = \"egjidjbpglichdcondbcbdnbeeppgdph\" ascii wide nocase // Trust Wallet\n        $s92 = \"pnndplcbkakcplkjnolgbkdgjikjednm\" ascii wide nocase // Tronium\n        $s93 = \"gojhcdgcpbpfigcaejpfhfegekdgiblk\" ascii wide nocase // Opera Wallet\n        $s94 = \"djclckkglechooblngghdinmeemkbgci\" ascii wide nocase // MetaMask\n        $s95 = \"jnmbobjmhlngoefaiojfljckilhhlhcj\" ascii wide nocase // OneKey\n    condition:\n        (uint16(0) == 0x5a4d and 8 of them) or (12 of them)\n}\n\nrule INDICATOR_Binary_Embedded_MFA_Browser_Extension_IDs {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detect binaries embedding considerable number of MFA browser extension IDs.\"\n    strings:\n        $s1 = \"bhghoamapcdpbohphigoooaddinpkbai\" ascii wide nocase // Authenticator\n        $s2 = \"gaedmjdfmmahhbjefcbgaolhhanlaolb\" ascii wide nocase // Authy 2FA\n        $s3 = \"oeljdldpnmdbchonielidgobddffflal\" ascii wide nocase // EOS Authenticator\n        $s4 = \"ilgcnhelpchnceeipipijaljkblbcobl\" ascii wide nocase // GAuth Authenticator\n        $s5 = \"imloifkgjagghnncjkhggdhalmcnfklk\" ascii wide nocase // Trezor Password Manager\n        $s6 = \"fdjamakpfbbddfjaooikfcpapjohcfmg\" ascii wide nocase // Dashlane — Password Manager\n        $s7 = \"fooolghllnmhmmndgjiamiiodkpenpbb\" ascii wide nocase // NordPass® Password Manager & Digital Vault\n        $s8 = \"pnlccmojcmeohlpggmfnbbiapkmbliob\" ascii wide nocase // RoboForm Password Manager\n        $s9 = \"hdokiejnpimakedhajhdlcegeplioahd\" ascii wide nocase // LastPass: Free Password Manager\n        $s10 = \"naepdomgkenhinolocfifgehidddafch\" ascii wide nocase // Browserpass\n        $s11 = \"bmikpgodpkclnkgmnpphehdgcimmided\" ascii wide nocase // MYKI Password Manager & Authenticator\n        $s12 = \"oboonakemofpalcgghocfoadofidjkkk\" ascii wide nocase // KeePassXC-Browser\n        $s13 = \"fmhmiaejopepamlcjkncpgpdjichnecm\" ascii wide nocase // KeePass Tusk\n        $s14 = \"nngceckbapebfimnlniiiahkandclblb\" ascii wide nocase // Bitwarden\n        $s15 = \"fiedbfgcleddlbcmgdigjgdfcggjcion\" ascii wide nocase // Microsoft AutoFill\n        $s16 = \"bfogiafebfohielmmehodmfbbebbbpei\" ascii wide nocase // Keeper\n        $s17 = \"jhfjfclepacoldmjmkmdlmganfaalklb\" ascii wide nocase // Splikity\n        $s18 = \"chgfefjpcobfbnpmiokfjjaglahmnded\" ascii wide nocase // CommonKey\n        $s19 = \"igkpcodhieompeloncfnbekccinhapdb\" ascii wide nocase // Zoho Vault\n    condition:\n        (uint16(0) == 0x5a4d and 5 of them) or (8 of them)\n}\n\nrule INDICATOR_SUSPICOUS_EXE_UNC_Regex {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables with considerable number of regexes often observed in infostealers\"\n    strings:\n        $s1 = \"^((8|\\\\+7|\\\\+380|\\\\+375|\\\\+373)[\\\\- ]?)?(\\\\(?\\\\d{3}\\\\)?[\\\\- ]?)?[\\\\d\\\\- ]{7,10}$\" ascii wide\n        $s2 = \"(^(1|3)(?=.*[0-9])(?=.*[a-zA-Z])[\\\\da-zA-Z]{27,34}?[\\\\d\\\\- ])|(^(1|3)(?=.*[0-9])(?=.*[a-zA-Z])[\\\\da-zA-Z]{27,34})$\" ascii wide\n        $s3 = \"(^L[A-Za-z0-9]{32,34}?[\\\\d\\\\- ])|(^L[A-Za-z0-9]{32,34})$\" ascii wide\n        $s4 = \"(^q[A-Za-z0-9\\\\:]{32,54}?[\\\\d\\\\- ])|(^q[A-Za-z0-9\\\\:]{32,54})$\" ascii wide\n        $s5 = \"^(P|p){1}[0-9]?[\\\\d\\\\- ]{7,15}|.+@.+\\\\..+$\" ascii wide\n        $s6 = \"(^0x[A-Za-z0-9]{40,42}?[\\\\d\\\\- ])|(^0x[A-Za-z0-9]{40,42})$\" ascii wide\n        $s7 = \"(^X[A-Za-z0-9]{32,34}?[\\\\d\\\\- ])|(^X[A-Za-z0-9]{32,34})$\" ascii wide\n        $s8 = \"^41001[0-9]?[\\\\d\\\\- ]{7,11}$\" ascii wide\n        $s9 = \"^R[0-9]?[\\\\d\\\\- ]{12,13}$\" ascii wide\n        $s10 = \"^Z[0-9]?[\\\\d\\\\- ]{12,13}$\" ascii wide\n        $s11 = \"(^(GD|GC)[A-Z0-9]{54,56}?[\\\\d\\\\- ])|(^(GD|GC)[A-Z0-9]{54,56})$\" ascii wide\n        $s12 = \"(^A[A-Za-z0-9]{32,34}?[\\\\d\\\\- ])|(^A[A-Za-z0-9]{32,34})$\" ascii wide\n        $s13 = \"(^t[A-Za-z0-9]{32,36}?[\\\\d\\\\- ])|(^t[A-Za-z0-9]{32,36})$\" ascii wide\n        $s14 = \"(^r[A-Za-z0-9]{32,34}?[\\\\d\\\\- ])|(^r[A-Za-z0-9]{32,34})$\" ascii wide\n        $s15 = \"(^G[A-Za-z0-9]{32,35}?[\\\\d\\\\- ])|(^G[A-Za-z0-9]{32,35})$\" ascii wide\n        $s16 = \"(^D[A-Za-z0-9]{32,35}?[\\\\d\\\\- ])|(^D[A-Za-z0-9]{32,35})$\" ascii wide\n        $s17 = \"(^(T[A-Z])[A-Za-z0-9]{32,35}?[\\\\d\\\\- ])|(^(T[A-Z])[A-Za-z0-9]{32,35})$\" ascii wide\n        $s18 = \"^1[a-km-zA-HJ-NP-Z1-9]{25,34}$\" wide // Crypto Wallet Address\n        $s19 = \"^3[a-km-zA-HJ-NP-Z1-9]{25,34}$\" wide // Crypto Wallet Address\n        $s20 = \"^([a-zA-Z0-9_\\\\-\\\\.]+)@([a-zA-Z0-9_\\\\-\\\\.]+)\\\\.([a-zA-Z]{2,5})$\" wide\n        $s21 = \"^(?!:\\\\/\\\\/)([a-zA-Z0-9-_]+\\\\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\\\\.[a-zA-Z]{2,11}?$\" wide\n    condition:\n        uint16(0) == 0x5a4d and 6 of them\n}\n\nrule INDICATOR_SUSPICIOUS_DeleteRecentItems {\n     meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding anti-forensic artifcats of deletiing Windows Recent Items\"\n    strings:\n        $s1 = \"del C:\\\\Windows\\\\AppCompat\\\\Programs\\\\RecentFileCache.bcf\" ascii wide nocase\n        $s2 = \"del /F /Q %APPDATA%\\\\Microsoft\\\\Windows\\\\Recent\\\\*\" ascii wide nocase\n        $s3 = \"del /F /Q %APPDATA%\\\\Microsoft\\\\Windows\\\\Recent\\\\CustomDestinations\\\\*\" ascii wide nocase\n        $s4 = \"del /F /Q %APPDATA%\\\\Microsoft\\\\Windows\\\\Recent\\\\AutomaticDestinations\\\\*\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and 2 of them\n}\n\nrule INDICATOR_SUSPICIOUS_DeleteWinDefednerQuarantineFiles {\n     meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding anti-forensic artifcats of deletiing Windows defender quarantine files\"\n    strings:\n        $s1 = \"rmdir C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Quarantine\\\\Entries /S\" ascii wide nocase\n\t\t$s2 = \"rmdir C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Quarantine\\\\Resources /S\" ascii wide nocase\n\t\t$s3 = \"rmdir C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Quarantine\\\\ResourceData /S\" ascii wide nocase\n        $r1 = \"rmdir\" ascii wide nocase\n        $p1 = \"Microsoft\\\\Windows Defender\\\\Quarantine\\\\Entries /S\" ascii wide nocase\n        $p2 = \"Microsoft\\\\Windows Defender\\\\Quarantine\\\\Resources /S\" ascii wide nocase\n        $p3 = \"Microsoft\\\\Windows Defender\\\\Quarantine\\\\ResourceData /S\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($s*) or (1 of ($r*) and 2 of ($p*)))\n}\n\nrule INDICATOR_SUSPICIOUS_DeleteShimCache {\n     meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding anti-forensic artifcats of deletiing shim cache\"\n    strings:\n        $s1 = \"Rundll32.exe apphelp.dll,ShimFlushCache\" ascii wide nocase\n        $s2 = \"Rundll32 apphelp.dll,ShimFlushCache\" ascii wide nocase\n        $m1 = \".dll,ShimFlushCache\" ascii wide nocase\n        $m2 = \"rundll32\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($s*) or all of ($m*))\n}\n\nrule INDICATOR_SUSPICIOUS_ShredFileSteps {\n     meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables embedding/copying file shredding steps\"\n    strings:\n        $s1 = { 55 00 00 00 aa 00 00 00 92 49 24 00 49 24 92 00\n                24 92 49 00 00 00 00 00 11 00 00 00 22 00 00 00\n                33 00 00 00 44 00 00 00 66 00 00 00 88 00 00 00\n                99 00 00 00 bb 00 00 00 cc 00 00 00 dd 00 00 00\n                ee 00 00 00 ff 00 00 00 6d b6 db 00 b6 db 6d 00\n                db 6d b6 }\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule INDICATOR_SUSPICIOUS_PWS_CaptureScreenshot {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PowerShell script with screenshot capture capability\"\n    strings:\n        $encoder = \".ImageCodecInfo]::GetImageEncoders(\" ascii nocase\n        $capture1 = \".Sendkeys]::SendWait(\\\"{PrtSc}\\\")\" ascii nocase\n        $capture2 = \".Sendkeys]::SendWait('{PrtSc}')\" ascii nocase\n        $access = \".Clipboard]::GetImage(\" ascii nocase\n        $save = \".Save(\" ascii nocase\n    condition:\n        $encoder and (1 of ($capture*) and ($access or $save))\n}\n\nrule INDICATOR_SUSPICIOUS_PWS_CaptureBrowserPlugins {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects PowerShell script with browser plugins capture capability\"\n    strings:\n        $s1 = \"$env:APPDATA +\" ascii nocase\n        $s2 = \"[\\\\w-]{24}\\\\.[\\\\w-]{6}\\\\.[\\\\w-]{27}|mfa\\\\.[\\\\w-]{84}\" ascii nocase\n        $s3 = \"\\\\leveldb\" ascii nocase\n        $o1 = \".Match(\" ascii nocase\n        $o2 = \".Contains(\" ascii nocase\n        $o3 = \".Add(\" ascii nocase\n    condition:\n        2 of ($s*) and 2 of ($o*)\n}\n\nrule INDICATOR_SUSPICIOUS_IMG_Embedded_B64_EXE {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects images with specific base64 markers and/or embedding (reversed) base64-encoded executables\"\n    strings:\n        $m1 = \"<<BASE64_START>>\" ascii\n        $m2 = \"<<BASE64_END>>\" ascii\n        $m3 = \"BASE64_START\" ascii\n        $m4 = \"BASE64_END\" ascii\n        $m5 = \"BASE64-START\" ascii\n        $m6 = \"BASE64-END\" ascii\n        $m7 = \"BASE64START\" ascii\n        $m8 = \"BASE64END\" ascii\n        $h1 = \"TVqQA\" ascii\n        $h2 = \"AQqVT\" ascii\n    condition:\n        (uint32(0) == 0xd8ff or uint32(0) == 0x474e5089 or uint16(0) == 0x4d42) and ((2 of ($m*)) or (1 of ($h*)))\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_TransferSh_URL {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects images embedding based64-encoded executable, and a base64 marker\"\n    strings:\n        $s1 = \"//transfer.sh/get/\" ascii wide nocase\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_References_AdsBlocker_Browser_Extension_IDs {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detect executables referencing considerable number of Ads blocking browser extension IDs\"\n    strings:\n        $s1 = \"gighmmpiobklfepjocnamgkkbiglidom\" ascii wide nocase // AdBlock\n        $s2 = \"cfhdojbkjhnklbpkdaibdccddilifddb\" ascii wide nocase // Adblock Plus\n        $s3 = \"cjpalhdlnbpafiamejdnhcphjbkeiagm\" ascii wide nocase // uBlock Origin\n        $s4 = \"epcnnfbjfcgphgdmggkamkmgojdagdnn\" ascii wide nocase // uBlock\n        $s5 = \"kacljcbejojnapnmiifgckbafkojcncf\" ascii wide nocase // Ad-Blocker\n        $s6 = \"gginmiamniniinhbipmknjiefidjlnob\" ascii wide nocase // Easy AdBlocker\n        $s7 = \"alplpnakfeabeiebipdmaenpmbgknjce\" ascii wide nocase // Adblocker for Chrome - NoAds\n        $s8 = \"ohahllgiabjaoigichmmfljhkcfikeof\" ascii wide nocase // AdBlocker Ultimate\n        $s9 = \"lmiknjkanfacinilblfjegkpajpcpjce\" ascii wide nocase // uBlocker\n        $s10 = \"lalfpjdbhpmnhfofkckdpkljeilmogfl\" ascii wide nocase // Hola ad remover\n    condition:\n        (uint16(0) == 0x5a4d and 5 of them) or (7 of them)\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_References_PublicServiceInterface {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detect executables referencing public and free service interface testing and dev services as means of CnC\"\n    strings:\n        $s1 = \"mockbin.org/bin\" ascii wide nocase\n        $s2 = \"run.mocky.io/v3\" ascii wide nocase\n        $s3 = \"webhook.site/\" ascii wide nocase\n        $s4 = \"devtunnels.ms/\" ascii wide nocase\n    condition:\n        (uint16(0) == 0x5a4d or uint16(0) == 0x457f or uint16(0) == 0xfacf) and 1 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SandboxComputerNames {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing possible sandbox analysis VM names\"\n    strings:\n        $s1 = \"bee7370c-8c0c-4\" fullword ascii wide nocase\n        $s2 = \"desktop-nakffmt\" fullword ascii wide nocase\n        $s3 = \"win-5e07cos9alr\" fullword ascii wide nocase\n        $s4 = \"b30f0242-1c6a-4\" fullword ascii wide nocase\n        $s5 = \"desktop-vrsqlag\" fullword ascii wide nocase\n        $s6 = \"desktop-d019gdm\" fullword ascii wide nocase\n        $s7 = \"desktop-wi8clet\" fullword ascii wide nocase\n        $s8 = \"server1\" fullword ascii wide nocase\n        $s9 = \"lisa-pc\" fullword ascii wide nocase\n        $s10 = \"john-pc\" fullword ascii wide nocase\n        $s11 = \"desktop-b0t93d6\" fullword ascii wide nocase\n        $s12 = \"desktop-1pykp29\" fullword ascii wide nocase\n        $s13 = \"desktop-1y2433r\" fullword ascii wide nocase\n        $s14 = \"wileypc\" fullword ascii wide nocase\n        $s15 = \"6c4e733f-c2d9-4\" fullword ascii wide nocase\n        $s16 = \"ralphs-pc\" fullword ascii wide nocase\n        $s17 = \"desktop-wg3myjs\" fullword ascii wide nocase\n        $s18 = \"desktop-7xc6gez\" fullword ascii wide nocase\n        $s19 = \"desktop-5ov9s0o\" fullword ascii wide nocase\n        $s20 = \"oreleepc\" fullword ascii wide nocase\n        $s21 = \"archibaldpc\" fullword ascii wide nocase\n        $s22 = \"julia-pc\" fullword ascii wide nocase\n        $s23 = \"compname_5076\" fullword ascii wide nocase\n        $s24 = \"desktop-vkeons4\" fullword ascii wide nocase\n        $s25 = \"NTT-EFF-2W11WSS\" fullword ascii wide nocase\n    condition:\n       uint16(0) == 0x5a4d and 10 of them\n}\n\nrule INDICATOR_SUSPICIOUS_EXE_SandboxSystemUUIDs {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects executables containing possible sandbox system UUIDs\"\n    strings:\n        $s1 = \"00000000-0000-0000-0000-000000000000\" ascii wide nocase\n        $s2 = \"00000000-0000-0000-0000-50E5493391EF\" ascii wide nocase\n        $s3 = \"00000000-0000-0000-0000-AC1F6BD048FE\" ascii wide nocase\n        $s4 = \"00000000-0000-0000-0000-AC1F6BD04972\" ascii wide nocase\n        $s5 = \"00000000-0000-0000-0000-AC1F6BD04986\" ascii wide nocase\n        $s6 = \"00000000-0000-0000-0000-AC1F6BD04D98\" ascii wide nocase\n        $s7 = \"02AD9898-FA37-11EB-AC55-1D0C0A67EA8A\" ascii wide nocase\n        $s8 = \"032E02B4-0499-05C3-0806-3C0700080009\" ascii wide nocase\n        $s9 = \"03DE0294-0480-05DE-1A06-350700080009\" ascii wide nocase\n        $s10 = \"050C3342-FADD-AEDF-EF24-C6454E1A73C9\" ascii wide nocase\n        $s11 = \"05790C00-3B21-11EA-8000-3CECEF4400D0\" ascii wide nocase\n        $s12 = \"07E42E42-F43D-3E1C-1C6B-9C7AC120F3B9\" ascii wide nocase\n        $s13 = \"08C1E400-3C56-11EA-8000-3CECEF43FEDE\" ascii wide nocase\n        $s14 = \"0934E336-72E4-4E6A-B3E5-383BD8E938C3\" ascii wide nocase\n        $s15 = \"11111111-2222-3333-4444-555555555555\" ascii wide nocase\n        $s16 = \"119602E8-92F9-BD4B-8979-DA682276D385\" ascii wide nocase\n        $s17 = \"12204D56-28C0-AB03-51B7-44A8B7525250\" ascii wide nocase\n        $s18 = \"12EE3342-87A2-32DE-A390-4C2DA4D512E9\" ascii wide nocase\n        $s19 = \"1D4D3342-D6C4-710C-98A3-9CC6571234D5\" ascii wide nocase\n        $s20 = \"2DD1B176-C043-49A4-830F-C623FFB88F3C\" ascii wide nocase\n        $s21 = \"2E6FB594-9D55-4424-8E74-CE25A25E36B0\" ascii wide nocase\n        $s22 = \"365B4000-3B25-11EA-8000-3CECEF44010C\" ascii wide nocase\n        $s23 = \"38813342-D7D0-DFC8-C56F-7FC9DFE5C972\" ascii wide nocase\n        $s24 = \"38AB3342-66B0-7175-0B23-F390B3728B78\" ascii wide nocase\n        $s25 = \"3A9F3342-D1F2-DF37-68AE-C10F60BFB462\" ascii wide nocase\n        $s26 = \"3F284CA4-8BDF-489B-A273-41B44D668F6D\" ascii wide nocase\n        $s27 = \"3F3C58D1-B4F2-4019-B2A2-2A500E96AF2E\" ascii wide nocase\n        $s28 = \"42A82042-3F13-512F-5E3D-6BF4FFFD8518\" ascii wide nocase\n        $s29 = \"44B94D56-65AB-DC02-86A0-98143A7423BF\" ascii wide nocase\n        $s30 = \"4729AEB0-FC07-11E3-9673-CE39E79C8A00\" ascii wide nocase\n        $s31 = \"481E2042-A1AF-D390-CE06-A8F783B1E76A\" ascii wide nocase\n        $s32 = \"48941AE9-D52F-11DF-BBDA-503734826431\" ascii wide nocase\n        $s33 = \"49434D53-0200-9036-2500-369025000C65\" ascii wide nocase\n        $s34 = \"49434D53-0200-9036-2500-369025003865\" ascii wide nocase\n        $s35 = \"49434D53-0200-9036-2500-369025003AF0\" ascii wide nocase\n        $s36 = \"49434D53-0200-9036-2500-36902500F022\" ascii wide nocase\n        $s37 = \"49434D53-0200-9065-2500-65902500E439\" ascii wide nocase\n        $s38 = \"4C4C4544-0050-3710-8058-CAC04F59344A\" ascii wide nocase\n        $s39 = \"4CB82042-BA8F-1748-C941-363C391CA7F3\" ascii wide nocase\n        $s40 = \"4D4DDC94-E06C-44F4-95FE-33A1ADA5AC27\" ascii wide nocase\n        $s41 = \"4DC32042-E601-F329-21C1-03F27564FD6C\" ascii wide nocase\n        $s42 = \"5BD24D56-789F-8468-7CDC-CAA7222CC121\" ascii wide nocase\n        $s43 = \"5E3E7FE0-2636-4CB7-84F5-8D2650FFEC0E\" ascii wide nocase\n        $s44 = \"5EBD2E42-1DB8-78A6-0EC3-031B661D5C57\" ascii wide nocase\n        $s45 = \"60C83342-0A97-928D-7316-5F1080A78E72\" ascii wide nocase\n        $s46 = \"63203342-0EB0-AA1A-4DF5-3FB37DBB0670\" ascii wide nocase\n        $s47 = \"63FA3342-31C7-4E8E-8089-DAFF6CE5E967\" ascii wide nocase\n        $s48 = \"6608003F-ECE4-494E-B07E-1C4615D1D93C\" ascii wide nocase\n        $s49 = \"67E595EB-54AC-4FF0-B5E3-3DA7C7B547E3\" ascii wide nocase\n        $s50 = \"6ECEAF72-3548-476C-BD8D-73134A9182C8\" ascii wide nocase\n        $s51 = \"6F3CA5EC-BEC9-4A4D-8274-11168F640058\" ascii wide nocase\n        $s52 = \"76122042-C286-FA81-F0A8-514CC507B250\" ascii wide nocase\n        $s53 = \"777D84B3-88D1-451C-93E4-D235177420A7\" ascii wide nocase\n        $s54 = \"79AF5279-16CF-4094-9758-F88A616D81B4\" ascii wide nocase\n        $s55 = \"7AB5C494-39F5-4941-9163-47F54D6D5016\" ascii wide nocase\n        $s56 = \"84FE3342-6C67-5FC6-5639-9B3CA3D775A1\" ascii wide nocase\n        $s57 = \"88DC3342-12E6-7D62-B0AE-C80E578E7B07\" ascii wide nocase\n        $s58 = \"8B4E8278-525C-7343-B825-280AEBCD3BCB\" ascii wide nocase\n        $s59 = \"8DA62042-8B59-B4E3-D232-38B29A10964A\" ascii wide nocase\n        $s60 = \"907A2A79-7116-4CB6-9FA5-E5A58C4587CD\" ascii wide nocase\n        $s61 = \"921E2042-70D3-F9F1-8CBD-B398A21F89C6\" ascii wide nocase\n        $s62 = \"96BB3342-6335-0FA8-BA29-E1BA5D8FEFBE\" ascii wide nocase\n        $s63 = \"9921DE3A-5C1A-DF11-9078-563412000026\" ascii wide nocase\n        $s64 = \"9961A120-E691-4FFE-B67B-F0E4115D5919\" ascii wide nocase\n        $s65 = \"9C6D1742-046D-BC94-ED09-C36F70CC9A91\" ascii wide nocase\n        $s66 = \"A15A930C-8251-9645-AF63-E45AD728C20C\" ascii wide nocase\n        $s67 = \"A7721742-BE24-8A1C-B859-D7F8251A83D3\" ascii wide nocase\n        $s68 = \"A9C83342-4800-0578-1EE8-BA26D2A678D2\" ascii wide nocase\n        $s69 = \"ACA69200-3C4C-11EA-8000-3CECEF4401AA\" ascii wide nocase\n        $s70 = \"ADEEEE9E-EF0A-6B84-B14B-B83A54AFC548\" ascii wide nocase\n        $s71 = \"AF1B2042-4B90-0000-A4E4-632A1C8C7EB1\" ascii wide nocase\n        $s72 = \"B1112042-52E8-E25B-3655-6A4F54155DBF\" ascii wide nocase\n        $s73 = \"B6464A2B-92C7-4B95-A2D0-E5410081B812\" ascii wide nocase\n        $s74 = \"BB233342-2E01-718F-D4A1-E7F69D026428\" ascii wide nocase\n        $s75 = \"BB64E044-87BA-C847-BC0A-C797D1A16A50\" ascii wide nocase\n        $s76 = \"BE784D56-81F5-2C8D-9D4B-5AB56F05D86E\" ascii wide nocase\n        $s77 = \"C249957A-AA08-4B21-933F-9271BEC63C85\" ascii wide nocase\n        $s78 = \"C6B32042-4EC3-6FDF-C725-6F63914DA7C7\" ascii wide nocase\n        $s79 = \"C7D23342-A5D4-68A1-59AC-CF40F735B363\" ascii wide nocase\n        $s80 = \"CC5B3F62-2A04-4D2E-A46C-AA41B7050712\" ascii wide nocase\n        $s81 = \"CE352E42-9339-8484-293A-BD50CDC639A5\" ascii wide nocase\n        $s82 = \"CEFC836C-8CB1-45A6-ADD7-209085EE2A57\" ascii wide nocase\n        $s83 = \"CF1BE00F-4AAF-455E-8DCD-B5B09B6BFA8F\" ascii wide nocase\n        $s84 = \"D2DC3342-396C-6737-A8F6-0C6673C1DE08\" ascii wide nocase\n        $s85 = \"D7382042-00A0-A6F0-1E51-FD1BBF06CD71\" ascii wide nocase\n        $s86 = \"D8C30328-1B06-4611-8E3C-E433F4F9794E\" ascii wide nocase\n        $s87 = \"D9142042-8F51-5EFF-D5F8-EE9AE3D1602A\" ascii wide nocase\n        $s88 = \"DBC22E42-59F7-1329-D9F2-E78A2EE5BD0D\" ascii wide nocase\n        $s89 = \"DBCC3514-FA57-477D-9D1F-1CAF4CC92D0F\" ascii wide nocase\n        $s90 = \"DD9C3342-FB80-9A31-EB04-5794E5AE2B4C\" ascii wide nocase\n        $s91 = \"DEAEB8CE-A573-9F48-BD40-62ED6C223F20\" ascii wide nocase\n        $s92 = \"E08DE9AA-C704-4261-B32D-57B2A3993518\" ascii wide nocase\n        $s93 = \"EADD1742-4807-00A0-F92E-CCD933E9D8C1\" ascii wide nocase\n        $s94 = \"EB16924B-FB6D-4FA1-8666-17B91F62FB37\" ascii wide nocase\n        $s95 = \"F3988356-32F5-4AE1-8D47-FD3B8BAFBD4C\" ascii wide nocase\n        $s96 = \"F5744000-3C78-11EA-8000-3CECEF43FEFE\" ascii wide nocase\n        $s97 = \"FA8C2042-205D-13B0-FCB5-C5CC55577A35\" ascii wide nocase\n        $s98 = \"FCE23342-91F1-EAFC-BA97-5AAE4509E173\" ascii wide nocase\n        $s99 = \"FE455D1A-BE27-4BA4-96C8-967A6D3A9661\" ascii wide nocase\n        $s100 = \"FE822042-A70C-D08B-F1D1-C207055A488F\" ascii wide nocase\n        $s101 = \"FED63342-E0D6-C669-D53F-253D696D74DA\" ascii wide nocase\n        $s102 = \"FF577B79-782E-0A4D-8568-B35A9B7EB76B\" ascii wide nocase\n    condition:\n       uint16(0) == 0x5a4d and 10 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.606Z",
    "status": "active"
}