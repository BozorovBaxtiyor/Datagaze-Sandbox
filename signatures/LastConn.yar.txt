{
    "name": "LastConn.yar",
    "rule": "rule LastConn {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects LastConn\"\n        cape_type = \"LastConn Payload\"\n    strings:\n        $s1 = \"System.Net.Http.SysSR\" fullword wide\n        $s2 = \"System.Net.Http.WrSR\" fullword wide\n        $s3 = \"yyyy'-'MM'-'dd'T'HH':'mm':'ss.FFFFFFFK\" fullword wide\n        $s4 = { 63 00 6f 00 6e 00 74 00 65 00 6e 00 74 00 0c 6e\n               00 6f 00 74 00 69 00 66 00 79 00 04 06 12 80 e8\n               05 00 00 12 80 e8 08 75 00 73 00 65 00 72 00 08\n               74 00 65 00 61 00 6d 00 06 61 00 70 00 70 00 0c\n               6e 00 6f 00 61 00 75 00 74 00 68 00 }\n        $s5 = { 68 00 69 00 64 00 64 00 65 00 6e 00 10 64 00 69\n               00 73 00 61 00 6c 00 6c 00 6f 00 77 00 0e 65 00\n               78 00 74 00 65 00 6e 00 64 00 73 00 04 69 00 64\n               00 16 75 00 6e 00 69 00 71 00 75 00 65 00 49 00\n               74 00 65 00 6d 00 73 }\n        $s6 = \"<RunFileOnes>d__\" ascii\n        $s7 = \"<UploadFile>d__\" ascii\n        $s8 = \"<ChunkUpload>d__\" ascii\n        $s9 = \"<StartFolder>d__\" ascii\n        $s10 = \"<ReadFileAlw>d__\" ascii\n        $s12 = \"<WriteFileToD>d__\" ascii\n        $s13 = \"<ReadFile>d__\" ascii\n        $s14 = \"<GetUpload>d__\" ascii\n        $s15 = \"CDropbox.Api.DropboxRequestHandler+<RequestJsonStringWithRetry>d__\" ascii\n    condition:\n        uint16(0) == 0x5a4d and 12 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.734Z",
    "status": "active"
}