{
    "name": "WCE.yar",
    "rule": "rule WindowsCredentialsEditor\n{\nmeta:\n\tdescription = \"Identifies Windows Credentials Editor (WCE), post-exploitation tool.\"\n\tauthor = \"@bartblaze\"\n\tdate = \"2020-01\"\n\treference = \"https://www.ampliasecurity.com/research/windows-credentials-editor/\"\n\ttlp = \"White\"\n\tcape_type = \"WCE Payload\"\n\nstrings:\n\t$ = \"Windows Credentials Editor\" ascii wide\n\t$ = \"Can't enumerate logon sessions!\" ascii wide\n\t$ = \"Cannot get PID of LSASS.EXE!\" ascii wide\n\t$ = \"Error: cannot dump TGT\" ascii wide\n\t$ = \"Error: Cannot extract auxiliary DLL!\" ascii wide\n\t$ = \"Error: cannot generate LM Hash.\" ascii wide\n\t$ = \"Error: cannot generate NT Hash.\" ascii wide\n\t$ = \"Error: Cannot open LSASS.EXE!.\" ascii wide\n\t$ = \"Error in cmdline!.\" ascii wide\n\t$ = \"Forced Safe Mode Error: cannot read credentials using 'safe mode'.\" ascii wide\n\t$ = \"Reading by injecting code! (less-safe mode)\" ascii wide\n\t$ = \"username is too long!.\" ascii wide\n\t$ = \"Using WCE Windows Service..\" ascii wide\n\t$ = \"Using WCE Windows Service...\" ascii wide\n\t$ = \"Warning: I will not be able to extract the TGT session key\" ascii wide\n\t$ = \"WCEAddNTLMCredentials\" ascii wide\n\t$ = \"wceaux.dll\" ascii wide fullword\n\t$ = \"WCEGetNTLMCredentials\" ascii wide\n\t$ = \"wce_ccache\" ascii wide fullword\n\t$ = \"wce_krbtkts\" ascii wide fullword\n\ncondition:\n\t3 of them\n}\n\nrule WCE\n{\n\tmeta:\n\t\tdescription\t\t= \"Windows Credentials Editor\"\n\t\tauthor\t\t\t= \"Benjamin DELPY (gentilkiwi)\"\n\t\ttool_author\t\t= \"Hernan Ochoa (hernano)\"\n\t\tcape_type\t\t= \"WCE Payload\"\n\n\tstrings:\n\t\t$hex_legacy\t\t= { 8b ff 55 8b ec 6a 00 ff 75 0c ff 75 08 e8 [0-3] 5d c2 08 00 }\n\t\t$hex_x86\t\t= { 8d 45 f0 50 8d 45 f8 50 8d 45 e8 50 6a 00 8d 45 fc 50 [0-8] 50 72 69 6d 61 72 79 00 }\n\t\t$hex_x64\t\t= { ff f3 48 83 ec 30 48 8b d9 48 8d 15 [0-16] 50 72 69 6d 61 72 79 00 }\n\n\tcondition:\n\t\tany of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.673Z",
    "status": "active"
}