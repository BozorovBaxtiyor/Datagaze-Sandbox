{
    "name": "ScoutElite.yar",
    "rule": "import \"pe\"\n\nrule MALWARE_Win_ScoutElite {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects ScoutElite\"\n        cape_type = \"ScoutElite Payload\"\n        reference = \"https://github.com/ditekshen/back-in-2017\"\n    strings:\n        $cmd1 = \"command=scote_ping\" fullword ascii\n        $cmd2 = \"command=scote_info_ipconfig\" fullword ascii\n        $cmd3 = \"command=scote_info_systeminfo\" fullword ascii\n        $cmd4 = \"command=scote_connection|hwid=\" fullword ascii\n        $cmd5 = \"command=ping\" fullword wide\n        $cmd6 = \"command=screen_capture_init\" fullword wide\n        $cmd7 = \"command=screen_capture\" fullword wide\n        $cmd8 = \"command=silence_screenshot\" fullword wide\n        $cmd9 = \"command=silence_keylogger\" fullword wide\n        $cmd10 = \"command=silence_password\" fullword wide\n        $cmd11 = \"command=screen_thumb\" fullword wide\n        $cmd12 = \"command=filemanager_upload_tcp\" fullword wide\n        $cmd13 = \"command=filemanager_download\" fullword wide\n        $cmd14 = \"command=filemanager_init\" fullword wide\n        $cmd15 = \"command=filemanager_root\" fullword wide\n        $cmd16 = \"command=filemanager_folder_filemanager_file\" fullword wide\n        $cmd17 = \"command=filemanager_thumb\" fullword wide\n        $cmd18 = \"command=keylogger_init\" fullword wide\n        $cmd19 = \"command=keylogger_file\" fullword wide\n        $cmd20 = \"command=password_firefox\" fullword wide\n        $cmd21 = \"command=password_opera\" fullword wide\n        $cmd22 = \"command=password_chrome\" fullword wide\n        $cmd23 = \"command=password_all\" fullword wide\n        $cmd24 = \"command=password_init\" fullword wide\n        $cmd25 = \"command=misc_init\" fullword wide\n        $cmd26 = \"command=misc_process\" fullword wide\n        $cmd27 = \"command=misc_cmd\" fullword wide\n        $cmd28 = \"command=new_rcs\" fullword wide\n        $cmd29 = \"command=microphone_capture\" fullword wide\n        $cmd30 = \"command=microphone_capture_init\" fullword wide\n        $cmd31 = \"command=rvmedia_capture_init\" fullword wide\n        $cmd32 = \"command=rvmedia_list\" fullword wide\n        $cmd33 = \"command=rvmedia_resolution\" fullword wide\n        $cmd34 = \"command=webcam_capture_init\" fullword wide\n        $cmd35 = \"command=webcam_list\" fullword wide\n        $cmd36 = \"command=webcam_resolution\" fullword wide\n        $cmd37 = \"command=webcam_capture\" fullword wide\n\n        $gcmd1 = \"filemanager_download_ftp\" fullword wide\n        $gcmd2 = \"download_file_ftp\" fullword wide\n        $gcmd3 = \"filemanager_upload_http\" fullword wide\n        $gcmd4 = \"upload_file_http\" fullword wide\n        $gcmd5 = \"upload_url\" fullword wide\n        $gcmd6 = \"filemanager_delete\" fullword wide\n        $gcmd7 = \"filemanager_execute_file\" fullword wide\n        $gcmd8 = /(microphone|webcam|rvmedia|keylogger|password|screen|filemanager)_(host|port|guid)/ nocase\n\n        $confs1 = \"[nick_name]\" fullword ascii\n        $confe1 = \"[/nick_name]\" fullword ascii wide\n        $confs2 = \"[install_name]\" fullword ascii wide\n        $confe2 = \"[/install_name]\" fullword ascii wide\n        $confs3 = \"[install_folder]\" fullword ascii wide\n        $confe3 = \"[/install_folder]\" fullword ascii wide\n        $confs4 = \"[reg_startup]\" fullword ascii wide\n        $confe4 = \"[/reg_startup]\" fullword ascii wide\n        $confs5 = \"[folder_startup]\" fullword ascii wide\n        $confe5 = \"[/folder_startup]\" fullword ascii wide\n        $confs6 = \"[task_startup]\" fullword ascii wide\n        $confe6 = \"[/task_startup]\" fullword ascii wide\n        $confs7 = \"[injection]\" fullword ascii wide\n        $confe7 = \"[/injection]\" fullword ascii wide\n        $confs8 = \"[injection_process]\" fullword ascii wide\n        $confe8 = \"[/injection_process]\" fullword ascii wide\n        $confs9 = \"[connection]\" fullword ascii wide\n        $confe9 = \"[/connection]\" fullword ascii wide\n    condition:\n        (uint16(0) == 0x5a4d and (2 of ($cmd*) or 7 of ($gcmd*) or (2 of ($confs*) and 2 of ($confe*)) or (pe.exports(\"__elite\") and 2 of them))) or (15 of them)\n}\n\nrule MALWARE_Win_ScoutElitePS {\n    meta:\n        author = \"ditekshen\"\n        description = \"Detects PowerShell-based ScoutElite\"\n        cape_type = \"ScoutElite Payload\"\n        reference = \"https://github.com/ditekshen/back-in-2017\"\n    strings:\n        $cnc1 = \"http://beginpassport.comf\" ascii wide nocase\n        $cnc2 = \"f_dump.php\" ascii wide nocase\n        $cnc3 = \"c_dump.php\" ascii wide nocase\n        $cnc4 = \"o_dump.php\" ascii wide nocase\n        $db1 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cookies\" ascii wide nocase\n        $db2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*.default\" ascii wide nocase\n        $db3 = \"\\\\Opera Software\\\\Opera Stable\\\\Cookies\" ascii wide nocase\n        $db4 = \"$($env:LOCALAPPDATA)\\\\Google\\\\Chrome\\\\User Data\\\\Default\" ascii nocase\n        $db5 = \"$($env:APPDATA)\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*.default\" ascii nocase\n        $db6 = \"$($env:APPDATA)\\\\Opera Software\\\\Opera Stable\" ascii nocase\n        $cond1 = \"SSID\" ascii wide\n        $cond2 = \"MSPAuth\" ascii wide\n        $cond3 = \"\\\"'T'\\\"\" ascii wide\n        $cond4 = \"SNS_AA\" ascii wide\n        $cond5 = \"X-APPLE-WEBAUTH-TOKEN\" ascii wide\n        $sql1 = \"SELECT * FROM 'cookies' WHERE host_key LIKE $\" ascii wide nocase\n        $sql2 = \"SELECT * FROM 'moz_cookies' WHERE host LIKE $\" ascii wide nocase\n        $sql3 = \"SELECT origin_url, username_value ,password_value FROM 'logins'\" ascii nocase\n        $def1 = \"Add-Type -AssemblyName System.Security\" ascii wide nocase\n        $def2 = \"System.Security.SecureString\" ascii wide nocase\n        $def3 = \"ConvertFrom-SecureString\" ascii wide nocase\n        $def4 = \"[System.Security.Cryptography.ProtectedData]::Unprotect(\" ascii wide nocase\n        $def5 = \"[Security.Cryptography.DataProtectionScope]::LocalMachine\" ascii wide nocase\n        $def6 = \"[Security.Cryptography.DataProtectionScope]::CurrentUser\" ascii wide nocase\n        $def7 = \"System.Data.SQLite.SQLiteConnection\" ascii wide nocase\n        $def8 = \"[Environment]::OSVersion.ToString().Replace(\\\"Microsoft Windows \\\",\" ascii wide nocase\n        $def9 = \"Start-Sleep\" ascii wide nocase\n condition:\n     (1 of ($cnc*) and any of ($db*) and any of ($cond*) and any of ($sql*) and 7 of ($def*)) or (all of them)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.740Z",
    "status": "active"
}