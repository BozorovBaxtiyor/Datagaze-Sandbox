{
    "name": "Karagany.yar",
    "rule": "rule KaraganyCore {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Karagany/xFrost core plugin\"\n        cape_type = \"KaraganyCore Payload\"\n    strings:\n        $s1 = \"127.0.0.1\" fullword ascii\n        $s2 = \"port\" fullword ascii\n        $s3 = \"C:\\\\Windows\\\\System32\\\\Kernel32.dll\" fullword ascii\n        $s4 = \"kernel32.dll\" fullword ascii\n        $s5 = \"http\" ascii\n        $s6 = \"Move\" fullword ascii\n        $s7 = \"<supportedOS Id=\\\"{\" ascii\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule KaraganyKeylogger {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Karagany/xFrost keylogger plugin\"\n        cape_type = \"KaraganyKeylogger Payload\"\n    strings:\n        $s1 = \"__klg__\" fullword wide\n        $s2 = \"__klgkillsoft__\" fullword wide\n        $s3 = \"CLIPBOARD_PASTE\" wide\n        $s4 = \"%s\\\\k%d.txt\" wide\n        $s5 = \"\\\\Update\\\\Tmp\" wide\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule KaraganyScreenUtil {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Karagany/xFrost ScreenUtil module\"\n        cape_type = \"KaraganyScreenUtil Payload\"\n    strings:\n        $s1 = \"__pic__\" ascii wide\n        $s2 = \"__pickill__\" ascii wide\n        $s3 = \"\\\\picture.png\" fullword wide\n        $s4 = \"%d.jpg\" wide\n        $s5 = \"\\\\Update\\\\Tmp\" wide\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule KaraganyListrix {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects Karagany/xFrost Listrix module\"\n        cape_type = \"KaraganyListrix Payload\"\n    strings:\n        $s1 = \"\\\\Update\\\\Tmp\\\\\" wide\n        $s2 = \"*pass*.*\" fullword wide\n        $s3 = \">> NUL\" wide\n        $s4 = \"%02d.%02d.%04d %02d:%02d\" wide\n        $s5 = \"/c del\" wide\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.735Z",
    "status": "active"
}