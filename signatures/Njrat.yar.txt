{
    "name": "Njrat.yar",
    "rule": "rule Njrat\n{\n        meta:\n                author = \" Kevin Breen <kevin@techanarchy.net> & ditekSHen\"\n                ref = \"http://malwareconfig.com/stats/njRat\"\n                maltype = \"Remote Access Trojan\"\n                filetype = \"exe\"\n        cape_type = \"Njrat Payload\"\n\n        strings:\n\n                $s1 = {7C 00 27 00 7C 00 27 00 7C} // |'|'|\n                $s2 = \"netsh firewall add allowedprogram\" wide\n                $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" wide\n                $s4 = \"yyyy-MM-dd\" wide\n\n                $v1 = \"cmd.exe /k ping 0 & del\" wide\n                $v2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide\n                $v3 = \"cmd.exe /c ping 0 -n 2 & del\" wide\n\n                $x1 = \"netsh firewall delete allowedprogram\" wide\n                $x2 = \"netsh firewall add allowedprogram\" wide\n                $x3 = { 63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 20 00 2f 00 (63|6b) 00 20 00 70 00 69 00 6e 00 67 }\n                $x4 = \"Execute ERROR\" wide\n                $x5 = \"Download ERROR\" wide\n                $x6 = \"[kl]\" fullword wide\n        condition:\n                (all of ($s*) and any of ($v*)) or (uint16(0) == 0x5a4d and 4 of ($x*))\n}\n\nrule NjRATGolden {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects NjRAT / Bladabindi / NjRAT Golden\"\n        cape_type = \"Njrat Payload\"\n    strings:\n        $x1 = /Njrat\\s\\d+\\.\\d+\\sGolden\\s/ wide\n        $s1 = /\\sfirewall\\s(add|delete)\\sallowedprogram/ wide\n        $s2 = { 63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 20 00 2f 00 (63|6b) 00 20 00 70 00 69 00 6e 00 67 }\n        $s3 = \"Execute ERROR\" wide\n        $s4 = \"Download ERROR\" wide\n        $s5 = \"[kl]\" fullword wide\n        $s6 = \"UploadValues\" fullword wide\n        $s7 = \"winmgmts:\\\\\\\\.\\\\root\\\\SecurityCenter2\" fullword wide\n        $s8 = \"HideM\" fullword wide \n        $s9 = \"No Antivirus\" fullword wide \n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.656Z",
    "status": "active"
}