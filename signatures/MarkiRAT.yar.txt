{
    "name": "MarkiRAT.yar",
    "rule": "rule MarkiRAT {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects MarkiRAT\"\n        cape_type = \"MarkiRAT Payload\"\n    strings:\n        $pdb = \"\\\\mfcmklg.pdb\" ascii\n        $s1 = \"runinhome Completed\" wide\n        $s2 = \"ERROR find next file<br>\" wide\n        $s3 = \"<br><mark>Hello: %s</mark>\" wide\n        $s4 = \"<br><mark>CLIPBOARD[\" wide\n        $s5 = \"@userhome@\" wide\n        $s6 = \"Global\\\\{2194ABA1-BFFA-4e6b-8C26-D1BB20190312}\" wide\n        $s7 = \"taskkill /im svehost.exe /t /f\" fullword ascii\n        $s8 = \"taskkill /im keepass.exe /t /f\" fullword ascii\n        $ba = /bitsadmin \\/(addfile|cancel|SetPriority|resume)/ ascii wide\n        $c1 = \"/ech/client.php?u=\" wide\n        $c2 = \"/up/uploadx.php?u=\" wide\n        $c3 = \"/ech/echo.php?req=rr&u=\" wide\n        $c4 = \"/ech/rite.php\" wide\n        $c5 = \"http://microsoft.com-view.space/i.php?u=\" wide\n        $c6 = \"Content-Disposition: form-data; name=\\\"uploadedfile\\\"; filename=\\\"\" ascii\n    condition:\n        uint16(0) == 0x5a4d and (($pdb and any of them) or (5 of ($s*)) or (3 of ($c*)) or ((#ba > 3 and 4 of them)))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.692Z",
    "status": "active"
}