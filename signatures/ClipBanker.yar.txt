{
    "name": "ClipBanker.yar",
    "rule": "rule ClipBanker01 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects ClipBanker infostealer\"\n        cape_type = \"ClipBanker Payload\"\n    strings:\n        $s1 = \"Clipper\" fullword wide\n        $s2 = \"Ushell\" fullword wide\n        $s3 = \"Banker\" fullword wide\n        $s4 = \"ClipPurse\" fullword wide nocase\n        $s5 = \"SelfClip\" fullword wide\n        $s6 = \"Cliper\" fullword wide\n        $s7 = \"FHQD4313-33DE-489D-9721-6AFF69841DEA\" fullword wide\n        $s8 = \"Remove.bat\" fullword wide\n        $s9 = \"\\\\w{1}\\\\d{12}\" fullword wide\n        $s10 = \"SELECT * FROM Win32_ComputerSystem\" fullword wide\n        $s11 = \"red hat\" fullword wide\n        $s12 = { 73 00 63 00 68 00 74 00 61 00 73 00 6b 00 73 00\n                 2e 00 65 00 78 00 65 00 00 ?? 2f 00 63 00 72 00\n                 65 00 61 00 74 00 65 00 20 00 2f 00 73 00 63 00\n                 20 00 00 ?? 20 00 2f 00 6d 00 6f 00 20 00 00 ??\n                 20 00 2f 00 72 00 6c 00 20 00 00 ?? 20 00 2f 00\n                 74 00 6e 00 20 00 00 ?? 20 00 2f 00 74 00 72 00\n                 20 00 00 ?? 20 00 ?? 00 ?? 00 00 ?? 2f 00 64 00\n                 65 00 6c 00 65 00 74 00 65 00 20 00 2f 00 74 00\n                 6e }\n        $s13 = \"ClipChanger\" fullword ascii\n        $s14 = \"CheckVirtual\" fullword ascii\n        $s15 = \"InjReg\" fullword ascii\n        $s16 = \"SuicideFile\" fullword ascii\n        $s17 = \"HideFile\" fullword ascii\n        $s18 = \"AntiVm\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and 7 of them\n}\n\nrule ClipBanker02 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects ClipBanker infostealer\"\n        cape_type = \"ClipBanker Payload\"\n    strings:\n        $x1 = \"\\\\Allcome\\\\Source code\\\\Clipper\\\\\" ascii nocase\n        $x2 = \"\\\\cleaper\\\\Release\\\\cleaper.pdb\" ascii nocase\n        $v1_1 = \"&username=\" fullword ascii\n        $v1_2 = \"/card.php?data=\" fullword ascii\n        $v1_3 = \"/Create /tn MicrosoftDriver /sc MINUTE /tr\" fullword ascii\n        $v1_4 = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0\" fullword ascii\n        $v1_5 = \"/API/Clipper/ykesqk0o.php?cf6zrlhn=\" fullword ascii\n        $v1_6 = \"&di7ztth6=\" fullword ascii\n        $v1_7 = \"/API/Clipper/hr627gzk.php?v6etwxo5=\" fullword ascii\n        $v2_1 = \"bitcoincash:\" fullword ascii\n        $v2_2 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\" ascii\n        $re1 = \"^[0-9]{16}$\" fullword ascii\n        $re2 = \"^[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\\\\s[0-9]{4}\" fullword ascii\n        $re3 = \"^\\\\d{2}\\\\D\\\\d{2}\" fullword ascii\n        $re4 = \"^[0-9]{3}\" fullword ascii\n        $re5 = \"([\\\\W]?[0-9]{4}[\\\\W]?[0-9]{4}[\\\\W]?[0-9]{4}[\\\\W]?[0-9]{4}[\\\\W]?)\" fullword ascii\n        $re6 = \"(\\\\d{2}\\\\D\\\\d{2})\" fullword ascii\n        $re7 = \"(\\\\d{3})\" fullword ascii\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($x*) and (5 of ($v1*) or all of ($v2*))) or (3 of ($re*) and (2 of ($v1*) or 2 of ($v2*))))\n}\n\nrule ClipBanker03 {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects ClipBanker Infostealer\"\n        cape_type = \"ClipBanker Payload\"\n    strings:\n        $s1 = \"UNIC_KEY\" fullword wide\n        $s2 = \"[StartUp]\" fullword wide\n        $s3 = \"[Kill]\" fullword wide\n        $s4 = \"[antivm]\" fullword wide\n        $s5 = \"AntiVM\" fullword ascii\n        $s6 = \"AntiKill\" fullword ascii\n        $s7 = \"hWndRemove\" fullword ascii\n        $s8 = \"/Clip(watch|Chang|Mon)/\" fullword ascii\n        $w1 = \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\" fullword wide\n        $w2 = \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0\" fullword wide\n        $w3 = \"/create /sc MINUTE /mo 1 /tn \\\"Windows Service\\\" /tr \\\"\" fullword wide\n        $w4 = \"Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\" fullword wide\n        $w5 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and (5 of ($s*) or all of ($w*) or 6 of them)\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.707Z",
    "status": "active"
}