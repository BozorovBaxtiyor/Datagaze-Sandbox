{
    "name": "WinDealer.yar",
    "rule": "import \"pe\"\n\nrule WinDealer {\n    meta:\n        author = \"ditekSHen\"\n        description = \"Detects WinDealer\"\n        cape_type = \"WinDealer\"\n    strings:\n        $d1 = \"downfile\" fullword ascii\n        $d2 = \"getmypath\" fullword ascii\n        $d3 = \"content-type: monitor\" fullword ascii\n        $d4 = \"content-type: UsedType\" fullword ascii\n        $d5 = \"write command error\" fullword ascii\n        $d6 = \"C:\\\\WINDOWS\\\\system32\\\\kernel32.dll\" fullword ascii\n        $l1 = \"currentconfig\" fullword ascii\n        $l2 = \"remotedomain\" fullword ascii\n        $l3 = \"reserveip\" fullword ascii\n        $l4 = \"otherinfo\" fullword ascii\n        $l5 = \"filelen\" fullword ascii\n        $l6 = \"%s%s.bak\" fullword wide\n        $l7 = \"localmachine\" fullword ascii\n        $l8 = \"remoteip\" fullword ascii\n        $l9 = \"datastate\" fullword ascii\n        $l10 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Network\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\%s\\\\Connection\" fullword ascii\n        $s1 = \"%s\\\\%s\\\\V5_History.dat\" fullword wide\n        $s2 = \"%s\\\\%s\\\\history2.dat\" fullword wide\n        $s3 = \"%s\\\\%s\\\\history.imw\" fullword wide\n        $s4 = \"%s\\\\%s\\\\main.imw\" fullword wide\n        $s5 = \"%s%d.%d.%d.%dWindows/%u\" fullword ascii\n        $s6 = \"%s\\\\%c_%s_tmp\" fullword wide\n        $s7 = \"%s\\\\%s\\\\main.db\" fullword wide\n    condition:\n        uint16(0) == 0x5a4d and ((4 of ($d*) and 1 of ($s*)) or (5 of ($s*) and 1 of ($d*)) or 6 of ($l*) or (pe.exports(\"DealC\") and pe.exports(\"DealR\") and pe.exports(\"DealS\") and 1 of them))\n}\n",
    "uploadedBy": "f0b33c9c-0019-4046-984b-f6f3d95dea61",
    "category": "yar",
    "uploadedAt": "2025-05-07T09:54:43.661Z",
    "status": "active"
}